import{j as n,M as VC,S as wt,G as yi,m as re,B as du,U as Xt,H as sE,L as jr,F as cr,a as zr,b as rr,c as jo,d as js,e as bt,f as ba,C as Gl,g as Kl,h as Ts,i as As,k as ot,l as lt,n as ug,o as wo,p as iE,q as fa,r as ja,A as GC,X as Qe,s as ma,t as Le,T as Ge,u as Yn,E as Ff,v as mr,P as Cr,w as vi,x as ks,y as lr,z as dt,D as fc,I as xt,J as un,R as no,K as KC,N as fd,O as XC,Q as An,V as Hr,W as Df,Y as Cn,Z as sa,_ as ar,$ as ti,a0 as pt,a1 as Rf,a2 as Ia,a3 as Xl,a4 as No,a5 as L0,a6 as Pn,a7 as YC,a8 as Mr,a9 as nr,aa as Za,ab as nl,ac as n1,ad as _o,ae as JC,af as s1,ag as sl,ah as oE,ai as ci,aj as uu,ak as lE,al as Mf,am as $0,an as il,ao as QC,ap as Xa,aq as ZC,ar as fu,as as hu,at as Lf,au as cE,av as hc,aw as dE,ax as B0,ay as U0,az as eP,aA as tP,aB as rP,aC as aP,aD as nP,aE as i1,aF as fg,aG as uE,aH as o1,aI as sP,aJ as Yl,aK as iP,aL as oP,aM as lP,aN as l1,aO as di,aP as cP,aQ as dP,aR as Vs,aS as uP,aT as fP,aU as hP,aV as mP,aW as fE,aX as xP}from"./ui-BiGhBaNv.js";import{b as pP,a as C,u as Rs,L as ke,c as nv,d as Hn,g as Ct,e as gP,f as hE,R as ee,B as yP,h as vP,i as at,N as Wn}from"./react-Bb7_eYuX.js";import{i as bP,g as jP,a as wP,b as NP,e as _P,d as SP,c as Oe,s as Ve,f as Fa,h as st,j as Dt,q as Me,w as De,k as Ie,l as Da,u as sr,E as kP,r as EP,m as TP,n as AP,T as la,o as So,p as CP,t as mu,v as mE,x as sv,y as PP,z as ol,A as OP,B as _l,G as IP,C as FP,D as hg,F as xE,H as DP,I as mg,J as RP,K as MP,L as LP,M as ri}from"./firebase-DNVDAXfl.js";function $P(e,t){for(var r=0;r<t.length;r++){const a=t[r];if(typeof a!="string"&&!Array.isArray(a)){for(const s in a)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(a,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>a[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Id={},c1;function BP(){if(c1)return Id;c1=1;var e=pP();return Id.createRoot=e.createRoot,Id.hydrateRoot=e.hydrateRoot,Id}var UP=BP();const qP=(e,t,r,a)=>{var i,o,l,c;const s=[r,{code:t,...a||{}}];if((o=(i=e==null?void 0:e.services)==null?void 0:i.logger)!=null&&o.forward)return e.services.logger.forward(s,"warn","react-i18next::",!0);ui(s[0])&&(s[0]=`react-i18next:: ${s[0]}`),(c=(l=e==null?void 0:e.services)==null?void 0:l.logger)!=null&&c.warn?e.services.logger.warn(...s):console!=null&&console.warn&&console.warn(...s)},d1={},xg=(e,t,r,a)=>{ui(r)&&d1[r]||(ui(r)&&(d1[r]=new Date),qP(e,t,r,a))},pE=(e,t)=>()=>{if(e.isInitialized)t();else{const r=()=>{setTimeout(()=>{e.off("initialized",r)},0),t()};e.on("initialized",r)}},pg=(e,t,r)=>{e.loadNamespaces(t,pE(e,r))},u1=(e,t,r,a)=>{if(ui(r)&&(r=[r]),e.options.preload&&e.options.preload.indexOf(t)>-1)return pg(e,r,a);r.forEach(s=>{e.options.ns.indexOf(s)<0&&e.options.ns.push(s)}),e.loadLanguages(t,pE(e,a))},WP=(e,t,r={})=>!t.languages||!t.languages.length?(xg(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(e,{lng:r.lng,precheck:(a,s)=>{if(r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&a.services.backendConnector.backend&&a.isLanguageChangingTo&&!s(a.isLanguageChangingTo,e))return!1}}),ui=e=>typeof e=="string",HP=e=>typeof e=="object"&&e!==null,zP=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,VP={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},GP=e=>VP[e],KP=e=>e.replace(zP,GP);let gg={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:KP};const XP=(e={})=>{gg={...gg,...e}},YP=()=>gg;let gE;const JP=e=>{gE=e},QP=()=>gE,ZP={type:"3rdParty",init(e){XP(e.options.react),JP(e)}},yE=C.createContext();class eO{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(r=>{this.usedNamespaces[r]||(this.usedNamespaces[r]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const tO=(e,t)=>{const r=C.useRef();return C.useEffect(()=>{r.current=e},[e,t]),r.current},vE=(e,t,r,a)=>e.getFixedT(t,r,a),rO=(e,t,r,a)=>C.useCallback(vE(e,t,r,a),[e,t,r,a]),ft=(e,t={})=>{var N,j,w,_;const{i18n:r}=t,{i18n:a,defaultNS:s}=C.useContext(yE)||{},i=r||a||QP();if(i&&!i.reportNamespaces&&(i.reportNamespaces=new eO),!i){xg(i,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const S=(E,A)=>ui(A)?A:HP(A)&&ui(A.defaultValue)?A.defaultValue:Array.isArray(E)?E[E.length-1]:E,k=[S,{},!1];return k.t=S,k.i18n={},k.ready=!1,k}(N=i.options.react)!=null&&N.wait&&xg(i,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const o={...YP(),...i.options.react,...t},{useSuspense:l,keyPrefix:c}=o;let d=s||((j=i.options)==null?void 0:j.defaultNS);d=ui(d)?[d]:d||["translation"],(_=(w=i.reportNamespaces).addUsedNamespaces)==null||_.call(w,d);const u=(i.isInitialized||i.initializedStoreOnce)&&d.every(S=>WP(S,i,o)),f=rO(i,t.lng||null,o.nsMode==="fallback"?d:d[0],c),x=()=>f,p=()=>vE(i,t.lng||null,o.nsMode==="fallback"?d:d[0],c),[h,m]=C.useState(x);let g=d.join();t.lng&&(g=`${t.lng}${g}`);const v=tO(g),b=C.useRef(!0);C.useEffect(()=>{const{bindI18n:S,bindI18nStore:k}=o;b.current=!0,!u&&!l&&(t.lng?u1(i,t.lng,d,()=>{b.current&&m(p)}):pg(i,d,()=>{b.current&&m(p)})),u&&v&&v!==g&&b.current&&m(p);const E=()=>{b.current&&m(p)};return S&&(i==null||i.on(S,E)),k&&(i==null||i.store.on(k,E)),()=>{b.current=!1,i&&S&&(S==null||S.split(" ").forEach(A=>i.off(A,E))),k&&i&&k.split(" ").forEach(A=>i.store.off(A,E))}},[i,g]),C.useEffect(()=>{b.current&&u&&m(x)},[i,c,u]);const y=[h,i,u];if(y.t=h,y.i18n=i,y.ready=u,u||!u&&!l)return y;throw new Promise(S=>{t.lng?u1(i,t.lng,d,()=>S()):pg(i,d,()=>S())})};function aO({i18n:e,defaultNS:t,children:r}){const a=C.useMemo(()=>({i18n:e,defaultNS:t}),[e,t]);return C.createElement(yE.Provider,{value:a},r)}const xu={apiKey:"AIzaSyCKlDIhgAIPif3q2J4TAyVSBpdrUQ2P1G8",authDomain:"my-project-plateform-react.firebaseapp.com",projectId:"my-project-plateform-react",storageBucket:"my-project-plateform-react.firebasestorage.app",messagingSenderId:"1092300975970",appId:"1:1092300975970:web:76e0d3717dbf899c7b463b",measurementId:"G-S28HDNJNMH"},iv=bP(xu);console.log("🔥 Firebase Configuration:",{projectId:xu.projectId,authDomain:xu.authDomain,environment:"production",timestamp:new Date().toISOString()});const Sa=jP(iv),he=wP(iv),pu=NP(iv),bE=So,Zt=st;console.log("🌐 Using production Firebase services for project:",xu.projectId);let gu=navigator.onLine;const nO=async()=>{if(!gu){gu=!0;try{await _P(he),console.log("Firestore network enabled - back online")}catch(e){console.warn("Failed to enable Firestore network:",e)}}},jE=async()=>{if(gu){gu=!1;try{await SP(he),console.log("Firestore network disabled - operating offline")}catch(e){console.warn("Failed to disable Firestore network:",e)}}};window.addEventListener("online",nO);window.addEventListener("offline",jE);navigator.onLine||jE();const rn=async(e,t)=>{try{return await e()}catch(r){return console.warn("Firestore operation failed:",r.message),r.code==="unavailable"&&console.warn("Firestore unavailable - check your internet connection or Firebase configuration"),t}},ov=async()=>rn(async()=>{try{console.log("🏫 Fetching schools from Firestore...");const e=Me(Oe(he,"users"),De("role","==","school")),t=await Ie(e);console.log(`📊 Found ${t.size} school documents in Firestore`),t.docs.forEach((a,s)=>{console.log(`🏫 School document [${s}]:`,{id:a.id,name:a.data().name,email:a.data().email,status:a.data().status,role:a.data().role})});const r=t.docs.filter(a=>a.data().status==="active"||!a.data().status).map(a=>{const s=a.data();return{id:a.id,name:s.name||"مدرسة بدون اسم",status:s.status||"active",...s}});return console.log(`✅ Filtered to ${r.length} active schools`),r}catch(e){throw console.error("❌ Error in getSchools:",e),e}},[]),sO=async()=>rn(async()=>{const e=Me(Oe(he,"users"),De("role","==","consultant")),t=await Ie(e);return console.log("Raw consultants data from Firestore:",t.docs.map(a=>({id:a.id,...a.data()}))),t.docs.map(a=>{const s=a.data(),i={id:a.id,name:s.name||"مستشار",title:s.subject||"مستشار",specialties:s.specializations||[],rating:s.rating||5,reviews:s.reviews_count||0,experience:s.experience_years?`${s.experience_years} سنوات`:"5+ سنوات",avatar:s.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",hourlyRate:s.hourly_rate||150,availability:"متاح",languages:s.languages||["العربية"],location:s.location||"الرياض، السعودية"};return console.log("Processed consultant object:",i),i})},[]),iO=async()=>rn(async()=>(await Ie(Oe(he,"projects"),{source:"server"})).docs.map(t=>{const r=t.data();return{id:t.id,...r,due_date:r.due_date?r.due_date.toDate().toISOString():null,created_at:r.created_at?r.created_at.toDate().toISOString():new Date().toISOString(),updated_at:r.updated_at?r.updated_at.toDate().toISOString():new Date().toISOString()}}),[]),wE=async e=>rn(async()=>{const t=await Dt(Zt(he,"projects",e),{source:"server"});if(t.exists()){const r=t.data();return{id:t.id,...r,due_date:r.due_date?r.due_date.toDate().toISOString():null,created_at:r.created_at?r.created_at.toDate().toISOString():new Date().toISOString(),updated_at:r.updated_at?r.updated_at.toDate().toISOString():new Date().toISOString()}}return null},null),oO=async e=>rn(async()=>{console.log("Fetching projects for teacher ID:",e);const t=Me(Oe(he,"projects"),De("teacher_id","==",e)),r=await Ie(t);return console.log("Found",r.size,"projects for teacher"),r.docs.map(a=>{const s=a.data();return{id:a.id,...s,due_date:s.due_date?s.due_date.toDate().toISOString():null,created_at:s.created_at?s.created_at.toDate().toISOString():new Date().toISOString(),updated_at:s.updated_at?s.updated_at.toDate().toISOString():new Date().toISOString()}})},[]),lO=async e=>rn(async()=>{const t=Me(Oe(he,"projects"),De("school_id","==",e));return(await Ie(t)).docs.map(a=>{const s=a.data();return{id:a.id,...s,due_date:s.due_date?s.due_date.toDate().toISOString():null,created_at:s.created_at?s.created_at.toDate().toISOString():new Date().toISOString(),updated_at:s.updated_at?s.updated_at.toDate().toISOString():new Date().toISOString()}})},[]),cO=async e=>rn(async()=>{const t=Me(Oe(he,"project_students"),De("student_id","==",e)),a=(await Ie(t)).docs.map(i=>i.data().project_id);if(a.length===0)return[];const s=[];for(const i of a){const o=await Dt(Zt(he,"projects",i));if(o.exists()){const l=o.data();s.push({id:o.id,...l,due_date:l.due_date?l.due_date.toDate().toISOString():null,created_at:l.created_at?l.created_at.toDate().toISOString():new Date().toISOString(),updated_at:l.updated_at?l.updated_at.toDate().toISOString():new Date().toISOString()})}}return s},[]),dO=async e=>{try{const t=e.dueDate||e.due_date?la.fromDate(new Date(e.dueDate||e.due_date)):null;return{id:(await Fa(Oe(he,"projects"),{...e,due_date:t,created_at:Ve(),updated_at:Ve(),status:e.status||"active",progress:e.progress||0,resources:[]})).id,...e,due_date:t?t.toDate().toISOString():null}}catch(t){throw console.error("Error creating project:",t),t}},f1=async(e,t)=>{try{const r=Zt(he,"projects",e),a={...t};(t.dueDate||t.due_date)&&(a.due_date=la.fromDate(new Date(t.dueDate||t.due_date)),"dueDate"in a&&delete a.dueDate),a.updated_at=Ve(),await sr(r,a)}catch(r){throw console.error("Error updating project:",r),r}},uO=async(e,t,r)=>{const a=mu(pu,`project_resources/${t}/${Date.now()}_${e.name}`),s=mE(a,e);return new Promise((i,o)=>{s.on("state_changed",l=>{const c=l.bytesTransferred/l.totalBytes*100;r==null||r(c)},l=>{o(l)},async()=>{const l=await sv(s.snapshot.ref);let c="file";e.type.startsWith("image/")?c="image":e.type.startsWith("video/")&&(c="video"),i({downloadURL:l,fileType:c})})})},NE=async(e,t)=>{try{const r=Zt(he,"projects",e);if(!(await Dt(r)).exists())throw new Error("Project not found");return await sr(r,{resources:CP(t),updated_at:Ve()}),!0}catch(r){throw console.error("Error adding project resource:",r),r}},fO=async e=>{try{await Da(Zt(he,"projects",e))}catch(t){throw console.error("Error deleting project:",t),t}},$f=async e=>rn(async()=>{console.log("Fetching students for project:",e);const t=Me(Oe(he,"project_students"),De("project_id","==",e)),r=await Ie(t);console.log("projectStudentsSnapshot.empty:",r.empty),console.log("Number of project_students documents found:",r.docs.length);const a=[],s=[];if(r.forEach(c=>{const d=c.data();a.push(d.student_id),s.push({id:c.id,...d,student:null})}),a.length===0)return[];const i=[...new Set(a)],o=new Map;for(let c=0;c<i.length;c+=10){const d=i.slice(c,c+10),u=Me(Oe(he,"users"),De(PP(),"in",d));(await Ie(u)).forEach(x=>{o.set(x.id,x.data())})}const l=s.map(c=>({...c,student:o.get(c.student_id)||null}));return console.log("Final students array from getProjectStudents (optimized):",l),l},[]),yg=async({project_id:e,student_id:t,role:r,created_at:a,status:s})=>{try{return(await Fa(Oe(he,"project_students"),{project_id:e,student_id:t,role:r,created_at:a?la.fromDate(new Date(a)):Ve(),status:s||"active"})).id}catch(i){throw console.error("Error adding student to project:",i),i}},_E=async(e,t)=>{try{const r=Me(Oe(he,"project_students"),De("project_id","==",e),De("student_id","==",t)),a=await Ie(r);for(const s of a.docs)await Da(s.ref)}catch(r){throw console.error("Error removing student from project:",r),r}},hO=async e=>{try{console.log("Fetching tasks for project:",e);const t=Me(Oe(he,"project_tasks"),De("project_id","==",e)),r=await Ie(t);if(console.log("Tasks snapshot size:",r.size),r.empty)return console.log("No tasks found for project:",e),[];const a=r.docs.map(s=>{const i=s.data();return console.log("Raw task data:",{id:s.id,...i}),{id:s.id,title:i.title||"Untitled Task",description:i.description||"",status:i.status||"pending",priority:i.priority||"medium",due_date:i.due_date&&i.due_date.toDate?i.due_date.toDate().toISOString():null,assigned_to:i.assigned_to||null,progress:i.progress||0,project_id:i.project_id,created_at:i.created_at&&i.created_at.toDate?i.created_at.toDate().toISOString():new Date().toISOString(),updated_at:i.updated_at&&i.updated_at.toDate?i.updated_at.toDate().toISOString():new Date().toISOString(),created_by:i.created_by||null}});return a.sort((s,i)=>new Date(i.created_at).getTime()-new Date(s.created_at).getTime()),console.log("Processed tasks:",a),a}catch(t){return console.error("Error fetching project tasks:",t),[]}},mO=async e=>{try{console.log("Creating project task with data:",e);const t=e.due_date?la.fromDate(new Date(e.due_date)):null,r=e.start_date?la.fromDate(new Date(e.start_date)):la.fromDate(new Date),a=await Fa(Oe(he,"project_tasks"),{...e,start_date:r,due_date:t,created_at:Ve(),updated_at:Ve()});return console.log("Task created with ID:",a.id),{id:a.id,...e,start_date:r.toDate().toISOString(),due_date:t?t.toDate().toISOString():null}}catch(t){throw console.error("Error creating project task:",t),t}},xO=async(e,t)=>{try{console.log("Updating project task:",e,"with data:",t);const r={...t,updated_at:Ve()};t.start_date&&(r.start_date=la.fromDate(new Date(t.start_date))),t.due_date&&(r.due_date=la.fromDate(new Date(t.due_date)));const a=st(he,"project_tasks",e);return await sr(a,r),console.log("Task updated successfully:",e),{id:e,...t}}catch(r){throw console.error("Error updating project task:",r),r}},pO=async e=>{try{console.log("Deleting project task:",e);const t=st(he,"project_tasks",e);await Da(t),console.log("Task deleted successfully:",e)}catch(t){throw console.error("Error deleting project task:",t),t}},gO=async()=>rn(async()=>{console.log("Getting approved project ideas from Firestore...");const e=Me(Oe(he,"project_ideas"),De("status","==","approved")),t=await Ie(e);return console.log("Approved project ideas snapshot size:",t.size),t.empty?(console.log("No approved project ideas found, returning empty array"),[]):t.docs.map(a=>({id:a.id,views:0,downloads:0,rating:4.5,...a.data()})).sort((a,s)=>{var l,c,d,u;const i=((c=(l=a.created_at)==null?void 0:l.toDate)==null?void 0:c.call(l))||new Date(a.created_at||0);return(((u=(d=s.created_at)==null?void 0:d.toDate)==null?void 0:u.call(d))||new Date(s.created_at||0)).getTime()-i.getTime()})},[]),yO=async()=>rn(async()=>{console.log("Getting ALL project ideas (admin mode)...");const e=Me(Oe(he,"project_ideas")),t=await Ie(e);return console.log("All project ideas snapshot size (admin view):",t.size),t.empty?(console.log("No project ideas found (admin view), returning empty array"),[]):t.docs.map(a=>({id:a.id,views:0,downloads:0,rating:4.5,...a.data()})).sort((a,s)=>{var l,c,d,u;const i=((c=(l=a.created_at)==null?void 0:l.toDate)==null?void 0:c.call(l))||new Date(a.created_at||0);return(((u=(d=s.created_at)==null?void 0:d.toDate)==null?void 0:u.call(d))||new Date(s.created_at||0)).getTime()-i.getTime()})},[]),vO=async e=>{try{const t={...e,views:e.views||0,downloads:e.downloads||0,rating:e.rating||4.5,status:e.status||"pending",created_at:Ve(),updated_at:Ve()};return{id:(await Fa(Oe(he,"project_ideas"),t)).id,...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}catch(t){throw console.error("Error creating project idea:",t),t}},bO=async(e,t)=>{try{const r=Zt(he,"project_ideas",e),a={...t,updated_at:Ve()};return await sr(r,a),!0}catch(r){throw console.error("Error updating project idea:",r),r}},jO=async e=>{try{return await Da(Zt(he,"project_ideas",e)),!0}catch(t){throw console.error("Error deleting project idea:",t),t}},wO=async e=>{try{const t=Zt(he,"project_ideas",e);await sr(t,{views:bE(1)})}catch(t){throw console.error("Error incrementing project idea views:",t),t}},NO=async e=>{try{const t=Zt(he,"project_ideas",e);await sr(t,{downloads:bE(1)})}catch(t){throw console.error("Error incrementing project idea downloads:",t),t}},_O=async e=>{try{const t=Zt(he,"project_ideas",e),r=await Dt(t);if(r.exists()){const a=r.data();return{id:r.id,title:a.title,description:a.description,category:a.category,difficulty:a.difficulty,duration:a.duration,subject:a.subject,image:a.image,objectives:a.objectives||[],materials:a.materials||[],steps:a.steps||[],tags:a.tags||[],views:a.views||0,downloads:a.downloads||0,rating:a.rating||4.5,status:a.status||"approved",created_at:a.created_at?a.created_at.toDate().toISOString():new Date().toISOString(),updated_at:a.updated_at?a.updated_at.toDate().toISOString():new Date().toISOString()}}return null}catch(t){throw console.error("Error fetching project idea by ID:",t),t}},SO=async()=>{try{console.log("Starting cleanup of duplicate project ideas...");const e=Oe(he,"project_ideas"),t=await Ie(e);if(t.empty)return console.log("No project ideas found to clean up"),0;const r=new Map,a=[];t.docs.forEach(i=>{const o=i.data(),l=`${o.title}-${o.description}`;r.has(l)?a.push(i.id):r.set(l,i.id)}),console.log(`Found ${a.length} duplicate project ideas to delete`);let s=0;for(const i of a)await Da(Zt(he,"project_ideas",i)),s++;return console.log(`Successfully deleted ${s} duplicate project ideas`),s}catch(e){throw console.error("Error deleting duplicate project ideas:",e),e}},kO=async()=>{try{console.log("Starting cleanup of duplicate learning resources...");const e=Oe(he,"learning_resources"),t=await Ie(e);if(t.empty)return console.log("No learning resources found to clean up"),0;const r=new Map,a=[];t.docs.forEach(i=>{const o=i.data(),l=`${o.title}-${o.type}`;r.has(l)?a.push(i.id):r.set(l,i.id)}),console.log(`Found ${a.length} duplicate learning resources to delete`);let s=0;for(const i of a)await Da(Zt(he,"learning_resources",i)),s++;return console.log(`Successfully deleted ${s} duplicate learning resources`),s}catch(e){throw console.error("Error deleting duplicate learning resources:",e),e}},lv=async(e,t)=>{try{const r=Zt(he,"users",e);(await Dt(r)).exists()&&await sr(r,{...t,updated_at:Ve()})}catch(r){throw console.error("Error updating user:",r),r}},EO=async e=>{try{const t=Zt(he,"users",e);await Da(t)}catch(t){throw console.error("Error deleting user:",t),t}},h1=async(e,t)=>{try{await lv(e,{status:t,updated_at:Ve()})}catch(r){throw console.error("Error updating user status:",r),r}},TO=async(e,t)=>{try{const r=Sa.currentUser;if(!r||!r.email)return console.error("No authenticated user found"),{success:!1,message:"لم يتم العثور على مستخدم مسجل دخول"};console.log("Starting password update process for user:",r.uid);const a=kP.credential(r.email,e);return console.log("Re-authenticating user..."),await EP(r,a),console.log("User re-authenticated successfully"),console.log("Updating password..."),await TP(r,t),console.log("Password updated successfully"),{success:!0,message:"تم تحديث كلمة المرور بنجاح"}}catch(r){return console.error("Error updating password:",r),r.code==="auth/wrong-password"?{success:!1,message:"كلمة المرور الحالية غير صحيحة"}:r.code==="auth/weak-password"?{success:!1,message:"كلمة المرور الجديدة ضعيفة جداً. يجب أن تكون 6 أحرف على الأقل"}:r.code==="auth/requires-recent-login"?{success:!1,message:"يجب تسجيل الدخول مرة أخرى لتغيير كلمة المرور"}:r.code==="auth/network-request-failed"?{success:!1,message:"فشل الاتصال بالشبكة. يرجى التحقق من اتصال الإنترنت"}:{success:!1,message:r.message||"حدث خطأ أثناء تحديث كلمة المرور"}}},cv=async e=>{try{return console.log("Sending password reset email to:",e),await AP(Sa,e),console.log("Password reset email sent successfully"),{success:!0,message:"تم إرسال رابط إعادة تعيين كلمة المرور إلى البريد الإلكتروني"}}catch(t){return console.error("Error sending password reset email:",t),t.code==="auth/user-not-found"?{success:!1,message:"لم يتم العثور على مستخدم بهذا البريد الإلكتروني"}:t.code==="auth/invalid-email"?{success:!1,message:"البريد الإلكتروني غير صالح"}:t.code==="auth/network-request-failed"?{success:!1,message:"فشل الاتصال بالشبكة. يرجى التحقق من اتصال الإنترنت"}:{success:!1,message:t.message||"حدث خطأ أثناء إرسال رابط إعادة تعيين كلمة المرور"}}},AO=async e=>rn(async()=>{const t=Me(Oe(he,"users"),De("role","==","student"),De("school_id","==",e));return(await Ie(t)).docs.map(a=>({id:a.id,...a.data()}))},[]),CO=async()=>rn(async()=>{const e=Oe(he,"summer_program_registrations"),t=Me(e,ol("createdAt","desc"));return(await Ie(t)).docs.map(a=>{const s=a.data();return{id:a.id,fullName:s.fullName,email:s.email,phone:s.phone,parentPhone:s.parentPhone,city:s.city,idNumber:s.idNumber,school:s.school,grade:s.grade,educationAdministration:s.educationAdministration,hasParticipatedBefore:s.hasParticipatedBefore,previousProjects:s.previousProjects,interests:s.interests||[],howDidYouHear:s.howDidYouHear,notes:s.notes,status:s.status||"pending",createdAt:s.createdAt?s.createdAt.toDate():new Date,updatedAt:s.updatedAt?s.updatedAt.toDate():new Date}})},[]),PO=async e=>{try{const t=Oe(he,"summer_program_registrations"),r={...e,status:"pending",createdAt:Ve(),updatedAt:Ve()};return(await Fa(t,r)).id}catch(t){throw console.error("Error adding summer program registration:",t),t}},m1=async(e,t)=>{try{const r=Zt(he,"summer_program_registrations",e);await sr(r,{...t,updatedAt:Ve()})}catch(r){throw console.error("Error updating summer program registration:",r),r}},OO=async e=>{try{const t=Zt(he,"summer_program_registrations",e);await Da(t)}catch(t){throw console.error("Error deleting summer program registration:",t),t}},ct=!0,SE=C.createContext(void 0),ut=()=>{const e=C.useContext(SE);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},IO=({children:e})=>{const[t,r]=C.useState(null),[a,s]=C.useState(!0),[i,o]=C.useState(!navigator.onLine);C.useEffect(()=>{const x=()=>o(!1),p=()=>o(!0);return window.addEventListener("online",x),window.addEventListener("offline",p),()=>{window.removeEventListener("online",x),window.removeEventListener("offline",p)}},[]),C.useEffect(()=>{const x=OP(Sa,async p=>{var h,m,g,v,b,y,N;if(console.log("Auth state changed, user:",p==null?void 0:p.uid),!p){r(null),s(!1);return}try{try{const j=await Dt(st(he,"users",p.uid));if(ct&&console.log("User document exists in auth state change:",j.exists()),j.exists()){const w=j.data();ct&&console.log("User data in auth state change:",w),r({id:p.uid,email:p.email||"",name:w.name||p.displayName||"",role:w.role||"student",avatar:w.avatar||p.photoURL,phone:w.phone,bio:w.bio,createdAt:((g=(m=(h=w.createdAt)==null?void 0:h.toDate)==null?void 0:m.call(h))==null?void 0:g.toISOString())||new Date().toISOString(),school_id:w.school_id,grade:w.grade,subject:w.subject,languages:w.languages,status:w.status||"active",specializations:w.specializations,experience_years:w.experience_years,hourly_rate:w.hourly_rate,rating:w.rating,reviews_count:w.reviews_count})}else{console.error("CRITICAL: User document doesn't exist for authenticated user:",p.uid),console.log("This indicates an incomplete registration. Signing out user to prevent invalid state."),await _l(Sa),r(null);return}}catch(j){if(j.code==="unavailable"||j.code==="auth/network-request-failed"||j.code==="firestore/unavailable"||((v=j.message)==null?void 0:v.includes("offline"))||((b=j.message)==null?void 0:b.includes("client is offline"))||((y=j.message)==null?void 0:y.includes("network"))||((N=j.message)==null?void 0:N.includes("Could not reach Cloud Firestore backend"))){console.warn("Operating in offline mode - using basic user profile:",j.message),o(!0);const _={id:p.uid,email:p.email||"",name:p.displayName||"مستخدم",role:"student",avatar:p.photoURL,createdAt:new Date().toISOString(),status:"active"};r(_)}else{console.error("Non-network error fetching user profile:",j),console.log("Signing out user due to profile fetch error to prevent invalid state."),await _l(Sa),r(null);return}}}catch(j){console.error("Fatal error in auth state change:",j);try{await _l(Sa)}catch(w){console.error("Failed to sign out after fatal error:",w)}r(null)}s(!1)});return()=>x()},[]);const f={user:t,loading:a,isOffline:i,login:async(x,p)=>{try{const{user:h}=await DP(Sa,x,p);console.log("Firebase user authenticated:",h.uid),await h.getIdToken(!0)}catch(h){throw h.code==="auth/network-request-failed"||h.code==="unavailable"?(console.warn("Network request failed during login:",h.message),o(!0),new Error("فشل في الاتصال بالشبكة. يرجى التحقق من اتصال الإنترنت والمحاولة مرة أخرى.")):(console.error("Login error:",h),h)}},register:async(x,p,h)=>{var m,g,v;try{if(ct&&console.log("🚀 بدء عملية التسجيل:",{email:x,role:h.role,name:h.name,hasSchoolId:!!h.school_id,timestamp:new Date().toISOString()}),!h.role)throw ct&&console.error("❌ فشل التحقق: دور المستخدم مطلوب"),new Error("دور المستخدم مطلوب");if(!h.name||h.name.trim()==="")throw ct&&console.error("❌ فشل التحقق: اسم المستخدم مطلوب"),new Error("اسم المستخدم مطلوب");ct&&console.log("✅ تم التحقق من البيانات المطلوبة بنجاح"),ct&&(console.log("📋 تحليل البيانات الخاصة بالدور قبل إنشاء الحساب:",{role:h.role,name:h.name,email:x,timestamp:new Date().toISOString()}),h.role==="student"?console.log("👨‍🎓 بيانات الطالب المقدمة:",{grade:h.grade,grade_type:typeof h.grade,grade_provided:!!h.grade,school_id:h.school_id,school_id_type:typeof h.school_id,school_id_provided:!!h.school_id,schoolIdNumber:h.schoolIdNumber,schoolIdNumber_type:typeof h.schoolIdNumber,schoolIdNumber_provided:!!h.schoolIdNumber,phone:h.phone,phone_provided:!!h.phone}):h.role==="teacher"?console.log("👩‍🏫 بيانات المشرف المقدمة:",{subject:h.subject,subject_type:typeof h.subject,subject_provided:!!h.subject,school_id:h.school_id,school_id_type:typeof h.school_id,school_id_provided:!!h.school_id,schoolIdNumber:h.schoolIdNumber,schoolIdNumber_type:typeof h.schoolIdNumber,schoolIdNumber_provided:!!h.schoolIdNumber,phone:h.phone,phone_provided:!!h.phone}):h.role==="school"?console.log("🏫 بيانات المدرسة المقدمة:",{bio:h.bio,bio_type:typeof h.bio,bio_provided:!!h.bio,phone:h.phone,phone_type:typeof h.phone,phone_provided:!!h.phone,note:"school_id سيتم تعيينه إلى firebaseUser.uid بعد إنشاء الحساب"}):h.role==="consultant"&&console.log("💼 بيانات المستشار المقدمة:",{bio:h.bio,bio_type:typeof h.bio,bio_provided:!!h.bio,specializations:h.specializations,specializations_count:((m=h.specializations)==null?void 0:m.length)||0,specializations_type:typeof h.specializations,experience_years:h.experience_years,experience_years_type:typeof h.experience_years,hourly_rate:h.hourly_rate,hourly_rate_type:typeof h.hourly_rate,languages:h.languages,languages_count:((g=h.languages)==null?void 0:g.length)||0,languages_type:typeof h.languages,phone:h.phone,phone_provided:!!h.phone})),ct&&console.log("🔐 محاولة إنشاء مستخدم Firebase Auth...");const{user:b}=await xE(Sa,x,p);if(ct&&console.log("✅ تم إنشاء مستخدم Firebase Auth بنجاح:",{role:h.role,name:h.name,email:h.email,firebaseUid:b.uid,uidType:typeof b.uid,uidLength:(v=b.uid)==null?void 0:v.length}),!b||!b.uid)throw ct&&console.error("❌ فشل في إنشاء حساب Firebase: firebaseUser أو uid غير موجود"),new Error("فشل في إنشاء حساب Firebase");ct&&console.log("🔍 تحديد الحالة الأولية والمدرسة...");let y="active";h.role==="school"||h.role==="consultant"?(y="pending",ct&&console.log(`📋 تم تعيين الحالة إلى "pending" لدور ${h.role}`)):ct&&console.log(`📋 تم تعيين الحالة إلى "active" لدور ${h.role}`);let N=null;ct&&console.log("🏫 تحديد school_id بناءً على الدور..."),h.role==="school"?(N=b.uid,ct&&console.log("🏫 تسجيل مدرسة: تعيين school_id إلى UID الخاص:",{schoolId:N,schoolIdType:typeof N,firebaseUid:b.uid})):h.role==="student"||h.role==="teacher"?(N=h.school_id?h.school_id:null,ct&&console.log("👨‍🎓👩‍🏫 تسجيل طالب/معلم: تعيين school_id:",{providedSchoolId:h.school_id,finalSchoolId:N,schoolIdType:typeof N})):ct&&console.log("👑💼 تسجيل مدير/مستشار: school_id يبقى null"),N===void 0&&(ct&&console.error("🚨 خطر: schoolId هو undefined، هذا لا يجب أن يحدث أبداً"),N=null),ct&&console.log("📝 إنشاء كائن بيانات المستخدم الأساسي...");const j={name:h.name||"مستخدم جديد",email:b.email||x,role:h.role||"student",phone:h.phone??null,bio:h.bio??null,createdAt:Ve(),updatedAt:Ve(),school_id:N,grade:h.grade??null,subject:h.subject??null,schoolIdNumber:h.schoolIdNumber??null,languages:h.languages||["العربية"],status:y};ct&&console.log("📋 بيانات المستخدم الأساسية:",{name:j.name,email:j.email,role:j.role,school_id:j.school_id,school_id_type:typeof j.school_id,status:j.status});let w={...j};h.role==="consultant"&&(ct&&console.log("💼 إضافة حقول خاصة بالمستشار..."),w={...w,specializations:h.specializations||[],experience_years:h.experience_years??null,hourly_rate:h.hourly_rate??null,rating:5,reviews_count:0}),ct&&console.log("🔍 فحص القيم غير المعرفة (undefined)...");const _=Object.entries(w).filter(([S,k])=>k===void 0);if(_.length>0?(ct&&console.error("🚨 تم العثور على حقول undefined في بيانات المستخدم:",_),_.forEach(([S])=>{ct&&console.log(`🔧 تحويل ${S} من undefined إلى null`),w[S]=null})):ct&&console.log("✅ لا توجد حقول undefined - البيانات نظيفة"),ct){const S={...w,createdAt:"[ServerTimestamp]",updatedAt:"[ServerTimestamp]"};console.log("📤 البيانات النهائية التي سيتم إرسالها إلى Firestore:",{uid:b.uid,role:w.role,school_id:w.school_id,school_id_type:typeof w.school_id,allFieldsCount:Object.keys(w).length,completeDataPreview:JSON.stringify(S,null,2).substring(0,500)+"..."}),console.log("🔍 التحقق النهائي من الحقول الحرجة:",{name_valid:!!w.name&&w.name!=="",email_valid:!!w.email&&w.email!=="",role_valid:!!w.role&&["student","teacher","school","admin","consultant"].includes(w.role),school_id_valid:w.school_id===null||typeof w.school_id=="string"&&w.school_id!=="",status_valid:!!w.status&&["active","pending"].includes(w.status),no_undefined_values:!Object.values(w).includes(void 0)})}try{ct&&console.log("💾 محاولة إنشاء مستند المستخدم في Firestore..."),await hg(st(he,"users",b.uid),w),ct&&console.log("✅ تم إنشاء مستند المستخدم بنجاح في Firestore:",{role:w.role,uid:b.uid,school_id:w.school_id,status:w.status,timestamp:new Date().toISOString()}),ct&&console.log("🔄 تحديث رمز المصادقة..."),await b.getIdToken(!0),ct&&console.log("✅ تم تحديث رمز المصادقة بنجاح"),ct&&console.log("🎉 اكتملت عملية التسجيل بنجاح!",{userRole:w.role,userStatus:w.status,timestamp:new Date().toISOString()})}catch(S){ct&&console.error("❌ فشل في إنشاء مستند المستخدم في Firestore:",{error:S,userRole:w.role,userEmail:w.email,uid:b.uid,errorMessage:S instanceof Error?S.message:"Unknown error"});try{ct&&console.log("🗑️ محاولة حذف مستخدم Firebase Auth بسبب فشل Firestore..."),await b.delete(),ct&&console.log("✅ تم حذف مستخدم Firebase Auth بنجاح بعد فشل Firestore")}catch(k){ct&&console.error("❌ فشل في حذف مستخدم Firebase Auth بعد فشل Firestore:",k),await _l(Sa),ct&&console.log("🚪 تم تسجيل الخروج كحل بديل")}throw S}}catch(b){throw console.error("❌ فشلت عملية التسجيل:",{error:b,errorCode:b.code,errorMessage:b.message,userData:{role:h.role,name:h.name,email:x},timestamp:new Date().toISOString()}),b.code==="auth/email-already-in-use"?(console.error("📧 البريد الإلكتروني مستخدم بالفعل:",{email:x,role:h.role,suggestion:"يجب على المستخدم استخدام بريد إلكتروني مختلف أو تسجيل الدخول"}),new Error("هذا البريد الإلكتروني مسجل بالفعل. يرجى استخدام بريد إلكتروني آخر أو تسجيل الدخول.")):b.code==="auth/weak-password"?(console.error("🔒 كلمة المرور ضعيفة:",{email:x,role:h.role}),new Error("كلمة المرور ضعيفة جداً. يرجى اختيار كلمة مرور أقوى.")):b.code==="auth/invalid-email"?(console.error("📧 البريد الإلكتروني غير صالح:",{email:x,role:h.role}),new Error("البريد الإلكتروني غير صالح. يرجى التحقق من صحة البريد الإلكتروني.")):b.code==="auth/network-request-failed"||b.code==="unavailable"?(console.warn("🌐 فشل طلب الشبكة أثناء التسجيل:",b.message),o(!0),new Error("فشل في الاتصال بالشبكة. يرجى التحقق من اتصال الإنترنت والمحاولة مرة أخرى.")):(console.error("❌ خطأ غير متوقع في التسجيل:",{errorCode:b.code,errorMessage:b.message,fullError:b}),new Error("حدث خطأ غير متوقع أثناء التسجيل. يرجى المحاولة مرة أخرى."))}},loginWithGoogle:async()=>{try{const x=new IP,{user:p}=await FP(Sa,x);(await Dt(st(he,"users",p.uid))).exists()||await hg(st(he,"users",p.uid),{name:p.displayName||"مستخدم جديد",email:p.email,role:"student",createdAt:Ve(),updatedAt:Ve(),status:"active"})}catch(x){throw x.code==="auth/network-request-failed"||x.code==="unavailable"?(console.warn("Network request failed during Google login:",x.message),o(!0),new Error("فشل في الاتصال بالشبكة. يرجى التحقق من اتصال الإنترنت والمحاولة مرة أخرى.")):(console.error("Google login error:",x),x)}},logout:async()=>{try{await _l(Sa),r(null)}catch(x){console.error("Logout error:",x),r(null)}}};return n.jsx(SE.Provider,{value:f,children:e})},kE=C.createContext(void 0),dv=()=>{const e=C.useContext(kE);if(e===void 0)throw new Error("useCart must be used within a CartProvider");return e},FO=({children:e})=>{const[t,r]=C.useState({}),[a,s]=C.useState([]);C.useEffect(()=>{const p=localStorage.getItem("cart"),h=localStorage.getItem("wishlist");if(p)try{r(JSON.parse(p))}catch(m){console.error("Error parsing saved cart:",m)}if(h)try{s(JSON.parse(h))}catch(m){console.error("Error parsing saved wishlist:",m)}},[]),C.useEffect(()=>{localStorage.setItem("cart",JSON.stringify(t))},[t]),C.useEffect(()=>{localStorage.setItem("wishlist",JSON.stringify(a))},[a]);const x={cart:t,wishlist:a,addToCart:p=>{r(h=>({...h,[p]:(h[p]||0)+1}))},removeFromCart:p=>{r(h=>{const m={...h};return m[p]>1?m[p]--:delete m[p],m})},updateQuantity:(p,h)=>{h<=0?r(m=>{const g={...m};return delete g[p],g}):r(m=>({...m,[p]:h}))},clearCart:()=>{r({})},toggleWishlist:p=>{s(h=>h.includes(p)?h.filter(m=>m!==p):[...h,p])},getTotalItems:()=>Object.values(t).reduce((p,h)=>p+h,0),getTotalPrice:p=>Object.entries(t).reduce((h,[m,g])=>{const v=p.find(b=>b.id===m);return h+(v?v.price*g:0)},0)};return n.jsx(kE.Provider,{value:x,children:e})},hd=e=>{if(!e)return null;try{if(e instanceof la)return e.toDate();if(e instanceof Date)return e;if(typeof e=="string"){if(!isNaN(Number(e)))return new Date(Number(e));const t=new Date(e);return isNaN(t.getTime())?null:t}return null}catch(t){return console.error("Error converting to Date object:",t),null}},Ye=(e,t)=>{const r=hd(e);if(!r)return"غير محدد";const a={year:"numeric",month:"long",day:"numeric",calendar:"gregory"};return r.toLocaleDateString("ar-SA",{...a,...t})},wn=e=>{const t=hd(e);if(!t)return null;try{const r=new Date;r.setHours(0,0,0,0);const a=new Date(t);a.setHours(0,0,0,0);const s=a.getTime()-r.getTime();return Math.ceil(s/(1e3*60*60*24))}catch(r){return console.error("Error calculating days remaining:",r),null}},q0=e=>{const t=hd(e);return t?t.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit",calendar:"gregory"}):""},Bl=e=>{const t=hd(e);if(!t)return"";const a=Math.floor((new Date().getTime()-t.getTime())/1e3);if(a<60)return"الآن";const s=Math.floor(a/60);if(s<60)return`منذ ${s} دقيقة`;const i=Math.floor(s/60);if(i<24)return`منذ ${i} ساعة`;const o=Math.floor(i/24);if(o<30)return`منذ ${o} يوم`;const l=Math.floor(o/30);return l<12?`منذ ${l} شهر`:`منذ ${Math.floor(l/12)} سنة`},DO=()=>{const{user:e}=ut(),[t,r]=C.useState([]),[a,s]=C.useState(!0),[i,o]=C.useState(null);return C.useEffect(()=>{if(!e){r([]),s(!1);return}const u=async()=>{try{s(!0),o(null);const v=[],b=await f();if(b.length>0){const j=await x(b);v.push(...j)}const y=await p();v.push(...y);const N=await h();v.push(...N),v.sort((j,w)=>w.createdAt.getTime()-j.createdAt.getTime()),r(v.slice(0,20))}catch(v){console.error("Error fetching notifications:",v),o("حدث خطأ في تحميل الإشعارات")}finally{s(!1)}},f=async()=>{const v=[];try{if(e.role==="student"){const b=Me(Oe(he,"project_students"),De("student_id","==",e.id));(await Ie(b)).docs.forEach(N=>{v.push(N.data().project_id)})}else if(e.role==="teacher"){const b=Me(Oe(he,"projects"),De("teacher_id","==",e.id));(await Ie(b)).docs.forEach(N=>{v.push(N.id)})}else if(e.role==="school"){const b=Me(Oe(he,"projects"),De("school_id","==",e.id));(await Ie(b)).docs.forEach(N=>{v.push(N.id)})}else if(e.role==="admin"){const b=Me(Oe(he,"projects"),ol("created_at","desc"));(await Ie(b)).docs.forEach(N=>{v.push(N.id)})}}catch(b){console.error("Error getting user project IDs:",b)}return[...new Set(v)]},x=async v=>{var y;const b=[];try{const N=new Date;N.setDate(N.getDate()-1);for(const j of v.slice(0,10)){const w=Me(Oe(he,"chat_messages"),De("project_id","==",j)),S=(await Ie(w)).docs.sort((k,E)=>{var L,R;const A=((L=k.data().created_at)==null?void 0:L.toDate())||new Date(0);return(((R=E.data().created_at)==null?void 0:R.toDate())||new Date(0)).getTime()-A.getTime()}).slice(0,5);for(const k of S){const E=k.data();if(E.user_id===e.id)continue;const A=((y=E.created_at)==null?void 0:y.toDate())||new Date;if(A>N&&!(E.seen_by||[]).includes(e.id)){let L="مشروع";try{const I=await Dt(st(he,"projects",j));I.exists()&&(L=I.data().title||"مشروع")}catch(I){console.error("Error getting project title:",I)}let R="مستخدم";try{const I=await Dt(st(he,"users",E.user_id));I.exists()&&(R=I.data().name||"مستخدم")}catch(I){console.error("Error getting sender name:",I)}b.push({id:k.id,title:`رسالة جديدة في ${L}`,message:`${R}: ${E.message.substring(0,100)}${E.message.length>100?"...":""}`,time:Bl(A.toISOString()),type:"message",read:!1,relatedId:j,createdAt:A})}}}}catch(N){console.error("Error getting chat notifications:",N)}return b},p=async()=>{const v=[];try{const b=Me(Oe(he,"consultations"),De("student_id","==",e.id));(await Ie(b)).docs.sort((j,w)=>{var k,E;const _=((k=j.data().updated_at)==null?void 0:k.toDate())||new Date(0);return(((E=w.data().updated_at)==null?void 0:E.toDate())||new Date(0)).getTime()-_.getTime()}).forEach(j=>{var k;const w=j.data(),_=((k=w.updated_at)==null?void 0:k.toDate())||new Date,S=new Date;if(S.setDate(S.getDate()-7),_>S){let E="",A="";w.status==="scheduled"&&w.mentor_id?(E="تم قبول طلب الاستشارة",A=`تم قبول طلب الاستشارة "${w.topic}" وتحديد موعد لها`):w.status==="cancelled"?(E="تم إلغاء الاستشارة",A=`تم إلغاء الاستشارة "${w.topic}"`):w.status==="completed"&&(E="تمت الاستشارة بنجاح",A=`تمت الاستشارة "${w.topic}" بنجاح. يمكنك تقييمها الآن`),E&&A&&v.push({id:`consultation_${j.id}`,title:E,message:A,time:Bl(_.toISOString()),type:"consultation",read:!1,relatedId:j.id,createdAt:_})}})}catch(b){console.error("Error getting consultation notifications:",b)}return v},h=async()=>{const v=[];try{const b=await f(),y=new Date;for(const N of b){const j=await Dt(st(he,"projects",N));if(j.exists()){const w=j.data(),_=hd(w.due_date);if(_&&_<y&&w.status!=="completed"){const S=Math.floor((y.getTime()-_.getTime())/864e5);v.push({id:`overdue_${N}`,title:"مشروع متأخر",message:`المشروع "${w.title}" متأخر بـ ${S} يوم`,time:Bl(_.toISOString()),type:"project",read:!1,relatedId:N,createdAt:_})}else if(_){const S=new Date;if(S.setDate(y.getDate()+3),_<=S&&_>y&&w.status!=="completed"){const k=Math.ceil((_.getTime()-y.getTime())/864e5);v.push({id:`due_soon_${N}`,title:"تذكير: موعد نهائي قريب",message:`المشروع "${w.title}" ينتهي خلال ${k} يوم`,time:Bl(_.toISOString()),type:"project",read:!1,relatedId:N,createdAt:y})}}}}}catch(b){console.error("Error getting overdue project notifications:",b)}return v};u();const m=[];return(async()=>{try{(await f()).forEach(N=>{const j=Me(Oe(he,"chat_messages"),De("project_id","==",N)),w=mg(j,_=>{_.docChanges().sort((k,E)=>{var L,R;const A=((L=k.doc.data().created_at)==null?void 0:L.toDate())||new Date(0);return(((R=E.doc.data().created_at)==null?void 0:R.toDate())||new Date(0)).getTime()-A.getTime()}).forEach(k=>{var E;if(k.type==="added"){const A=k.doc.data();if(A.user_id===e.id)return;const P=((E=A.created_at)==null?void 0:E.toDate())||new Date,L=new Date;L.setMinutes(L.getMinutes()-5),P>L&&((A.seen_by||[]).includes(e.id)||u())}})});m.push(w)});const b=Me(Oe(he,"consultations"),De("student_id","==",e.id)),y=mg(b,N=>{N.docChanges().forEach(j=>{j.type==="modified"&&u()})});m.push(y)}catch(v){console.error("Error setting up real-time listeners:",v)}})(),()=>{m.forEach(v=>v())}},[e]),{notifications:t,loading:a,error:i,markAsRead:u=>{r(f=>f.map(x=>x.id===u?{...x,read:!0}:x))},markAllAsRead:()=>{r(u=>u.map(f=>({...f,read:!0})))},getUnreadCount:()=>t.filter(u=>!u.read).length}},RO=({onMenuClick:e})=>{const{user:t,logout:r}=ut(),{t:a,i18n:s}=ft(),{notifications:i,loading:o,markAsRead:l,markAllAsRead:c,getUnreadCount:d}=DO(),[u,f]=C.useState(!1),[x,p]=C.useState(!1),[h,m]=C.useState(""),g=Rs(),v=C.useRef(null);C.useEffect(()=>{const _=S=>{v.current&&!v.current.contains(S.target)&&p(!1)};return x?document.addEventListener("mousedown",_):document.removeEventListener("mousedown",_),()=>{document.removeEventListener("mousedown",_)}},[x]);const b=d(),y=_=>{switch(_){case"consultation":return"✅";case"project":return"⚠️";case"message":return"💬";case"system":default:return"ℹ️"}},N=_=>{s.changeLanguage(_),f(!1)},j=_=>a(`roles.${_}`),w=()=>{h.trim()&&g(`/search-results?q=${encodeURIComponent(h.trim())}`)};return n.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("button",{onClick:e,className:"lg:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(VC,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{className:"relative hidden md:block",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:a("header.searchProjects"),className:"w-80 pl-4 pr-12 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:h,onChange:_=>m(_.target.value),onKeyPress:_=>{_.key==="Enter"&&w()}})]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>f(!u),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors flex items-center gap-1",children:[n.jsx(yi,{className:"w-5 h-5 text-gray-600"}),n.jsx("span",{className:"text-sm",children:s.language==="ar"?"العربية":"English"})]}),u&&n.jsxs("div",{className:"absolute top-full right-0 mt-1 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[n.jsx("button",{onClick:()=>N("ar"),className:`block w-full text-right px-4 py-2 text-sm hover:bg-gray-50 ${s.language==="ar"?"font-bold text-blue-600":""}`,children:"العربية"}),n.jsx("button",{onClick:()=>N("en"),className:`block w-full text-left px-4 py-2 text-sm hover:bg-gray-50 ${s.language==="en"?"font-bold text-blue-600":""}`,children:"English"})]})]}),n.jsxs("div",{className:"relative",ref:v,children:[n.jsxs(re.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>p(!x),className:"relative p-2 rounded-lg hover:bg-gray-100 transition-colors",children:[n.jsx(du,{className:"w-6 h-6 text-gray-600"}),b>0&&n.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:b})]}),x&&n.jsxs(re.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute top-full right-0 mt-3 w-96 bg-white rounded-lg shadow-lg border border-gray-200 z-50 overflow-hidden",children:[n.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"font-bold text-gray-800",children:a("header.notifications")}),b>0&&n.jsxs("span",{className:"text-xs text-blue-600 font-medium",children:[b," إشعار جديد"]})]})}),n.jsx("div",{className:"max-h-80 overflow-y-auto",children:o?n.jsxs("div",{className:"p-8 text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-3"}),n.jsx("p",{className:"text-gray-500",children:"جاري تحميل الإشعارات..."})]}):i.length>0?i.map(_=>n.jsx("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition-colors ${_.read?"":"bg-blue-50"}`,onClick:()=>{l(_.id),_.type==="message"&&_.relatedId?(g(`/projects/${_.relatedId}`),p(!1)):_.type==="consultation"&&_.relatedId?(g("/my-consultations"),p(!1)):_.type==="project"&&_.relatedId&&(g(`/projects/${_.relatedId}`),p(!1))},children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"text-lg flex-shrink-0 mt-1",children:y(_.type)}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsx("p",{className:`text-sm font-medium ${_.read?"text-gray-700":"text-gray-900"}`,children:_.title}),!_.read&&n.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-2"})]}),n.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:_.message}),n.jsx("p",{className:"text-xs text-gray-500 mt-2",children:_.time})]})]})},_.id)):n.jsxs("div",{className:"p-8 text-center",children:[n.jsx(du,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),n.jsx("p",{className:"text-gray-500",children:"لا توجد إشعارات"})]})}),n.jsx("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("button",{onClick:()=>{c()},className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"تعيين الكل كمقروء"}),n.jsx(ke,{to:"/notifications",className:"text-xs text-blue-600 hover:text-blue-800 font-medium",onClick:()=>p(!1),children:"عرض جميع الإشعارات"})]})})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-sm font-medium text-gray-800",children:t==null?void 0:t.name}),n.jsx("p",{className:"text-xs text-gray-500",children:t!=null&&t.role?j(t.role):a("common.user")})]}),n.jsxs("div",{className:"relative group",children:[n.jsx("button",{className:"w-10 h-10 rounded-full overflow-hidden border-2 border-gray-200 hover:border-blue-500 transition-colors",children:t!=null&&t.avatar?n.jsx("img",{src:t.avatar,alt:t.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:n.jsx(Xt,{className:"w-5 h-5 text-white"})})}),n.jsx("div",{className:"absolute left-0 top-12 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50",children:n.jsxs("div",{className:"p-2",children:[n.jsx(ke,{to:"/settings",className:"w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md block",children:a("header.profile")}),n.jsx(ke,{to:"/settings",className:"w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md block",children:a("header.settings")}),n.jsx("hr",{className:"my-1"}),n.jsx("button",{onClick:r,className:"w-full text-right px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",children:a("header.logout")})]})})]})]})]})]})})},MO=({isOpen:e,onClose:t,isMinimized:r,onToggleMinimize:a})=>{const s=nv(),{user:i}=ut(),{t:o,i18n:l}=ft(),c=l.language==="ar",d=[{id:"home",icon:sE,label:o("sidebar.home"),path:"/"},{id:"project-ideas",icon:jr,label:o("sidebar.projectIdeas"),path:"/project-ideas"},{id:"projects",icon:cr,label:o("sidebar.projects"),path:"/projects"},{id:"store",icon:zr,label:o("sidebar.store"),path:"/store"},{id:"consultations",icon:rr,label:o("sidebar.consultations"),path:"/consultations"},{id:"gallery",icon:jo,label:o("sidebar.gallery"),path:"/gallery"},{id:"ai-assistant",icon:js,label:o("sidebar.aiAssistant"),path:"/ai-assistant"},{id:"resources",icon:bt,label:o("sidebar.resources"),path:"/resources"},{id:"intellectual-property",icon:ba,label:o("sidebar.intellectualProperty"),path:"/intellectual-property"}],f=(()=>{let x=[...d];return(i==null?void 0:i.role)==="teacher"?x.push({id:"reports",icon:Ts,label:o("sidebar.reports"),path:"/reports"}):(i==null?void 0:i.role)==="consultant"?x.push({id:"consultant-dashboard",icon:As,label:o("sidebar.consultantDashboard"),path:"/consultant-dashboard"},{id:"consultation-requests",icon:rr,label:o("sidebar.consultationRequests"),path:"/consultation-requests"},{id:"consultant-schedule",icon:ot,label:o("sidebar.consultantSchedule"),path:"/consultant-schedule"},{id:"consultant-profile",icon:Xt,label:o("sidebar.consultantProfile"),path:"/consultant-profile"},{id:"reviews",icon:lt,label:o("sidebar.reviews"),path:"/reviews"}):(i==null?void 0:i.role)==="school"?x.push({id:"reports",icon:Ts,label:o("sidebar.reports"),path:"/reports"}):(i==null?void 0:i.role)==="admin"&&x.push({id:"admin-dashboard",icon:ug,label:o("sidebar.adminDashboard"),path:"/admin-dashboard"}),x.push({id:"settings",icon:wo,label:o("sidebar.settings"),path:"/settings"}),x})();return n.jsxs(n.Fragment,{children:[e&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:t}),n.jsxs(re.div,{initial:!1,animate:{width:r?80:320},transition:{duration:.3,ease:"easeInOut"},className:`
          bg-white shadow-lg border-gray-200 z-50 flex-shrink-0
          ${e?"fixed inset-y-0 lg:relative":"hidden lg:flex lg:flex-col"}
          ${r?"w-20":"w-80"}
          ${c?"border-l":"border-r"}
          ${c?e?"right-0":"":e?"left-0":""}
        `,children:[n.jsx("div",{className:`p-6 border-gray-200 ${r?"px-4":""} border-b`,children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:`flex items-center gap-3 ${r?"justify-center":""}`,children:[n.jsx("div",{className:"w-16 h-16 rounded-xl flex items-center justify-center overflow-hidden",children:n.jsx("img",{src:"/mashroui-logo.png",alt:o("appName"),className:"w-full h-full object-contain"})}),!r&&n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:o("appName")}),n.jsx("p",{className:"text-sm text-gray-500",children:o("appTagline")})]})]}),n.jsx("button",{onClick:a,className:"hidden lg:flex p-2 rounded-lg hover:bg-gray-100 transition-colors",children:r?c?n.jsx(Gl,{className:"w-5 h-5 text-gray-600"}):n.jsx(Kl,{className:"w-5 h-5 text-gray-600"}):c?n.jsx(Kl,{className:"w-5 h-5 text-gray-600"}):n.jsx(Gl,{className:"w-5 h-5 text-gray-600"})}),n.jsx("button",{onClick:t,className:"lg:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors",children:c?n.jsx(Kl,{className:"w-5 h-5 text-gray-600"}):n.jsx(Gl,{className:"w-5 h-5 text-gray-600"})})]})}),n.jsx("nav",{className:`p-4 space-y-2 overflow-y-auto flex-1 ${r?"px-2":""}`,children:f.map(x=>{const p=s.pathname===x.path;return n.jsxs("div",{className:"relative",children:[n.jsxs(ke,{to:x.path,onClick:t,className:`flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 group ${p?"bg-gradient-to-r from-blue-500 via-purple-600 to-pink-600 text-white shadow-lg":"text-gray-600 hover:bg-gray-50 hover:text-gray-800"} ${r?"justify-center px-2":""}`,children:[n.jsx(x.icon,{className:"w-5 h-5 flex-shrink-0"}),!r&&n.jsx("span",{className:"font-medium",children:x.label})]}),r&&n.jsx("div",{className:`absolute ${c?"right-full":"left-full"} top-1/2 transform -translate-y-1/2 ${c?"mr-2":"ml-2"} bg-gray-800 text-white px-2 py-1 rounded text-sm opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10`,children:x.label})]},x.path)})})]})]})},LO=({children:e})=>{const[t,r]=C.useState(!1),[a,s]=C.useState(!1),{i18n:i}=ft(),o=i.language==="ar";return n.jsxs("div",{className:`min-h-screen bg-gray-50 flex ${o?"flex-row-reverse":"flex-row"}`,children:[n.jsx(MO,{isOpen:t,onClose:()=>r(!1),isMinimized:a,onToggleMinimize:()=>s(!a)}),n.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[n.jsx(RO,{onMenuClick:()=>r(!0)}),n.jsx("main",{className:"flex-1 p-6 overflow-auto",children:e})]})]})},EE=({returnUrl:e="/home",className:t=""})=>{const[r,a]=C.useState(!1),[s,i]=C.useState(null),[o,l]=C.useState("checking");C.useEffect(()=>{l("online")},[]);const c=async d=>{d.preventDefault(),d.stopPropagation();try{a(!0),i(null),console.log("[ClasseraLoginButton] Initiating LTI 1.3 login");const u="/api/lti/login",f=`${window.location.origin}/api/lti/launch`,x=new URLSearchParams({iss:"https://partners.classera.com",client_id:"5ee30a16-c764-47d1-8314-effae92c950a",target_link_uri:f,login_hint:"user_login",lti_deployment_id:"27"}),p=`${u}?${x.toString()}`;console.log("[ClasseraLoginButton] Redirecting to LTI login:",p),window.location.href=p}catch(u){console.error("[ClasseraLoginButton] Login failed:",u),i("حدث خطأ في تسجيل الدخول. يرجى المحاولة مرة أخرى."),a(!1)}};return n.jsxs("div",{className:"space-y-3",children:[!1,!1,n.jsx(re.button,{whileHover:{scale:r?1:1.02},whileTap:{scale:r?1:.98},onClick:c,disabled:r||!1,className:`w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-3 rounded-xl font-medium hover:shadow-lg transition-all duration-200 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed ${t}`,children:r?n.jsxs(n.Fragment,{children:[n.jsx(iE,{className:"w-5 h-5 animate-spin"}),n.jsx("span",{children:"جاري تسجيل الدخول عبر Classera..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(fa,{className:"w-5 h-5"}),n.jsx("span",{children:"تسجيل الدخول عبر Classera"})]})}),s&&n.jsx(re.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(ja,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),n.jsx("div",{className:"flex-1",children:s})]})}),!s&&!r&&o==="online"&&n.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[n.jsx(fa,{className:"w-3 h-3"}),n.jsx("span",{children:"تسجيل دخول آمن باستخدام LTI 1.3"})]}),n.jsx("div",{className:"text-green-600 font-medium",children:"سيتم إعادة توجيهك إلى Classera"})]})]})},$O=({isOpen:e,onClose:t})=>{const{t:r}=ft(),[a,s]=C.useState(""),[i,o]=C.useState(!1),[l,c]=C.useState(!1),[d,u]=C.useState(""),f=async p=>{if(p.preventDefault(),!a||!a.trim()){u(r("auth.forgotPassword.emailRequired"));return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)){u(r("auth.forgotPassword.invalidEmail"));return}o(!0),u(""),c(!1);try{const m=await cv(a);m.success?(c(!0),s(""),setTimeout(()=>{x()},3e3)):u(m.message)}catch(m){console.error("Error sending password reset email:",m),u(r("auth.forgotPassword.sendError"))}finally{o(!1)}},x=()=>{s(""),u(""),c(!1),o(!1),t()};return n.jsx(GC,{children:e&&n.jsx(n.Fragment,{children:n.jsx(re.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:x,className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:p=>p.stopPropagation(),className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full relative",children:[n.jsx("button",{onClick:x,className:"absolute top-4 left-4 text-gray-400 hover:text-gray-600 transition-colors",children:n.jsx(Qe,{className:"w-6 h-6"})}),n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ma,{className:"w-8 h-8 text-blue-600"})}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:r("auth.forgotPassword.title")}),n.jsx("p",{className:"text-gray-600 text-sm",children:r("auth.forgotPassword.description")})]}),l&&n.jsxs(re.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-center gap-3",children:[n.jsx(Le,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("span",{className:"text-sm",children:r("auth.forgotPassword.successMessage")})]}),d&&n.jsxs(re.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-center gap-3",children:[n.jsx(Ge,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("span",{className:"text-sm",children:d})]}),n.jsxs("form",{onSubmit:f,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("common.email")}),n.jsxs("div",{className:"relative",children:[n.jsx(ma,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:a,onChange:p=>s(p.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:r("auth.forgotPassword.emailPlaceholder"),disabled:i||l})]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{type:"button",onClick:x,disabled:i,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:r("common.cancel")}),n.jsx("button",{type:"submit",disabled:i||l,className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl font-medium hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:i?n.jsxs(n.Fragment,{children:[n.jsx(iE,{className:"w-5 h-5 animate-spin"}),n.jsx("span",{children:r("common.sending")})]}):n.jsx("span",{children:r("auth.forgotPassword.sendButton")})})]})]})]})})})})},BO=()=>{const{t:e}=ft(),[t,r]=C.useState(""),[a,s]=C.useState(""),[i,o]=C.useState(!1),[l,c]=C.useState(!1),[d,u]=C.useState(""),[f,x]=C.useState(!1),{login:p}=ut(),h=async m=>{m.preventDefault(),u(""),c(!0);try{await p(t,a)}catch(g){console.error("Auth error:",g);let v=e("auth.loginError");if(g instanceof Error){const b=g.message.toLowerCase();b.includes("invalid login credentials")||b.includes("invalid_credentials")||b.includes("user-not-found")||b.includes("wrong-password")?v=e("auth.loginError"):b.includes("email not confirmed")?v=e("auth.emailNotConfirmed"):b.includes("too many requests")?v=e("auth.tooManyRequests"):b.includes("network")||b.includes("fetch")?v=e("auth.networkError"):v=g.message}u(v)}finally{c(!1)}};return n.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:[n.jsx("div",{className:"max-w-md w-full",children:n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-xl p-8",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx(re.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-32 h-32 rounded-2xl flex items-center justify-center mx-auto mb-4 overflow-hidden",children:n.jsx("img",{src:"/mashroui-logo.png",alt:e("appName"),className:"w-full h-full object-contain"})}),n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:e("appName")}),n.jsx("p",{className:"text-gray-600",children:e("appTagline")})]}),d&&n.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:d}),n.jsxs("form",{onSubmit:h,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("common.email")}),n.jsxs("div",{className:"relative",children:[n.jsx(ma,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:t,onChange:m=>r(m.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:e("auth.enterEmail"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e("common.password")}),n.jsx("button",{type:"button",onClick:()=>x(!0),className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",children:e("auth.forgotPassword.link")})]}),n.jsxs("div",{className:"relative",children:[n.jsx(Yn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:i?"text":"password",value:a,onChange:m=>s(m.target.value),className:"w-full pr-12 pl-12 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:e("auth.enterPassword"),required:!0}),n.jsx("button",{type:"button",onClick:()=>o(!i),className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:i?n.jsx(Ff,{className:"w-5 h-5"}):n.jsx(mr,{className:"w-5 h-5"})})]})]}),n.jsx(re.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:l,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 rounded-xl font-medium hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed",children:l?n.jsxs("span",{className:"flex items-center justify-center",children:[n.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e("common.loading")]}):e("auth.login")})]}),n.jsxs("div",{className:"relative mt-6",children:[n.jsx("div",{className:"absolute inset-0 flex items-center",children:n.jsx("div",{className:"w-full border-t border-gray-300"})}),n.jsx("div",{className:"relative flex justify-center text-sm",children:n.jsx("span",{className:"px-2 bg-white text-gray-500",children:"أو"})})]}),n.jsx(EE,{returnUrl:"/home"}),n.jsx("div",{className:"mt-4 text-center",children:n.jsx(ke,{to:"/summer-program-enrollment",className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",children:'"برنامج مشروعي إبداعي"'})}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs(ke,{to:"/register",className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",children:[e("auth.noAccount")," ",e("auth.createAccount")]})})]})}),n.jsx($O,{isOpen:f,onClose:()=>x(!1)})]})},UO=()=>{const{register:e}=ut(),[t,r]=C.useState({name:"",email:"",password:"",confirmPassword:"",phone:"",role:"student",bio:"",school_id:"",grade:"",subject:"",schoolIdNumber:"",specializations:[],experience_years:0,hourly_rate:150,languages:["العربية"],otherSpecialization:""}),[a,s]=C.useState(!1),[i,o]=C.useState(!1),[l,c]=C.useState(""),[d,u]=C.useState([]),[f,x]=C.useState(!0),p=["الذكاء الاصطناعي","تعلم الآلة","الروبوتات","تطوير التطبيقات","تطوير الويب","قواعد البيانات","الأمن السيبراني","الشبكات","التصميم الجرافيكي","تجربة المستخدم","التسويق الرقمي","ريادة الأعمال","إدارة المشاريع","العلوم","الرياضيات","الفيزياء","الكيمياء","الأحياء","الهندسة الميكانيكية","الهندسة الكهربائية","الهندسة المدنية","الطب العام","طب الأطفال","الجراحة العامة","أخرى"],h=["العربية","الإنجليزية","الفرنسية","الإسبانية","الألمانية","الصينية","اليابانية","الروسية","الهندية","البرتغالية"];C.useEffect(()=>{(async()=>{try{x(!0),c("");const N=await ov();console.log("Fetched schools:",N),N&&N.length>0?u(N):(console.warn("No schools found or empty schools array returned"),u([]))}catch(N){console.error("Error fetching schools:",N),console.error("Error details:",N.message),u([])}finally{x(!1)}})()},[]);const m=(y,N)=>{r(j=>({...j,[y]:N}))},g=y=>{r(N=>({...N,specializations:N.specializations.includes(y)?N.specializations.filter(j=>j!==y):[...N.specializations,y]}))},v=y=>{r(N=>({...N,languages:N.languages.includes(y)?N.languages.filter(j=>j!==y):[...N.languages,y]}))},b=async y=>{if(y.preventDefault(),c(""),t.password!==t.confirmPassword){c("كلمات المرور غير متطابقة");return}if(t.password.length<6){c("يجب أن تكون كلمة المرور 6 أحرف على الأقل");return}o(!0);try{let N=[...t.specializations];t.specializations.includes("أخرى")&&t.otherSpecialization.trim()&&(N=N.filter(j=>j!=="أخرى"),N.push(t.otherSpecialization.trim())),await e(t.email,t.password,{name:t.name,role:t.role,phone:t.phone,bio:t.bio,school_id:t.school_id,grade:t.grade,subject:t.subject,specializations:N,experience_years:t.experience_years,languages:t.languages})}catch{c("حدث خطأ في إنشاء الحساب")}finally{o(!1)}};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:n.jsx("div",{className:"max-w-2xl w-full",children:n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-xl p-8",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx(re.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-32 h-32 rounded-2xl flex items-center justify-center mx-auto mb-4 overflow-hidden",children:n.jsx("img",{src:"/mashroui-logo.png",alt:"مشروعي",className:"w-full h-full object-contain"})}),n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"إنشاء حساب جديد"}),n.jsx("p",{className:"text-gray-600",children:"انضم إلى منصة مشروعي"})]}),l&&n.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:l}),n.jsxs("form",{onSubmit:b,className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الاسم الكامل"}),n.jsxs("div",{className:"relative",children:[n.jsx(Xt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:t.name,onChange:y=>m("name",y.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل اسمك الكامل",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البريد الإلكتروني"}),n.jsxs("div",{className:"relative",children:[n.jsx(ma,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:t.email,onChange:y=>m("email",y.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل بريدك الإلكتروني",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"كلمة المرور"}),n.jsxs("div",{className:"relative",children:[n.jsx(Yn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:a?"text":"password",value:t.password,onChange:y=>m("password",y.target.value),className:"w-full pr-12 pl-12 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل كلمة المرور",required:!0}),n.jsx("button",{type:"button",onClick:()=>s(!a),className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:a?n.jsx(Ff,{className:"w-5 h-5"}):n.jsx(mr,{className:"w-5 h-5"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تأكيد كلمة المرور"}),n.jsxs("div",{className:"relative",children:[n.jsx(Yn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:a?"text":"password",value:t.confirmPassword,onChange:y=>m("confirmPassword",y.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أعد إدخال كلمة المرور",required:!0})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الهاتف"}),n.jsxs("div",{className:"relative",children:[n.jsx(Cr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"tel",value:t.phone,onChange:y=>m("phone",y.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"05xxxxxxxx"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الحساب"}),n.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-3",children:[n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${t.role==="student"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"role",value:"student",checked:t.role==="student",onChange:()=>m("role","student"),className:"sr-only"}),n.jsx(vi,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:"طالب"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${t.role==="teacher"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"role",value:"teacher",checked:t.role==="teacher",onChange:()=>m("role","teacher"),className:"sr-only"}),n.jsx(bt,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:"مشرف"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${t.role==="consultant"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"role",value:"consultant",checked:t.role==="consultant",onChange:()=>m("role","consultant"),className:"sr-only"}),n.jsx(As,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:"مستشار"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${t.role==="school"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"role",value:"school",checked:t.role==="school",onChange:()=>m("role","school"),className:"sr-only"}),n.jsx(ks,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:"مدرسة"})]})]})]}),t.role==="student"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدرسة"}),n.jsxs("div",{className:"relative",children:[n.jsx(ks,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:t.school_id,onChange:y=>m("school_id",y.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:"اختر المدرسة"}),f&&n.jsx("option",{disabled:!0,children:"جاري تحميل المدارس..."}),!f&&d.length===0&&n.jsx("option",{disabled:!0,children:"لا توجد مدارس متاحة"}),!f&&d.map(y=>n.jsx("option",{value:y.id,children:y.name},y.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الصف الدراسي"}),n.jsxs("div",{className:"relative",children:[n.jsx(vi,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:t.grade,onChange:y=>m("grade",y.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"مثال: الصف الثالث الثانوي"})]})]})]}),(t.role==="student"||t.role==="teacher")&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم التعريف الخاص بك في مدرستك (ID, رقمك المدرسي, رقم البطاقة المدرسية)"}),n.jsx("div",{className:"relative",children:n.jsx("input",{type:"text",value:t.schoolIdNumber,onChange:y=>m("schoolIdNumber",y.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل رقم التعريف الخاص بك في مدرستك"})})]}),t.role==="teacher"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدرسة"}),n.jsxs("div",{className:"relative",children:[n.jsx(ks,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:t.school_id,onChange:y=>m("school_id",y.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:"اختر المدرسة"}),f&&n.jsx("option",{disabled:!0,children:"جاري تحميل المدارس..."}),!f&&d.length===0&&n.jsx("option",{disabled:!0,children:"لا توجد مدارس متاحة"}),!f&&d.map(y=>n.jsx("option",{value:y.id,children:y.name},y.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التخصص"}),n.jsxs("div",{className:"relative",children:[n.jsx(bt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:t.subject,onChange:y=>m("subject",y.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"مثال: الرياضيات، العلوم، اللغة العربية"})]})]})]}),t.role==="consultant"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نبذة مهنية"}),n.jsx("textarea",{value:t.bio,onChange:y=>m("bio",y.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اكتب نبذة مختصرة عن خبرتك المهنية..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التخصصات"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:p.map(y=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${t.specializations.includes(y)?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:t.specializations.includes(y),onChange:()=>g(y),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:y})]},y))}),t.specializations.includes("أخرى")&&n.jsxs("div",{className:"mt-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"حدد التخصص الآخر"}),n.jsx("input",{type:"text",value:t.otherSpecialization,onChange:y=>m("otherSpecialization",y.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اكتب تخصصك...",required:t.specializations.includes("أخرى")})]})]}),n.jsx("div",{children:n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سنوات الخبرة"}),n.jsxs("div",{className:"relative",children:[n.jsx(lr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:t.experience_years,onChange:y=>m("experience_years",parseInt(y.target.value)||0),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"عدد سنوات الخبرة",min:"0"})]})]})}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اللغات"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2",children:h.map(y=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${t.languages.includes(y)?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:t.languages.includes(y),onChange:()=>v(y),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:y})]},y))})]})]}),t.role==="school"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"معلومات المدرسة"}),n.jsx("textarea",{value:t.bio,onChange:y=>m("bio",y.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اكتب نبذة مختصرة عن المدرسة..."})]}),n.jsx(re.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:i,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 rounded-xl font-medium hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed",children:i?"جاري إنشاء الحساب...":"إنشاء حساب"})]}),n.jsx("div",{className:"mt-6 text-center",children:n.jsx(ke,{to:"/login",className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",children:"لديك حساب بالفعل؟ تسجيل الدخول"})})]})})})},qO=()=>{const{t:e}=ft(),t=[{icon:bt,title:e("sidebar.projectIdeas"),description:e("home.features.projectIdeas.description"),link:"/project-ideas",color:"from-amber-600 to-yellow-600"},{icon:dt,title:e("sidebar.projects"),description:e("home.features.projects.description"),link:"/projects",color:"from-slate-600 to-gray-700"},{icon:rr,title:e("sidebar.consultations"),description:e("home.features.consultations.description"),link:"/consultations",color:"from-emerald-600 to-teal-700"},{icon:zr,title:e("sidebar.store"),description:e("home.features.store.description"),link:"/store",color:"from-orange-600 to-red-700"},{icon:js,title:e("sidebar.aiAssistant"),description:e("home.features.aiAssistant.description"),link:"/ai-assistant",color:"from-cyan-600 to-sky-700"},{icon:jo,title:e("sidebar.gallery"),description:e("home.features.gallery.description"),link:"/gallery",color:"from-teal-600 to-cyan-700"}];return n.jsxs("div",{className:"space-y-8",children:[n.jsxs("div",{children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-8",children:[n.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:e("home.featuresSection.title")}),n.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:e("home.featuresSection.description")})]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((r,a)=>n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:a*.1},whileHover:{y:-5},className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 group",children:[n.jsx("div",{className:`w-14 h-14 bg-gradient-to-r ${r.color} rounded-2xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300`,children:n.jsx(r.icon,{className:"w-7 h-7 text-white"})}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-3",children:r.title}),n.jsx("p",{className:"text-gray-600 mb-4 leading-relaxed",children:r.description}),n.jsxs(ke,{to:r.link,className:"inline-flex items-center gap-2 text-blue-600 font-medium hover:text-blue-800 transition-colors",children:[e("home.featuresSection.exploreMore"),n.jsx(fc,{className:"w-4 h-4"})]})]},r.title))})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-slate-700 to-gray-800 rounded-3xl p-8 text-white text-center",children:[n.jsx("h2",{className:"text-3xl font-bold mb-4",children:e("home.cta.title")}),n.jsx("p",{className:"text-xl mb-6 opacity-90",children:e("home.cta.description")}),n.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[n.jsx(ke,{to:"/project-ideas",className:"bg-white text-slate-700 px-8 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200",children:e("home.cta.exploreIdeas")}),n.jsx(ke,{to:"/projects",className:"bg-white bg-opacity-20 text-white px-8 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 backdrop-blur-sm",children:e("home.cta.createProject")})]})]})]})},WO=()=>{const{t:e,i18n:t}=ft(),[r,a]=C.useState(!1),s=l=>{t.changeLanguage(l),a(!1)},i=[{icon:jr,title:e("sidebar.projectIdeas"),description:e("home.featuresSection.description"),link:"/project-ideas",color:"from-amber-600 to-yellow-600"},{icon:dt,title:e("sidebar.projects"),description:e("home.featuresSection.description"),link:"/projects",color:"from-slate-600 to-gray-700"},{icon:rr,title:e("sidebar.consultations"),description:e("home.featuresSection.description"),link:"/consultations",color:"from-emerald-600 to-teal-700"},{icon:zr,title:e("sidebar.store"),description:e("home.featuresSection.description"),link:"/store",color:"from-orange-600 to-red-700"},{icon:js,title:e("sidebar.aiAssistant"),description:e("home.featuresSection.description"),link:"/ai-assistant",color:"from-cyan-600 to-sky-700"},{icon:jo,title:e("sidebar.gallery"),description:e("home.featuresSection.description"),link:"/gallery",color:"from-teal-600 to-cyan-700"},{icon:bt,title:e("sidebar.resources"),description:e("home.featuresSection.description"),link:"/resources",color:"from-emerald-600 to-green-700"},{icon:ba,title:e("sidebar.intellectualProperty"),description:e("home.featuresSection.description"),link:"/intellectual-property",color:"from-red-700 to-rose-800"}],o=[{name:"د. سارة أحمد",role:"أستاذة الفيزياء الجزيئية",content:"منصة مشروعي حولت أسلوب إدارة الأبحاث تماماً. الطلاب الجامعيين أصبحوا أكثر انخراطاً في البحث العلمي.",avatar:"https://images.pexels.com/photos/774909/pexels-photo-774909.jpeg?auto=compress&cs=tinysrgb&w=150",rating:5},{name:"محمد علي",role:"طالب هندسة - السنة الثالثة",content:"تمكنت من تطوير نظام ذكي متطور لإدارة الطاقة بفضل الإشراف الأكاديمي والدعم البحثي المتاح.",avatar:"https://images.pexels.com/photos/2282451/pexels-photo-2282451.jpeg?auto=compress&cs=tinysrgb&w=150",rating:5},{name:"د. سعيد صالح",role:"المشرف على المشاريع",content:"المنصة ساعدتنا في تنظيم وإدارة المشاريع البحثية للطلاب الجامعيين بكفاءة عالية ومتابعة تقدمهم الأكاديمي.",avatar:"https://images.pexels.com/photos/14267043/pexels-photo-14267043.jpeg?auto=compress&cs=tinysrgb&w=150",rating:5}];return n.jsxs("div",{className:"min-h-screen bg-gray-50",children:[n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-0 w-full h-full",style:{backgroundImage:'url("https://images.pexels.com/photos/256490/pexels-photo-256490.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1")',backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),n.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-slate-800 via-gray-700 to-slate-900 opacity-80"}),n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"relative text-white py-20 px-4 overflow-hidden",children:n.jsxs("div",{className:"relative z-10 max-w-6xl mx-auto text-center",children:[n.jsx("div",{className:"absolute top-4 right-4 z-20",children:n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>a(!r),className:"flex items-center gap-2 px-3 py-2 bg-white bg-opacity-20 text-white rounded-lg hover:bg-opacity-30 transition-all",children:[n.jsx(yi,{className:"w-4 h-4"}),n.jsx("span",{children:t.language==="ar"?"العربية":"English"})]}),r&&n.jsxs("div",{className:"absolute top-full right-0 mt-1 bg-white rounded-lg shadow-lg overflow-hidden",children:[n.jsx("button",{onClick:()=>s("ar"),className:`block w-full text-right px-4 py-2 text-sm hover:bg-gray-100 ${t.language==="ar"?"bg-blue-50 text-blue-600 font-medium":"text-gray-700"}`,children:"العربية"}),n.jsx("button",{onClick:()=>s("en"),className:`block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 ${t.language==="en"?"bg-blue-50 text-blue-600 font-medium":"text-gray-700"}`,children:"English"})]})]})}),n.jsx("div",{className:"flex items-center justify-center gap-6 mb-6",children:n.jsx("img",{src:"/mashroui-logo.png",alt:e("appName"),className:"h-24 drop-shadow-lg"})}),n.jsxs("h1",{className:"text-5xl font-extrabold mb-4 leading-tight",children:[n.jsx("span",{className:"block text-2xl font-medium mb-2 text-blue-100",children:e("landingPage.welcomeMessage")}),e("appName")," - ",e("appTagline")]}),n.jsx("p",{className:"text-xl mb-8 opacity-90 max-w-3xl mx-auto",children:e("home.description")}),n.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4 mt-8",children:[n.jsx(ke,{to:"/register",className:"bg-white text-blue-600 px-8 py-3 rounded-full font-bold text-lg shadow-lg hover:bg-gray-100 transition-all duration-300 transform hover:scale-105",children:e("auth.createAccount")}),n.jsx(ke,{to:"/login",className:"bg-transparent border-2 border-white text-white px-8 py-3 rounded-full font-bold text-lg shadow-lg hover:bg-white hover:bg-opacity-20 transition-all duration-300 transform hover:scale-105",children:e("auth.login")})]})]})})]}),n.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:[n.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm text-center",children:[n.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"100+"}),n.jsx("div",{className:"text-gray-600",children:"طالب مسجل"})]}),n.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm text-center",children:[n.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"25+"}),n.jsx("div",{className:"text-gray-600",children:"مشروع منجز"})]}),n.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm text-center",children:[n.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:"20+"}),n.jsx("div",{className:"text-gray-600",children:"مشرف ومستشار"})]}),n.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm text-center",children:[n.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:"5+"}),n.jsx("div",{className:"text-gray-600",children:"مدرسة شريكة"})]})]}),n.jsx("div",{className:"py-8",children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx("div",{className:"relative overflow-hidden rounded-lg shadow-md group",children:n.jsx("img",{src:"https://images.pexels.com/photos/2599244/pexels-photo-2599244.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",alt:"Advanced Robotics and AI Engineering Project",className:"w-full h-48 object-cover transition-transform duration-300 group-hover:scale-110"})}),n.jsx("div",{className:"relative overflow-hidden rounded-lg shadow-md group",children:n.jsx("img",{src:"https://images.pexels.com/photos/356036/pexels-photo-356036.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",alt:"Sustainable Energy Engineering and Solar Technology Research",className:"w-full h-48 object-cover transition-transform duration-300 group-hover:scale-110"})}),n.jsx("div",{className:"relative overflow-hidden rounded-lg shadow-md group",children:n.jsx("img",{src:"https://images.pexels.com/photos/577585/pexels-photo-577585.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",alt:"Computer Science and Software Development Research",className:"w-full h-48 object-cover transition-transform duration-300 group-hover:scale-110"})}),n.jsx("div",{className:"relative overflow-hidden rounded-lg shadow-md group",children:n.jsx("img",{src:"https://images.pexels.com/photos/3861969/pexels-photo-3861969.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",alt:"Biomedical Engineering and Laboratory Research",className:"w-full h-48 object-cover transition-transform duration-300 group-hover:scale-110"})})]})}),n.jsx("div",{className:"py-16 px-4 bg-white",children:n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsx(re.h2,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-4xl font-bold text-gray-800 mb-12 text-center",children:e("home.featuresSection.title")}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:i.map((l,c)=>n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:c*.1},className:"bg-gray-50 rounded-xl p-6 text-center shadow-sm hover:shadow-md transition-all duration-300",children:[n.jsx("div",{className:`w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center bg-gradient-to-r ${l.color}`,children:n.jsx(l.icon,{className:"w-8 h-8 text-white"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:l.title}),n.jsx("p",{className:"text-gray-600 text-sm",children:l.description})]},l.title))})]})}),n.jsx("div",{className:"py-16 px-4 bg-gray-100",children:n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsx(re.h2,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-4xl font-bold text-gray-800 mb-12 text-center",children:e("home.testimonials.title")}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:o.map((l,c)=>n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:c*.1},className:"bg-white rounded-xl p-6 shadow-md",children:[n.jsx("div",{className:"flex items-center mb-4",children:[...Array(l.rating)].map((d,u)=>n.jsx(lt,{className:"w-5 h-5 text-yellow-400 fill-current"},u))}),n.jsxs("p",{className:"text-gray-700 mb-4 italic",children:['"',l.content,'"']}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("img",{src:l.avatar,alt:l.name,className:"w-12 h-12 rounded-full object-cover mr-4"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:l.name}),n.jsx("p",{className:"text-sm text-gray-600",children:l.role})]})]})]},l.name))})]})}),n.jsx("div",{className:"py-16 px-4 bg-white",children:n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsx(re.h2,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-4xl font-bold text-gray-800 mb-12 text-center",children:"لماذا منصة مشروعي؟"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Le,{className:"w-8 h-8 text-blue-600"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"تعلم قائم على المشاريع"}),n.jsx("p",{className:"text-gray-600",children:"تطوير مهارات الطلاب من خلال مشاريع عملية تطبيقية في مختلف المجالات"})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(lr,{className:"w-8 h-8 text-green-600"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"تطوير المهارات"}),n.jsx("p",{className:"text-gray-600",children:"تنمية مهارات القرن الواحد والعشرين والتفكير النقدي والإبداعي"})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(dt,{className:"w-8 h-8 text-purple-600"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"مجتمع تعليمي"}),n.jsx("p",{className:"text-gray-600",children:"بيئة تفاعلية تجمع الطلاب والمشرفين والمستشارين في منصة واحدة"})]})]})]})}),n.jsx("div",{className:"py-16 px-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white",children:n.jsxs("div",{className:"max-w-6xl mx-auto text-center",children:[n.jsx(re.h2,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-4xl font-bold mb-4",children:e("home.cta.title")}),n.jsx("p",{className:"text-xl mb-8 opacity-90 max-w-3xl mx-auto",children:e("home.cta.description")}),n.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4",children:[n.jsx(ke,{to:"/register",className:"bg-white text-blue-600 px-8 py-3 rounded-full font-bold text-lg shadow-lg hover:bg-gray-100 transition-all duration-300 transform hover:scale-105",children:e("auth.createAccount")}),n.jsx(ke,{to:"/summer-program-enrollment",className:"bg-transparent border-2 border-white text-white px-8 py-3 rounded-full font-bold text-lg shadow-lg hover:bg-white hover:bg-opacity-20 transition-all duration-300",children:"......."})]})]})}),n.jsx("footer",{className:"bg-gray-800 text-white py-8 px-4",children:n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8 mb-8",children:[n.jsxs("div",{children:[n.jsx("img",{src:"/mashroui-logo.png",alt:e("appName"),className:"h-12 mb-4"}),n.jsx("p",{className:"text-gray-400",children:e("appTagline")})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-lg font-semibold mb-4",children:"روابط سريعة"}),n.jsxs("ul",{className:"space-y-2",children:[n.jsx("li",{children:n.jsx(ke,{to:"/login",className:"text-gray-400 hover:text-white transition-colors",children:"تسجيل الدخول"})}),n.jsx("li",{children:n.jsx(ke,{to:"/register",className:"text-gray-400 hover:text-white transition-colors",children:"إنشاء حساب"})}),n.jsx("li",{children:n.jsx(ke,{to:"/summer-program-enrollment",className:"text-gray-400 hover:text-white transition-colors",children:"......"})})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-lg font-semibold mb-4",children:"تواصل معنا"}),n.jsxs("ul",{className:"space-y-2",children:[n.jsx("li",{className:"text-gray-400",children:"البريد الإلكتروني: sales@innovationladders.com"}),n.jsx("li",{className:"text-gray-400",children:"الهاتف: 966554344899 "})]})]}),n.jsx("div",{children:n.jsx("h4",{className:"text-lg font-semibold mb-4",children:"تابعنا"})})]}),n.jsx("div",{className:"border-t border-gray-700 pt-8 text-center",children:n.jsxs("p",{className:"text-gray-400",children:["© ",new Date().getFullYear()," ",e("appName"),". جميع الحقوق محفوظة."]})})]})})]})},HO=()=>{const{user:e,logout:t}=ut(),{t:r}=ft(),a=(e==null?void 0:e.role)==="school",s=(e==null?void 0:e.role)==="consultant";return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-xl p-8 max-w-2xl w-full",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"w-32 h-32 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(xt,{className:"w-16 h-16 text-yellow-600"})}),n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:r("pendingActivation.title")}),n.jsx("p",{className:"text-gray-600 text-lg",children:r(a?"pendingActivation.description.school":s?"pendingActivation.description.consultant":"pendingActivation.description.default")})]}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 mb-6",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Ge,{className:"w-6 h-6 text-blue-600 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h2",{className:"font-semibold text-blue-800 mb-2",children:r("pendingActivation.whatHappensNext")}),n.jsxs("ul",{className:"space-y-2 text-blue-700",children:[n.jsxs("li",{children:["• ",r("pendingActivation.steps.review")]}),n.jsxs("li",{children:["• ",r("pendingActivation.steps.verify")]}),n.jsxs("li",{children:["• ",r("pendingActivation.steps.email")]}),n.jsxs("li",{children:["• ",r("pendingActivation.steps.timeframe")]})]})]})]})}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6 mb-6",children:[n.jsx("h2",{className:"font-semibold text-gray-800 mb-4",children:r("pendingActivation.contactInfo")}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(ma,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:r("common.email")}),n.jsx("p",{className:"font-medium",children:e==null?void 0:e.email})]})]}),(e==null?void 0:e.phone)&&n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Cr,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:r("common.phone")}),n.jsx("p",{className:"font-medium",children:e.phone})]})]})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[n.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:n.jsx(Le,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:r("pendingActivation.approvalStates.approved")}),n.jsx("p",{className:"text-sm text-gray-600",children:r("pendingActivation.approvalStates.approvedDesc")})]})]}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:n.jsx(un,{className:"w-5 h-5 text-red-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:r("pendingActivation.approvalStates.rejected")}),n.jsx("p",{className:"text-sm text-gray-600",children:r("pendingActivation.approvalStates.rejectedDesc")})]})]})]}),n.jsx("div",{className:"bg-gray-50 rounded-xl p-6 mb-6",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(ba,{className:"w-6 h-6 text-gray-600 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h2",{className:"font-semibold text-gray-800 mb-2",children:r("pendingActivation.needHelp")}),n.jsxs("p",{className:"text-gray-600 mb-4",children:[r("pendingActivation.helpText"),n.jsx("a",{href:"mailto:support@mashroui.com",className:"text-blue-600 hover:underline mx-1",children:"support@mashroui.com"})]})]})]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[n.jsxs("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center justify-center gap-2",children:[n.jsx(no,{className:"w-5 h-5"}),r("pendingActivation.refreshPage")]}),n.jsxs("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[n.jsx(KC,{className:"w-5 h-5"}),r("pendingActivation.logout")]})]})]})})},Ke=e=>typeof e=="string",Sl=()=>{let e,t;const r=new Promise((a,s)=>{e=a,t=s});return r.resolve=e,r.reject=t,r},x1=e=>e==null?"":""+e,zO=(e,t,r)=>{e.forEach(a=>{t[a]&&(r[a]=t[a])})},VO=/###/g,p1=e=>e&&e.indexOf("###")>-1?e.replace(VO,"."):e,g1=e=>!e||Ke(e),Jl=(e,t,r)=>{const a=Ke(t)?t.split("."):t;let s=0;for(;s<a.length-1;){if(g1(e))return{};const i=p1(a[s]);!e[i]&&r&&(e[i]=new r),Object.prototype.hasOwnProperty.call(e,i)?e=e[i]:e={},++s}return g1(e)?{}:{obj:e,k:p1(a[s])}},y1=(e,t,r)=>{const{obj:a,k:s}=Jl(e,t,Object);if(a!==void 0||t.length===1){a[s]=r;return}let i=t[t.length-1],o=t.slice(0,t.length-1),l=Jl(e,o,Object);for(;l.obj===void 0&&o.length;)i=`${o[o.length-1]}.${i}`,o=o.slice(0,o.length-1),l=Jl(e,o,Object),l!=null&&l.obj&&typeof l.obj[`${l.k}.${i}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${i}`]=r},GO=(e,t,r,a)=>{const{obj:s,k:i}=Jl(e,t,Object);s[i]=s[i]||[],s[i].push(r)},yu=(e,t)=>{const{obj:r,k:a}=Jl(e,t);if(r&&Object.prototype.hasOwnProperty.call(r,a))return r[a]},KO=(e,t,r)=>{const a=yu(e,r);return a!==void 0?a:yu(t,r)},TE=(e,t,r)=>{for(const a in t)a!=="__proto__"&&a!=="constructor"&&(a in e?Ke(e[a])||e[a]instanceof String||Ke(t[a])||t[a]instanceof String?r&&(e[a]=t[a]):TE(e[a],t[a],r):e[a]=t[a]);return e},Vi=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var XO={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const YO=e=>Ke(e)?e.replace(/[&<>"'\/]/g,t=>XO[t]):e;class JO{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const r=this.regExpMap.get(t);if(r!==void 0)return r;const a=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,a),this.regExpQueue.push(t),a}}const QO=[" ",",","?","!",";"],ZO=new JO(20),e8=(e,t,r)=>{t=t||"",r=r||"";const a=QO.filter(o=>t.indexOf(o)<0&&r.indexOf(o)<0);if(a.length===0)return!0;const s=ZO.getRegExp(`(${a.map(o=>o==="?"?"\\?":o).join("|")})`);let i=!s.test(e);if(!i){const o=e.indexOf(r);o>0&&!s.test(e.substring(0,o))&&(i=!0)}return i},vg=(e,t,r=".")=>{if(!e)return;if(e[t])return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0;const a=t.split(r);let s=e;for(let i=0;i<a.length;){if(!s||typeof s!="object")return;let o,l="";for(let c=i;c<a.length;++c)if(c!==i&&(l+=r),l+=a[c],o=s[l],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&c<a.length-1)continue;i+=c-i+1;break}s=o}return s},mc=e=>e==null?void 0:e.replace("_","-"),t8={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){var r,a;(a=(r=console==null?void 0:console[e])==null?void 0:r.apply)==null||a.call(r,console,t)}};class vu{constructor(t,r={}){this.init(t,r)}init(t,r={}){this.prefix=r.prefix||"i18next:",this.logger=t||t8,this.options=r,this.debug=r.debug}log(...t){return this.forward(t,"log","",!0)}warn(...t){return this.forward(t,"warn","",!0)}error(...t){return this.forward(t,"error","")}deprecate(...t){return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(t,r,a,s){return s&&!this.debug?null:(Ke(t[0])&&(t[0]=`${a}${this.prefix} ${t[0]}`),this.logger[r](t))}create(t){return new vu(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new vu(this.logger,t)}}var Nn=new vu;let Bf=class{constructor(){this.observers={}}on(t,r){return t.split(" ").forEach(a=>{this.observers[a]||(this.observers[a]=new Map);const s=this.observers[a].get(r)||0;this.observers[a].set(r,s+1)}),this}off(t,r){if(this.observers[t]){if(!r){delete this.observers[t];return}this.observers[t].delete(r)}}emit(t,...r){this.observers[t]&&Array.from(this.observers[t].entries()).forEach(([s,i])=>{for(let o=0;o<i;o++)s(...r)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([s,i])=>{for(let o=0;o<i;o++)s.apply(s,[t,...r])})}};class v1 extends Bf{constructor(t,r={ns:["translation"],defaultNS:"translation"}){super(),this.data=t||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const r=this.options.ns.indexOf(t);r>-1&&this.options.ns.splice(r,1)}getResource(t,r,a,s={}){var d,u;const i=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,o=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;t.indexOf(".")>-1?l=t.split("."):(l=[t,r],a&&(Array.isArray(a)?l.push(...a):Ke(a)&&i?l.push(...a.split(i)):l.push(a)));const c=yu(this.data,l);return!c&&!r&&!a&&t.indexOf(".")>-1&&(t=l[0],r=l[1],a=l.slice(2).join(".")),c||!o||!Ke(a)?c:vg((u=(d=this.data)==null?void 0:d[t])==null?void 0:u[r],a,i)}addResource(t,r,a,s,i={silent:!1}){const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let l=[t,r];a&&(l=l.concat(o?a.split(o):a)),t.indexOf(".")>-1&&(l=t.split("."),s=r,r=l[1]),this.addNamespaces(r),y1(this.data,l,s),i.silent||this.emit("added",t,r,a,s)}addResources(t,r,a,s={silent:!1}){for(const i in a)(Ke(a[i])||Array.isArray(a[i]))&&this.addResource(t,r,i,a[i],{silent:!0});s.silent||this.emit("added",t,r,a)}addResourceBundle(t,r,a,s,i,o={silent:!1,skipCopy:!1}){let l=[t,r];t.indexOf(".")>-1&&(l=t.split("."),s=a,a=r,r=l[1]),this.addNamespaces(r);let c=yu(this.data,l)||{};o.skipCopy||(a=JSON.parse(JSON.stringify(a))),s?TE(c,a,i):c={...c,...a},y1(this.data,l,c),o.silent||this.emit("added",t,r,a)}removeResourceBundle(t,r){this.hasResourceBundle(t,r)&&delete this.data[t][r],this.removeNamespaces(r),this.emit("removed",t,r)}hasResourceBundle(t,r){return this.getResource(t,r)!==void 0}getResourceBundle(t,r){return r||(r=this.options.defaultNS),this.getResource(t,r)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const r=this.getDataByLanguage(t);return!!(r&&Object.keys(r)||[]).find(s=>r[s]&&Object.keys(r[s]).length>0)}toJSON(){return this.data}}var AE={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,r,a,s){return e.forEach(i=>{var o;t=((o=this.processors[i])==null?void 0:o.process(t,r,a,s))??t}),t}};const CE=Symbol("i18next/PATH_KEY");function r8(){const e=[],t=Object.create(null);let r;return t.get=(a,s)=>{var i;return(i=r==null?void 0:r.revoke)==null||i.call(r),s===CE?e:(e.push(s),r=Proxy.revocable(a,t),r.proxy)},Proxy.revocable(Object.create(null),t).proxy}function bg(e,t){const{[CE]:r}=e(r8());return r.join((t==null?void 0:t.keySeparator)??".")}const b1={},j1=e=>!Ke(e)&&typeof e!="boolean"&&typeof e!="number";class bu extends Bf{constructor(t,r={}){super(),zO(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Nn.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t,r={interpolation:{}}){const a={...r};if(t==null)return!1;const s=this.resolve(t,a);return(s==null?void 0:s.res)!==void 0}extractFromKey(t,r){let a=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;a===void 0&&(a=":");const s=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let i=r.ns||this.options.defaultNS||[];const o=a&&t.indexOf(a)>-1,l=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!e8(t,a,s);if(o&&!l){const c=t.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:t,namespaces:Ke(i)?[i]:i};const d=t.split(a);(a!==s||a===s&&this.options.ns.indexOf(d[0])>-1)&&(i=d.shift()),t=d.join(s)}return{key:t,namespaces:Ke(i)?[i]:i}}translate(t,r,a){let s=typeof r=="object"?{...r}:r;if(typeof s!="object"&&this.options.overloadTranslationOptionHandler&&(s=this.options.overloadTranslationOptionHandler(arguments)),typeof s=="object"&&(s={...s}),s||(s={}),t==null)return"";typeof t=="function"&&(t=bg(t,{...this.options,...s})),Array.isArray(t)||(t=[String(t)]);const i=s.returnDetails!==void 0?s.returnDetails:this.options.returnDetails,o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,{key:l,namespaces:c}=this.extractFromKey(t[t.length-1],s),d=c[c.length-1];let u=s.nsSeparator!==void 0?s.nsSeparator:this.options.nsSeparator;u===void 0&&(u=":");const f=s.lng||this.language,x=s.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((f==null?void 0:f.toLowerCase())==="cimode")return x?i?{res:`${d}${u}${l}`,usedKey:l,exactUsedKey:l,usedLng:f,usedNS:d,usedParams:this.getUsedParamsDetails(s)}:`${d}${u}${l}`:i?{res:l,usedKey:l,exactUsedKey:l,usedLng:f,usedNS:d,usedParams:this.getUsedParamsDetails(s)}:l;const p=this.resolve(t,s);let h=p==null?void 0:p.res;const m=(p==null?void 0:p.usedKey)||l,g=(p==null?void 0:p.exactUsedKey)||l,v=["[object Number]","[object Function]","[object RegExp]"],b=s.joinArrays!==void 0?s.joinArrays:this.options.joinArrays,y=!this.i18nFormat||this.i18nFormat.handleAsObject,N=s.count!==void 0&&!Ke(s.count),j=bu.hasDefaultValue(s),w=N?this.pluralResolver.getSuffix(f,s.count,s):"",_=s.ordinal&&N?this.pluralResolver.getSuffix(f,s.count,{ordinal:!1}):"",S=N&&!s.ordinal&&s.count===0,k=S&&s[`defaultValue${this.options.pluralSeparator}zero`]||s[`defaultValue${w}`]||s[`defaultValue${_}`]||s.defaultValue;let E=h;y&&!h&&j&&(E=k);const A=j1(E),P=Object.prototype.toString.apply(E);if(y&&E&&A&&v.indexOf(P)<0&&!(Ke(b)&&Array.isArray(E))){if(!s.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const L=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,E,{...s,ns:c}):`key '${l} (${this.language})' returned an object instead of string.`;return i?(p.res=L,p.usedParams=this.getUsedParamsDetails(s),p):L}if(o){const L=Array.isArray(E),R=L?[]:{},I=L?g:m;for(const D in E)if(Object.prototype.hasOwnProperty.call(E,D)){const V=`${I}${o}${D}`;j&&!h?R[D]=this.translate(V,{...s,defaultValue:j1(k)?k[D]:void 0,joinArrays:!1,ns:c}):R[D]=this.translate(V,{...s,joinArrays:!1,ns:c}),R[D]===V&&(R[D]=E[D])}h=R}}else if(y&&Ke(b)&&Array.isArray(h))h=h.join(b),h&&(h=this.extendTranslation(h,t,s,a));else{let L=!1,R=!1;!this.isValidLookup(h)&&j&&(L=!0,h=k),this.isValidLookup(h)||(R=!0,h=l);const D=(s.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&R?void 0:h,V=j&&k!==h&&this.options.updateMissing;if(R||L||V){if(this.logger.log(V?"updateKey":"missingKey",f,d,l,V?k:h),o){const K=this.resolve(l,{...s,keySeparator:!1});K&&K.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let F=[];const U=this.languageUtils.getFallbackCodes(this.options.fallbackLng,s.lng||this.language);if(this.options.saveMissingTo==="fallback"&&U&&U[0])for(let K=0;K<U.length;K++)F.push(U[K]);else this.options.saveMissingTo==="all"?F=this.languageUtils.toResolveHierarchy(s.lng||this.language):F.push(s.lng||this.language);const q=(K,T,O)=>{var z;const W=j&&O!==h?O:D;this.options.missingKeyHandler?this.options.missingKeyHandler(K,d,T,W,V,s):(z=this.backendConnector)!=null&&z.saveMissing&&this.backendConnector.saveMissing(K,d,T,W,V,s),this.emit("missingKey",K,d,T,h)};this.options.saveMissing&&(this.options.saveMissingPlurals&&N?F.forEach(K=>{const T=this.pluralResolver.getSuffixes(K,s);S&&s[`defaultValue${this.options.pluralSeparator}zero`]&&T.indexOf(`${this.options.pluralSeparator}zero`)<0&&T.push(`${this.options.pluralSeparator}zero`),T.forEach(O=>{q([K],l+O,s[`defaultValue${O}`]||k)})}):q(F,l,k))}h=this.extendTranslation(h,t,s,p,a),R&&h===l&&this.options.appendNamespaceToMissingKey&&(h=`${d}${u}${l}`),(R||L)&&this.options.parseMissingKeyHandler&&(h=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${d}${u}${l}`:l,L?h:void 0,s))}return i?(p.res=h,p.usedParams=this.getUsedParamsDetails(s),p):h}extendTranslation(t,r,a,s,i){var c,d;if((c=this.i18nFormat)!=null&&c.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...a},a.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!a.skipInterpolation){a.interpolation&&this.interpolator.init({...a,interpolation:{...this.options.interpolation,...a.interpolation}});const u=Ke(t)&&(((d=a==null?void 0:a.interpolation)==null?void 0:d.skipOnVariables)!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let f;if(u){const p=t.match(this.interpolator.nestingRegexp);f=p&&p.length}let x=a.replace&&!Ke(a.replace)?a.replace:a;if(this.options.interpolation.defaultVariables&&(x={...this.options.interpolation.defaultVariables,...x}),t=this.interpolator.interpolate(t,x,a.lng||this.language||s.usedLng,a),u){const p=t.match(this.interpolator.nestingRegexp),h=p&&p.length;f<h&&(a.nest=!1)}!a.lng&&s&&s.res&&(a.lng=this.language||s.usedLng),a.nest!==!1&&(t=this.interpolator.nest(t,(...p)=>(i==null?void 0:i[0])===p[0]&&!a.context?(this.logger.warn(`It seems you are nesting recursively key: ${p[0]} in key: ${r[0]}`),null):this.translate(...p,r),a)),a.interpolation&&this.interpolator.reset()}const o=a.postProcess||this.options.postProcess,l=Ke(o)?[o]:o;return t!=null&&(l!=null&&l.length)&&a.applyPostProcessor!==!1&&(t=AE.handle(l,t,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(a)},...a}:a,this)),t}resolve(t,r={}){let a,s,i,o,l;return Ke(t)&&(t=[t]),t.forEach(c=>{if(this.isValidLookup(a))return;const d=this.extractFromKey(c,r),u=d.key;s=u;let f=d.namespaces;this.options.fallbackNS&&(f=f.concat(this.options.fallbackNS));const x=r.count!==void 0&&!Ke(r.count),p=x&&!r.ordinal&&r.count===0,h=r.context!==void 0&&(Ke(r.context)||typeof r.context=="number")&&r.context!=="",m=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);f.forEach(g=>{var v,b;this.isValidLookup(a)||(l=g,!b1[`${m[0]}-${g}`]&&((v=this.utils)!=null&&v.hasLoadedNamespace)&&!((b=this.utils)!=null&&b.hasLoadedNamespace(l))&&(b1[`${m[0]}-${g}`]=!0,this.logger.warn(`key "${s}" for languages "${m.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),m.forEach(y=>{var w;if(this.isValidLookup(a))return;o=y;const N=[u];if((w=this.i18nFormat)!=null&&w.addLookupKeys)this.i18nFormat.addLookupKeys(N,u,y,g,r);else{let _;x&&(_=this.pluralResolver.getSuffix(y,r.count,r));const S=`${this.options.pluralSeparator}zero`,k=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(x&&(r.ordinal&&_.indexOf(k)===0&&N.push(u+_.replace(k,this.options.pluralSeparator)),N.push(u+_),p&&N.push(u+S)),h){const E=`${u}${this.options.contextSeparator||"_"}${r.context}`;N.push(E),x&&(r.ordinal&&_.indexOf(k)===0&&N.push(E+_.replace(k,this.options.pluralSeparator)),N.push(E+_),p&&N.push(E+S))}}let j;for(;j=N.pop();)this.isValidLookup(a)||(i=j,a=this.getResource(y,g,j,r))}))})}),{res:a,usedKey:s,exactUsedKey:i,usedLng:o,usedNS:l}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,r,a,s={}){var i;return(i=this.i18nFormat)!=null&&i.getResource?this.i18nFormat.getResource(t,r,a,s):this.resourceStore.getResource(t,r,a,s)}getUsedParamsDetails(t={}){const r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],a=t.replace&&!Ke(t.replace);let s=a?t.replace:t;if(a&&typeof t.count<"u"&&(s.count=t.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!a){s={...s};for(const i of r)delete s[i]}return s}static hasDefaultValue(t){const r="defaultValue";for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&r===a.substring(0,r.length)&&t[a]!==void 0)return!0;return!1}}class w1{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Nn.create("languageUtils")}getScriptPartFromCode(t){if(t=mc(t),!t||t.indexOf("-")<0)return null;const r=t.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(t){if(t=mc(t),!t||t.indexOf("-")<0)return t;const r=t.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(t){if(Ke(t)&&t.indexOf("-")>-1){let r;try{r=Intl.getCanonicalLocales(t)[0]}catch{}return r&&this.options.lowerCaseLng&&(r=r.toLowerCase()),r||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let r;return t.forEach(a=>{if(r)return;const s=this.formatLanguageCode(a);(!this.options.supportedLngs||this.isSupportedCode(s))&&(r=s)}),!r&&this.options.supportedLngs&&t.forEach(a=>{if(r)return;const s=this.getScriptPartFromCode(a);if(this.isSupportedCode(s))return r=s;const i=this.getLanguagePartFromCode(a);if(this.isSupportedCode(i))return r=i;r=this.options.supportedLngs.find(o=>{if(o===i)return o;if(!(o.indexOf("-")<0&&i.indexOf("-")<0)&&(o.indexOf("-")>0&&i.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===i||o.indexOf(i)===0&&i.length>1))return o})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(t,r){if(!t)return[];if(typeof t=="function"&&(t=t(r)),Ke(t)&&(t=[t]),Array.isArray(t))return t;if(!r)return t.default||[];let a=t[r];return a||(a=t[this.getScriptPartFromCode(r)]),a||(a=t[this.formatLanguageCode(r)]),a||(a=t[this.getLanguagePartFromCode(r)]),a||(a=t.default),a||[]}toResolveHierarchy(t,r){const a=this.getFallbackCodes((r===!1?[]:r)||this.options.fallbackLng||[],t),s=[],i=o=>{o&&(this.isSupportedCode(o)?s.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return Ke(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(t))):Ke(t)&&i(this.formatLanguageCode(t)),a.forEach(o=>{s.indexOf(o)<0&&i(this.formatLanguageCode(o))}),s}}const N1={zero:0,one:1,two:2,few:3,many:4,other:5},_1={select:e=>e===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class a8{constructor(t,r={}){this.languageUtils=t,this.options=r,this.logger=Nn.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,r){this.rules[t]=r}clearCache(){this.pluralRulesCache={}}getRule(t,r={}){const a=mc(t==="dev"?"en":t),s=r.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:a,type:s});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let o;try{o=new Intl.PluralRules(a,{type:s})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),_1;if(!t.match(/-|_/))return _1;const c=this.languageUtils.getLanguagePartFromCode(t);o=this.getRule(c,r)}return this.pluralRulesCache[i]=o,o}needsPlural(t,r={}){let a=this.getRule(t,r);return a||(a=this.getRule("dev",r)),(a==null?void 0:a.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(t,r,a={}){return this.getSuffixes(t,a).map(s=>`${r}${s}`)}getSuffixes(t,r={}){let a=this.getRule(t,r);return a||(a=this.getRule("dev",r)),a?a.resolvedOptions().pluralCategories.sort((s,i)=>N1[s]-N1[i]).map(s=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${s}`):[]}getSuffix(t,r,a={}){const s=this.getRule(t,a);return s?`${this.options.prepend}${a.ordinal?`ordinal${this.options.prepend}`:""}${s.select(r)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",r,a))}}const S1=(e,t,r,a=".",s=!0)=>{let i=KO(e,t,r);return!i&&s&&Ke(r)&&(i=vg(e,r,a),i===void 0&&(i=vg(t,r,a))),i},W0=e=>e.replace(/\$/g,"$$$$");class n8{constructor(t={}){var r;this.logger=Nn.create("interpolator"),this.options=t,this.format=((r=t==null?void 0:t.interpolation)==null?void 0:r.format)||(a=>a),this.init(t)}init(t={}){t.interpolation||(t.interpolation={escapeValue:!0});const{escape:r,escapeValue:a,useRawValueToEscape:s,prefix:i,prefixEscaped:o,suffix:l,suffixEscaped:c,formatSeparator:d,unescapeSuffix:u,unescapePrefix:f,nestingPrefix:x,nestingPrefixEscaped:p,nestingSuffix:h,nestingSuffixEscaped:m,nestingOptionsSeparator:g,maxReplaces:v,alwaysFormat:b}=t.interpolation;this.escape=r!==void 0?r:YO,this.escapeValue=a!==void 0?a:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=i?Vi(i):o||"{{",this.suffix=l?Vi(l):c||"}}",this.formatSeparator=d||",",this.unescapePrefix=u?"":f||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=x?Vi(x):p||Vi("$t("),this.nestingSuffix=h?Vi(h):m||Vi(")"),this.nestingOptionsSeparator=g||",",this.maxReplaces=v||1e3,this.alwaysFormat=b!==void 0?b:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(r,a)=>(r==null?void 0:r.source)===a?(r.lastIndex=0,r):new RegExp(a,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(t,r,a,s){var p;let i,o,l;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},d=h=>{if(h.indexOf(this.formatSeparator)<0){const b=S1(r,c,h,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(b,void 0,a,{...s,...r,interpolationkey:h}):b}const m=h.split(this.formatSeparator),g=m.shift().trim(),v=m.join(this.formatSeparator).trim();return this.format(S1(r,c,g,this.options.keySeparator,this.options.ignoreJSONStructure),v,a,{...s,...r,interpolationkey:g})};this.resetRegExp();const u=(s==null?void 0:s.missingInterpolationHandler)||this.options.missingInterpolationHandler,f=((p=s==null?void 0:s.interpolation)==null?void 0:p.skipOnVariables)!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:h=>W0(h)},{regex:this.regexp,safeValue:h=>this.escapeValue?W0(this.escape(h)):W0(h)}].forEach(h=>{for(l=0;i=h.regex.exec(t);){const m=i[1].trim();if(o=d(m),o===void 0)if(typeof u=="function"){const v=u(t,i,s);o=Ke(v)?v:""}else if(s&&Object.prototype.hasOwnProperty.call(s,m))o="";else if(f){o=i[0];continue}else this.logger.warn(`missed to pass in variable ${m} for interpolating ${t}`),o="";else!Ke(o)&&!this.useRawValueToEscape&&(o=x1(o));const g=h.safeValue(o);if(t=t.replace(i[0],g),f?(h.regex.lastIndex+=o.length,h.regex.lastIndex-=i[0].length):h.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),t}nest(t,r,a={}){let s,i,o;const l=(c,d)=>{const u=this.nestingOptionsSeparator;if(c.indexOf(u)<0)return c;const f=c.split(new RegExp(`${u}[ ]*{`));let x=`{${f[1]}`;c=f[0],x=this.interpolate(x,o);const p=x.match(/'/g),h=x.match(/"/g);(((p==null?void 0:p.length)??0)%2===0&&!h||h.length%2!==0)&&(x=x.replace(/'/g,'"'));try{o=JSON.parse(x),d&&(o={...d,...o})}catch(m){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,m),`${c}${u}${x}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,c};for(;s=this.nestingRegexp.exec(t);){let c=[];o={...a},o=o.replace&&!Ke(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const d=/{.*}/.test(s[1])?s[1].lastIndexOf("}")+1:s[1].indexOf(this.formatSeparator);if(d!==-1&&(c=s[1].slice(d).split(this.formatSeparator).map(u=>u.trim()).filter(Boolean),s[1]=s[1].slice(0,d)),i=r(l.call(this,s[1].trim(),o),o),i&&s[0]===t&&!Ke(i))return i;Ke(i)||(i=x1(i)),i||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${t}`),i=""),c.length&&(i=c.reduce((u,f)=>this.format(u,f,a.lng,{...a,interpolationkey:s[1].trim()}),i.trim())),t=t.replace(s[0],i),this.regexp.lastIndex=0}return t}}const s8=e=>{let t=e.toLowerCase().trim();const r={};if(e.indexOf("(")>-1){const a=e.split("(");t=a[0].toLowerCase().trim();const s=a[1].substring(0,a[1].length-1);t==="currency"&&s.indexOf(":")<0?r.currency||(r.currency=s.trim()):t==="relativetime"&&s.indexOf(":")<0?r.range||(r.range=s.trim()):s.split(";").forEach(o=>{if(o){const[l,...c]=o.split(":"),d=c.join(":").trim().replace(/^'+|'+$/g,""),u=l.trim();r[u]||(r[u]=d),d==="false"&&(r[u]=!1),d==="true"&&(r[u]=!0),isNaN(d)||(r[u]=parseInt(d,10))}})}return{formatName:t,formatOptions:r}},k1=e=>{const t={};return(r,a,s)=>{let i=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(i={...i,[s.interpolationkey]:void 0});const o=a+JSON.stringify(i);let l=t[o];return l||(l=e(mc(a),s),t[o]=l),l(r)}},i8=e=>(t,r,a)=>e(mc(r),a)(t);class o8{constructor(t={}){this.logger=Nn.create("formatter"),this.options=t,this.init(t)}init(t,r={interpolation:{}}){this.formatSeparator=r.interpolation.formatSeparator||",";const a=r.cacheInBuiltFormats?k1:i8;this.formats={number:a((s,i)=>{const o=new Intl.NumberFormat(s,{...i});return l=>o.format(l)}),currency:a((s,i)=>{const o=new Intl.NumberFormat(s,{...i,style:"currency"});return l=>o.format(l)}),datetime:a((s,i)=>{const o=new Intl.DateTimeFormat(s,{...i});return l=>o.format(l)}),relativetime:a((s,i)=>{const o=new Intl.RelativeTimeFormat(s,{...i});return l=>o.format(l,i.range||"day")}),list:a((s,i)=>{const o=new Intl.ListFormat(s,{...i});return l=>o.format(l)})}}add(t,r){this.formats[t.toLowerCase().trim()]=r}addCached(t,r){this.formats[t.toLowerCase().trim()]=k1(r)}format(t,r,a,s={}){const i=r.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(l=>l.indexOf(")")>-1)){const l=i.findIndex(c=>c.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,l)].join(this.formatSeparator)}return i.reduce((l,c)=>{var f;const{formatName:d,formatOptions:u}=s8(c);if(this.formats[d]){let x=l;try{const p=((f=s==null?void 0:s.formatParams)==null?void 0:f[s.interpolationkey])||{},h=p.locale||p.lng||s.locale||s.lng||a;x=this.formats[d](l,h,{...u,...s,...p})}catch(p){this.logger.warn(p)}return x}else this.logger.warn(`there was no format function for ${d}`);return l},t)}}const l8=(e,t)=>{e.pending[t]!==void 0&&(delete e.pending[t],e.pendingCount--)};class c8 extends Bf{constructor(t,r,a,s={}){var i,o;super(),this.backend=t,this.store=r,this.services=a,this.languageUtils=a.languageUtils,this.options=s,this.logger=Nn.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],(o=(i=this.backend)==null?void 0:i.init)==null||o.call(i,a,s.backend,s)}queueLoad(t,r,a,s){const i={},o={},l={},c={};return t.forEach(d=>{let u=!0;r.forEach(f=>{const x=`${d}|${f}`;!a.reload&&this.store.hasResourceBundle(d,f)?this.state[x]=2:this.state[x]<0||(this.state[x]===1?o[x]===void 0&&(o[x]=!0):(this.state[x]=1,u=!1,o[x]===void 0&&(o[x]=!0),i[x]===void 0&&(i[x]=!0),c[f]===void 0&&(c[f]=!0)))}),u||(l[d]=!0)}),(Object.keys(i).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(i),pending:Object.keys(o),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(c)}}loaded(t,r,a){const s=t.split("|"),i=s[0],o=s[1];r&&this.emit("failedLoading",i,o,r),!r&&a&&this.store.addResourceBundle(i,o,a,void 0,void 0,{skipCopy:!0}),this.state[t]=r?-1:2,r&&a&&(this.state[t]=0);const l={};this.queue.forEach(c=>{GO(c.loaded,[i],o),l8(c,t),r&&c.errors.push(r),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(d=>{l[d]||(l[d]={});const u=c.loaded[d];u.length&&u.forEach(f=>{l[d][f]===void 0&&(l[d][f]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(c=>!c.done)}read(t,r,a,s=0,i=this.retryTimeout,o){if(!t.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:r,fcName:a,tried:s,wait:i,callback:o});return}this.readingCalls++;const l=(d,u)=>{if(this.readingCalls--,this.waitingReads.length>0){const f=this.waitingReads.shift();this.read(f.lng,f.ns,f.fcName,f.tried,f.wait,f.callback)}if(d&&u&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,t,r,a,s+1,i*2,o)},i);return}o(d,u)},c=this.backend[a].bind(this.backend);if(c.length===2){try{const d=c(t,r);d&&typeof d.then=="function"?d.then(u=>l(null,u)).catch(l):l(null,d)}catch(d){l(d)}return}return c(t,r,l)}prepareLoading(t,r,a={},s){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();Ke(t)&&(t=this.languageUtils.toResolveHierarchy(t)),Ke(r)&&(r=[r]);const i=this.queueLoad(t,r,a,s);if(!i.toLoad.length)return i.pending.length||s(),null;i.toLoad.forEach(o=>{this.loadOne(o)})}load(t,r,a){this.prepareLoading(t,r,{},a)}reload(t,r,a){this.prepareLoading(t,r,{reload:!0},a)}loadOne(t,r=""){const a=t.split("|"),s=a[0],i=a[1];this.read(s,i,"read",void 0,void 0,(o,l)=>{o&&this.logger.warn(`${r}loading namespace ${i} for language ${s} failed`,o),!o&&l&&this.logger.log(`${r}loaded namespace ${i} for language ${s}`,l),this.loaded(t,o,l)})}saveMissing(t,r,a,s,i,o={},l=()=>{}){var c,d,u,f,x;if((d=(c=this.services)==null?void 0:c.utils)!=null&&d.hasLoadedNamespace&&!((f=(u=this.services)==null?void 0:u.utils)!=null&&f.hasLoadedNamespace(r))){this.logger.warn(`did not save key "${a}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(a==null||a==="")){if((x=this.backend)!=null&&x.create){const p={...o,isUpdate:i},h=this.backend.create.bind(this.backend);if(h.length<6)try{let m;h.length===5?m=h(t,r,a,s,p):m=h(t,r,a,s),m&&typeof m.then=="function"?m.then(g=>l(null,g)).catch(l):l(null,m)}catch(m){l(m)}else h(t,r,a,s,l,p)}!t||!t[0]||this.store.addResource(t[0],r,a,s)}}}const E1=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if(typeof e[1]=="object"&&(t=e[1]),Ke(e[1])&&(t.defaultValue=e[1]),Ke(e[2])&&(t.tDescription=e[2]),typeof e[2]=="object"||typeof e[3]=="object"){const r=e[3]||e[2];Object.keys(r).forEach(a=>{t[a]=r[a]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),T1=e=>{var t,r;return Ke(e.ns)&&(e.ns=[e.ns]),Ke(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),Ke(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),((r=(t=e.supportedLngs)==null?void 0:t.indexOf)==null?void 0:r.call(t,"cimode"))<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),typeof e.initImmediate=="boolean"&&(e.initAsync=e.initImmediate),e},Fd=()=>{},d8=e=>{Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(r=>{typeof e[r]=="function"&&(e[r]=e[r].bind(e))})};class xc extends Bf{constructor(t={},r){if(super(),this.options=T1(t),this.services={},this.logger=Nn,this.modules={external:[]},d8(this),r&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,r),this;setTimeout(()=>{this.init(t,r)},0)}}init(t={},r){this.isInitializing=!0,typeof t=="function"&&(r=t,t={}),t.defaultNS==null&&t.ns&&(Ke(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const a=E1();this.options={...a,...this.options,...T1(t)},this.options.interpolation={...a.interpolation,...this.options.interpolation},t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);const s=d=>d?typeof d=="function"?new d:d:null;if(!this.options.isClone){this.modules.logger?Nn.init(s(this.modules.logger),this.options):Nn.init(null,this.options);let d;this.modules.formatter?d=this.modules.formatter:d=o8;const u=new w1(this.options);this.store=new v1(this.options.resources,this.options);const f=this.services;f.logger=Nn,f.resourceStore=this.store,f.languageUtils=u,f.pluralResolver=new a8(u,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==a.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),d&&(!this.options.interpolation.format||this.options.interpolation.format===a.interpolation.format)&&(f.formatter=s(d),f.formatter.init&&f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new n8(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new c8(s(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",(p,...h)=>{this.emit(p,...h)}),this.modules.languageDetector&&(f.languageDetector=s(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=s(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new bu(this.services,this.options),this.translator.on("*",(p,...h)=>{this.emit(p,...h)}),this.modules.external.forEach(p=>{p.init&&p.init(this)})}if(this.format=this.options.interpolation.format,r||(r=Fd),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const d=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);d.length>0&&d[0]!=="dev"&&(this.options.lng=d[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(d=>{this[d]=(...u)=>this.store[d](...u)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(d=>{this[d]=(...u)=>(this.store[d](...u),this)});const l=Sl(),c=()=>{const d=(u,f)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(f),r(u,f)};if(this.languages&&!this.isInitialized)return d(null,this.t.bind(this));this.changeLanguage(this.options.lng,d)};return this.options.resources||!this.options.initAsync?c():setTimeout(c,0),l}loadResources(t,r=Fd){var i,o;let a=r;const s=Ke(t)?t:this.language;if(typeof t=="function"&&(a=t),!this.options.resources||this.options.partialBundledLanguages){if((s==null?void 0:s.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return a();const l=[],c=d=>{if(!d||d==="cimode")return;this.services.languageUtils.toResolveHierarchy(d).forEach(f=>{f!=="cimode"&&l.indexOf(f)<0&&l.push(f)})};s?c(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(u=>c(u)),(o=(i=this.options.preload)==null?void 0:i.forEach)==null||o.call(i,d=>c(d)),this.services.backendConnector.load(l,this.options.ns,d=>{!d&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),a(d)})}else a(null)}reloadResources(t,r,a){const s=Sl();return typeof t=="function"&&(a=t,t=void 0),typeof r=="function"&&(a=r,r=void 0),t||(t=this.languages),r||(r=this.options.ns),a||(a=Fd),this.services.backendConnector.reload(t,r,i=>{s.resolve(),a(i)}),s}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&AE.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1)){for(let r=0;r<this.languages.length;r++){const a=this.languages[r];if(!(["cimode","dev"].indexOf(a)>-1)&&this.store.hasLanguageSomeTranslations(a)){this.resolvedLanguage=a;break}}!this.resolvedLanguage&&this.languages.indexOf(t)<0&&this.store.hasLanguageSomeTranslations(t)&&(this.resolvedLanguage=t,this.languages.unshift(t))}}changeLanguage(t,r){this.isLanguageChangingTo=t;const a=Sl();this.emit("languageChanging",t);const s=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},i=(l,c)=>{c?this.isLanguageChangingTo===t&&(s(c),this.translator.changeLanguage(c),this.isLanguageChangingTo=void 0,this.emit("languageChanged",c),this.logger.log("languageChanged",c)):this.isLanguageChangingTo=void 0,a.resolve((...d)=>this.t(...d)),r&&r(l,(...d)=>this.t(...d))},o=l=>{var u,f;!t&&!l&&this.services.languageDetector&&(l=[]);const c=Ke(l)?l:l&&l[0],d=this.store.hasLanguageSomeTranslations(c)?c:this.services.languageUtils.getBestMatchFromCodes(Ke(l)?[l]:l);d&&(this.language||s(d),this.translator.language||this.translator.changeLanguage(d),(f=(u=this.services.languageDetector)==null?void 0:u.cacheUserLanguage)==null||f.call(u,d)),this.loadResources(d,x=>{i(x,d)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(t),a}getFixedT(t,r,a){const s=(i,o,...l)=>{let c;typeof o!="object"?c=this.options.overloadTranslationOptionHandler([i,o].concat(l)):c={...o},c.lng=c.lng||s.lng,c.lngs=c.lngs||s.lngs,c.ns=c.ns||s.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||a||s.keyPrefix);const d=this.options.keySeparator||".";let u;return c.keyPrefix&&Array.isArray(i)?u=i.map(f=>(typeof f=="function"&&(f=bg(f,{...this.options,...o})),`${c.keyPrefix}${d}${f}`)):(typeof i=="function"&&(i=bg(i,{...this.options,...o})),u=c.keyPrefix?`${c.keyPrefix}${d}${i}`:i),this.t(u,c)};return Ke(t)?s.lng=t:s.lngs=t,s.ns=r,s.keyPrefix=a,s}t(...t){var r;return(r=this.translator)==null?void 0:r.translate(...t)}exists(...t){var r;return(r=this.translator)==null?void 0:r.exists(...t)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t,r={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const a=r.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(a.toLowerCase()==="cimode")return!0;const o=(l,c)=>{const d=this.services.backendConnector.state[`${l}|${c}`];return d===-1||d===0||d===2};if(r.precheck){const l=r.precheck(this,o);if(l!==void 0)return l}return!!(this.hasResourceBundle(a,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(a,t)&&(!s||o(i,t)))}loadNamespaces(t,r){const a=Sl();return this.options.ns?(Ke(t)&&(t=[t]),t.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{a.resolve(),r&&r(s)}),a):(r&&r(),Promise.resolve())}loadLanguages(t,r){const a=Sl();Ke(t)&&(t=[t]);const s=this.options.preload||[],i=t.filter(o=>s.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return i.length?(this.options.preload=s.concat(i),this.loadResources(o=>{a.resolve(),r&&r(o)}),a):(r&&r(),Promise.resolve())}dir(t){var s,i;if(t||(t=this.resolvedLanguage||(((s=this.languages)==null?void 0:s.length)>0?this.languages[0]:this.language)),!t)return"rtl";try{const o=new Intl.Locale(t);if(o&&o.getTextInfo){const l=o.getTextInfo();if(l&&l.direction)return l.direction}}catch{}const r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],a=((i=this.services)==null?void 0:i.languageUtils)||new w1(E1());return t.toLowerCase().indexOf("-latn")>1?"ltr":r.indexOf(a.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(t={},r){return new xc(t,r)}cloneInstance(t={},r=Fd){const a=t.forkResourceStore;a&&delete t.forkResourceStore;const s={...this.options,...t,isClone:!0},i=new xc(s);if((t.debug!==void 0||t.prefix!==void 0)&&(i.logger=i.logger.clone(t)),["store","services","language"].forEach(l=>{i[l]=this[l]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},a){const l=Object.keys(this.store.data).reduce((c,d)=>(c[d]={...this.store.data[d]},c[d]=Object.keys(c[d]).reduce((u,f)=>(u[f]={...c[d][f]},u),c[d]),c),{});i.store=new v1(l,s),i.services.resourceStore=i.store}return i.translator=new bu(i.services,s),i.translator.on("*",(l,...c)=>{i.emit(l,...c)}),i.init(s,r),i.translator.options=s,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const wr=xc.createInstance();wr.createInstance=xc.createInstance;wr.createInstance;wr.dir;wr.init;wr.loadResources;wr.reloadResources;wr.use;wr.changeLanguage;wr.getFixedT;wr.t;wr.exists;wr.setDefaultNamespace;wr.hasLoadedNamespace;wr.loadNamespaces;wr.loadLanguages;function jg(e){"@babel/helpers - typeof";return jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jg(e)}function PE(){return typeof XMLHttpRequest=="function"||(typeof XMLHttpRequest>"u"?"undefined":jg(XMLHttpRequest))==="object"}function u8(e){return!!e&&typeof e.then=="function"}function f8(e){return u8(e)?e:Promise.resolve(e)}function h8(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Dd={exports:{}},Rd={exports:{}},A1;function m8(){return A1||(A1=1,(function(e,t){var r=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Hn<"u"&&Hn,a=(function(){function i(){this.fetch=!1,this.DOMException=r.DOMException}return i.prototype=r,new i})();(function(i){(function(o){var l=typeof i<"u"&&i||typeof self<"u"&&self||typeof l<"u"&&l,c={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function d(I){return I&&DataView.prototype.isPrototypeOf(I)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=ArrayBuffer.isView||function(I){return I&&u.indexOf(Object.prototype.toString.call(I))>-1};function x(I){if(typeof I!="string"&&(I=String(I)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(I)||I==="")throw new TypeError('Invalid character in header field name: "'+I+'"');return I.toLowerCase()}function p(I){return typeof I!="string"&&(I=String(I)),I}function h(I){var D={next:function(){var V=I.shift();return{done:V===void 0,value:V}}};return c.iterable&&(D[Symbol.iterator]=function(){return D}),D}function m(I){this.map={},I instanceof m?I.forEach(function(D,V){this.append(V,D)},this):Array.isArray(I)?I.forEach(function(D){this.append(D[0],D[1])},this):I&&Object.getOwnPropertyNames(I).forEach(function(D){this.append(D,I[D])},this)}m.prototype.append=function(I,D){I=x(I),D=p(D);var V=this.map[I];this.map[I]=V?V+", "+D:D},m.prototype.delete=function(I){delete this.map[x(I)]},m.prototype.get=function(I){return I=x(I),this.has(I)?this.map[I]:null},m.prototype.has=function(I){return this.map.hasOwnProperty(x(I))},m.prototype.set=function(I,D){this.map[x(I)]=p(D)},m.prototype.forEach=function(I,D){for(var V in this.map)this.map.hasOwnProperty(V)&&I.call(D,this.map[V],V,this)},m.prototype.keys=function(){var I=[];return this.forEach(function(D,V){I.push(V)}),h(I)},m.prototype.values=function(){var I=[];return this.forEach(function(D){I.push(D)}),h(I)},m.prototype.entries=function(){var I=[];return this.forEach(function(D,V){I.push([V,D])}),h(I)},c.iterable&&(m.prototype[Symbol.iterator]=m.prototype.entries);function g(I){if(I.bodyUsed)return Promise.reject(new TypeError("Already read"));I.bodyUsed=!0}function v(I){return new Promise(function(D,V){I.onload=function(){D(I.result)},I.onerror=function(){V(I.error)}})}function b(I){var D=new FileReader,V=v(D);return D.readAsArrayBuffer(I),V}function y(I){var D=new FileReader,V=v(D);return D.readAsText(I),V}function N(I){for(var D=new Uint8Array(I),V=new Array(D.length),F=0;F<D.length;F++)V[F]=String.fromCharCode(D[F]);return V.join("")}function j(I){if(I.slice)return I.slice(0);var D=new Uint8Array(I.byteLength);return D.set(new Uint8Array(I)),D.buffer}function w(){return this.bodyUsed=!1,this._initBody=function(I){this.bodyUsed=this.bodyUsed,this._bodyInit=I,I?typeof I=="string"?this._bodyText=I:c.blob&&Blob.prototype.isPrototypeOf(I)?this._bodyBlob=I:c.formData&&FormData.prototype.isPrototypeOf(I)?this._bodyFormData=I:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(I)?this._bodyText=I.toString():c.arrayBuffer&&c.blob&&d(I)?(this._bodyArrayBuffer=j(I.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(I)||f(I))?this._bodyArrayBuffer=j(I):this._bodyText=I=Object.prototype.toString.call(I):this._bodyText="",this.headers.get("content-type")||(typeof I=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(I)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var I=g(this);if(I)return I;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var I=g(this);return I||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else return this.blob().then(b)}),this.text=function(){var I=g(this);if(I)return I;if(this._bodyBlob)return y(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(N(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function S(I){var D=I.toUpperCase();return _.indexOf(D)>-1?D:I}function k(I,D){if(!(this instanceof k))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');D=D||{};var V=D.body;if(I instanceof k){if(I.bodyUsed)throw new TypeError("Already read");this.url=I.url,this.credentials=I.credentials,D.headers||(this.headers=new m(I.headers)),this.method=I.method,this.mode=I.mode,this.signal=I.signal,!V&&I._bodyInit!=null&&(V=I._bodyInit,I.bodyUsed=!0)}else this.url=String(I);if(this.credentials=D.credentials||this.credentials||"same-origin",(D.headers||!this.headers)&&(this.headers=new m(D.headers)),this.method=S(D.method||this.method||"GET"),this.mode=D.mode||this.mode||null,this.signal=D.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&V)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(V),(this.method==="GET"||this.method==="HEAD")&&(D.cache==="no-store"||D.cache==="no-cache")){var F=/([?&])_=[^&]*/;if(F.test(this.url))this.url=this.url.replace(F,"$1_="+new Date().getTime());else{var U=/\?/;this.url+=(U.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}k.prototype.clone=function(){return new k(this,{body:this._bodyInit})};function E(I){var D=new FormData;return I.trim().split("&").forEach(function(V){if(V){var F=V.split("="),U=F.shift().replace(/\+/g," "),q=F.join("=").replace(/\+/g," ");D.append(decodeURIComponent(U),decodeURIComponent(q))}}),D}function A(I){var D=new m,V=I.replace(/\r?\n[\t ]+/g," ");return V.split("\r").map(function(F){return F.indexOf(`
`)===0?F.substr(1,F.length):F}).forEach(function(F){var U=F.split(":"),q=U.shift().trim();if(q){var K=U.join(":").trim();D.append(q,K)}}),D}w.call(k.prototype);function P(I,D){if(!(this instanceof P))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');D||(D={}),this.type="default",this.status=D.status===void 0?200:D.status,this.ok=this.status>=200&&this.status<300,this.statusText=D.statusText===void 0?"":""+D.statusText,this.headers=new m(D.headers),this.url=D.url||"",this._initBody(I)}w.call(P.prototype),P.prototype.clone=function(){return new P(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new m(this.headers),url:this.url})},P.error=function(){var I=new P(null,{status:0,statusText:""});return I.type="error",I};var L=[301,302,303,307,308];P.redirect=function(I,D){if(L.indexOf(D)===-1)throw new RangeError("Invalid status code");return new P(null,{status:D,headers:{location:I}})},o.DOMException=l.DOMException;try{new o.DOMException}catch{o.DOMException=function(D,V){this.message=D,this.name=V;var F=Error(D);this.stack=F.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function R(I,D){return new Promise(function(V,F){var U=new k(I,D);if(U.signal&&U.signal.aborted)return F(new o.DOMException("Aborted","AbortError"));var q=new XMLHttpRequest;function K(){q.abort()}q.onload=function(){var O={status:q.status,statusText:q.statusText,headers:A(q.getAllResponseHeaders()||"")};O.url="responseURL"in q?q.responseURL:O.headers.get("X-Request-URL");var W="response"in q?q.response:q.responseText;setTimeout(function(){V(new P(W,O))},0)},q.onerror=function(){setTimeout(function(){F(new TypeError("Network request failed"))},0)},q.ontimeout=function(){setTimeout(function(){F(new TypeError("Network request failed"))},0)},q.onabort=function(){setTimeout(function(){F(new o.DOMException("Aborted","AbortError"))},0)};function T(O){try{return O===""&&l.location.href?l.location.href:O}catch{return O}}q.open(U.method,T(U.url),!0),U.credentials==="include"?q.withCredentials=!0:U.credentials==="omit"&&(q.withCredentials=!1),"responseType"in q&&(c.blob?q.responseType="blob":c.arrayBuffer&&U.headers.get("Content-Type")&&U.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(q.responseType="arraybuffer")),D&&typeof D.headers=="object"&&!(D.headers instanceof m)?Object.getOwnPropertyNames(D.headers).forEach(function(O){q.setRequestHeader(O,p(D.headers[O]))}):U.headers.forEach(function(O,W){q.setRequestHeader(W,O)}),U.signal&&(U.signal.addEventListener("abort",K),q.onreadystatechange=function(){q.readyState===4&&U.signal.removeEventListener("abort",K)}),q.send(typeof U._bodyInit>"u"?null:U._bodyInit)})}return R.polyfill=!0,l.fetch||(l.fetch=R,l.Headers=m,l.Request=k,l.Response=P),o.Headers=m,o.Request=k,o.Response=P,o.fetch=R,o})({})})(a),a.fetch.ponyfill=!0,delete a.fetch.polyfill;var s=r.fetch?r:a;t=s.fetch,t.default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,e.exports=t})(Rd,Rd.exports)),Rd.exports}var C1;function x8(){return C1||(C1=1,(function(e,t){var r=typeof fetch=="function"?fetch:void 0;if(typeof Hn<"u"&&Hn.fetch?r=Hn.fetch:typeof window<"u"&&window.fetch&&(r=window.fetch),typeof h8<"u"&&typeof window>"u"){var a=r||m8();a.default&&(a=a.default),t.default=a,e.exports=t.default}})(Dd,Dd.exports)),Dd.exports}var OE=x8();const IE=Ct(OE),P1=$P({__proto__:null,default:IE},[OE]);function O1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function I1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O1(Object(r),!0).forEach(function(a){p8(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function p8(e,t,r){return(t=g8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g8(e){var t=y8(e,"string");return bi(t)=="symbol"?t:t+""}function y8(e,t){if(bi(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(bi(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bi(e){"@babel/helpers - typeof";return bi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bi(e)}var Cs=typeof fetch=="function"?fetch:void 0;typeof global<"u"&&global.fetch?Cs=global.fetch:typeof window<"u"&&window.fetch&&(Cs=window.fetch);var pc;PE()&&(typeof global<"u"&&global.XMLHttpRequest?pc=global.XMLHttpRequest:typeof window<"u"&&window.XMLHttpRequest&&(pc=window.XMLHttpRequest));var ju;typeof ActiveXObject=="function"&&(typeof global<"u"&&global.ActiveXObject?ju=global.ActiveXObject:typeof window<"u"&&window.ActiveXObject&&(ju=window.ActiveXObject));!Cs&&P1&&!pc&&!ju&&(Cs=IE||P1);typeof Cs!="function"&&(Cs=void 0);var wg=function(t,r){if(r&&bi(r)==="object"){var a="";for(var s in r)a+="&"+encodeURIComponent(s)+"="+encodeURIComponent(r[s]);if(!a)return t;t=t+(t.indexOf("?")!==-1?"&":"?")+a.slice(1)}return t},F1=function(t,r,a,s){var i=function(c){if(!c.ok)return a(c.statusText||"Error",{status:c.status});c.text().then(function(d){a(null,{status:c.status,data:d})}).catch(a)};if(s){var o=s(t,r);if(o instanceof Promise){o.then(i).catch(a);return}}typeof fetch=="function"?fetch(t,r).then(i).catch(a):Cs(t,r).then(i).catch(a)},D1=!1,v8=function(t,r,a,s){t.queryStringParams&&(r=wg(r,t.queryStringParams));var i=I1({},typeof t.customHeaders=="function"?t.customHeaders():t.customHeaders);typeof window>"u"&&typeof global<"u"&&typeof global.process<"u"&&global.process.versions&&global.process.versions.node&&(i["User-Agent"]="i18next-http-backend (node/".concat(global.process.version,"; ").concat(global.process.platform," ").concat(global.process.arch,")")),a&&(i["Content-Type"]="application/json");var o=typeof t.requestOptions=="function"?t.requestOptions(a):t.requestOptions,l=I1({method:a?"POST":"GET",body:a?t.stringify(a):void 0,headers:i},D1?{}:o),c=typeof t.alternateFetch=="function"&&t.alternateFetch.length>=1?t.alternateFetch:void 0;try{F1(r,l,s,c)}catch(d){if(!o||Object.keys(o).length===0||!d.message||d.message.indexOf("not implemented")<0)return s(d);try{Object.keys(o).forEach(function(u){delete l[u]}),F1(r,l,s,c),D1=!0}catch(u){s(u)}}},b8=function(t,r,a,s){a&&bi(a)==="object"&&(a=wg("",a).slice(1)),t.queryStringParams&&(r=wg(r,t.queryStringParams));try{var i;pc?i=new pc:i=new ju("MSXML2.XMLHTTP.3.0"),i.open(a?"POST":"GET",r,1),t.crossDomain||i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.withCredentials=!!t.withCredentials,a&&i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.overrideMimeType&&i.overrideMimeType("application/json");var o=t.customHeaders;if(o=typeof o=="function"?o():o,o)for(var l in o)i.setRequestHeader(l,o[l]);i.onreadystatechange=function(){i.readyState>3&&s(i.status>=400?i.statusText:null,{status:i.status,data:i.responseText})},i.send(a)}catch(c){console&&console.log(c)}},j8=function(t,r,a,s){if(typeof a=="function"&&(s=a,a=void 0),s=s||function(){},Cs&&r.indexOf("file:")!==0)return v8(t,r,a,s);if(PE()||typeof ActiveXObject=="function")return b8(t,r,a,s);s(new Error("No fetch and no xhr implementation found!"))};function ko(e){"@babel/helpers - typeof";return ko=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ko(e)}function R1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function H0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R1(Object(r),!0).forEach(function(a){FE(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function w8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N8(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,DE(a.key),a)}}function _8(e,t,r){return t&&N8(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function FE(e,t,r){return(t=DE(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DE(e){var t=S8(e,"string");return ko(t)=="symbol"?t:t+""}function S8(e,t){if(ko(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(ko(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var k8=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(r){return JSON.parse(r)},stringify:JSON.stringify,parsePayload:function(r,a,s){return FE({},a,s||"")},parseLoadPayload:function(r,a){},request:j8,reloadInterval:typeof window<"u"?!1:3600*1e3,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},RE=(function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};w8(this,e),this.services=t,this.options=r,this.allOptions=a,this.type="backend",this.init(t,r,a)}return _8(e,[{key:"init",value:function(r){var a=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.services=r,this.options=H0(H0(H0({},k8()),this.options||{}),s),this.allOptions=i,this.services&&this.options.reloadInterval){var o=setInterval(function(){return a.reload()},this.options.reloadInterval);ko(o)==="object"&&typeof o.unref=="function"&&o.unref()}}},{key:"readMulti",value:function(r,a,s){this._readAny(r,r,a,a,s)}},{key:"read",value:function(r,a,s){this._readAny([r],r,[a],a,s)}},{key:"_readAny",value:function(r,a,s,i,o){var l=this,c=this.options.loadPath;typeof this.options.loadPath=="function"&&(c=this.options.loadPath(r,s)),c=f8(c),c.then(function(d){if(!d)return o(null,{});var u=l.services.interpolator.interpolate(d,{lng:r.join("+"),ns:s.join("+")});l.loadUrl(u,o,a,i)})}},{key:"loadUrl",value:function(r,a,s,i){var o=this,l=typeof s=="string"?[s]:s,c=typeof i=="string"?[i]:i,d=this.options.parseLoadPayload(l,c);this.options.request(this.options,r,d,function(u,f){if(f&&(f.status>=500&&f.status<600||!f.status))return a("failed loading "+r+"; status code: "+f.status,!0);if(f&&f.status>=400&&f.status<500)return a("failed loading "+r+"; status code: "+f.status,!1);if(!f&&u&&u.message){var x=u.message.toLowerCase(),p=["failed","fetch","network","load"].find(function(g){return x.indexOf(g)>-1});if(p)return a("failed loading "+r+": "+u.message,!0)}if(u)return a(u,!1);var h,m;try{typeof f.data=="string"?h=o.options.parse(f.data,s,i):h=f.data}catch{m="failed parsing "+r+" to json"}if(m)return a(m,!1);a(null,h)})}},{key:"create",value:function(r,a,s,i,o){var l=this;if(this.options.addPath){typeof r=="string"&&(r=[r]);var c=this.options.parsePayload(a,s,i),d=0,u=[],f=[];r.forEach(function(x){var p=l.options.addPath;typeof l.options.addPath=="function"&&(p=l.options.addPath(x,a));var h=l.services.interpolator.interpolate(p,{lng:x,ns:a});l.options.request(l.options,h,c,function(m,g){d+=1,u.push(m),f.push(g),d===r.length&&typeof o=="function"&&o(u,f)})})}}},{key:"reload",value:function(){var r=this,a=this.services,s=a.backendConnector,i=a.languageUtils,o=a.logger,l=s.language;if(!(l&&l.toLowerCase()==="cimode")){var c=[],d=function(f){var x=i.toResolveHierarchy(f);x.forEach(function(p){c.indexOf(p)<0&&c.push(p)})};d(l),this.allOptions.preload&&this.allOptions.preload.forEach(function(u){return d(u)}),c.forEach(function(u){r.allOptions.ns.forEach(function(f){s.read(u,f,"read",null,null,function(x,p){x&&o.warn("loading namespace ".concat(f," for language ").concat(u," failed"),x),!x&&p&&o.log("loaded namespace ".concat(f," for language ").concat(u),p),s.loaded("".concat(u,"|").concat(f),x,p)})})})}}}])})();RE.type="backend";const{slice:E8,forEach:T8}=[];function A8(e){return T8.call(E8.call(arguments,1),t=>{if(t)for(const r in t)e[r]===void 0&&(e[r]=t[r])}),e}function C8(e){return typeof e!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(r=>r.test(e))}const M1=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,P8=function(e,t){const a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},s=encodeURIComponent(t);let i=`${e}=${s}`;if(a.maxAge>0){const o=a.maxAge-0;if(Number.isNaN(o))throw new Error("maxAge should be a Number");i+=`; Max-Age=${Math.floor(o)}`}if(a.domain){if(!M1.test(a.domain))throw new TypeError("option domain is invalid");i+=`; Domain=${a.domain}`}if(a.path){if(!M1.test(a.path))throw new TypeError("option path is invalid");i+=`; Path=${a.path}`}if(a.expires){if(typeof a.expires.toUTCString!="function")throw new TypeError("option expires is invalid");i+=`; Expires=${a.expires.toUTCString()}`}if(a.httpOnly&&(i+="; HttpOnly"),a.secure&&(i+="; Secure"),a.sameSite)switch(typeof a.sameSite=="string"?a.sameSite.toLowerCase():a.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a.partitioned&&(i+="; Partitioned"),i},L1={create(e,t,r,a){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};r&&(s.expires=new Date,s.expires.setTime(s.expires.getTime()+r*60*1e3)),a&&(s.domain=a),document.cookie=P8(e,t,s)},read(e){const t=`${e}=`,r=document.cookie.split(";");for(let a=0;a<r.length;a++){let s=r[a];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(t)===0)return s.substring(t.length,s.length)}return null},remove(e,t){this.create(e,"",-1,t)}};var O8={name:"cookie",lookup(e){let{lookupCookie:t}=e;if(t&&typeof document<"u")return L1.read(t)||void 0},cacheUserLanguage(e,t){let{lookupCookie:r,cookieMinutes:a,cookieDomain:s,cookieOptions:i}=t;r&&typeof document<"u"&&L1.create(r,e,a,s,i)}},I8={name:"querystring",lookup(e){var a;let{lookupQuerystring:t}=e,r;if(typeof window<"u"){let{search:s}=window.location;!window.location.search&&((a=window.location.hash)==null?void 0:a.indexOf("?"))>-1&&(s=window.location.hash.substring(window.location.hash.indexOf("?")));const o=s.substring(1).split("&");for(let l=0;l<o.length;l++){const c=o[l].indexOf("=");c>0&&o[l].substring(0,c)===t&&(r=o[l].substring(c+1))}}return r}},F8={name:"hash",lookup(e){var s;let{lookupHash:t,lookupFromHashIndex:r}=e,a;if(typeof window<"u"){const{hash:i}=window.location;if(i&&i.length>2){const o=i.substring(1);if(t){const l=o.split("&");for(let c=0;c<l.length;c++){const d=l[c].indexOf("=");d>0&&l[c].substring(0,d)===t&&(a=l[c].substring(d+1))}}if(a)return a;if(!a&&r>-1){const l=i.match(/\/([a-zA-Z-]*)/g);return Array.isArray(l)?(s=l[typeof r=="number"?r:0])==null?void 0:s.replace("/",""):void 0}}}return a}};let Gi=null;const $1=()=>{if(Gi!==null)return Gi;try{if(Gi=typeof window<"u"&&window.localStorage!==null,!Gi)return!1;const e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch{Gi=!1}return Gi};var D8={name:"localStorage",lookup(e){let{lookupLocalStorage:t}=e;if(t&&$1())return window.localStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupLocalStorage:r}=t;r&&$1()&&window.localStorage.setItem(r,e)}};let Ki=null;const B1=()=>{if(Ki!==null)return Ki;try{if(Ki=typeof window<"u"&&window.sessionStorage!==null,!Ki)return!1;const e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch{Ki=!1}return Ki};var R8={name:"sessionStorage",lookup(e){let{lookupSessionStorage:t}=e;if(t&&B1())return window.sessionStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupSessionStorage:r}=t;r&&B1()&&window.sessionStorage.setItem(r,e)}},M8={name:"navigator",lookup(e){const t=[];if(typeof navigator<"u"){const{languages:r,userLanguage:a,language:s}=navigator;if(r)for(let i=0;i<r.length;i++)t.push(r[i]);a&&t.push(a),s&&t.push(s)}return t.length>0?t:void 0}},L8={name:"htmlTag",lookup(e){let{htmlTag:t}=e,r;const a=t||(typeof document<"u"?document.documentElement:null);return a&&typeof a.getAttribute=="function"&&(r=a.getAttribute("lang")),r}},$8={name:"path",lookup(e){var s;let{lookupFromPathIndex:t}=e;if(typeof window>"u")return;const r=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(r)?(s=r[typeof t=="number"?t:0])==null?void 0:s.replace("/",""):void 0}},B8={name:"subdomain",lookup(e){var s,i;let{lookupFromSubdomainIndex:t}=e;const r=typeof t=="number"?t+1:1,a=typeof window<"u"&&((i=(s=window.location)==null?void 0:s.hostname)==null?void 0:i.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(a)return a[r]}};let ME=!1;try{document.cookie,ME=!0}catch{}const LE=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];ME||LE.splice(1,1);const U8=()=>({order:LE,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:e=>e});class $E{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(t,r)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=t,this.options=A8(r,this.options||{},U8()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=s=>s.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=a,this.addDetector(O8),this.addDetector(I8),this.addDetector(D8),this.addDetector(R8),this.addDetector(M8),this.addDetector(L8),this.addDetector($8),this.addDetector(B8),this.addDetector(F8)}addDetector(t){return this.detectors[t.name]=t,this}detect(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,r=[];return t.forEach(a=>{if(this.detectors[a]){let s=this.detectors[a].lookup(this.options);s&&typeof s=="string"&&(s=[s]),s&&(r=r.concat(s))}}),r=r.filter(a=>a!=null&&!C8(a)).map(a=>this.options.convertDetectedLanguage(a)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?r:r.length>0?r[0]:null}cacheUserLanguage(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;r&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(t)>-1||r.forEach(a=>{this.detectors[a]&&this.detectors[a].cacheUserLanguage(t,this.options)}))}}$E.type="languageDetector";wr.use(RE).use($E).use(ZP).init({fallbackLng:"ar",supportedLngs:["ar","en"],debug:!1,interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"]},backend:{loadPath:"/locales/{{lng}}/{{ns}}.json"},ns:["translation"],defaultNS:"translation",react:{useSuspense:!1,wait:!0,bindI18n:"languageChanged loaded"}});const q8=()=>{const{t:e,i18n:t}=ft();Rs();const[r,a]=C.useState({fullName:"",email:"",phone:"",parentPhone:"",city:"",idNumber:"",school:"",grade:"",educationAdministration:"",hasParticipatedBefore:!1,previousProjects:"",interests:[],howDidYouHear:"",notes:""}),[s,i]=C.useState(!1),[o,l]=C.useState(null),[c,d]=C.useState(!1),u=(h,m)=>{a(g=>({...g,[h]:m}))},f=h=>{a(m=>{const g=[...m.interests];return g.includes(h)?{...m,interests:g.filter(v=>v!==h)}:{...m,interests:[...g,h]}})},x=()=>{if(!r.fullName||!r.email||!r.phone||!r.parentPhone||!r.city||!r.idNumber||!r.school||!r.grade||!r.educationAdministration||!r.howDidYouHear||r.interests.length===0)return l(e("summerProgram.enrollmentForm.requiredField")),!1;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email))return l(e("summerProgram.enrollmentForm.invalidEmail")),!1;const m=/^\d{9,15}$/;return!m.test(r.phone.replace(/\D/g,""))||!m.test(r.parentPhone.replace(/\D/g,""))?(l(e("summerProgram.enrollmentForm.invalidPhone")),!1):r.idNumber.length<5?(l(e("summerProgram.enrollmentForm.invalidIdNumber")),!1):!0},p=async h=>{if(h.preventDefault(),!!x()){i(!0),l(null);try{await PO(r),d(!0),a({fullName:"",email:"",phone:"",parentPhone:"",city:"",idNumber:"",school:"",grade:"",educationAdministration:"",hasParticipatedBefore:!1,previousProjects:"",interests:[],howDidYouHear:"",notes:""}),window.scrollTo(0,0)}catch(m){console.error("Error submitting summer program registration:",m),l(e("summerProgram.enrollmentForm.errorMessage"))}finally{i(!1)}}};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 py-12 px-4",children:n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"mb-8 text-center",children:[n.jsx(ke,{to:"/",className:"inline-block mb-6",children:n.jsx("img",{src:"/mashroui-logo.png",alt:e("appName"),className:"h-32 w-auto"})}),n.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-2",children:e("summerProgram.title")}),n.jsx("p",{className:"text-lg text-gray-600",children:e("summerProgram.subtitle")})]}),n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-xl p-8",children:c?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:n.jsx(Le,{className:"w-10 h-10 text-green-600"})}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:e("summerProgram.enrollmentForm.successMessage")}),n.jsx("p",{className:"text-gray-600 mb-8",children:"سيتم التواصل معك قريباً بخصوص البرنامج الصيفي. يمكنك العودة إلى الصفحة الرئيسية أو تسجيل الدخول إلى حسابك."}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[n.jsx(ke,{to:"/",className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"العودة للصفحة الرئيسية"}),n.jsx(ke,{to:"/login",className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"تسجيل الدخول"})]})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("summerProgram.enrollmentForm.title")}),n.jsx("p",{className:"text-gray-600",children:e("summerProgram.enrollmentForm.subtitle")})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>t.changeLanguage("ar"),className:`px-3 py-1 rounded-lg ${t.language==="ar"?"bg-blue-500 text-white":"bg-gray-100"}`,children:"العربية"}),n.jsx("button",{onClick:()=>t.changeLanguage("en"),className:`px-3 py-1 rounded-lg ${t.language==="en"?"bg-blue-500 text-white":"bg-gray-100"}`,children:"English"})]})]}),o&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:o})]}),n.jsxs("form",{onSubmit:p,className:"space-y-6",children:[n.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 mb-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-blue-800 mb-4 flex items-center gap-2",children:[n.jsx(Xt,{className:"w-5 h-5"}),t.language==="ar"?"المعلومات الشخصية":"Personal Information"]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.fullName")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Xt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:r.fullName,onChange:h=>u("fullName",h.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.fullNamePlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.email")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(ma,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:r.email,onChange:h=>u("email",h.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.emailPlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.phone")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Cr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"tel",value:r.phone,onChange:h=>u("phone",h.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.phonePlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.parentPhone")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Cr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"tel",value:r.parentPhone,onChange:h=>u("parentPhone",h.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.parentPhonePlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.city")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(fd,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:r.city,onChange:h=>u("city",h.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:e("summerProgram.enrollmentForm.cityPlaceholder")}),e("summerProgram.cities",{returnObjects:!0}).map(h=>n.jsx("option",{value:h,children:h},h))]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.idNumber")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(XC,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:r.idNumber,onChange:h=>u("idNumber",h.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.idNumberPlaceholder"),required:!0})]})]})]})]}),n.jsxs("div",{className:"bg-green-50 rounded-xl p-4 mb-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-green-800 mb-4 flex items-center gap-2",children:[n.jsx(fa,{className:"w-5 h-5"}),t.language==="ar"?"المعلومات التعليمية":"Educational Information"]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.school")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(fa,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:r.school,onChange:h=>u("school",h.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.schoolPlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.grade")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(vi,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:r.grade,onChange:h=>u("grade",h.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:e("summerProgram.enrollmentForm.gradePlaceholder")}),e("summerProgram.grades",{returnObjects:!0}).map(h=>n.jsx("option",{value:h,children:h},h))]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.educationAdministration")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(ks,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:r.educationAdministration,onChange:h=>u("educationAdministration",h.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:e("summerProgram.enrollmentForm.educationAdministrationPlaceholder")}),e("summerProgram.educationAdministrations",{returnObjects:!0}).map(h=>n.jsx("option",{value:h,children:h},h))]})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.hasParticipatedBefore")," *"]}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",checked:r.hasParticipatedBefore===!0,onChange:()=>u("hasParticipatedBefore",!0),className:"w-4 h-4 text-blue-600"}),n.jsx("span",{children:e("summerProgram.enrollmentForm.yes")})]}),n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",checked:r.hasParticipatedBefore===!1,onChange:()=>u("hasParticipatedBefore",!1),className:"w-4 h-4 text-blue-600"}),n.jsx("span",{children:e("summerProgram.enrollmentForm.no")})]})]})]}),r.hasParticipatedBefore&&n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.previousProjects")," *"]}),n.jsx("textarea",{value:r.previousProjects,onChange:h=>u("previousProjects",h.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.previousProjectsPlaceholder"),required:r.hasParticipatedBefore})]})]})]}),n.jsxs("div",{className:"bg-purple-50 rounded-xl p-4 mb-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-purple-800 mb-4 flex items-center gap-2",children:[n.jsx(bt,{className:"w-5 h-5"}),t.language==="ar"?"الاهتمامات والتفضيلات":"Interests and Preferences"]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.interests")," *"]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:e("summerProgram.interests",{returnObjects:!0}).map(h=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${r.interests.includes(h)?"bg-purple-100 border-purple-500 text-purple-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:r.interests.includes(h),onChange:()=>f(h),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:h})]},h))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.howDidYouHear")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(An,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:r.howDidYouHear,onChange:h=>u("howDidYouHear",h.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:e("summerProgram.enrollmentForm.howDidYouHearPlaceholder")}),e("summerProgram.hearAboutUs",{returnObjects:!0}).map(h=>n.jsx("option",{value:h,children:h},h))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.enrollmentForm.notes")}),n.jsxs("div",{className:"relative",children:[n.jsx(Hr,{className:"absolute right-3 top-3 w-5 h-5 text-gray-400"}),n.jsx("textarea",{value:r.notes,onChange:h=>u("notes",h.target.value),rows:4,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.notesPlaceholder")})]})]})]})]}),n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-6",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(An,{className:"w-6 h-6 text-yellow-600 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:t.language==="ar"?"معلومات مهمة":"Important Information"}),n.jsxs("ul",{className:"space-y-1 text-yellow-700 text-sm",children:[n.jsxs("li",{children:["• ",t.language==="ar"?"سيتم مراجعة طلبك والرد عليك في أقرب وقت ممكن.":"Your application will be reviewed and we will respond as soon as possible."]}),n.jsxs("li",{children:["• ",t.language==="ar"?"يرجى التأكد من صحة جميع المعلومات المقدمة.":"Please ensure all provided information is accurate."]}),n.jsxs("li",{children:["• ",t.language==="ar"?"سيتم التواصل معك عبر البريد الإلكتروني أو الهاتف المقدم.":"You will be contacted via the provided email or phone number."]}),n.jsxs("li",{children:["• ",t.language==="ar"?"البرنامج مخصص للطلاب في المرحلة المتوسطة والثانوية.":"The program is designed for middle and high school students."]})]})]})]})}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"submit",disabled:s,className:"px-8 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e("summerProgram.enrollmentForm.submitting")]}):n.jsxs(n.Fragment,{children:[n.jsx(Df,{className:"w-5 h-5"}),e("summerProgram.enrollmentForm.submit")]})})})]})]})}),n.jsxs("div",{className:"mt-8 text-center text-gray-600 text-sm",children:[n.jsxs("p",{children:["© 2025 ",e("appName")," - ",e("appTagline")]}),n.jsxs("div",{className:"mt-2 flex justify-center gap-4",children:[n.jsx(ke,{to:"/",className:"hover:text-blue-600 transition-colors",children:t.language==="ar"?"الصفحة الرئيسية":"Home"}),n.jsx(ke,{to:"/login",className:"hover:text-blue-600 transition-colors",children:t.language==="ar"?"تسجيل الدخول":"Login"}),n.jsx(ke,{to:"/register",className:"hover:text-blue-600 transition-colors",children:t.language==="ar"?"إنشاء حساب":"Register"})]})]})]})})},W8=()=>{const e=[{icon:dt,title:"تسجيل دخول موحد",description:"استخدم حساب Classera الخاص بك للوصول المباشر باستخدام LTI 1.3"},{icon:bt,title:"مزامنة البيانات",description:"تزامن تلقائي لبيانات الطلاب والمشرفين"},{icon:lr,title:"تتبع التقدم",description:"مشاركة درجات ونتائج المشاريع مع Classera"}];return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-white to-emerald-50 flex items-center justify-center p-4",children:n.jsx("div",{className:"max-w-6xl w-full",children:n.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 items-center",children:[n.jsxs(re.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6},className:"text-center lg:text-right",children:[n.jsxs("div",{className:"flex items-center justify-center lg:justify-start gap-4 mb-6",children:[n.jsx("img",{src:"/mashroui-logo.png",alt:"مشروعي",className:"h-16 w-auto"}),n.jsx("div",{className:"text-2xl font-bold text-gray-800",children:"×"}),n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-xl flex items-center justify-center",children:n.jsx(fa,{className:"w-8 h-8 text-green-600"})})]}),n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"تسجيل الدخول عبر Classera"}),n.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"استخدم حساب Classera الخاص بك للوصول المباشر إلى منصة مشروعي"}),n.jsx("div",{className:"space-y-4",children:e.map((t,r)=>n.jsxs(re.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,delay:r*.1},className:"flex items-center gap-4 p-4 bg-white rounded-xl shadow-sm",children:[n.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:n.jsx(t.icon,{className:"w-6 h-6 text-green-600"})}),n.jsxs("div",{className:"text-right",children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:t.title}),n.jsx("p",{className:"text-gray-600 text-sm",children:t.description})]})]},r))}),n.jsx("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(An,{className:"w-5 h-5 text-blue-500 mt-1 flex-shrink-0"}),n.jsxs("div",{className:"text-right",children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"معلومات الاتصال"}),n.jsxs("p",{className:"text-blue-700 text-sm",children:["نستخدم بروتوكول LTI 1.3 للمصادقة الآمنة مع Classera",n.jsx("br",{}),"اتصال مشفر ومصادق عليه بالكامل"]})]})]})})]}),n.jsxs(re.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-xl p-8",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(fa,{className:"w-10 h-10 text-green-600"})}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"مرحباً بك"}),n.jsx("p",{className:"text-gray-600",children:"سجل دخولك باستخدام حساب Classera"})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx(EE,{}),n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-0 flex items-center",children:n.jsx("div",{className:"w-full border-t border-gray-300"})}),n.jsx("div",{className:"relative flex justify-center text-sm",children:n.jsx("span",{className:"px-2 bg-white text-gray-500",children:"أو"})})]}),n.jsxs(ke,{to:"/login",className:"w-full border border-gray-300 text-gray-700 py-3 rounded-xl font-medium hover:bg-gray-50 transition-all duration-200 flex items-center justify-center gap-2",children:["تسجيل الدخول العادي",n.jsx(Cn,{className:"w-4 h-4"})]})]}),n.jsx("div",{className:"mt-6 text-center",children:n.jsxs("p",{className:"text-sm text-gray-500",children:["ليس لديك حساب؟"," ",n.jsx(ke,{to:"/register",className:"text-green-600 hover:text-green-800 font-medium",children:"إنشاء حساب جديد"})]})}),n.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-xl",children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(sa,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-green-800 text-sm",children:"اتصال آمن"}),n.jsx("p",{className:"text-green-700 text-xs",children:"يتم تشفير جميع البيانات المنقولة بين Classera ومنصة مشروعي"})]})]})})]})]})})})};function H8(){const[e]=gP(),t=Rs(),[r,a]=C.useState(null),[s,i]=C.useState(!0);return C.useEffect(()=>{(async()=>{try{const l=e.get("token"),c=e.get("role");if(!l)throw new Error("Missing authentication token");await RP(Sa,l),localStorage.setItem("ltiAuthenticated","true"),c&&localStorage.setItem("ltiRole",c),t(c==="teacher"||c==="admin"?"/home":"/projects",{replace:!0})}catch(l){console.error("LTI authentication error:",l),a(l instanceof Error?l.message:"Authentication failed"),i(!1)}})()},[e,t]),s?n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),n.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"Authenticating with Classera"}),n.jsx("p",{className:"text-gray-600",children:"Please wait while we sign you in..."})]})}):r?n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-red-50 to-pink-100",children:n.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl max-w-md",children:[n.jsx("div",{className:"text-red-600 text-5xl mb-4 text-center",children:"⚠️"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4 text-center",children:"Authentication Failed"}),n.jsx("p",{className:"text-gray-600 mb-6 text-center",children:r}),n.jsx("button",{onClick:()=>t("/login"),className:"w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition",children:"Return to Login"})]})}):null}const Ms=()=>{const[e,t]=C.useState([]),[r,a]=C.useState([]),[s,i]=C.useState(!0),[o,l]=C.useState(null),{user:c}=ut(),d=async()=>{try{i(!0),console.log("Fetching consultants...");const h=await sO();console.log("Consultants data received:",h),a(h||[])}catch(h){console.error("Error fetching consultants:",h),l(h instanceof Error?h.message:"حدث خطأ في تحميل المستشارين")}finally{i(!1)}},u=async()=>{if(c)try{i(!0),l(null);const h=Oe(he,"consultations");let m;if(c.role==="student")m=Me(h,De("student_id","==",c.id));else if(c.role==="teacher"||c.role==="consultant"){const b=Me(h,De("mentor_id","==",c.id)),y=await Ie(b),N=Me(h,De("mentor_id","==",null)),j=await Ie(N),w=[...y.docs,...j.docs];if(w.length===0){t([]),i(!1);return}const _=await Promise.all(w.map(async S=>{const k=S.data();let E=null;if(k.mentor_id)try{const A=st(he,"users",k.mentor_id),P=await Dt(A);P.exists()&&(E=P.data().name)}catch(A){console.error("Error fetching mentor data:",A)}return{id:S.id,mentor_id:k.mentor_id||null,mentor_name:E,student_id:k.student_id,project_id:k.project_id||null,topic:k.topic,description:k.description,type:k.type,status:k.status,method:k.method||"video",duration:k.duration||60,scheduledDate:k.scheduled_at?new Date(k.scheduled_at.toDate()).toISOString():void 0,preferredDate:k.preferred_date?new Date(k.preferred_date.toDate()).toISOString():void 0,completedAt:k.completed_at?new Date(k.completed_at.toDate()).toISOString():void 0,rating:k.rating,feedback:k.feedback,createdAt:k.created_at?new Date(k.created_at.toDate()).toISOString():new Date().toISOString()}}));t(_),i(!1);return}else m=h;const g=await Ie(m);if(g.empty){t([]),i(!1);return}const v=await Promise.all(g.docs.map(async b=>{const y=b.data();let N=null;if(y.mentor_id)try{const j=st(he,"users",y.mentor_id),w=await Dt(j);w.exists()&&(N=w.data().name)}catch(j){console.error("Error fetching mentor data:",j)}return{id:b.id,mentor_id:y.mentor_id||null,mentor_name:N,student_id:y.student_id,project_id:y.project_id||null,topic:y.topic,description:y.description,type:y.type,status:y.status,method:y.method||"video",duration:y.duration||60,scheduledDate:y.scheduled_at?new Date(y.scheduled_at.toDate()).toISOString():void 0,preferredDate:y.preferred_date?new Date(y.preferred_date.toDate()).toISOString():void 0,completedAt:y.completed_at?new Date(y.completed_at.toDate()).toISOString():void 0,rating:y.rating,feedback:y.feedback,createdAt:y.created_at?new Date(y.created_at.toDate()).toISOString():new Date().toISOString()}}));t(v)}catch(h){console.error("Error fetching consultations:",h),l(h instanceof Error?h.message:"حدث خطأ في تحميل الاستشارات")}finally{i(!1)}},f=async h=>{if(!c)throw new Error("يجب تسجيل الدخول أولاً");try{const m=Oe(he,"consultations"),g={student_id:c.id,mentor_id:h.mentor_id||null,project_id:h.project_id||null,topic:h.topic,description:h.description,type:h.type,status:h.status||"pending",method:h.method||"video",duration:h.duration||60,scheduled_at:h.scheduledDate?la.fromDate(new Date(h.scheduledDate)):null,preferred_date:h.preferredDate?la.fromDate(new Date(h.preferredDate)):null,created_at:Ve()},v=await Fa(m,g);return await u(),{id:v.id,...g}}catch(m){throw console.error("Error creating consultation:",m),m}},x=async(h,m)=>{try{const g=st(he,"consultations",h),v={};m.status&&(v.status=m.status),m.mentor_id&&(v.mentor_id=m.mentor_id),m.scheduledDate&&(v.scheduled_at=la.fromDate(new Date(m.scheduledDate))),m.completedAt&&(v.completed_at=la.fromDate(new Date(m.completedAt))),m.rating!==void 0&&(v.rating=m.rating),m.feedback&&(v.feedback=m.feedback),v.updated_at=Ve(),await sr(g,v),await u()}catch(g){throw console.error("Error updating consultation:",g),g}},p=async(h,m)=>{if(!c)throw new Error("يجب تسجيل الدخول أولاً");try{const g=st(he,"consultations",h),v={mentor_id:c.id,status:"scheduled",updated_at:Ve()};m&&(v.scheduled_at=la.fromDate(new Date(m))),await sr(g,v),await u()}catch(g){throw console.error("Error accepting consultation:",g),g}};return C.useEffect(()=>{c&&(u(),d())},[c]),{consultations:e,consultants:r,loading:s,error:o,fetchConsultations:u,fetchConsultants:d,createConsultation:f,updateConsultation:x,acceptConsultation:p}},Ii=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),{user:o}=ut(),l=async()=>{if(!o){console.log("No user found, skipping project fetch");return}try{a(!0),i(null),console.log("Fetching projects for user:",{id:o.id,role:o.role,school_id:o.school_id});let x=[];if(o.role==="teacher"){console.log("Fetching projects for teacher with ID:",o.id);const h=await oO(o.id);console.log("Teacher assigned projects fetched:",h.length);const m=Me(Oe(he,"projects"),De("school_id","==",o.school_id),De("status","==","draft")),v=(await Ie(m)).docs.map(y=>{const N=y.data();return{id:y.id,...N,due_date:N.due_date?N.due_date.toDate().toISOString():null,created_at:N.created_at?N.created_at.toDate().toISOString():new Date().toISOString(),updated_at:N.updated_at?N.updated_at.toDate().toISOString():new Date().toISOString()}});console.log("School draft projects fetched:",v.length);const b=new Map;h.forEach(y=>{b.set(y.id,y)}),v.forEach(y=>{b.has(y.id)||b.set(y.id,y)}),x=Array.from(b.values()),console.log("Combined unique projects:",x.length)}else o.role==="student"?(console.log("Fetching projects for student with ID:",o.id),x=await cO(o.id),console.log("Student projects fetched:",x.length)):o.role==="school"?(console.log("Fetching projects for school user with Firebase UID:",o.id),x=await lO(o.id),console.log("School projects fetched:",x.length)):o.role==="admin"&&(console.log("Fetching all projects for admin user"),x=await iO(),console.log("All projects fetched:",x.length));console.log("Raw projects data:",x);const p=await Promise.all(x.map(async h=>{console.log("Processing project:",h.id,"with school_id:",h.school_id);let m="مدرسة غير معروفة",g=!1,v=0,b=0,y=0;try{const N=Me(Oe(he,"project_students"),De("project_id","==",h.id)),j=await Ie(N);if(v=j.size,console.log("Student count for project",h.id,":",v),!g&&!j.empty){const _=j.docs[0].data().student_id,S=st(he,"users",_),k=await Dt(S);if(k.exists()){const A=k.data().school_id;if(A){const P=st(he,"users",A),L=await Dt(P);if(L.exists()){const R=L.data();R.role==="school"&&(m=R.name||"مدرسة غير معروفة",g=!0)}}}}}catch(N){console.error("Error fetching student count for project:",h.id,N)}try{const N=Me(Oe(he,"project_tasks"),De("project_id","==",h.id)),j=await Ie(N);b=j.size,y=j.docs.filter(w=>w.data().status==="completed").length,console.log("Task counts for project",h.id,"- Total:",b,"Completed:",y)}catch(N){console.error("Error fetching task counts for project:",h.id,N)}if(!g&&h.school_id)try{console.log("Fetching school for project:",h.id,"school_id:",h.school_id);const N=st(he,"users",h.school_id),j=await Dt(N);if(console.log("School document exists:",j.exists()),j.exists()){const w=j.data();console.log("School data:",w),m=w.name||"مدرسة غير معروفة",console.log("Assigned school_name:",m),g=!0}else console.log("School document does not exist for school_id:",h.school_id)}catch(N){console.error("Error fetching school name for project:",h.id,N)}return g||console.log("Returning project with default school_name for project:",h.id),{...h,school_name:m,studentCount:v,totalTasks:b,completedTasks:y}}));console.log("Final projects with school names and counts:",p.map(h=>({id:h.id,title:h.title,school_id:h.school_id,school_name:h.school_name,studentCount:h.studentCount,totalTasks:h.totalTasks,completedTasks:h.completedTasks}))),t(p)}catch(x){console.error("Error fetching projects:",x),i(x instanceof Error?x.message:"حدث خطأ في تحميل المشاريع")}finally{a(!1)}},c=async x=>{if(!o)throw new Error("يجب تسجيل الدخول أولاً");try{const p=o.role==="school"?o.id:o.school_id,h=await dO({...x,teacher_id:o.role==="teacher"?o.id:null,school_id:p,progress:0});if(x.selectedStudentIds&&x.selectedStudentIds.length>0)for(let m=0;m<x.selectedStudentIds.length;m++){const g=x.selectedStudentIds[m];await yg({project_id:h.id,student_id:g,role:m===0?"leader":"member"})}return await l(),h}catch(p){throw p}},d=async(x,p)=>{try{if((o==null?void 0:o.role)==="teacher"&&p.status==="active"&&(p.teacher_id=o.id),await f1(x,p),p.selectedStudentIds){const h=await $f(x);for(const m of h)p.selectedStudentIds.includes(m.student_id)||await _E(x,m.student_id);for(let m=0;m<p.selectedStudentIds.length;m++){const g=p.selectedStudentIds[m];h.find(b=>b.student_id===g)||await yg({project_id:x,student_id:g,role:m===0?"leader":"member"})}}await l()}catch(h){throw h}},u=async x=>{try{await f1(x,{status:"archived"}),await l()}catch(p){throw p}},f=async x=>{try{await fO(x),await l()}catch(p){throw p}};return C.useEffect(()=>{o&&l()},[o]),{projects:e,loading:r,error:s,fetchProjects:l,createProject:c,updateProject:d,archiveProject:u,deleteProject:f}},z8=({onClose:e,onSubmit:t})=>{const{user:r}=ut(),{projects:a}=Ii(),[s,i]=C.useState({topic:"",description:"",type:"technical",method:"video",duration:60,project_id:"",preferredDate:""}),[o,l]=C.useState(!1),[c,d]=C.useState(null),u=[{id:"technical",name:"استشارة تقنية",description:"استشارة في مجال التقنية والبرمجة"},{id:"academic",name:"استشارة أكاديمية",description:"استشارة في المجالات الأكاديمية والتعليمية"},{id:"career",name:"استشارة مهنية",description:"استشارة في التطوير المهني والوظيفي"},{id:"project",name:"استشارة مشروع",description:"استشارة متعلقة بمشروع محدد"}],f=[{id:"video",name:"مكالمة فيديو",icon:ar},{id:"phone",name:"مكالمة صوتية",icon:Cr},{id:"chat",name:"محادثة نصية",icon:Hr}],x=[{value:30,label:"30 دقيقة"},{value:60,label:"ساعة واحدة"},{value:90,label:"ساعة ونصف"},{value:120,label:"ساعتان"}],p=(g,v)=>{i(b=>({...b,[g]:v}))},h=async g=>{if(g.preventDefault(),!s.topic||!s.description){d("يرجى ملء جميع الحقول المطلوبة");return}l(!0),d(null);try{await t(s)}catch(v){console.error("Error submitting consultation request:",v),d(v instanceof Error?v.message:"حدث خطأ في إرسال طلب الاستشارة")}finally{l(!1)}},m=a.filter(g=>g.status==="active");return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(rr,{className:"w-6 h-6 text-blue-600"}),"طلب استشارة جديدة"]}),n.jsx("button",{onClick:e,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),c&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:c})]}),n.jsxs("form",{onSubmit:h,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان الاستشارة *"}),n.jsx("input",{type:"text",value:s.topic,onChange:g=>p("topic",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل عنوان الاستشارة",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف الاستشارة *"}),n.jsx("textarea",{value:s.description,onChange:g=>p("description",g.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اشرح تفاصيل الاستشارة واحتياجاتك بوضوح",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الاستشارة *"}),n.jsx("div",{className:"grid grid-cols-2 gap-3",children:u.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.type===g.id?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"type",value:g.id,checked:s.type===g.id,onChange:()=>p("type",g.id),className:"sr-only"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:g.name}),n.jsx("p",{className:"text-xs text-gray-500",children:g.description})]})]},g.id))})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"طريقة الاستشارة *"}),n.jsx("div",{className:"space-y-2",children:f.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.method===g.id?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"method",value:g.id,checked:s.method===g.id,onChange:()=>p("method",g.id),className:"sr-only"}),n.jsx(g.icon,{className:"w-5 h-5"}),n.jsx("span",{children:g.name})]},g.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مدة الاستشارة *"}),n.jsx("div",{className:"space-y-2",children:x.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.duration===g.value?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"duration",value:g.value,checked:s.duration===g.value,onChange:()=>p("duration",g.value),className:"sr-only"}),n.jsx(xt,{className:"w-5 h-5"}),n.jsx("span",{children:g.label})]},g.value))})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المشروع المرتبط (اختياري)"}),n.jsxs("select",{value:s.project_id,onChange:g=>p("project_id",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"بدون مشروع"}),m.map(g=>n.jsx("option",{value:g.id,children:g.title},g.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التاريخ المفضل (اختياري)"}),n.jsxs("div",{className:"relative",children:[n.jsx(ot,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"datetime-local",value:s.preferredDate,onChange:g=>p("preferredDate",g.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx("div",{className:"text-blue-500 mt-1",children:n.jsx(An,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"معلومات مهمة"}),n.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[n.jsx("li",{children:"• سيتم مراجعة طلبك وتعيين مشرف مناسب في أقرب وقت"}),n.jsx("li",{children:"• سيتم إرسال رابط الاستشارة قبل الموعد بـ 15 دقيقة"}),n.jsx("li",{children:"• يمكنك إلغاء الاستشارة قبل 24 ساعة من الموعد"})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:e,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:o,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الإرسال..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Le,{className:"w-5 h-5"}),"إرسال الطلب"]})})]})]})]})})},V8=({consultation:e,onClose:t,onUpdate:r})=>{const[a,s]=C.useState(e.rating||0),[i,o]=C.useState(e.feedback||""),[l,c]=C.useState(!1),[d,u]=C.useState(null),[f,x]=C.useState(!1),p=y=>{switch(y){case"video":return n.jsx(ar,{className:"w-5 h-5"});case"phone":return n.jsx(Cr,{className:"w-5 h-5"});case"chat":return n.jsx(Hr,{className:"w-5 h-5"});default:return n.jsx(rr,{className:"w-5 h-5"})}},h=y=>{switch(y){case"video":return"مكالمة فيديو";case"phone":return"مكالمة صوتية";case"chat":return"محادثة نصية";case"screen_share":return"مشاركة الشاشة";default:return y}},m=y=>{switch(y){case"pending":return"bg-yellow-100 text-yellow-800";case"scheduled":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},g=y=>{switch(y){case"pending":return"في الانتظار";case"scheduled":return"مجدولة";case"completed":return"مكتملة";case"cancelled":return"ملغية";default:return y}},v=async()=>{if(a===0){u("يرجى اختيار تقييم");return}c(!0),u(null);try{await r(e.id,{rating:a,feedback:i,status:"completed"})}catch(y){console.error("Error submitting rating:",y),u(y instanceof Error?y.message:"حدث خطأ في إرسال التقييم")}finally{c(!1)}},b=async()=>{if(confirm("هل أنت متأكد من إلغاء هذه الاستشارة؟")){c(!0);try{await r(e.id,{status:"cancelled"})}catch(y){console.error("Error cancelling consultation:",y),u(y instanceof Error?y.message:"حدث خطأ في إلغاء الاستشارة")}finally{c(!1)}}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(rr,{className:"w-6 h-6 text-blue-600"}),"تفاصيل الاستشارة"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),d&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(AlertTriangle,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:d})]}),n.jsx("div",{className:"flex items-center gap-4 p-4 bg-blue-50 rounded-xl mb-6",children:n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:e.mentor_name||"مشرف غير معين"}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${m(e.status)}`,children:g(e.status)})]}),n.jsx("p",{className:"text-gray-600 text-sm",children:"مشرف"})]})}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx(rr,{className:"w-5 h-5 text-blue-600"}),"موضوع الاستشارة"]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("h5",{className:"font-semibold text-gray-800 mb-2",children:e.topic}),n.jsx("p",{className:"text-gray-700",children:e.description})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"تفاصيل الاستشارة"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[p(e.method),n.jsxs("span",{children:["طريقة الاستشارة: ",h(e.method)]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(xt,{className:"w-5 h-5"}),n.jsxs("span",{children:["المدة: ",e.duration," دقيقة"]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(ot,{className:"w-5 h-5"}),n.jsxs("span",{children:["تاريخ الإنشاء: ",Ye(e.createdAt)]})]})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"معلومات الموعد"}),n.jsxs("div",{className:"space-y-3",children:[e.scheduledDate?n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(ot,{className:"w-5 h-5 text-blue-600"}),n.jsxs("span",{children:["موعد الاستشارة: ",Ye(e.scheduledDate,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",calendar:"gregory"})]})]}):e.preferredDate?n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(ot,{className:"w-5 h-5 text-yellow-600"}),n.jsxs("span",{children:["الموعد المفضل: ",Ye(e.preferredDate,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",calendar:"gregory"})]})]}):n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(ot,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{children:"لم يتم تحديد موعد بعد"})]}),e.status==="scheduled"&&n.jsx("div",{className:"mt-2",children:n.jsxs("a",{href:"https://meet.google.com/new",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[n.jsx(ar,{className:"w-4 h-4"}),"انضمام للاستشارة"]})})]})]})]}),e.status==="completed"&&e.rating?n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"تقييمك للاستشارة"}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[[1,2,3,4,5].map(y=>n.jsx(lt,{className:`w-6 h-6 ${y<=e.rating?"text-yellow-400 fill-current":"text-gray-300"}`},y)),n.jsxs("span",{className:"text-gray-700 mr-2",children:[e.rating,"/5"]})]}),e.feedback&&n.jsx("p",{className:"text-gray-700",children:e.feedback})]})]}):e.status==="completed"&&!f?n.jsx("div",{className:"text-center py-4",children:n.jsx("button",{onClick:()=>x(!0),className:"px-6 py-3 bg-yellow-500 text-white rounded-xl hover:bg-yellow-600 transition-colors",children:"تقييم الاستشارة"})}):f&&n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"تقييم الاستشارة"}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("div",{className:"flex items-center justify-center gap-2 mb-4",children:[1,2,3,4,5].map(y=>n.jsx("button",{type:"button",onClick:()=>s(y),className:"focus:outline-none",children:n.jsx(lt,{className:`w-8 h-8 ${y<=a?"text-yellow-400 fill-current":"text-gray-300"}`})},y))}),n.jsx("textarea",{value:i,onChange:y=>o(y.target.value),placeholder:"اكتب تعليقك حول الاستشارة...",rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),n.jsx("div",{className:"flex justify-end mt-3",children:n.jsx("button",{type:"button",onClick:v,disabled:l,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"جاري الإرسال...":"إرسال التقييم"})})]})]}),n.jsxs("div",{className:"flex justify-between pt-4 border-t border-gray-200",children:[n.jsx("div",{children:(e.status==="pending"||e.status==="scheduled")&&n.jsx("button",{type:"button",onClick:b,disabled:l,className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"جاري الإلغاء...":"إلغاء الاستشارة"})}),n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 bg-gray-200 text-gray-800 rounded-xl hover:bg-gray-300 transition-colors",children:"إغلاق"})]})]})]})})},BE=({consultant:e,onClose:t,onSubmit:r})=>{const{t:a}=ft(),[s,i]=C.useState({topic:"",description:"",type:"technical",method:"video",duration:60,scheduledDate:""}),[o,l]=C.useState(!1),[c,d]=C.useState(null),u=[{id:"technical",name:"استشارة تقنية"},{id:"academic",name:"استشارة أكاديمية"},{id:"career",name:"استشارة مهنية"},{id:"project",name:"استشارة مشروع"}],f=[{id:"video",name:"مكالمة فيديو",icon:ar},{id:"phone",name:"مكالمة صوتية",icon:Cr},{id:"chat",name:"محادثة نصية",icon:Hr}],x=[{value:30,label:"30 دقيقة",price:e.hourlyRate/2},{value:60,label:"ساعة واحدة",price:e.hourlyRate},{value:90,label:"ساعة ونصف",price:e.hourlyRate*1.5},{value:120,label:"ساعتان",price:e.hourlyRate*2}],h=(()=>{const y=[],N=new Date;for(let j=1;j<=7;j++){const w=new Date(N);w.setDate(w.getDate()+j);const _=new Date(w);_.setHours(10,0,0,0),y.push(_);const S=new Date(w);S.setHours(14,0,0,0),y.push(S);const k=new Date(w);k.setHours(18,0,0,0),y.push(k)}return y})(),m=(y,N)=>{i(j=>({...j,[y]:N}))},g=async y=>{if(y.preventDefault(),!s.topic||!s.description||!s.scheduledDate){d("يرجى ملء جميع الحقول المطلوبة");return}l(!0),d(null);try{await r({...s,mentor_id:e.id,status:"scheduled"})}catch(N){console.error("Error booking consultation:",N),d(N instanceof Error?N.message:"حدث خطأ في حجز الاستشارة")}finally{l(!1)}},v=x.find(y=>y.value===s.duration),b=v?v.price:e.hourlyRate;return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(ot,{className:"w-6 h-6 text-indigo-600"}),"حجز استشارة مع ",e.name]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),c&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:c})]}),n.jsxs("div",{className:"flex items-center gap-4 p-4 bg-indigo-50 rounded-xl mb-6",children:[n.jsx("img",{src:e.avatar,alt:e.name,className:"w-16 h-16 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:e.name}),n.jsx("p",{className:"text-gray-600",children:e.title}),n.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[n.jsx(lt,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsxs("span",{className:"text-sm",children:[e.rating," (",e.reviews," تقييم)"]})]})]})]}),n.jsxs("form",{onSubmit:g,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان الاستشارة *"}),n.jsx("input",{type:"text",value:s.topic,onChange:y=>m("topic",y.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"أدخل عنوان الاستشارة",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف الاستشارة *"}),n.jsx("textarea",{value:s.description,onChange:y=>m("description",y.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"اشرح تفاصيل الاستشارة واحتياجاتك بوضوح",required:!0})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الاستشارة *"}),n.jsx("select",{value:s.type,onChange:y=>m("type",y.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0,children:u.map(y=>n.jsx("option",{value:y.id,children:y.name},y.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"طريقة الاستشارة *"}),n.jsx("div",{className:"grid grid-cols-3 gap-2",children:f.map(y=>n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${s.method===y.id?"bg-indigo-50 border-indigo-500 text-indigo-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"method",value:y.id,checked:s.method===y.id,onChange:()=>m("method",y.id),className:"sr-only"}),n.jsx(y.icon,{className:"w-5 h-5"}),n.jsx("span",{children:y.name})]},y.id))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مدة الاستشارة *"}),n.jsx("div",{className:"grid grid-cols-4 gap-2",children:x.map(y=>n.jsxs("label",{className:`flex flex-col items-center p-3 border rounded-xl cursor-pointer transition-colors ${s.duration===y.value?"bg-indigo-50 border-indigo-500 text-indigo-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"duration",value:y.value,checked:s.duration===y.value,onChange:()=>m("duration",y.value),className:"sr-only"}),n.jsx(xt,{className:"w-5 h-5 mb-1"}),n.jsx("span",{children:y.label}),n.jsxs("span",{className:"text-xs mt-1",children:[y.price," ر.س"]})]},y.value))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اختر موعد الاستشارة *"}),n.jsx("div",{className:"grid grid-cols-3 gap-2 max-h-48 overflow-y-auto p-2",children:h.map((y,N)=>n.jsxs("label",{className:`flex flex-col items-center p-3 border rounded-xl cursor-pointer transition-colors ${s.scheduledDate===y.toISOString()?"bg-indigo-50 border-indigo-500 text-indigo-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"scheduledDate",value:y.toISOString(),checked:s.scheduledDate===y.toISOString(),onChange:()=>m("scheduledDate",y.toISOString()),className:"sr-only"}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"font-medium",children:y.toLocaleDateString("ar-SA",{weekday:"short",day:"numeric",month:"short"})}),n.jsx("div",{className:"text-sm",children:y.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"})})]})]},N))})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"ملخص الحجز"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:["سعر الاستشارة (",v==null?void 0:v.label,")"]}),n.jsxs("span",{children:[b," ر.س"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"ضريبة القيمة المضافة (15%)"}),n.jsxs("span",{children:[(b*.15).toFixed(2)," ر.س"]})]}),n.jsx("div",{className:"border-t border-gray-200 pt-2 mt-2",children:n.jsxs("div",{className:"flex justify-between font-bold",children:[n.jsx("span",{children:"المجموع"}),n.jsxs("span",{children:[(b*1.15).toFixed(2)," ر.س"]})]})})]})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx("div",{className:"text-blue-500 mt-1",children:n.jsx(An,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"معلومات مهمة"}),n.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[n.jsx("li",{children:"• سيتم إرسال رابط الاستشارة قبل الموعد بـ 15 دقيقة"}),n.jsx("li",{children:"• يمكنك إلغاء الاستشارة قبل 24 ساعة من الموعد"}),n.jsx("li",{children:"• سيتم خصم المبلغ عند تأكيد الحجز"})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:o,className:"px-6 py-3 bg-indigo-500 text-white rounded-xl hover:bg-indigo-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحجز..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ti,{className:"w-5 h-5"}),"تأكيد الحجز"]})})]})]})]})})},G8=()=>{const{t:e,i18n:t}=ft(),[r,a]=C.useState("my-consultations"),[s,i]=C.useState("all"),[o,l]=C.useState("all"),[c,d]=C.useState(""),[u,f]=C.useState(!1),[x,p]=C.useState(null),[h,m]=C.useState(null),[g,v]=C.useState(!1),{consultations:b,consultants:y,loading:N,error:j,fetchConsultations:w,fetchConsultants:_,createConsultation:S,updateConsultation:k}=Ms();C.useEffect(()=>{console.log("i18n initialization status:",{language:t.language,isInitialized:t.isInitialized,availableLanguages:t.languages})},[t.language,t.isInitialized]),C.useEffect(()=>{_()},[]);const E=[{id:"all",name:e("consultations.types.all")},{id:"technical",name:e("consultations.types.technical")},{id:"academic",name:e("consultations.types.academic")},{id:"career",name:e("consultations.types.career")},{id:"project",name:e("consultations.types.project")}],A=[{id:"all",name:e("consultations.statuses.all"),color:"bg-yellow-100 text-yellow-800",icon:xt},{id:"pending",name:e("consultations.statuses.pending"),color:"bg-yellow-100 text-yellow-800",icon:xt},{id:"scheduled",name:e("consultations.statuses.scheduled"),color:"bg-blue-100 text-blue-800",icon:ot},{id:"completed",name:e("consultations.statuses.completed"),color:"bg-green-100 text-green-800",icon:Le},{id:"cancelled",name:e("consultations.statuses.cancelled"),color:"bg-red-100 text-red-800",icon:un}],P=b.filter(F=>{const U=s==="all"||F.type===s,q=o==="all"||F.status===o,K=F.topic.toLowerCase().includes(c.toLowerCase())||F.description.toLowerCase().includes(c.toLowerCase());return U&&q&&K}),L=F=>A.find(q=>q.id===F)||{name:F,color:"bg-gray-100 text-gray-800",icon:ja},R=F=>{switch(F){case"video":return n.jsx(ar,{className:"w-4 h-4"});case"phone":return n.jsx(Cr,{className:"w-4 h-4"});case"chat":return n.jsx(Hr,{className:"w-4 h-4"});default:return n.jsx(rr,{className:"w-4 h-4"})}},I=F=>{switch(F){case"video":return e("consultations.methods.video");case"phone":return e("consultations.methods.phone");case"chat":return e("consultations.methods.chat");case"screen_share":return e("consultations.methods.screenShare");default:return F}},D=async F=>{try{await S(F),f(!1),v(!1),w()}catch(U){console.error("Error creating consultation:",U)}},V=async(F,U)=>{try{await k(F,U),p(null),w()}catch(q){console.error("Error updating consultation:",q)}};return N?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):j?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ja,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:j})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(rr,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("consultations.title")}),n.jsx("p",{className:"opacity-90",children:e("consultations.subtitle")})]})]}),n.jsxs("button",{onClick:()=>f(!0),className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5"}),e("consultations.requestConsultation")]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:b.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("consultations.stats.total")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:b.filter(F=>F.status==="scheduled").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("consultations.stats.scheduled")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:b.filter(F=>F.status==="completed").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("consultations.stats.completed")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:b.filter(F=>F.status==="pending").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("consultations.stats.pending")})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsx("div",{className:"border-b border-gray-200",children:n.jsxs("nav",{className:"flex",children:[n.jsx("button",{onClick:()=>a("my-consultations"),className:`px-4 py-4 font-medium text-sm border-b-2 ${r==="my-consultations"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e("consultations.tabs.myConsultations")}),n.jsx("button",{onClick:()=>a("search-consultants"),className:`px-4 py-4 font-medium text-sm border-b-2 ${r==="search-consultants"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e("consultations.tabs.searchConsultants")})]})}),r==="my-consultations"&&n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("consultations.searchPlaceholder"),value:c,onChange:F=>d(F.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsx("select",{value:s,onChange:F=>i(F.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:E.map(F=>n.jsx("option",{value:F.id,children:F.name},F.id))}),n.jsx("select",{value:o,onChange:F=>l(F.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:A.map(F=>n.jsx("option",{value:F.id,children:F.name},F.id))})]}),n.jsx("div",{className:"space-y-4",children:P.map((F,U)=>{const q=L(F.status);return n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:U*.1},className:"border border-gray-200 rounded-xl p-6 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:F.topic}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${q.color}`,children:q.name})]}),n.jsx("p",{className:"text-gray-600 mb-2",children:F.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{children:[e("consultations.consultant"),": ",F.mentor_name||e("consultations.unassigned")]}),n.jsx("span",{children:"•"}),n.jsxs("span",{className:"flex items-center gap-1",children:[R(F.method),I(F.method)]}),n.jsx("span",{children:"•"}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(xt,{className:"w-4 h-4"}),F.duration," ",e("consultations.minutes")]})]})]}),n.jsxs("div",{className:"text-right",children:[F.status==="scheduled"&&F.scheduledDate&&n.jsxs("div",{className:"text-sm",children:[n.jsx("div",{className:"font-medium text-gray-800",children:e("consultations.appointmentTime")}),n.jsx("div",{className:"text-gray-600",children:Ye(F.scheduledDate,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",calendar:"gregory"})})]}),F.status==="completed"&&F.rating&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:F.rating})]})]})]}),F.status==="completed"&&F.feedback&&n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mt-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("consultations.yourFeedback"),":"]}),n.jsx("p",{className:"text-gray-700 text-sm",children:F.feedback})]}),n.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"text-sm text-gray-500",children:[e("consultations.created"),": ",Ye(F.createdAt)]}),n.jsxs("div",{className:"flex gap-2",children:[F.status==="scheduled"&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>window.open("https://meet.google.com/new","_blank"),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm flex items-center gap-2",children:[n.jsx(ar,{className:"w-4 h-4"}),e("consultations.joinConsultation")]}),n.jsx("button",{onClick:()=>p(F.id),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:e("consultations.reschedule")})]}),F.status==="pending"&&n.jsx("button",{onClick:()=>p(F.id),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:e("consultations.editRequest")}),F.status==="completed"&&!F.rating&&n.jsx("button",{onClick:()=>p(F.id),className:"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors text-sm",children:e("consultations.rateConsultation")}),n.jsx("button",{onClick:()=>p(F.id),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:e("consultations.viewDetails")})]})]})]},F.id)})}),P.length===0&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(rr,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("consultations.noConsultations")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("consultations.startByRequesting")}),n.jsx("button",{onClick:()=>f(!0),className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("consultations.requestNewConsultation")})]})]}),r==="search-consultants"&&n.jsxs("div",{className:"p-6",children:[n.jsx("div",{className:"mb-6",children:n.jsxs("div",{className:"relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("consultations.searchConsultantPlaceholder"),value:c,onChange:F=>d(F.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),!1,t.isInitialized?n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map((F,U)=>n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:U*.1},className:"bg-white border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-all duration-300",children:[n.jsxs("div",{className:"text-center mb-4",children:[n.jsx("img",{src:F.avatar,alt:F.name,className:"w-20 h-20 rounded-full object-cover mx-auto mb-3"}),n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-1",children:F.name}),n.jsx("p",{className:"text-gray-600 text-sm mb-2",children:F.title}),n.jsxs("div",{className:"flex items-center justify-center gap-1 mb-2",children:[n.jsx(lt,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:F.rating}),n.jsxs("span",{className:"text-gray-500 text-sm",children:["(",F.reviews," ",e("search.reviews"),")"]})]})]}),n.jsxs("div",{className:"space-y-3 mb-4",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:[e("search.specialties"),":"]}),n.jsxs("div",{className:"flex flex-wrap gap-1",children:[(F.specialties||[]).slice(0,3).map((q,K)=>n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-lg",children:q},K)),(F.specialties||[]).length>3&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",(F.specialties||[]).length-3]})]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("search.price"),":"]}),n.jsxs("span",{className:"font-medium text-blue-600",children:[F.hourlyRate," ",e("search.pricePerHour")]})]})]}),n.jsx("button",{onClick:()=>{m(F.id),v(!0)},className:"w-full bg-blue-500 text-white py-2 rounded-xl hover:bg-blue-600 transition-colors font-medium",children:e("search.bookConsultation")})]},F.id))}):n.jsx("div",{className:"flex justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}),y.length===0&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Xt,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("consultations.noConsultants")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("consultations.noConsultantsAvailable")}),n.jsx(ke,{to:"/search",className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("consultations.advancedSearch")})]})]})]}),u&&n.jsx(z8,{onClose:()=>f(!1),onSubmit:D}),x&&n.jsx(V8,{consultation:b.find(F=>F.id===x),onClose:()=>p(null),onUpdate:V}),g&&h&&n.jsx(BE,{consultant:y.find(F=>F.id===h),onClose:()=>{m(null),v(!1)},onSubmit:D}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center",children:n.jsx(An,{className:"w-5 h-5 text-indigo-600"})}),n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:e("consultations.howToUse.title")})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-6 h-6 bg-indigo-100 rounded-full flex items-center justify-center text-sm text-indigo-600",children:"1"}),e("consultations.howToUse.step1.title")]}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("consultations.howToUse.step1.description")})]}),n.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-6 h-6 bg-indigo-100 rounded-full flex items-center justify-center text-sm text-indigo-600",children:"2"}),e("consultations.howToUse.step2.title")]}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("consultations.howToUse.step2.description")})]}),n.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-6 h-6 bg-indigo-100 rounded-full flex items-center justify-center text-sm text-indigo-600",children:"3"}),e("consultations.howToUse.step3.title")]}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("consultations.howToUse.step3.description")})]})]})]})]})},K8=()=>{const{t:e}=ft(),{consultations:t,loading:r,error:a}=Ms(),[s,i]=C.useState("all"),[o,l]=C.useState(""),c=t.filter(p=>{const h=s==="all"||p.status===s,m=p.topic.toLowerCase().includes(o.toLowerCase())||p.description.toLowerCase().includes(o.toLowerCase());return h&&m}),d=p=>{switch(p){case"pending":return"bg-yellow-100 text-yellow-800";case"scheduled":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},u=p=>{switch(p){case"pending":return e("consultations.statuses.pending");case"scheduled":return e("consultations.statuses.scheduled");case"completed":return e("consultations.statuses.completed");case"cancelled":return e("consultations.statuses.cancelled");default:return p}},f=p=>{switch(p){case"video":return n.jsx(ar,{className:"w-4 h-4"});case"phone":return n.jsx(Cr,{className:"w-4 h-4"});case"chat":return n.jsx(Hr,{className:"w-4 h-4"});default:return n.jsx(rr,{className:"w-4 h-4"})}},x=p=>{switch(p){case"video":return e("consultations.methods.video");case"phone":return e("consultations.methods.phone");case"chat":return e("consultations.methods.chat");default:return p}};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ge,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(cr,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("myConsultations.title")}),n.jsx("p",{className:"opacity-90",children:e("myConsultations.subtitle")})]})]}),n.jsxs(ke,{to:"/consultations",className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5"}),e("myConsultations.newRequest")]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("myConsultations.stats.total")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(p=>p.status==="pending").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("myConsultations.stats.pending")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(p=>p.status==="scheduled").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("myConsultations.stats.scheduled")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(p=>p.status==="completed").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("myConsultations.stats.completed")})]})]})]}),n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("myConsultations.searchPlaceholder"),value:o,onChange:p=>l(p.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("select",{value:s,onChange:p=>i(p.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("myConsultations.filters.allStatuses")}),n.jsx("option",{value:"pending",children:e("consultations.statuses.pending")}),n.jsx("option",{value:"scheduled",children:e("consultations.statuses.scheduled")}),n.jsx("option",{value:"completed",children:e("consultations.statuses.completed")}),n.jsx("option",{value:"cancelled",children:e("consultations.statuses.cancelled")})]})]})}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("myConsultations.showing")," ",c.length," ",e("myConsultations.of")," ",t.length," ",e("myConsultations.request")]})}),n.jsx("div",{className:"space-y-4",children:c.map((p,h)=>n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:h*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:p.topic}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${d(p.status)}`,children:u(p.status)})]}),n.jsx("p",{className:"text-gray-600 mb-2",children:p.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{children:[e("consultations.consultant"),": ",p.mentor_name||e("consultations.unassigned")]}),n.jsx("span",{children:"•"}),n.jsxs("span",{className:"flex items-center gap-1",children:[f(p.method),x(p.method)]}),n.jsx("span",{children:"•"}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(xt,{className:"w-4 h-4"}),p.duration," ",e("consultations.minutes")]})]})]}),n.jsxs("div",{className:"relative group/menu",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Rf,{className:"w-5 h-5 text-gray-400"})}),n.jsx("div",{className:"absolute left-0 top-10 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover/menu:opacity-100 group-hover/menu:visible transition-all duration-200 z-10",children:n.jsxs("div",{className:"p-2",children:[n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(mr,{className:"w-4 h-4"}),e("myConsultations.actions.viewDetails")]}),p.status==="pending"&&n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(Ia,{className:"w-4 h-4"}),e("myConsultations.actions.editRequest")]}),p.status!=="completed"&&p.status!=="cancelled"&&n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",children:[n.jsx(un,{className:"w-4 h-4"}),e("myConsultations.actions.cancelRequest")]})]})})]})]}),n.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"text-sm text-gray-500",children:[e("myConsultations.createdAt"),": ",Ye(p.createdAt)]}),n.jsxs("div",{className:"flex gap-2",children:[p.status==="scheduled"&&p.scheduledDate&&n.jsxs("div",{className:"text-sm",children:[n.jsxs("span",{className:"font-medium text-gray-800",children:[e("consultations.appointmentTime"),":"]})," ",n.jsx("span",{className:"text-blue-600",children:Ye(p.scheduledDate,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",calendar:"gregory"})})]}),p.status==="scheduled"&&n.jsxs("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm flex items-center gap-2",children:[n.jsx(ar,{className:"w-4 h-4"}),e("consultations.joinConsultation")]}),p.status==="completed"&&!p.rating&&n.jsx("button",{className:"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors text-sm",children:e("consultations.rateConsultation")})]})]})]},p.id))}),c.length===0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(cr,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("myConsultations.noRequests")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("myConsultations.noRequestsMatch")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs(ke,{to:"/create-request",className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(pt,{className:"w-4 h-4"}),e("myConsultations.newRequest")]}),n.jsx("button",{onClick:()=>{i("all"),l("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.resetFilters")})]})]})]})},X8=()=>{const{t:e}=ft(),t=Rs(),{createConsultation:r}=Ms(),{projects:a}=Ii(),[s,i]=C.useState({topic:"",description:"",type:"technical",method:"video",duration:60,project_id:"",preferredDate:""}),[o,l]=C.useState(!1),[c,d]=C.useState(null),u=[{id:"technical",name:e("consultations.types.technical"),description:e("consultations.typeDescriptions.technical")},{id:"academic",name:e("consultations.types.academic"),description:e("consultations.typeDescriptions.academic")},{id:"career",name:e("consultations.types.career"),description:e("consultations.typeDescriptions.career")},{id:"project",name:e("consultations.types.project"),description:e("consultations.typeDescriptions.project")}],f=[{id:"video",name:e("consultations.methods.video"),icon:ar},{id:"phone",name:e("consultations.methods.phone"),icon:Cr},{id:"chat",name:e("consultations.methods.chat"),icon:Hr}],x=[{value:30,label:e("consultations.durations.30min")},{value:60,label:e("consultations.durations.60min")},{value:90,label:e("consultations.durations.90min")},{value:120,label:e("consultations.durations.120min")}],p=(g,v)=>{i(b=>({...b,[g]:v}))},h=async g=>{if(g.preventDefault(),!s.topic||!s.description){d(e("consultations.errors.requiredFields"));return}l(!0),d(null);try{await r({...s,status:"pending"}),t("/my-consultations")}catch(v){console.error("Error submitting consultation request:",v),d(v instanceof Error?v.message:e("consultations.errors.submissionFailed"))}finally{l(!1)}},m=a.filter(g=>g.status==="active");return n.jsxs("div",{className:"space-y-6",children:[n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(ke,{to:"/my-consultations",className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Cn,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:e("consultations.createRequest.title")}),n.jsx("p",{className:"text-gray-600",children:e("consultations.createRequest.subtitle")})]})]})}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[c&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:c})]}),n.jsxs("form",{onSubmit:h,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.topic")," *"]}),n.jsx("input",{type:"text",value:s.topic,onChange:g=>p("topic",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("consultations.form.topicPlaceholder"),required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.description")," *"]}),n.jsx("textarea",{value:s.description,onChange:g=>p("description",g.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("consultations.form.descriptionPlaceholder"),required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.type")," *"]}),n.jsx("div",{className:"grid grid-cols-2 gap-3",children:u.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.type===g.id?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"type",value:g.id,checked:s.type===g.id,onChange:()=>p("type",g.id),className:"sr-only"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:g.name}),n.jsx("p",{className:"text-xs text-gray-500",children:g.description})]})]},g.id))})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.method")," *"]}),n.jsx("div",{className:"space-y-2",children:f.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.method===g.id?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"method",value:g.id,checked:s.method===g.id,onChange:()=>p("method",g.id),className:"sr-only"}),n.jsx(g.icon,{className:"w-5 h-5"}),n.jsx("span",{children:g.name})]},g.id))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.duration")," *"]}),n.jsx("div",{className:"space-y-2",children:x.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.duration===g.value?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"duration",value:g.value,checked:s.duration===g.value,onChange:()=>p("duration",g.value),className:"sr-only"}),n.jsx(xt,{className:"w-5 h-5"}),n.jsx("span",{children:g.label})]},g.value))})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("consultations.form.relatedProject")}),n.jsxs("div",{className:"relative",children:[n.jsx(Xl,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:s.project_id,onChange:g=>p("project_id",g.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:e("consultations.form.noProject")}),m.map(g=>n.jsx("option",{value:g.id,children:g.title},g.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("consultations.form.preferredDate")}),n.jsxs("div",{className:"relative",children:[n.jsx(ot,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"datetime-local",value:s.preferredDate,onChange:g=>p("preferredDate",g.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx("div",{className:"text-blue-500 mt-1",children:n.jsx(An,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:e("consultations.importantInfo.title")}),n.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[n.jsxs("li",{children:["• ",e("consultations.importantInfo.review")]}),n.jsxs("li",{children:["• ",e("consultations.importantInfo.link")]}),n.jsxs("li",{children:["• ",e("consultations.importantInfo.cancel")]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx(ke,{to:"/my-consultations",className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.cancel")}),n.jsx("button",{type:"submit",disabled:o,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e("consultations.submitting")]}):n.jsxs(n.Fragment,{children:[n.jsx(Le,{className:"w-5 h-5"}),e("consultations.submitRequest")]})})]})]})]})]})},Y8=()=>{const{t:e}=ft(),{user:t}=ut(),r=(t==null?void 0:t.role)==="student",a=(t==null?void 0:t.role)==="admin",[s,i]=C.useState("profile"),[o,l]=C.useState(!1),[c,d]=C.useState({name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",phone:(t==null?void 0:t.phone)||"",bio:(t==null?void 0:t.bio)||"",currentPassword:"",newPassword:"",confirmPassword:""}),[u,f]=C.useState({emailNotifications:!0,pushNotifications:!0,projectUpdates:!0,weeklyReports:!1,marketingEmails:!1}),[x,p]=C.useState({theme:"light",language:"ar",fontSize:"medium",animations:!0}),[h,m]=C.useState(!1),[g,v]=C.useState(null),[b,y]=C.useState(!1),[N,j]=C.useState(!1),[w,_]=C.useState(null),[S,k]=C.useState(!1),E=[{id:"profile",name:e("settings.sections.profile"),icon:Xt},{id:"notifications",name:e("settings.sections.notifications"),icon:du},{id:"security",name:e("settings.sections.security"),icon:ba},{id:"appearance",name:e("settings.sections.appearance"),icon:No},{id:"language",name:e("settings.sections.language"),icon:yi},{id:"data",name:e("settings.sections.data"),icon:L0}],A=(R,I)=>{if(R.startsWith("notifications.")){const D=R.split(".")[1];f(V=>({...V,[D]:I}))}else if(R.startsWith("appearance.")){const D=R.split(".")[1];p(V=>({...V,[D]:I}))}else d(D=>({...D,[R]:I}))},P=async()=>{if(!t){v(e("settings.errors.loginRequired"));return}m(!0),v(null),y(!1);try{const R={name:c.name,phone:c.phone,bio:c.bio,notifications_settings:u,appearance_settings:x};await lv(t.id,R),y(!0),setTimeout(()=>{y(!1)},3e3)}catch(R){console.error("Error saving settings:",R),v(R instanceof Error?R.message:e("settings.errors.saveFailed"))}finally{m(!1)}},L=async()=>{if(_(null),k(!1),!c.currentPassword){_("يرجى إدخال كلمة المرور الحالية");return}if(!c.newPassword){_("يرجى إدخال كلمة المرور الجديدة");return}if(c.newPassword.length<6){_("يجب أن تكون كلمة المرور الجديدة 6 أحرف على الأقل");return}if(c.newPassword!==c.confirmPassword){_("كلمة المرور الجديدة وتأكيد كلمة المرور غير متطابقتين");return}j(!0);try{const R=await TO(c.currentPassword,c.newPassword);R.success?(k(!0),d(I=>({...I,currentPassword:"",newPassword:"",confirmPassword:""})),setTimeout(()=>{k(!1)},5e3)):_(R.message)}catch(R){console.error("Error updating password:",R),_(R instanceof Error?R.message:"حدث خطأ أثناء تحديث كلمة المرور")}finally{j(!1)}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-gray-600 to-gray-800 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(wo,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("settings.title")}),n.jsx("p",{className:"opacity-90",children:e("settings.subtitle")})]})]})}),n.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[n.jsx(re.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.1},className:"lg:col-span-1",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("settings.settingsSections")}),n.jsx("nav",{className:"space-y-2",children:E.map(R=>n.jsxs("button",{onClick:()=>i(R.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${s===R.id?"bg-blue-500 text-white shadow-lg":"text-gray-700 hover:bg-gray-50"}`,children:[n.jsx(R.icon,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:R.name})]},R.id))})]})}),n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"lg:col-span-3",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[b&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-center gap-2",children:[n.jsx(Le,{className:"w-5 h-5"}),n.jsx("span",{children:e("settings.saveSuccess")})]}),g&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-center gap-2",children:[n.jsx(Ge,{className:"w-5 h-5"}),n.jsx("span",{children:g})]}),s==="profile"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(Xt,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.profile.title")})]}),n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:(t==null?void 0:t.avatar)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:"Profile",className:"w-24 h-24 rounded-full object-cover"}),n.jsx("button",{className:"absolute bottom-0 right-0 w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center hover:bg-blue-600 transition-colors",children:n.jsx(Pn,{className:"w-4 h-4"})})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:e("settings.profile.profilePicture")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("settings.profile.pictureRequirements")}),n.jsxs("div",{className:"flex gap-2 mt-2",children:[n.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm",children:e("settings.profile.changePicture")}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:e("settings.profile.remove")})]})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.profile.fullName")}),n.jsx("input",{type:"text",value:c.name,onChange:R=>A("name",R.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("common.email")}),n.jsx("input",{type:"email",value:c.email,onChange:R=>A("email",R.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("common.phone")}),n.jsx("input",{type:"tel",value:c.phone,onChange:R=>A("phone",R.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.profile.timezone")}),n.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{children:e("settings.profile.timezones.riyadh")}),n.jsx("option",{children:e("settings.profile.timezones.cairo")}),n.jsx("option",{children:e("settings.profile.timezones.dubai")})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.profile.bio")}),n.jsx("textarea",{value:c.bio,onChange:R=>A("bio",R.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("settings.profile.bioPlaceholder")})]})]}),s==="notifications"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(du,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.notifications.title")})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(ma,{className:"w-5 h-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.notifications.emailNotifications")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.notifications.emailNotificationsDesc")})]})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:u.emailNotifications,onChange:R=>A("notifications.emailNotifications",R.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(YC,{className:"w-5 h-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.notifications.pushNotifications")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.notifications.pushNotificationsDesc")})]})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:u.pushNotifications,onChange:R=>A("notifications.pushNotifications",R.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(no,{className:"w-5 h-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.notifications.projectUpdates")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.notifications.projectUpdatesDesc")})]})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:u.projectUpdates,onChange:R=>A("notifications.projectUpdates",R.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Mr,{className:"w-5 h-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.notifications.weeklyReports")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.notifications.weeklyReportsDesc")})]})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:u.weeklyReports,onChange:R=>A("notifications.weeklyReports",R.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),s==="security"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(ba,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.security.title")})]}),S&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(Le,{className:"w-5 h-5"}),n.jsx("span",{children:"تم تحديث كلمة المرور بنجاح"})]}),w&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(Ge,{className:"w-5 h-5"}),n.jsx("span",{children:w})]}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:e("settings.security.changePassword")}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.security.currentPassword")}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:o?"text":"password",value:c.currentPassword,onChange:R=>A("currentPassword",R.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:N}),n.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:N,children:o?n.jsx(Ff,{className:"w-5 h-5"}):n.jsx(mr,{className:"w-5 h-5"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.security.newPassword")}),n.jsx("input",{type:"password",value:c.newPassword,onChange:R=>A("newPassword",R.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:N}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"يجب أن تكون 6 أحرف على الأقل"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.security.confirmNewPassword")}),n.jsx("input",{type:"password",value:c.confirmPassword,onChange:R=>A("confirmPassword",R.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:N})]}),n.jsx("button",{onClick:L,disabled:N,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:N?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"جاري التحديث..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Yn,{className:"w-5 h-5"}),e("settings.security.updatePassword")]})})]})]}),n.jsx("div",{className:"border border-gray-200 rounded-xl p-6",children:n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:e("settings.security.twoFactorAuth")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("settings.security.twoFactorAuthDesc")})]}),n.jsx("button",{className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:e("settings.security.enable")})]})}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:e("settings.security.loginSessions")}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:e("settings.security.chromeWindows")}),n.jsxs("p",{className:"text-sm text-gray-600",children:[e("settings.security.riyadhSaudiArabia")," - ",e("settings.security.activeNow")]})]}),n.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:e("settings.security.currentSession")})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:e("settings.security.safariIphone")}),n.jsxs("p",{className:"text-sm text-gray-600",children:[e("settings.security.jeddahSaudiArabia")," - ",e("settings.security.twoDaysAgo")]})]}),n.jsx("button",{className:"text-red-600 hover:text-red-800 text-sm",children:e("settings.security.endSession")})]})]})]})]}),s==="appearance"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(No,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.appearance.title")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.appearance.theme")}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"theme",value:"light",checked:x.theme==="light",onChange:R=>A("appearance.theme",R.target.value),className:"text-blue-600"}),n.jsx("span",{children:e("settings.appearance.lightTheme")})]}),n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"theme",value:"dark",checked:x.theme==="dark",onChange:R=>A("appearance.theme",R.target.value),className:"text-blue-600"}),n.jsx("span",{children:e("settings.appearance.darkTheme")})]}),n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"theme",value:"auto",checked:x.theme==="auto",onChange:R=>A("appearance.theme",R.target.value),className:"text-blue-600"}),n.jsx("span",{children:e("settings.appearance.autoTheme")})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.appearance.fontSize")}),n.jsxs("select",{value:x.fontSize,onChange:R=>A("appearance.fontSize",R.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"small",children:e("settings.appearance.small")}),n.jsx("option",{value:"medium",children:e("settings.appearance.medium")}),n.jsx("option",{value:"large",children:e("settings.appearance.large")})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.appearance.animations")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.appearance.animationsDesc")})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:x.animations,onChange:R=>A("appearance.animations",R.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]}),s==="language"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(yi,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.language.title")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.language.interfaceLanguage")}),n.jsxs("select",{value:x.language,onChange:R=>A("appearance.language",R.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"ar",children:e("settings.language.arabic")}),n.jsx("option",{value:"en",children:e("settings.language.english")}),n.jsx("option",{value:"fr",children:e("settings.language.french")})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.language.timezone")}),n.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{children:e("settings.language.timezones.riyadh")}),n.jsx("option",{children:e("settings.language.timezones.cairo")}),n.jsx("option",{children:e("settings.language.timezones.dubai")})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.language.dateFormat")}),n.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{children:"DD/MM/YYYY"}),n.jsx("option",{children:"MM/DD/YYYY"}),n.jsx("option",{children:"YYYY-MM-DD"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.language.timeFormat")}),n.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{children:e("settings.language.timeFormats.24hour")}),n.jsx("option",{children:e("settings.language.timeFormats.12hour")})]})]})]})]}),s==="data"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(L0,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.data.title")})]}),!r&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:e("settings.data.exportData")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("settings.data.exportDataDesc")}),n.jsxs("button",{className:"flex items-center gap-2 px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:[n.jsx(Mr,{className:"w-5 h-5"}),e("settings.data.exportData")]})]}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:e("settings.data.importData")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("settings.data.importDataDesc")}),n.jsxs("button",{className:"flex items-center gap-2 px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors",children:[n.jsx(Pn,{className:"w-5 h-5"}),e("settings.data.importData")]})]}),a&&n.jsx("div",{className:"border border-red-200 rounded-xl p-6 bg-red-50",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Ge,{className:"w-6 h-6 text-red-600 mt-1"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:e("settings.data.deleteAccount")}),n.jsx("p",{className:"text-red-700 mb-4",children:e("settings.data.deleteAccountWarning")}),n.jsxs("button",{className:"flex items-center gap-2 px-6 py-3 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors",children:[n.jsx(nr,{className:"w-5 h-5"}),e("settings.data.permanentlyDeleteAccount")]})]})]})})]}),r&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(L0,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"إدارة البيانات"}),n.jsx("p",{className:"text-gray-600",children:"لا تتوفر خيارات إدارة البيانات للطلاب. يرجى التواصل مع المشرف أو مدير الجهة للمساعدة."})]})]}),n.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:n.jsx("button",{onClick:P,disabled:h,className:"flex items-center gap-2 px-8 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:h?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e("settings.saving")]}):n.jsxs(n.Fragment,{children:[n.jsx(Za,{className:"w-5 h-5"}),e("settings.saveChanges")]})})})]})})]})]})},J8=()=>{const{t:e}=ft(),{user:t}=ut(),r=(t==null?void 0:t.role)==="student",a=(t==null?void 0:t.role)==="teacher",s=(t==null?void 0:t.role)==="school",i=(t==null?void 0:t.role)==="admin",o=nv(),c=new URLSearchParams(o.search).get("search")||"",[d,u]=C.useState("all"),[f,x]=C.useState(c),[p,h]=C.useState(!1),[m,g]=C.useState({}),{projects:v,loading:b,error:y,archiveProject:N,deleteProject:j}=Ii();C.useEffect(()=>{const V=new URLSearchParams(o.search).get("search")||"";x(V)},[o.search]),C.useEffect(()=>{(async()=>{var V;if(v.length!==0)try{console.log("Fetching evaluations for projects:",v.map(q=>q.id));const F=Oe(he,"project_evaluations"),U={};for(const q of v){const K=q.id;console.log("Fetching evaluation for project:",K);const T=Me(F,De("projectId","==",K)),O=await Ie(T);if(console.log("Evaluation query result for",K,":",O.size,"documents"),O.empty)console.log("No evaluation found for project",K);else{const z=O.docs[0].data();console.log("Evaluation data for",K,":",z);const te=(V=z.criteria)==null?void 0:V.find(ae=>(console.log("Checking criterion:",ae.name,"against نسبة الإنجاز"),ae.name==="نسبة الإنجاز"));if(console.log("Progress criterion found:",te),te){const ae=te.score||0;U[K]=ae,console.log("Setting progress for",K,"to",ae)}else console.log("No progress criterion found for project",K),z.criteria&&console.log("Available criteria names:",z.criteria.map(ae=>ae.name))}}console.log("Final evaluations map:",U),g(U)}catch(F){console.error("Error fetching project evaluations:",F)}})()},[v]);const w=D=>{const V=m[D];return console.log("Getting progress for",D,":",V),V!==void 0?V:0},_=[{id:"all",name:e("projects.statuses.all"),color:"bg-gray-500"},{id:"draft",name:e("projects.statuses.draft"),color:"bg-gray-500"},{id:"active",name:e("projects.statuses.active"),color:"bg-blue-500"},{id:"completed",name:e("projects.statuses.completed"),color:"bg-green-500"},{id:"archived",name:e("projects.statuses.archived"),color:"bg-purple-500"}],S=v.filter(D=>{const V=d==="all"||D.status===d,F=D.title.toLowerCase().includes(f.toLowerCase())||D.description.toLowerCase().includes(f.toLowerCase());return V&&F}),k=D=>{switch(D){case"draft":return n.jsx(Ia,{className:"w-4 h-4"});case"active":return n.jsx(_o,{className:"w-4 h-4"});case"completed":return n.jsx(Le,{className:"w-4 h-4"});case"archived":return n.jsx(n1,{className:"w-4 h-4"});default:return n.jsx(Xl,{className:"w-4 h-4"})}},E=D=>{switch(D){case"draft":return e("projects.statuses.draft");case"active":return e("projects.statuses.active");case"completed":return e("projects.statuses.completed");case"archived":return e("projects.statuses.archived");default:return D}},A=D=>{switch(D){case"draft":return"bg-gray-100 text-gray-800";case"active":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"archived":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},P=D=>{switch(D){case"stem":return e("projects.categories.stem");case"entrepreneurship":return e("projects.categories.entrepreneurship");case"volunteer":return e("projects.categories.volunteer");case"ethics":return e("projects.categories.ethics");default:return D}},L=async D=>{if(window.confirm("هل أنت متأكد من أرشفة هذا المشروع؟"))try{await N(D)}catch(V){console.error("Error archiving project:",V),alert("حدث خطأ أثناء أرشفة المشروع")}},R=async D=>{if(window.confirm("هل أنت متأكد من حذف هذا المشروع؟ هذا الإجراء لا يمكن التراجع عنه."))try{await j(D)}catch(V){console.error("Error deleting project:",V),alert("حدث خطأ أثناء حذف المشروع")}},I=D=>{var V;return!!(i||s||a&&D.teacher_id===(t==null?void 0:t.id)||a&&D.status==="draft"&&D.school_id===(t==null?void 0:t.school_id)||r&&D.status==="draft"&&((V=D.students)!=null&&V.some(F=>F.student_id===(t==null?void 0:t.id))))};return b?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):y?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ja,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:y})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-green-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Xl,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("projects.title")}),n.jsx("div",{className:"text-sm text-gray-600",children:"نسبة الإنجاز"})]})]}),n.jsxs(ke,{to:"/projects/new",className:"bg-white text-green-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5"}),e("projects.newProject")]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:v.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("projects.stats.total")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:v.filter(D=>D.status==="active").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("projects.stats.active")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:v.filter(D=>D.status==="completed").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("projects.stats.completed")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:v.length>0?(Math.round(v.reduce((D,V)=>D+w(V.id),0)/v.length*10)/10).toFixed(1):0}),n.jsx("div",{className:"text-sm opacity-80",children:e("projects.stats.averageProgress")})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("projects.searchPlaceholder"),value:f,onChange:D=>x(D.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>h(!p),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(nl,{className:"w-5 h-5"}),e("common.filter")]})]}),n.jsxs("div",{className:`mt-4 ${p?"block":"hidden lg:block"}`,children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("projects.projectStatus")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(D=>n.jsxs("button",{onClick:()=>u(D.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${d===D.id?`${D.color} text-white shadow-lg`:"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[k(D.id),D.name]},D.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("projects.showing")," ",S.length," ",e("projects.of")," ",v.length," ",e("projects.project")]})}),n.jsx("div",{className:"grid lg:grid-cols-2 gap-6",children:S.map((D,V)=>{var F;return n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:V*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1 ${A(D.status)}`,children:[k(D.status),E(D.status)]}),n.jsx("span",{className:"text-xs text-gray-500",children:P(D.category)})]}),n.jsx(ke,{to:`/projects/${D.id}`,className:"text-xl font-bold text-blue-600 hover:text-blue-800 underline transition-colors line-clamp-2",children:D.title})]}),I(D)&&n.jsxs("div",{className:"relative group/menu",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Rf,{className:"w-5 h-5 text-gray-400"})}),n.jsx("div",{className:"absolute left-0 top-10 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover/menu:opacity-100 group-hover/menu:visible transition-all duration-200 z-10",children:n.jsxs("div",{className:"p-2",children:[n.jsxs(ke,{to:`/projects/${D.id}`,className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(mr,{className:"w-4 h-4"}),e("projects.actions.viewDetails")]}),n.jsxs(ke,{to:`/projects/${D.id}/edit`,className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(Ia,{className:"w-4 h-4"}),e("projects.actions.edit")]}),n.jsxs("button",{onClick:()=>L(D.id),className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(n1,{className:"w-4 h-4"}),e("projects.actions.archive")]}),n.jsx("hr",{className:"my-1"}),n.jsxs("button",{onClick:()=>R(D.id),className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",children:[n.jsx(nr,{className:"w-4 h-4"}),e("projects.actions.delete")]})]})})]})]}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-2 leading-relaxed",children:D.description}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium text-gray-700",children:e("common.progress")}),n.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["نسبة الإنجاز: ",w(D.id),"/10"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${w(D.id)>=9?"bg-green-500":w(D.id)>=5?"bg-blue-500":"bg-yellow-500"}`,style:{width:`${w(D.id)/10*100}%`}})})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4 text-center",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"text-lg font-bold text-gray-800",children:[D.completedTasks||0,"/",D.totalTasks||0]}),n.jsx("div",{className:"text-xs text-gray-500",children:e("projects.tasks")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:D.studentCount||0}),n.jsx("div",{className:"text-xs text-gray-500",children:e("projects.students")})]}),n.jsxs("div",{children:[n.jsx("div",{className:`text-lg font-bold ${D.due_date&&wn(D.due_date)<0?"text-red-600":D.due_date&&wn(D.due_date)<=7?"text-yellow-600":"text-green-600"}`,children:D.due_date?wn(D.due_date)<0?e("projects.overdue"):`${wn(D.due_date)} ${e("projects.days")}`:"--"}),n.jsx("div",{className:"text-xs text-gray-500",children:e("projects.remaining")})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:"flex -space-x-2",children:[(F=D.students)==null?void 0:F.slice(0,4).map((U,q)=>{var K,T,O;return n.jsx("img",{src:((K=U.student)==null?void 0:K.avatar_url)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:(T=U.student)==null?void 0:T.name,className:"w-8 h-8 rounded-full border-2 border-white object-cover",title:(O=U.student)==null?void 0:O.name},U.id)}),D.students&&D.students.length>4&&n.jsxs("div",{className:"w-8 h-8 rounded-full bg-gray-200 border-2 border-white flex items-center justify-center text-xs font-medium text-gray-600",children:["+",D.students.length-4]})]}),n.jsxs("span",{className:"mr-3 text-sm text-gray-500",children:[e("projects.lastUpdate"),": ",Ye(D.updated_at)]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[D.rating&&n.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[n.jsx(lt,{className:"w-4 h-4 text-yellow-400 fill-current"}),D.rating.toFixed(1)]}),n.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[n.jsx(ot,{className:"w-4 h-4"}),D.due_date?Ye(D.due_date):e("projects.notSpecified")]})]})]})]},D.id)})}),S.length===0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Xl,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("projects.noProjects")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("projects.startCreating")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs(ke,{to:"/projects/new",className:"px-6 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2",children:[n.jsx(pt,{className:"w-4 h-4"}),e("projects.createNewProject")]}),n.jsx("button",{onClick:()=>{u("all"),x("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.resetFilters")})]})]})]})},Q8=({projectId:e})=>{const{user:t}=ut(),[r,a]=C.useState([]),[s,i]=C.useState(""),[o,l]=C.useState(!0),[c,d]=C.useState(!1),[u,f]=C.useState(null),[x,p]=C.useState(null),[h,m]=C.useState(0),[g,v]=C.useState(!1),b=C.useRef(null),y=C.useRef(null),[N,j]=C.useState(null),[w,_]=C.useState(""),[S,k]=C.useState(null),[E,A]=C.useState(null),[P,L]=C.useState([]);C.useEffect(()=>{var M;(M=b.current)==null||M.scrollIntoView({behavior:"smooth"})},[r]),C.useEffect(()=>{if(!e)return;l(!0),f(null);const M=Oe(he,"chat_messages"),G=Me(M,De("project_id","==",e)),ne=mg(G,async B=>{var ye,Te;const pe=[];for(const de of B.docs){const xe=de.data();let We;try{if(xe.user_id){const Nt=Zt(he,"users",xe.user_id),_e=await Dt(Nt);if(_e.exists()){const He=_e.data();We={name:He.name||"مستخدم غير معروف",avatar_url:He.avatar_url,role:He.role}}}}catch(Nt){console.error("Error fetching user info:",Nt)}pe.push({id:de.id,project_id:xe.project_id,user_id:xe.user_id,message:xe.message,message_type:xe.message_type||"text",media_url:xe.media_url,reply_to:xe.reply_to,created_at:((ye=xe.created_at)==null?void 0:ye.toDate())||new Date,updated_at:(Te=xe.updated_at)==null?void 0:Te.toDate(),seen_by:xe.seen_by||[],user:We})}if(pe.sort((de,xe)=>de.created_at.getTime()-xe.created_at.getTime()),a(pe),l(!1),t&&pe.length>0){const de=pe[pe.length-1];de.user_id!==t.id&&O(de.id)}},B=>{console.error("Error fetching messages:",B),f("حدث خطأ في تحميل الرسائل"),l(!1)});return()=>ne()},[e,t]);const R=async()=>{if(!(!t||!e)&&!(!s.trim()&&!x)){d(!0),f(null);try{let M="",G="text";if(x){v(!0),x.type.startsWith("image/")?G="image":x.type.startsWith("video/")?G="video":G="file";const ne=mu(pu,`project_chats/${e}/${Date.now()}_${x.name}`),B=mE(ne,x);B.on("state_changed",pe=>{const ye=pe.bytesTransferred/pe.totalBytes*100;m(ye)},pe=>{console.error("Error uploading file:",pe),f("حدث خطأ في رفع الملف"),v(!1)},async()=>{M=await sv(B.snapshot.ref);const pe={name:x.name,url:M,type:G,uploadedBy:(t==null?void 0:t.name)||"مستخدم",uploadedAt:new Date};console.log("Adding resource to project:",e,pe),await NE(e,pe),console.log("Resource successfully added to project document."),await Fa(Oe(he,"chat_messages"),{project_id:e,user_id:t.id,message:s.trim()||`تم إرسال ${G==="image"?"صورة":G==="video"?"فيديو":"ملف"}`,message_type:G,media_url:M,created_at:Ve(),updated_at:Ve(),seen_by:[t.id]}),i(""),p(null),m(0),v(!1),d(!1)})}else await Fa(Oe(he,"chat_messages"),{project_id:e,user_id:t.id,message:s.trim(),message_type:"text",created_at:Ve(),updated_at:Ve(),seen_by:[t.id]}),i(""),d(!1)}catch(M){console.error("Error sending message:",M),f("حدث خطأ في إرسال الرسالة"),d(!1)}}},I=M=>{M.target.files&&M.target.files.length>0&&p(M.target.files[0])},D=()=>{p(null),y.current&&(y.current.value="")},V=(M,G)=>{j(M),_(G)},F=async M=>{if(w.trim())try{const G=Zt(he,"chat_messages",M);await sr(G,{message:w,updated_at:Ve()}),j(null),_("")}catch(G){console.error("Error updating message:",G),f("حدث خطأ في تحديث الرسالة")}},U=()=>{j(null),_("")},q=M=>{k(M)},K=async M=>{try{const G=r.find(B=>B.id===M),ne=Zt(he,"chat_messages",M);if(await Da(ne),G!=null&&G.media_url)try{const Te=new URL(G.media_url).pathname.split("?")[0].match(/\/o\/(.+)$/);if(Te&&Te[1]){const de=decodeURIComponent(Te[1]),xe=mu(pu,de);await MP(xe)}}catch(B){console.error("Error deleting file from storage:",B)}k(null)}catch(G){console.error("Error deleting message:",G),f("حدث خطأ في حذف الرسالة")}},T=()=>{k(null)},O=async M=>{if(t)try{const G=Zt(he,"chat_messages",M),ne=await Dt(G);if(ne.exists()){const pe=ne.data().seen_by||[];pe.includes(t.id)||await sr(G,{seen_by:[...pe,t.id]})}}catch(G){console.error("Error marking message as seen:",G)}},W=async M=>{try{const G=Zt(he,"chat_messages",M),ne=await Dt(G);if(ne.exists()){const pe=ne.data().seen_by||[],ye=[];for(const Te of pe){const de=Zt(he,"users",Te),xe=await Dt(de);if(xe.exists()){const We=xe.data();ye.push({id:Te,name:We.name||"مستخدم غير معروف",avatar_url:We.avatar_url,role:We.role})}}L(ye),A(M)}}catch(G){console.error("Error fetching seen by users:",G)}},z=()=>{A(null),L([])},te=M=>M.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit",hour12:!0,calendar:"gregory"}),ae=M=>M.toLocaleDateString("ar-SA",{weekday:"long",year:"numeric",month:"long",day:"numeric",calendar:"gregory"}),se={};return r.forEach(M=>{const G=ae(M.created_at);se[G]||(se[G]=[]),se[G].push(M)}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg flex flex-col h-[600px]",children:[n.jsx("div",{className:"p-4 border-b border-gray-200",children:n.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(dt,{className:"w-5 h-5 text-blue-600"}),"محادثة الفريق"]})}),n.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:o?n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):u?n.jsx("div",{className:"flex items-center justify-center h-full text-red-500",children:u}):r.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[n.jsx(js,{className:"w-12 h-12 text-gray-300 mb-2"}),n.jsx("p",{children:"لا توجد رسائل بعد"}),n.jsx("p",{className:"text-sm",children:"ابدأ المحادثة مع فريق المشروع"})]}):n.jsxs("div",{className:"space-y-6",children:[Object.entries(se).map(([M,G])=>n.jsxs("div",{children:[n.jsx("div",{className:"flex justify-center mb-4",children:n.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:M})}),n.jsx("div",{className:"space-y-4",children:G.map(ne=>{var B,pe;return n.jsx(re.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:`flex ${ne.user_id===(t==null?void 0:t.id)?"justify-end":"justify-start"}`,children:n.jsxs("div",{className:`flex gap-3 max-w-[80%] ${ne.user_id===(t==null?void 0:t.id)?"flex-row-reverse":""}`,children:[n.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 overflow-hidden",children:(B=ne.user)!=null&&B.avatar_url?n.jsx("img",{src:ne.user.avatar_url,alt:ne.user.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:`w-full h-full ${ne.user_id===(t==null?void 0:t.id)?"bg-blue-500":"bg-gradient-to-r from-purple-500 to-pink-500"} flex items-center justify-center`,children:n.jsx(Xt,{className:"w-4 h-4 text-white"})})}),n.jsxs("div",{className:"relative group",children:[n.jsxs("div",{className:`rounded-2xl p-4 ${ne.user_id===(t==null?void 0:t.id)?"bg-blue-500 text-white":"bg-gray-100 text-gray-800"}`,children:[ne.user_id!==(t==null?void 0:t.id)&&n.jsx("p",{className:"font-medium text-sm mb-1",children:((pe=ne.user)==null?void 0:pe.name)||"مستخدم غير معروف"}),N===ne.id?n.jsxs("div",{className:"mb-2",children:[n.jsx("textarea",{value:w,onChange:ye=>_(ye.target.value),className:`w-full p-2 rounded border ${ne.user_id===(t==null?void 0:t.id)?"bg-blue-50 text-gray-800 border-blue-300":"bg-white border-gray-300"}`,rows:2}),n.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[n.jsx("button",{onClick:()=>F(ne.id),className:"p-1 bg-green-500 text-white rounded",children:n.jsx(JC,{className:"w-4 h-4"})}),n.jsx("button",{onClick:U,className:"p-1 bg-gray-500 text-white rounded",children:n.jsx(Qe,{className:"w-4 h-4"})})]})]}):n.jsxs(n.Fragment,{children:[ne.message_type==="text"&&n.jsx("p",{className:"whitespace-pre-line",children:ne.message}),ne.message_type==="image"&&ne.media_url&&n.jsxs("div",{className:"mb-2",children:[n.jsx("img",{src:ne.media_url,alt:"صورة",className:"rounded-lg max-w-full max-h-60 object-contain"}),ne.message&&n.jsx("p",{className:"mt-2",children:ne.message})]}),ne.message_type==="video"&&ne.media_url&&n.jsxs("div",{className:"mb-2",children:[n.jsx("video",{src:ne.media_url,controls:!0,className:"rounded-lg max-w-full max-h-60"}),ne.message&&n.jsx("p",{className:"mt-2",children:ne.message})]}),ne.message_type==="file"&&ne.media_url&&n.jsxs("div",{className:"mb-2",children:[n.jsxs("a",{href:ne.media_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 bg-white bg-opacity-20 p-2 rounded-lg",children:[n.jsx(s1,{className:"w-4 h-4"}),n.jsx("span",{className:"truncate",children:"تحميل الملف"})]}),ne.message&&n.jsx("p",{className:"mt-2",children:ne.message})]})]}),n.jsxs("div",{className:`flex items-center justify-between text-xs mt-2 ${ne.user_id===(t==null?void 0:t.id)?"text-blue-100":"text-gray-500"}`,children:[n.jsxs("span",{children:[te(ne.created_at),ne.updated_at&&" (معدل)"]}),ne.user_id===(t==null?void 0:t.id)&&ne.seen_by&&ne.seen_by.length>1&&n.jsxs("button",{onClick:()=>W(ne.id),className:"flex items-center gap-1 hover:underline",children:[n.jsx(mr,{className:"w-3 h-3"}),ne.seen_by.length-1]})]})]}),ne.user_id===(t==null?void 0:t.id)&&n.jsx("div",{className:"absolute top-2 left-2 opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsxs("div",{className:"relative",children:[n.jsx("button",{className:`p-1 rounded-full ${ne.user_id===(t==null?void 0:t.id)?"bg-blue-400 hover:bg-blue-600":"bg-gray-200 hover:bg-gray-300"} text-white`,children:n.jsx(Rf,{className:"w-3 h-3"})}),n.jsxs("div",{className:"absolute left-0 top-full mt-1 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10 hidden group-hover:block",children:[n.jsxs("button",{onClick:()=>V(ne.id,ne.message),className:"flex items-center gap-2 px-3 py-1 hover:bg-gray-100 w-full text-right text-sm text-gray-700",children:[n.jsx(Ia,{className:"w-3 h-3"}),"تعديل"]}),n.jsxs("button",{onClick:()=>q(ne.id),className:"flex items-center gap-2 px-3 py-1 hover:bg-gray-100 w-full text-right text-sm text-red-600",children:[n.jsx(nr,{className:"w-3 h-3"}),"حذف"]})]})]})})]})]})},ne.id)})})]},M)),n.jsx("div",{ref:b})]})}),S&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"تأكيد الحذف"}),n.jsx("p",{className:"text-gray-600 mb-6",children:"هل أنت متأكد من حذف هذه الرسالة؟ لا يمكن التراجع عن هذا الإجراء."}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:T,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:()=>K(S),className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"حذف"})]})]})}),E&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"شاهد الرسالة"}),n.jsx("button",{onClick:z,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),n.jsx("div",{className:"max-h-60 overflow-y-auto",children:P.length>0?n.jsx("div",{className:"space-y-3",children:P.map(M=>n.jsxs("div",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden",children:M.avatar_url?n.jsx("img",{src:M.avatar_url,alt:M.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full bg-gray-300 flex items-center justify-center",children:n.jsx(Xt,{className:"w-4 h-4 text-gray-600"})})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:M.name}),n.jsx("p",{className:"text-xs text-gray-500",children:M.role||"مستخدم"})]})]},M.id))}):n.jsx("p",{className:"text-center text-gray-500 py-4",children:"لم يشاهد أحد هذه الرسالة بعد"})})]})}),x&&n.jsx("div",{className:"px-4 py-2 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[x.type.startsWith("image/")?n.jsx(sl,{className:"w-4 h-4 text-blue-500"}):x.type.startsWith("video/")?n.jsx(ar,{className:"w-4 h-4 text-purple-500"}):n.jsx(s1,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-sm truncate max-w-[200px]",children:x.name}),g&&n.jsx("div",{className:"w-20 h-2 bg-gray-200 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-blue-500",style:{width:`${h}%`}})})]}),n.jsx("button",{onClick:D,className:"p-1 hover:bg-gray-200 rounded-full",children:n.jsx(Qe,{className:"w-4 h-4 text-gray-500"})})]})}),n.jsx("div",{className:"p-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"file",ref:y,onChange:I,className:"hidden"}),n.jsx("button",{onClick:()=>{var M;return(M=y.current)==null?void 0:M.click()},disabled:g||c,className:"p-2 rounded-full hover:bg-gray-100 transition-colors disabled:opacity-50",children:n.jsx(oE,{className:"w-5 h-5 text-gray-500"})}),n.jsx("div",{className:"flex-1 relative",children:n.jsx("input",{type:"text",value:s,onChange:M=>i(M.target.value),onKeyPress:M=>M.key==="Enter"&&!M.shiftKey&&R(),placeholder:"اكتب رسالتك هنا...",disabled:g||c,className:"w-full px-4 py-2 border border-gray-300 rounded-full focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})}),n.jsx("button",{onClick:R,disabled:!s.trim()&&!x||g||c,className:"p-2 rounded-full bg-blue-500 text-white hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:bg-gray-300",children:n.jsx(Df,{className:"w-5 h-5"})})]})})]})},Z8=({task:e,projectId:t,students:r,onClose:a,onSuccess:s})=>{const{user:i}=ut(),[o,l]=C.useState({title:e.title,description:e.description,assigned_to:e.assigned_to||"",status:e.status,priority:e.priority,start_date:e.start_date?e.start_date.split("T")[0]:new Date().toISOString().split("T")[0],due_date:e.due_date?e.due_date.split("T")[0]:""}),[c,d]=C.useState(!1),[u,f]=C.useState(null),x=(h,m)=>{l(g=>({...g,[h]:m}))},p=async h=>{if(h.preventDefault(),!o.title||!o.start_date||!o.due_date){f("يرجى إدخال عنوان المهمة وتاريخ البداية وتاريخ الاستحقاق");return}if(new Date(o.start_date)>new Date(o.due_date)){f("تاريخ البداية يجب أن يكون قبل أو يساوي تاريخ الاستحقاق");return}d(!0),f(null);try{console.log("Updating task with data:",{title:o.title,description:o.description,assigned_to:o.assigned_to||null,status:o.status,priority:o.priority,due_date:o.due_date}),await xO(e.id,{title:o.title,description:o.description,assigned_to:o.assigned_to||null,status:o.status,priority:o.priority,progress:o.status==="completed"?100:o.status==="in_progress"?50:0,start_date:o.start_date,due_date:o.due_date}),console.log("Task updated successfully"),s&&s(),setTimeout(()=>{a()},500)}catch(m){console.error("Error updating task:",m),f(m instanceof Error?m.message:"حدث خطأ في تحديث المهمة")}finally{d(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Le,{className:"w-6 h-6 text-blue-600"}),"تعديل المهمة"]}),n.jsx("button",{onClick:a,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),u&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:u})]}),n.jsxs("form",{onSubmit:p,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان المهمة *"}),n.jsx("input",{type:"text",value:o.title,onChange:h=>x("title",h.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل عنوان المهمة",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف المهمة"}),n.jsx("textarea",{value:o.description,onChange:h=>x("description",h.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اكتب وصفاً تفصيلياً للمهمة"})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تعيين إلى"}),n.jsxs("select",{value:o.assigned_to,onChange:h=>x("assigned_to",h.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"غير معين"}),r.map(h=>{var m;return n.jsxs("option",{value:h.student_id,children:[((m=h.student)==null?void 0:m.name)||"طالب غير معروف"," ",h.role==="leader"?"(قائد الفريق)":""]},h.student_id)})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ البداية *"}),n.jsxs("div",{className:"relative",children:[n.jsx(ot,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"date",value:o.start_date,onChange:h=>x("start_date",h.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الاستحقاق *"}),n.jsxs("div",{className:"relative",children:[n.jsx(ot,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"date",value:o.due_date,onChange:h=>x("due_date",h.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الحالة"}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${o.status==="pending"?"bg-yellow-50 border-yellow-500 text-yellow-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"status",value:"pending",checked:o.status==="pending",onChange:()=>x("status","pending"),className:"sr-only"}),n.jsx(xt,{className:"w-5 h-5"}),n.jsx("span",{children:"في الانتظار"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${o.status==="in_progress"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"status",value:"in_progress",checked:o.status==="in_progress",onChange:()=>x("status","in_progress"),className:"sr-only"}),n.jsx(xt,{className:"w-5 h-5"}),n.jsx("span",{children:"قيد التنفيذ"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${o.status==="completed"?"bg-green-50 border-green-500 text-green-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"status",value:"completed",checked:o.status==="completed",onChange:()=>x("status","completed"),className:"sr-only"}),n.jsx(Le,{className:"w-5 h-5"}),n.jsx("span",{children:"مكتمل"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الأولوية"}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${o.priority==="low"?"bg-green-50 border-green-500 text-green-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"priority",value:"low",checked:o.priority==="low",onChange:()=>x("priority","low"),className:"sr-only"}),n.jsx(ci,{className:"w-5 h-5"}),n.jsx("span",{children:"منخفضة"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${o.priority==="medium"?"bg-yellow-50 border-yellow-500 text-yellow-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"priority",value:"medium",checked:o.priority==="medium",onChange:()=>x("priority","medium"),className:"sr-only"}),n.jsx(ci,{className:"w-5 h-5"}),n.jsx("span",{children:"متوسطة"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${o.priority==="high"?"bg-red-50 border-red-500 text-red-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"priority",value:"high",checked:o.priority==="high",onChange:()=>x("priority","high"),className:"sr-only"}),n.jsx(ci,{className:"w-5 h-5"}),n.jsx("span",{children:"عالية"})]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:a,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:c?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري التحديث..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Le,{className:"w-5 h-5"}),"تحديث المهمة"]})})]})]})]})})},eI=({tasks:e,students:t,projectId:r,onTaskUpdated:a})=>{const{user:s}=ut(),[i,o]=C.useState(null),[l,c]=C.useState(null),d=()=>(s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="teacher"||(s==null?void 0:s.role)==="school",u=async g=>{if(window.confirm("هل أنت متأكد من حذف هذه المهمة؟")){c(g);try{await pO(g),a&&a()}catch(v){console.error("Error deleting task:",v),alert("حدث خطأ أثناء حذف المهمة")}finally{c(null)}}},f=()=>{o(null),a&&a()};console.log("TasksList component received:",{tasksCount:(e==null?void 0:e.length)||0,studentsCount:(t==null?void 0:t.length)||0});const x=Array.isArray(e)?e:[];console.log("Tasks to render:",x);const p=g=>{switch(g){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},h=g=>{switch(g){case"completed":return"مكتملة";case"in_progress":return"قيد التنفيذ";case"pending":return"في الانتظار";default:return g}},m=g=>{var v;if(!g)return"غير محدد";try{const b=t.find(N=>N.student_id===g);if((v=b==null?void 0:b.student)!=null&&v.name)return b.student.name;const y=t.find(N=>N.id===g);if(y!=null&&y.name)return y.name;if((b==null?void 0:b.student_id)===g&&(b!=null&&b.student))return b.student.name||"غير محدد"}catch(b){console.error("Error getting student name:",b,"studentId:",g,"students:",t)}return"غير محدد"};return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"space-y-4",children:x.length>0?x.map(g=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:g.title}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p(g.status)}`,children:h(g.status)}),n.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 bg-gray-100 rounded-full text-xs ${g.priority==="high"?"text-red-600":g.priority==="medium"?"text-yellow-600":"text-green-600"}`,children:[n.jsx(ci,{className:"w-4 h-4"}),n.jsx("span",{children:g.priority==="high"?"عالية":g.priority==="medium"?"متوسطة":"منخفضة"})]})]}),g.description&&n.jsx("p",{className:"text-gray-600 text-sm mb-3",children:g.description}),n.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Xt,{className:"w-3 h-3"}),n.jsxs("span",{children:["المسؤول: ",m(g.assigned_to)]})]}),g.start_date&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ot,{className:"w-3 h-3"}),n.jsxs("span",{children:["تاريخ البداية: ",Ye(g.start_date)]})]}),g.due_date&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ot,{className:"w-3 h-3"}),n.jsxs("span",{children:["تاريخ الاستحقاق: ",Ye(g.due_date)]})]})]})]}),d()&&n.jsxs("div",{className:"flex items-center gap-2 mr-2",children:[n.jsx("button",{onClick:()=>o(g),className:"p-2 rounded-lg hover:bg-blue-50 text-blue-600 transition-colors",title:"تعديل المهمة",children:n.jsx(Ia,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>u(g.id),disabled:l===g.id,className:"p-2 rounded-lg hover:bg-red-50 text-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"حذف المهمة",children:l===g.id?n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):n.jsx(nr,{className:"w-4 h-4"})})]}),g.status!=="completed"&&n.jsx("div",{className:"w-16 flex flex-col items-center",children:n.jsx("div",{className:"w-12 h-12 rounded-full border-4 border-gray-200 flex items-center justify-center",children:n.jsx("span",{className:"text-sm font-medium",children:g.status==="in_progress"?"50%":"0%"})})}),g.status==="completed"&&n.jsx("div",{className:"w-16 flex flex-col items-center",children:n.jsx("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center",children:n.jsx(Le,{className:"w-6 h-6 text-green-600"})})})]})},g.id)):n.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Le,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد مهام"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم إضافة أي مهام لهذا المشروع بعد"})]})}),i&&n.jsx(Z8,{task:i,projectId:r,students:t,onClose:()=>o(null),onSuccess:f})]})};function Kt(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Ps(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Ng(e,t){const r=Kt(e);return isNaN(t)?Ps(e,NaN):(t&&r.setDate(r.getDate()+t),r)}const UE=6048e5,tI=864e5,qE=6e4,WE=36e5;let rI={};function Uf(){return rI}function zn(e,t){var l,c,d,u;const r=Uf(),a=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.weekStartsOn)??0,s=Kt(e),i=s.getDay(),o=(i<a?7:0)+i-a;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function wu(e){return zn(e,{weekStartsOn:1})}function HE(e){const t=Kt(e),r=t.getFullYear(),a=Ps(e,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const s=wu(a),i=Ps(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=wu(i);return t.getTime()>=s.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function U1(e){const t=Kt(e);return t.setHours(0,0,0,0),t}function q1(e){const t=Kt(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function zE(e,t){const r=U1(e),a=U1(t),s=+r-q1(r),i=+a-q1(a);return Math.round((s-i)/tI)}function aI(e){const t=HE(e),r=Ps(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),wu(r)}function nI(e,t){const r=t*7;return Ng(e,r)}function sI(e){let t;return e.forEach(function(r){const a=Kt(r);(t===void 0||t<a||isNaN(Number(a)))&&(t=a)}),t||new Date(NaN)}function iI(e){let t;return e.forEach(r=>{const a=Kt(r);(!t||t>a||isNaN(+a))&&(t=a)}),t||new Date(NaN)}function oI(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function lI(e){if(!oI(e)&&typeof e!="number")return!1;const t=Kt(e);return!isNaN(Number(t))}function Bn(e,t){const r=Kt(e),a=Kt(t),s=W1(r,a),i=Math.abs(zE(r,a));r.setDate(r.getDate()-s*i);const o=+(W1(r,a)===-s),l=s*(i-o);return l===0?0:l}function W1(e,t){const r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}function z0(e){const t=Kt(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function cI(e,t){const r=Kt(e.start),a=Kt(e.end);let s=+r>+a;const i=s?+r:+a,o=s?a:r;o.setHours(0,0,0,0);let l=1;const c=[];for(;+o<=i;)c.push(Kt(o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return s?c.reverse():c}function dI(e,t){const r=Kt(e.start),a=Kt(e.end);let s=+r>+a;const i=zn(s?a:r,t),o=zn(s?r:a,t);i.setHours(15),o.setHours(15);const l=+o.getTime();let c=i,d=1;const u=[];for(;+c<=l;)c.setHours(0),u.push(Kt(c)),c=nI(c,d),c.setHours(15);return s?u.reverse():u}function H1(e){const t=Kt(e);return t.setDate(1),t.setHours(0,0,0,0),t}function uI(e){const t=Kt(e),r=Ps(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}const fI={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},hI=(e,t,r)=>{let a;const s=fI[e];return typeof s=="string"?a=s:t===1?a=s.one:a=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+a:a+" ago":a};function V0(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const mI={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},xI={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},pI={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},gI={date:V0({formats:mI,defaultWidth:"full"}),time:V0({formats:xI,defaultWidth:"full"}),dateTime:V0({formats:pI,defaultWidth:"full"})},yI={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},vI=(e,t,r,a)=>yI[e];function kl(e){return(t,r)=>{const a=r!=null&&r.context?String(r.context):"standalone";let s;if(a==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;s=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[l]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const bI={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},jI={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},wI={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},NI={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},_I={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},SI={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},kI=(e,t)=>{const r=Number(e),a=r%100;if(a>20||a<10)switch(a%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},EI={ordinalNumber:kI,era:kl({values:bI,defaultWidth:"wide"}),quarter:kl({values:jI,defaultWidth:"wide",argumentCallback:e=>e-1}),month:kl({values:wI,defaultWidth:"wide"}),day:kl({values:NI,defaultWidth:"wide"}),dayPeriod:kl({values:_I,defaultWidth:"wide",formattingValues:SI,defaultFormattingWidth:"wide"})};function El(e){return(t,r={})=>{const a=r.width,s=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const o=i[0],l=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?AI(l,f=>f.test(o)):TI(l,f=>f.test(o));let d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const u=t.slice(o.length);return{value:d,rest:u}}}function TI(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function AI(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function CI(e){return(t,r={})=>{const a=t.match(e.matchPattern);if(!a)return null;const s=a[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(s.length);return{value:o,rest:l}}}const PI=/^(\d+)(th|st|nd|rd)?/i,OI=/\d+/i,II={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},FI={any:[/^b/i,/^(a|c)/i]},DI={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},RI={any:[/1/i,/2/i,/3/i,/4/i]},MI={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},LI={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},$I={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},BI={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},UI={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},qI={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},WI={ordinalNumber:CI({matchPattern:PI,parsePattern:OI,valueCallback:e=>parseInt(e,10)}),era:El({matchPatterns:II,defaultMatchWidth:"wide",parsePatterns:FI,defaultParseWidth:"any"}),quarter:El({matchPatterns:DI,defaultMatchWidth:"wide",parsePatterns:RI,defaultParseWidth:"any",valueCallback:e=>e+1}),month:El({matchPatterns:MI,defaultMatchWidth:"wide",parsePatterns:LI,defaultParseWidth:"any"}),day:El({matchPatterns:$I,defaultMatchWidth:"wide",parsePatterns:BI,defaultParseWidth:"any"}),dayPeriod:El({matchPatterns:UI,defaultMatchWidth:"any",parsePatterns:qI,defaultParseWidth:"any"})},HI={code:"en-US",formatDistance:hI,formatLong:gI,formatRelative:vI,localize:EI,match:WI,options:{weekStartsOn:0,firstWeekContainsDate:1}};function zI(e){const t=Kt(e);return zE(t,uI(t))+1}function VI(e){const t=Kt(e),r=+wu(t)-+aI(t);return Math.round(r/UE)+1}function VE(e,t){var u,f,x,p;const r=Kt(e),a=r.getFullYear(),s=Uf(),i=(t==null?void 0:t.firstWeekContainsDate)??((f=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((p=(x=s.locale)==null?void 0:x.options)==null?void 0:p.firstWeekContainsDate)??1,o=Ps(e,0);o.setFullYear(a+1,0,i),o.setHours(0,0,0,0);const l=zn(o,t),c=Ps(e,0);c.setFullYear(a,0,i),c.setHours(0,0,0,0);const d=zn(c,t);return r.getTime()>=l.getTime()?a+1:r.getTime()>=d.getTime()?a:a-1}function GI(e,t){var l,c,d,u;const r=Uf(),a=(t==null?void 0:t.firstWeekContainsDate)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,s=VE(e,t),i=Ps(e,0);return i.setFullYear(s,0,a),i.setHours(0,0,0,0),zn(i,t)}function KI(e,t){const r=Kt(e),a=+zn(r,t)-+GI(r,t);return Math.round(a/UE)+1}function Et(e,t){const r=e<0?"-":"",a=Math.abs(e).toString().padStart(t,"0");return r+a}const ps={y(e,t){const r=e.getFullYear(),a=r>0?r:1-r;return Et(t==="yy"?a%100:a,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Et(r+1,2)},d(e,t){return Et(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Et(e.getHours()%12||12,t.length)},H(e,t){return Et(e.getHours(),t.length)},m(e,t){return Et(e.getMinutes(),t.length)},s(e,t){return Et(e.getSeconds(),t.length)},S(e,t){const r=t.length,a=e.getMilliseconds(),s=Math.trunc(a*Math.pow(10,r-3));return Et(s,t.length)}},Xi={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},z1={G:function(e,t,r){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"});case"GGGGG":return r.era(a,{width:"narrow"});case"GGGG":default:return r.era(a,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const a=e.getFullYear(),s=a>0?a:1-a;return r.ordinalNumber(s,{unit:"year"})}return ps.y(e,t)},Y:function(e,t,r,a){const s=VE(e,a),i=s>0?s:1-s;if(t==="YY"){const o=i%100;return Et(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Et(i,t.length)},R:function(e,t){const r=HE(e);return Et(r,t.length)},u:function(e,t){const r=e.getFullYear();return Et(r,t.length)},Q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return Et(a,2);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return Et(a,2);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,r){const a=e.getMonth();switch(t){case"M":case"MM":return ps.M(e,t);case"Mo":return r.ordinalNumber(a+1,{unit:"month"});case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,r){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return Et(a+1,2);case"Lo":return r.ordinalNumber(a+1,{unit:"month"});case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,r,a){const s=KI(e,a);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):Et(s,t.length)},I:function(e,t,r){const a=VI(e);return t==="Io"?r.ordinalNumber(a,{unit:"week"}):Et(a,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):ps.d(e,t)},D:function(e,t,r){const a=zI(e);return t==="Do"?r.ordinalNumber(a,{unit:"dayOfYear"}):Et(a,t.length)},E:function(e,t,r){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"});case"EEEE":default:return r.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,r,a){const s=e.getDay(),i=(s-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Et(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,a){const s=e.getDay(),i=(s-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Et(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const a=e.getDay(),s=a===0?7:a;switch(t){case"i":return String(s);case"ii":return Et(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(a,{width:"short",context:"formatting"});case"iiii":default:return r.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const a=e.getHours();let s;switch(a===12?s=Xi.noon:a===0?s=Xi.midnight:s=a/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const a=e.getHours();let s;switch(a>=17?s=Xi.evening:a>=12?s=Xi.afternoon:a>=4?s=Xi.morning:s=Xi.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let a=e.getHours()%12;return a===0&&(a=12),r.ordinalNumber(a,{unit:"hour"})}return ps.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):ps.H(e,t)},K:function(e,t,r){const a=e.getHours()%12;return t==="Ko"?r.ordinalNumber(a,{unit:"hour"}):Et(a,t.length)},k:function(e,t,r){let a=e.getHours();return a===0&&(a=24),t==="ko"?r.ordinalNumber(a,{unit:"hour"}):Et(a,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):ps.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):ps.s(e,t)},S:function(e,t){return ps.S(e,t)},X:function(e,t,r){const a=e.getTimezoneOffset();if(a===0)return"Z";switch(t){case"X":return G1(a);case"XXXX":case"XX":return Ys(a);case"XXXXX":case"XXX":default:return Ys(a,":")}},x:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"x":return G1(a);case"xxxx":case"xx":return Ys(a);case"xxxxx":case"xxx":default:return Ys(a,":")}},O:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+V1(a,":");case"OOOO":default:return"GMT"+Ys(a,":")}},z:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+V1(a,":");case"zzzz":default:return"GMT"+Ys(a,":")}},t:function(e,t,r){const a=Math.trunc(e.getTime()/1e3);return Et(a,t.length)},T:function(e,t,r){const a=e.getTime();return Et(a,t.length)}};function V1(e,t=""){const r=e>0?"-":"+",a=Math.abs(e),s=Math.trunc(a/60),i=a%60;return i===0?r+String(s):r+String(s)+t+Et(i,2)}function G1(e,t){return e%60===0?(e>0?"-":"+")+Et(Math.abs(e)/60,2):Ys(e,t)}function Ys(e,t=""){const r=e>0?"-":"+",a=Math.abs(e),s=Et(Math.trunc(a/60),2),i=Et(a%60,2);return r+s+t+i}const K1=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},GE=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},XI=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],a=r[1],s=r[2];if(!s)return K1(e,t);let i;switch(a){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",K1(a,t)).replace("{{time}}",GE(s,t))},YI={p:GE,P:XI},JI=/^D+$/,QI=/^Y+$/,ZI=["D","DD","YY","YYYY"];function eF(e){return JI.test(e)}function tF(e){return QI.test(e)}function rF(e,t,r){const a=aF(e,t,r);if(console.warn(a),ZI.includes(e))throw new RangeError(a)}function aF(e,t,r){const a=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const nF=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,sF=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,iF=/^'([^]*?)'?$/,oF=/''/g,lF=/[a-zA-Z]/;function Tl(e,t,r){var u,f,x,p;const a=Uf(),s=a.locale??HI,i=a.firstWeekContainsDate??((f=(u=a.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??1,o=a.weekStartsOn??((p=(x=a.locale)==null?void 0:x.options)==null?void 0:p.weekStartsOn)??0,l=Kt(e);if(!lI(l))throw new RangeError("Invalid time value");let c=t.match(sF).map(h=>{const m=h[0];if(m==="p"||m==="P"){const g=YI[m];return g(h,s.formatLong)}return h}).join("").match(nF).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const m=h[0];if(m==="'")return{isToken:!1,value:cF(h)};if(z1[m])return{isToken:!0,value:h};if(m.match(lF))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:h}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return c.map(h=>{if(!h.isToken)return h.value;const m=h.value;(tF(m)||eF(m))&&rF(m,t,String(e));const g=z1[m[0]];return g(l,m,s.localize,d)}).join("")}function cF(e){const t=e.match(iF);return t?t[1].replace(oF,"'"):e}function Yi(e,t){const a=hF(e);let s;if(a.date){const c=mF(a.date,2);s=xF(c.restDateString,c.year)}if(!s||isNaN(s.getTime()))return new Date(NaN);const i=s.getTime();let o=0,l;if(a.time&&(o=pF(a.time),isNaN(o)))return new Date(NaN);if(a.timezone){if(l=gF(a.timezone),isNaN(l))return new Date(NaN)}else{const c=new Date(i+o),d=new Date(0);return d.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),d.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),d}return new Date(i+o+l)}const Md={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},dF=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,uF=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,fF=/^([+-])(\d{2})(?::?(\d{2}))?$/;function hF(e){const t={},r=e.split(Md.dateTimeDelimiter);let a;if(r.length>2)return t;if(/:/.test(r[0])?a=r[0]:(t.date=r[0],a=r[1],Md.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Md.timeZoneDelimiter)[0],a=e.substr(t.date.length,e.length))),a){const s=Md.timezone.exec(a);s?(t.time=a.replace(s[1],""),t.timezone=s[1]):t.time=a}return t}function mF(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),a=e.match(r);if(!a)return{year:NaN,restDateString:""};const s=a[1]?parseInt(a[1]):null,i=a[2]?parseInt(a[2]):null;return{year:i===null?s:i*100,restDateString:e.slice((a[1]||a[2]).length)}}function xF(e,t){if(t===null)return new Date(NaN);const r=e.match(dF);if(!r)return new Date(NaN);const a=!!r[4],s=Al(r[1]),i=Al(r[2])-1,o=Al(r[3]),l=Al(r[4]),c=Al(r[5])-1;if(a)return wF(t,l,c)?yF(t,l,c):new Date(NaN);{const d=new Date(0);return!bF(t,i,o)||!jF(t,s)?new Date(NaN):(d.setUTCFullYear(t,i,Math.max(s,o)),d)}}function Al(e){return e?parseInt(e):1}function pF(e){const t=e.match(uF);if(!t)return NaN;const r=G0(t[1]),a=G0(t[2]),s=G0(t[3]);return NF(r,a,s)?r*WE+a*qE+s*1e3:NaN}function G0(e){return e&&parseFloat(e.replace(",","."))||0}function gF(e){if(e==="Z")return 0;const t=e.match(fF);if(!t)return 0;const r=t[1]==="+"?-1:1,a=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return _F(a,s)?r*(a*WE+s*qE):NaN}function yF(e,t,r){const a=new Date(0);a.setUTCFullYear(e,0,4);const s=a.getUTCDay()||7,i=(t-1)*7+r+1-s;return a.setUTCDate(a.getUTCDate()+i),a}const vF=[31,null,31,30,31,30,31,31,30,31,30,31];function KE(e){return e%400===0||e%4===0&&e%100!==0}function bF(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(vF[t]||(KE(e)?29:28))}function jF(e,t){return t>=1&&t<=(KE(e)?366:365)}function wF(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function NF(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function _F(e,t){return t>=0&&t<=59}const SF=({tasks:e,students:t})=>{const[r,a]=C.useState("week"),[s,i]=C.useState(null),o=x=>{var h;if(!x)return"غير محدد";const p=t.find(m=>m.student_id===x);return((h=p==null?void 0:p.student)==null?void 0:h.name)||"غير محدد"},l=C.useMemo(()=>{if(!e||e.length===0)return null;const x=e.filter(_=>{const S=_.start_date||_.created_at,k=_.due_date;return S&&k});if(x.length===0)return null;const p=x.map(_=>Yi(_.start_date||_.created_at)),h=x.map(_=>Yi(_.due_date)),m=iI(p),g=sI(h),v=H1(m),b=z0(Ng(g,7)),y=Bn(b,v),N=r==="day"?cI({start:v,end:b}):r==="week"?dI({start:v,end:b}):(()=>{const _=[];let S=H1(v);for(;S<=b;)_.push(S),S=Ng(z0(S),1);return _})(),j=N.map((_,S)=>{const k=Bn(_,v),E=k/y*100;let A;if(r==="day")A=1;else if(r==="week"){const L=N[S+1];A=Bn(L||b,_)}else{z0(_);const L=N[S+1];A=Bn(L||b,_)}const P=A/y*100;return{date:_,leftPercent:E,widthPercent:P,startOffset:k,duration:A}}),w=x.map(_=>{const S=Yi(_.start_date||_.created_at),k=Yi(_.due_date),E=Bn(S,v),A=Bn(k,S)||1,P=E/y*100,L=A/y*100;let R=0;return _.status==="completed"?R=100:_.status==="in_progress"&&(R=50),{task:_,leftPercent:P,widthPercent:L,progressPercent:R,startOffset:E,duration:A}});return{chartStartDate:v,chartEndDate:b,totalDays:y,timelineUnits:N,timelinePositions:j,taskBars:w,today:new Date}},[e,r,t]);if(!l)return null;const d=Bn(l.today,l.chartStartDate)/l.totalDays*100,u=(x,p=!1)=>{if(p)switch(x){case"high":return"bg-red-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-blue-500"}else switch(x){case"high":return"bg-red-100 border-red-300";case"medium":return"bg-yellow-100 border-yellow-300";case"low":return"bg-green-100 border-green-300";default:return"bg-blue-100 border-blue-300"}},f=x=>{switch(x){case"completed":return"مكتملة";case"in_progress":return"قيد التنفيذ";case"pending":return"في الانتظار";default:return x}};return n.jsxs("div",{className:"mt-8 border-t pt-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:n.jsx(ot,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"المخطط الزمني للمهام (Gantt Chart)"}),n.jsx("p",{className:"text-sm text-gray-600",children:"عرض جدولة المهام على الخط الزمني"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>a("day"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${r==="day"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"يومي"}),n.jsx("button",{onClick:()=>a("week"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${r==="week"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"أسبوعي"}),n.jsx("button",{onClick:()=>a("month"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${r==="month"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"شهري"})]})]}),n.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("div",{className:"min-w-[800px]",children:[n.jsx("div",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3",children:n.jsxs("div",{className:"flex",children:[n.jsx("div",{className:"w-64 font-semibold text-gray-700 text-sm",children:"المهمة"}),n.jsx("div",{className:"flex-1 relative",children:n.jsx("div",{className:"relative h-8",children:l.timelinePositions.map((x,p)=>n.jsxs("div",{className:"absolute top-0 h-full text-xs text-gray-600 flex items-center justify-center",style:{left:`${x.leftPercent}%`,width:`${x.widthPercent}%`},children:[n.jsxs("div",{className:"text-center py-1",children:[r==="day"&&Tl(x.date,"d MMM"),r==="week"&&Tl(x.date,"d MMM"),r==="month"&&Tl(x.date,"MMM yyyy")]}),p<l.timelinePositions.length-1&&n.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-px bg-gray-200"})]},p))})})]})}),n.jsx("div",{className:"divide-y divide-gray-100",children:l.taskBars.map(({task:x,leftPercent:p,widthPercent:h,progressPercent:m})=>n.jsxs("div",{className:"flex items-center px-4 py-4 hover:bg-gray-50 transition-colors",onMouseEnter:()=>i(x.id),onMouseLeave:()=>i(null),children:[n.jsxs("div",{className:"w-64 pr-4",children:[n.jsx("div",{className:"font-medium text-gray-800 text-sm truncate",children:x.title}),n.jsx("div",{className:"text-xs text-gray-500 mt-1",children:o(x.assigned_to)})]}),n.jsxs("div",{className:"flex-1 relative h-12",children:[l.timelinePositions.map((g,v)=>n.jsx("div",{className:"absolute top-0 bottom-0 border-r border-gray-100 last:border-r-0",style:{left:`${g.leftPercent}%`,width:`${g.widthPercent}%`}},v)),n.jsxs("div",{className:"absolute top-0 h-full",style:{left:`${Math.max(0,p)}%`,width:`${Math.min(100-Math.max(0,p),h)}%`},children:[n.jsxs("div",{className:`relative h-8 mt-2 rounded-lg border-2 ${u(x.priority)} shadow-sm hover:shadow-md transition-shadow overflow-hidden`,children:[n.jsx("div",{className:`absolute inset-0 ${u(x.priority,!0)} opacity-80`,style:{width:`${m}%`}}),n.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:n.jsxs("span",{className:"text-xs font-semibold text-gray-700 px-2 truncate z-10",children:[m,"%"]})})]}),s===x.id&&n.jsx("div",{className:"absolute top-12 left-0 z-50 bg-gray-900 text-white rounded-lg shadow-xl p-4 min-w-[280px] animate-fade-in",children:n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"font-semibold text-sm border-b border-gray-700 pb-2",children:x.title}),x.description&&n.jsx("div",{className:"text-xs text-gray-300",children:x.description}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs pt-2",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"الحالة:"}),n.jsx("span",{className:"mr-1 font-medium",children:f(x.status)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"الأولوية:"}),n.jsx("span",{className:"mr-1 font-medium",children:x.priority==="high"?"عالية":x.priority==="medium"?"متوسطة":"منخفضة"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"تاريخ البداية:"}),n.jsx("span",{className:"mr-1",children:Tl(Yi(x.start_date||x.created_at),"d/M/yyyy")})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"تاريخ الاستحقاق:"}),n.jsx("span",{className:"mr-1",children:Tl(Yi(x.due_date),"d/M/yyyy")})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("span",{className:"text-gray-400",children:"المسؤول:"}),n.jsx("span",{className:"mr-1",children:o(x.assigned_to)})]})]})]})})]}),d>=0&&d<=100&&n.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-red-500 z-10",style:{left:`${d}%`},children:n.jsx("div",{className:"absolute -top-2 -right-8 text-xs text-red-600 font-semibold whitespace-nowrap",children:"اليوم"})})]})]},x.id))})]})})}),n.jsxs("div",{className:"mt-4 flex items-center gap-6 text-sm text-gray-600",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 rounded bg-red-100 border-2 border-red-300"}),n.jsx("span",{children:"أولوية عالية"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 rounded bg-yellow-100 border-2 border-yellow-300"}),n.jsx("span",{children:"أولوية متوسطة"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 rounded bg-green-100 border-2 border-green-300"}),n.jsx("span",{children:"أولوية منخفضة"})]}),n.jsxs("div",{className:"flex items-center gap-2 mr-auto",children:[n.jsx(xt,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{children:"الشريط الملون يمثل نسبة الإنجاز"})]})]})]})},kF=({projectId:e,students:t,onClose:r,onSuccess:a})=>{const{user:s}=ut(),[i,o]=C.useState({title:"",description:"",assigned_to:"",status:"pending",priority:"medium",start_date:new Date().toISOString().split("T")[0],due_date:""}),[l,c]=C.useState(!1),[d,u]=C.useState(null),f=(p,h)=>{o(m=>({...m,[p]:h}))},x=async p=>{if(p.preventDefault(),!i.title||!i.start_date||!i.due_date){u("يرجى إدخال عنوان المهمة وتاريخ البداية وتاريخ الاستحقاق");return}if(new Date(i.start_date)>new Date(i.due_date)){u("تاريخ البداية يجب أن يكون قبل أو يساوي تاريخ الاستحقاق");return}c(!0),u(null);try{console.log("Creating task with data:",{project_id:e,title:i.title,description:i.description,assigned_to:i.assigned_to||null,status:i.status,priority:i.priority,due_date:i.due_date,created_by:s==null?void 0:s.id}),await mO({project_id:e,title:i.title,description:i.description,assigned_to:i.assigned_to||null,status:i.status,priority:i.priority,progress:i.status==="completed"?100:i.status==="in_progress"?50:0,start_date:i.start_date,due_date:i.due_date,created_by:s==null?void 0:s.id}),console.log("Task created successfully"),a&&a(),setTimeout(()=>{r()},500)}catch(h){console.error("Error creating task:",h),u(h instanceof Error?h.message:"حدث خطأ في إنشاء المهمة")}finally{c(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Le,{className:"w-6 h-6 text-blue-600"}),"إضافة مهمة جديدة"]}),n.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),d&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:d})]}),n.jsxs("form",{onSubmit:x,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان المهمة *"}),n.jsx("input",{type:"text",value:i.title,onChange:p=>f("title",p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل عنوان المهمة",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف المهمة"}),n.jsx("textarea",{value:i.description,onChange:p=>f("description",p.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اكتب وصفاً تفصيلياً للمهمة"})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تعيين إلى"}),n.jsxs("select",{value:i.assigned_to,onChange:p=>f("assigned_to",p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"غير معين"}),t.map(p=>{var h;return n.jsxs("option",{value:p.student_id,children:[((h=p.student)==null?void 0:h.name)||"طالب غير معروف"," ",p.role==="leader"?"(قائد الفريق)":""]},p.student_id)})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ البداية *"}),n.jsxs("div",{className:"relative",children:[n.jsx(ot,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"date",value:i.start_date,onChange:p=>f("start_date",p.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الاستحقاق *"}),n.jsxs("div",{className:"relative",children:[n.jsx(ot,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"date",value:i.due_date,onChange:p=>f("due_date",p.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الحالة"}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.status==="pending"?"bg-yellow-50 border-yellow-500 text-yellow-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"status",value:"pending",checked:i.status==="pending",onChange:()=>f("status","pending"),className:"sr-only"}),n.jsx(xt,{className:"w-5 h-5"}),n.jsx("span",{children:"في الانتظار"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.status==="in_progress"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"status",value:"in_progress",checked:i.status==="in_progress",onChange:()=>f("status","in_progress"),className:"sr-only"}),n.jsx(xt,{className:"w-5 h-5"}),n.jsx("span",{children:"قيد التنفيذ"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.status==="completed"?"bg-green-50 border-green-500 text-green-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"status",value:"completed",checked:i.status==="completed",onChange:()=>f("status","completed"),className:"sr-only"}),n.jsx(Le,{className:"w-5 h-5"}),n.jsx("span",{children:"مكتمل"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الأولوية"}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.priority==="low"?"bg-green-50 border-green-500 text-green-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"priority",value:"low",checked:i.priority==="low",onChange:()=>f("priority","low"),className:"sr-only"}),n.jsx(ci,{className:"w-5 h-5"}),n.jsx("span",{children:"منخفضة"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.priority==="medium"?"bg-yellow-50 border-yellow-500 text-yellow-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"priority",value:"medium",checked:i.priority==="medium",onChange:()=>f("priority","medium"),className:"sr-only"}),n.jsx(ci,{className:"w-5 h-5"}),n.jsx("span",{children:"متوسطة"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.priority==="high"?"bg-red-50 border-red-500 text-red-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"priority",value:"high",checked:i.priority==="high",onChange:()=>f("priority","high"),className:"sr-only"}),n.jsx(ci,{className:"w-5 h-5"}),n.jsx("span",{children:"عالية"})]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:l,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:l?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الإنشاء..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Le,{className:"w-5 h-5"}),"إنشاء المهمة"]})})]})]})]})})},uv=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),{user:o}=ut(),l=async()=>{if(!(!o||!o.school_id))try{a(!0);const c=await AO(o.school_id);t(c)}catch(c){i(c instanceof Error?c.message:"حدث خطأ في تحميل الطلاب")}finally{a(!1)}};return C.useEffect(()=>{o&&o.school_id&&l()},[o]),{students:e,loading:r,error:s,fetchStudents:l}},EF=({projectId:e,maxStudents:t,currentStudents:r,onClose:a,onSuccess:s})=>{const{students:i,loading:o,error:l}=uv(),[c,d]=C.useState(""),[u,f]=C.useState([]),[x,p]=C.useState(!1),[h,m]=C.useState(null),[g,v]=C.useState([]);C.useEffect(()=>{(async()=>{const S=await $f(e);v(S)})()},[e]);const b=g.map(_=>_.student_id),N=i.filter(_=>!b.includes(_.id)).filter(_=>_.name.toLowerCase().includes(c.toLowerCase())||_.email.toLowerCase().includes(c.toLowerCase())||_.grade&&_.grade.toLowerCase().includes(c.toLowerCase())),j=_=>{f(S=>S.includes(_)?S.filter(k=>k!==_):g.length+S.length>=t?S:[...S,_])},w=async()=>{if(u.length!==0){p(!0),m(null);try{for(const _ of u)await yg({project_id:e,student_id:_,role:"member",created_at:new Date().toISOString(),status:"active"});s(),a()}catch(_){console.error("Error adding students to project:",_),m(_ instanceof Error?_.message:"حدث خطأ في إضافة الطلاب")}finally{p(!1)}}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(uu,{className:"w-6 h-6 text-blue-600"}),"إضافة طلاب للمشروع"]}),n.jsx("button",{onClick:a,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),h&&n.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4",children:h}),n.jsxs("div",{className:"relative mb-4",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث بالاسم أو البريد الإلكتروني...",value:c,onChange:_=>d(_.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),u.length>0&&n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-blue-800 font-medium",children:["تم اختيار ",u.length," طالب",r.length>0&&` (${r.length} موجود بالفعل)`]}),n.jsx("button",{onClick:()=>f([]),className:"text-blue-600 hover:text-blue-800 text-sm",children:"إلغاء الكل"})]})}),n.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto mb-6",children:o?n.jsx("div",{className:"flex items-center justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):l?n.jsx("div",{className:"text-center py-8 text-red-500",children:l}):N.length>0?N.map(_=>n.jsxs("div",{className:`flex items-center gap-4 p-4 border rounded-xl transition-all cursor-pointer hover:shadow-md ${u.includes(_.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>j(_.id),children:[n.jsx("input",{type:"checkbox",checked:u.includes(_.id),onChange:()=>j(_.id),disabled:!u.includes(_.id)&&r.length+u.length>=t,className:"text-blue-600"}),n.jsx("img",{src:_.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:_.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:_.name}),u.includes(_.id)&&n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"محدد"})]}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ma,{className:"w-4 h-4"}),_.email]}),_.grade&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(vi,{className:"w-4 h-4"}),_.grade]})]})]})]},_.id)):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(dt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا يوجد طلاب"}),n.jsx("p",{className:"text-gray-600",children:c?"لم يتم العثور على طلاب يطابقون البحث":"لا يوجد طلاب متاحين للإضافة"})]})}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"معلومات مهمة:"}),n.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[n.jsxs("li",{children:["• يمكنك اختيار حتى ",t-r.length," طلاب إضافيين"]}),n.jsxs("li",{children:["• يوجد حالياً ",r.length," طالب في المشروع"]}),n.jsxs("li",{children:["• الحد الأقصى للطلاب في هذا المشروع هو ",t]}),n.jsx("li",{children:"• يمكنك تعديل دور الطالب لاحقاً (قائد/عضو)"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:a,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:w,disabled:u.length===0||x,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:x?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الإضافة..."]}):n.jsxs(n.Fragment,{children:[n.jsx(uu,{className:"w-5 h-5"}),"إضافة الطلاب (",u.length,")"]})})]})]})})},TF=({studentName:e,studentRole:t,isLeader:r,onConfirm:a,onCancel:s,isRemoving:i})=>n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:n.jsx(Ge,{className:"w-6 h-6 text-red-600"})}),n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"إزالة طالب من المشروع"})]}),n.jsx("button",{onClick:s,disabled:i,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("p",{className:"text-gray-700 mb-4",children:["هل أنت متأكد من إزالة ",n.jsx("span",{className:"font-semibold",children:e})," من المشروع؟"]}),r&&n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-yellow-800 font-medium text-sm",children:"تحذير: هذا الطالب هو قائد الفريق"}),n.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"قد تحتاج إلى تعيين قائد جديد للفريق بعد إزالة هذا الطالب."})]})]})}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"سيتم:"}),n.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[n.jsx("li",{children:"• إزالة الطالب من قائمة أعضاء المشروع"}),n.jsx("li",{children:"• إلغاء تعيين جميع المهام المرتبطة بهذا الطالب"}),n.jsx("li",{children:"• عدم إمكانية الطالب من الوصول إلى محادثة المشروع"})]})]}),n.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"يمكنك إعادة إضافة الطالب لاحقاً إذا لزم الأمر."})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:s,disabled:i,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"إلغاء"}),n.jsx("button",{onClick:a,disabled:i,className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:i?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الإزالة..."]}):n.jsxs(n.Fragment,{children:[n.jsx(lE,{className:"w-5 h-5"}),"نعم، إزالة الطالب"]})})]})]})}),XE=e=>{const[t,r]=C.useState(null),[a,s]=C.useState(!0),[i,o]=C.useState(null),[l,c]=C.useState(null),[d,u]=C.useState(!1),f=async()=>{if(e)try{s(!0);const g=Me(Oe(he,"project_evaluations"),De("projectId","==",e)),v=await Ie(g);if(v.empty){const y={id:"",projectId:e,criteria:[{id:"1",name:"نسبة الإنجاز",weight:.4,score:0,maxScore:10},{id:"2",name:"جودة العمل",weight:.2,score:0,maxScore:10},{id:"3",name:"التواصل والتعاون",weight:.15,score:0,maxScore:10},{id:"4",name:"الإبداع والابتكار",weight:.15,score:0,maxScore:10},{id:"5",name:"جودة العرض والتوثيق",weight:.1,score:0,maxScore:10}],feedback:"",totalScore:0,percentage:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:""};c(y),u(!1)}else{const b=v.docs[0],y={id:b.id,...b.data()};y&&(r(y),c(y),u(!0))}}catch(g){console.error("Error fetching evaluation:",g),o("حدث خطأ في تحميل التقييم")}finally{s(!1)}},x=g=>{const v=g.reduce((N,j)=>N+j.score,0),b=g.reduce((N,j)=>N+j.maxScore,0),y=b>0?v/b*100:0;return{total:v,percentage:y}},p=(g,v,b)=>{if(!l)return;const y=[...l.criteria];y[g]={...y[g],score:v,comments:b!==void 0?b:y[g].comments},c({...l,criteria:y})},h=g=>{l&&c({...l,feedback:g})},m=async()=>{if(!(!e||!l))try{const g=l.criteria.find(w=>w.name==="نسبة الإنجاز"),v=g?g.score:0,{total:b,percentage:y}=x(l.criteria),N=l.criteria.map(w=>({...w,description:w.description||null,comments:w.comments||null}));if(d){const w=st(he,"project_evaluations",l.id);await sr(w,{criteria:N,feedback:l.feedback,totalScore:b,percentage:y,updatedAt:Ve()})}else{const w={projectId:e,criteria:N,feedback:l.feedback,totalScore:b,percentage:y,createdAt:Ve(),updatedAt:Ve(),createdBy:null},_=await Fa(Oe(he,"project_evaluations"),w);u(!0),l.id=_.id}const j=st(he,"projects",e);return await sr(j,{progress:v,updated_at:Ve()}),await f(),!0}catch(g){throw console.error("Error saving evaluation:",g),g}};return C.useEffect(()=>{f()},[e]),{evaluation:t,currentEvaluation:l,loading:a,error:i,evaluationExists:d,updateCriterionScore:p,updateFeedback:h,saveEvaluation:m,calculateTotalScore:x}},AF=({projectId:e,onSaved:t})=>{const{t:r}=ft(),{currentEvaluation:a,loading:s,error:i,updateCriterionScore:o,updateFeedback:l,saveEvaluation:c}=XE(e),[d,u]=C.useState(!1),[f,x]=C.useState(null),[p,h]=C.useState(!1),m=(N,j)=>{o(N,j)},g=(N,j)=>{o(N,(a==null?void 0:a.criteria[N].score)||0,j)},v=N=>{l(N)},b=async N=>{N.preventDefault(),u(!0),x(null),h(!1);try{const j=await c();h(!0),j&&t&&t(),setTimeout(()=>{h(!1)},3e3)}catch(j){console.error("Error saving evaluation:",j),x(j instanceof Error?j.message:"حدث خطأ في حفظ التقييم")}finally{u(!1)}},y=N=>{switch(N){case"نسبة الإنجاز":return n.jsx(Mf,{className:"w-5 h-5"});case"جودة العمل":return n.jsx(lr,{className:"w-5 h-5"});case"التواصل والتعاون":return n.jsx(dt,{className:"w-5 h-5"});case"الإبداع والابتكار":return n.jsx(jr,{className:"w-5 h-5"});case"جودة العرض والتوثيق":return n.jsx(Ts,{className:"w-5 h-5"});default:return n.jsx(lt,{className:"w-5 h-5"})}};return s?n.jsx("div",{className:"flex items-center justify-center p-8",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):i?n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 text-red-700",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Ge,{className:"w-5 h-5"}),n.jsx("p",{className:"font-medium",children:"حدث خطأ"})]}),n.jsx("p",{children:i})]}):a?n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx(lr,{className:"w-6 h-6 text-blue-600"}),"تقييم المشروع"]}),p&&n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 text-green-700 mb-6",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Le,{className:"w-5 h-5"}),n.jsx("p",{children:"تم حفظ التقييم بنجاح"})]})}),f&&n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 text-red-700 mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Ge,{className:"w-5 h-5"}),n.jsx("p",{className:"font-medium",children:"حدث خطأ"})]}),n.jsx("p",{children:f})]}),n.jsxs("form",{onSubmit:b,children:[n.jsx("div",{className:"mb-6 text-center",children:n.jsxs("div",{className:"w-32 h-32 bg-blue-50 rounded-full flex flex-col items-center justify-center mx-auto",children:[n.jsxs("span",{className:"text-3xl font-bold text-blue-600",children:[a.criteria.reduce((N,j)=>N+j.score*j.weight,0).toFixed(2),"/10"]}),n.jsx("span",{className:"text-sm text-blue-600",children:"الدرجة الموزونة"})]})}),n.jsxs("div",{className:"space-y-6 mb-8",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-4",children:"معايير التقييم"}),a.criteria.map((N,j)=>n.jsxs("div",{className:"border border-gray-200 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[y(N.name),n.jsx("h5",{className:"font-medium text-gray-800",children:N.name}),n.jsxs("span",{className:"text-sm text-gray-500",children:["(",N.weight*100,"%)"]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"font-bold text-blue-600",children:N.score}),n.jsxs("span",{className:"text-gray-500",children:["/ ",N.maxScore]})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("input",{type:"range",min:"0",max:N.maxScore,step:"0.5",value:N.score,onChange:w=>m(j,parseFloat(w.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[n.jsx("span",{children:"0"}),n.jsx("span",{children:N.maxScore/4}),n.jsx("span",{children:N.maxScore/2}),n.jsx("span",{children:N.maxScore*3/4}),n.jsx("span",{children:N.maxScore})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ملاحظات"}),n.jsx("textarea",{value:N.comments,onChange:w=>g(j,w.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"أضف ملاحظاتك حول هذا المعيار..."})]})]},j))]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("label",{className:"block font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx(Hr,{className:"w-5 h-5 text-blue-600"}),"التعليق العام"]}),n.jsx("textarea",{value:a.feedback,onChange:N=>v(N.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أضف تعليقك العام على المشروع وتوصياتك للطلاب..."})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"submit",disabled:d,className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:d?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Za,{className:"w-5 h-5"}),"حفظ التقييم"]})})})]})]}):n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 text-yellow-700",children:n.jsx("p",{children:"لا يمكن تحميل نموذج التقييم. يرجى المحاولة مرة أخرى لاحقاً."})})},CF=({evaluation:e,teacherName:t="المشرف"})=>{const{t:r}=ft(),a=o=>new Date(o).toLocaleDateString("ar-SA",{year:"numeric",month:"long",day:"numeric"}),s=o=>{switch(o){case"نسبة الإنجاز":return n.jsx(Mf,{className:"w-4 h-4"});case"جودة العمل":return n.jsx(lr,{className:"w-4 h-4"});case"التواصل والتعاون":return n.jsx(dt,{className:"w-4 h-4"});case"الإبداع والابتكار":return n.jsx(jr,{className:"w-4 h-4"});case"جودة العرض والتوثيق":return n.jsx(Ts,{className:"w-4 h-4"});default:return n.jsx(lt,{className:"w-4 h-4"})}},i=(o,l)=>{const c=o/l*100;return c>=90?"text-green-600":c>=75?"text-blue-600":c>=60?"text-yellow-600":"text-red-600"};return n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(lr,{className:"w-6 h-6 text-blue-600"}),"ملخص التقييم"]}),n.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[n.jsx(ot,{className:"w-4 h-4"}),a(e.updatedAt)]})]}),n.jsx("div",{className:"flex items-center justify-center mb-6",children:n.jsxs("div",{className:"w-32 h-32 bg-blue-50 rounded-full flex flex-col items-center justify-center",children:[n.jsxs("span",{className:"text-3xl font-bold text-blue-600",children:[e.criteria[0].score,"/10"]}),n.jsx("span",{className:"text-sm text-blue-600",children:r("common.progressScore")})]})}),n.jsxs("div",{className:"space-y-4 mb-6",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"تفاصيل التقييم"}),e.criteria.map((o,l)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[s(o.name),n.jsx("span",{className:"font-medium text-gray-800",children:o.name})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:`font-bold ${i(o.score,o.maxScore)}`,children:o.score}),n.jsxs("span",{className:"text-gray-500",children:["/ ",o.maxScore]})]})]},l))]}),e.feedback&&n.jsxs("div",{className:"mb-4",children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx(Hr,{className:"w-5 h-5 text-blue-600"}),"التعليق العام"]}),n.jsx("div",{className:"bg-gray-50 p-4 rounded-xl",children:n.jsx("span",{className:"text-sm text-blue-600",children:r("common.progressScore")})})]}),n.jsxs("div",{className:"text-sm text-gray-500 text-left",children:["تم التقييم بواسطة: ",t]})]})},PF=({projectId:e,onClose:t,onSuccess:r})=>{const[a,s]=C.useState(null),[i,o]=C.useState(0),[l,c]=C.useState(!1),[d,u]=C.useState(null),[f,x]=C.useState(null),p=C.useRef(null),h=v=>{v.target.files&&v.target.files.length>0&&(s(v.target.files[0]),u(null),x(null))},m=async()=>{if(!a){u("الرجاء اختيار ملف للرفع.");return}c(!0),u(null),x(null);try{const{downloadURL:v,fileType:b}=await uO(a,e,y=>o(y));await NE(e,{name:a.name,url:v,type:b,uploadedBy:"user_id_placeholder",uploadedAt:new Date().toISOString()}),x("تم رفع الملف بنجاح!"),r(),setTimeout(t,1500)}catch(v){console.error("Error uploading file:",v),u(v instanceof Error?v.message:"حدث خطأ أثناء رفع الملف.")}finally{c(!1),o(0),s(null),p.current&&(p.current.value="")}},g=v=>v?v.type.startsWith("image/")?n.jsx(sl,{className:"w-16 h-16 text-blue-500"}):v.type.startsWith("video/")?n.jsx(ar,{className:"w-16 h-16 text-purple-500"}):n.jsx(cr,{className:"w-16 h-16 text-gray-500"}):n.jsx(cr,{className:"w-16 h-16 text-gray-400"});return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Pn,{className:"w-6 h-6 text-blue-600"}),"رفع ملف جديد"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),d&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:d})]}),f&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Le,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:f})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center cursor-pointer hover:border-blue-500 transition-colors",onClick:()=>{var v;return(v=p.current)==null?void 0:v.click()},children:[g(a),n.jsx("h4",{className:"font-medium text-gray-800 mt-4 mb-2",children:a?a.name:"اسحب وأفلت الملف هنا أو اضغط للاختيار"}),n.jsx("p",{className:"text-gray-600 text-sm",children:a?`الحجم: ${(a.size/1024/1024).toFixed(2)} MB`:"الحد الأقصى للحجم: 20MB"}),n.jsx("input",{type:"file",ref:p,onChange:h,className:"hidden"})]}),l&&n.jsxs("div",{className:"mt-4",children:[n.jsxs("div",{className:"flex justify-between mb-1",children:[n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"جاري الرفع..."}),n.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[i.toFixed(0),"%"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:n.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${i}%`}})})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",disabled:l,children:"إلغاء"}),n.jsx("button",{type:"button",onClick:m,disabled:!a||l,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:l?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الرفع..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Pn,{className:"w-5 h-5"}),"رفع الملف"]})})]})]})})},OF=()=>{var Nt;const{t:e}=ft(),{id:t}=hE(),{user:r}=ut(),[a,s]=C.useState(null),[i,o]=C.useState(!0),[l,c]=C.useState(null),[d,u]=C.useState([]),[f,x]=C.useState([]),[p,h]=C.useState("overview"),[m,g]=C.useState(!1),[v,b]=C.useState(!1),[y,N]=C.useState(!1),[j,w]=C.useState(null),[_,S]=C.useState(!1),[k,E]=C.useState(null),[A,P]=C.useState(null),{evaluation:L}=XE(t),[R,I]=C.useState(!1),[D,V]=C.useState(0),[F,U]=C.useState(!1),[q,K]=C.useState(0);r==null||r.role,r==null||r.role;const T=(r==null?void 0:r.role)==="school",O=(r==null?void 0:r.role)==="admin",W=(a==null?void 0:a.teacher_id)===(r==null?void 0:r.id);d.some(_e=>_e.student_id===(r==null?void 0:r.id));const z=O||W||T&&(a==null?void 0:a.school_id)===(r==null?void 0:r.id),te=async _e=>{var He;try{console.log("Fetching evaluation for project details:",_e);const Ft=Oe(he,"project_evaluations"),_r=Me(Ft,De("projectId","==",_e)),Ut=await Ie(_r);if(console.log("Project details evaluation query result:",Ut.size,"documents"),Ut.empty)console.log("Project details no evaluation found for project:",_e);else{const na=Ut.docs[0].data();console.log("Project details evaluation data:",na);const sn=(He=na.criteria)==null?void 0:He.find(Mt=>(console.log("Project details checking criterion:",Mt.name,"against نسبة الإنجاز"),Mt.name==="نسبة الإنجاز"));if(console.log("Project details progress criterion found:",sn),sn){const Mt=sn.score||0;return console.log("Project details setting progress to:",Mt),K(Mt),Mt}else console.log("Project details no progress criterion found"),na.criteria&&console.log("Project details available criteria names:",na.criteria.map(Mt=>Mt.name))}return K(0),0}catch(Ft){return console.error("Error fetching project evaluation:",Ft),K(0),0}},ae=async()=>{if(t)try{o(!0),c(null),console.log("Fetching project details for ID:",t);const _e=await wE(t);if(!_e){c("المشروع غير موجود"),o(!1);return}console.log("Project data fetched successfully:",_e),s(_e);const He=await $f(t);console.log("Project students fetched:",He),u(He),console.log("Fetching tasks for project ID:",t);const Ft=await hO(t);console.log("Project tasks fetched:",Ft),x(Ft),await te(t),o(!1)}catch(_e){console.error("Error fetching project details:",_e),c(_e instanceof Error?_e.message:"حدث خطأ في تحميل بيانات المشروع"),o(!1)}};C.useEffect(()=>{ae()},[t,D]);const se=()=>{V(_e=>_e+1)},M=()=>{ae()},G=()=>{I(!0),ae()},ne=()=>{ae()},B=_e=>{w(_e),N(!0),E(null),P(null)},pe=async()=>{var _e;if(!(!j||!t)){S(!0),E(null);try{await _E(t,j.student_id),P(`تمت إزالة ${((_e=j.student)==null?void 0:_e.name)||"الطالب"} من المشروع بنجاح`),N(!1),w(null),await ae(),setTimeout(()=>{P(null)},3e3)}catch(He){console.error("Error removing student from project:",He),E(He instanceof Error?He.message:"حدث خطأ في إزالة الطالب من المشروع")}finally{S(!1)}}},ye=()=>{N(!1),w(null),E(null)},Te=_e=>{switch(_e){case"draft":return e("projects.statuses.draft");case"active":return e("projects.statuses.active");case"completed":return e("projects.statuses.completed");case"archived":return e("projects.statuses.archived");default:return _e}},de=_e=>{switch(_e){case"draft":return"bg-gray-100 text-gray-800";case"active":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"archived":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},xe=_e=>{switch(_e){case"stem":return e("projects.categories.stem");case"entrepreneurship":return e("projects.categories.entrepreneurship");case"volunteer":return e("projects.categories.volunteer");case"ethics":return e("projects.categories.ethics");default:return _e}},We=_e=>{switch(_e){case"beginner":return e("projectIdeas.difficulties.beginner");case"intermediate":return e("projectIdeas.difficulties.intermediate");case"advanced":return e("projectIdeas.difficulties.advanced");default:return _e}};return i?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):l?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ge,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:l})]})}):a?n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx(ke,{to:"/projects",className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Cn,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:a.title}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${de(a.status)}`,children:Te(a.status)})]}),n.jsx("p",{className:"text-gray-600",children:a.description})]})]}),z&&n.jsxs(ke,{to:`/projects/${t}/edit`,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(Ia,{className:"w-5 h-5"}),e("common.edit")]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[n.jsx("div",{className:"bg-blue-50 rounded-xl p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:n.jsx(dt,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold text-gray-800",children:d.length}),n.jsx("div",{className:"text-sm text-gray-600",children:e("projects.students")})]})]})}),n.jsx("div",{className:"bg-green-50 rounded-xl p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:n.jsx(Le,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold text-gray-800",children:f.filter(_e=>_e.status==="completed").length}),n.jsx("div",{className:"text-sm text-gray-600",children:"مهام مكتملة"})]})]})}),n.jsx("div",{className:"bg-yellow-50 rounded-xl p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center",children:n.jsx(xt,{className:"w-5 h-5 text-yellow-600"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold text-gray-800",children:a.due_date?wn(a.due_date)<0?e("projects.overdue"):`${wn(a.due_date)} ${e("projects.days")}`:e("common.notSpecified")}),n.jsx("div",{className:"text-sm text-gray-600",children:e("projects.remaining")})]})]})}),n.jsx("div",{className:"bg-purple-50 rounded-xl p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(lr,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[L?L.criteria.reduce((_e,He)=>_e+He.score*He.weight,0).toFixed(2):"0.00","/10"]}),n.jsx("div",{className:"text-sm text-gray-600",children:e("common.weightedScore")})]})]})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium text-gray-700",children:e("common.progress")}),n.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["نسبة الإنجاز: ",q,"/10"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:n.jsx("div",{className:`h-2.5 rounded-full transition-all duration-300 ${q>=8?"bg-green-500":q>=5?"bg-blue-500":"bg-yellow-500"}`,style:{width:`${q/10*100}%`}})})]}),n.jsx("div",{className:"border-b border-gray-200",children:n.jsxs("nav",{className:"flex space-x-8 overflow-x-auto whitespace-nowrap",children:[n.jsx("button",{onClick:()=>h("overview"),className:`py-4 px-1 border-b-2 font-medium text-sm flex-shrink-0 ${p==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(cr,{className:"w-5 h-5"}),e("common.overview","نظرة عامة")]})}),n.jsx("button",{onClick:()=>h("team"),className:`py-4 px-1 border-b-2 font-medium text-sm flex-shrink-0 ${p==="team"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(dt,{className:"w-5 h-5"}),e("common.team","فريق العمل")]})}),n.jsx("button",{onClick:()=>h("tasks"),className:`py-4 px-1 border-b-2 font-medium text-sm flex-shrink-0 ${p==="tasks"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Le,{className:"w-5 h-5"}),e("common.tasks","المهام")]})}),n.jsx("button",{onClick:()=>h("evaluation"),className:`py-4 px-1 border-b-2 font-medium text-sm flex-shrink-0 ${p==="evaluation"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(lr,{className:"w-5 h-5"}),e("common.evaluation","التقييم")]})}),n.jsx("button",{onClick:()=>h("chat"),className:`py-4 px-1 border-b-2 font-medium text-sm flex-shrink-0 ${p==="chat"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(rr,{className:"w-5 h-5"}),e("common.chat","المحادثة")]})}),n.jsx("button",{onClick:()=>h("resources"),className:`py-4 px-1 border-b-2 font-medium text-sm flex-shrink-0 ${p==="resources"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx($0,{className:"w-5 h-5"}),e("common.files","الملفات")]})})]})})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},children:[p==="overview"&&n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx(cr,{className:"w-6 h-6 text-blue-600"}),e("common.overview","نظرة عامة")]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:e("common.projectInfo","معلومات المشروع")}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:e("common.category","الفئة")}),n.jsx("p",{className:"font-medium text-gray-800",children:xe(a.category)})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:e("common.subject","الموضوع/المادة")}),n.jsx("p",{className:"font-medium text-gray-800",children:a.subject||e("common.notSpecified","غير محدد")})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:e("common.difficulty","مستوى الصعوبة")}),n.jsx("p",{className:"font-medium text-gray-800",children:We(a.difficulty)})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:e("common.duration","المدة المتوقعة")}),n.jsx("p",{className:"font-medium text-gray-800",children:a.duration||e("common.notSpecified","غير محدد")})]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:e("common.dates","التواريخ")}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:e("common.createdAt","تاريخ الإنشاء")}),n.jsx("p",{className:"font-medium text-gray-800",children:Ye(a.created_at)})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:e("common.updatedAt","آخر تحديث")}),n.jsx("p",{className:"font-medium text-gray-800",children:Ye(a.updated_at)})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:e("common.deadline","الموعد النهائي")}),n.jsx("p",{className:"font-medium text-gray-800",children:a.due_date?Ye(a.due_date):e("common.notSpecified","غير محدد")})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:e("common.remaining","المتبقي")}),n.jsx("p",{className:`font-medium ${a.due_date&&wn(a.due_date)<0?"text-red-600":a.due_date&&wn(a.due_date)<=7?"text-yellow-600":"text-green-600"}`,children:a.due_date?wn(a.due_date)<0?e("projects.overdue","متأخر"):`${wn(a.due_date)} ${e("projects.days","يوم")}`:e("common.notSpecified","غير محدد")})]})]})]})]}),a.objectives&&a.objectives.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:e("common.objectives","أهداف المشروع")}),n.jsx("div",{className:"space-y-2",children:a.objectives.map((_e,He)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center mt-0.5",children:n.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full"})}),n.jsx("p",{className:"text-gray-700",children:_e})]},He))})]}),a.materials&&a.materials.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:e("common.materials","المواد والأدوات المطلوبة")}),n.jsx("div",{className:"grid md:grid-cols-2 gap-2",children:a.materials.map((_e,He)=>n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),n.jsx("span",{className:"text-gray-700",children:_e})]},He))})]}),a.steps&&a.steps.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:e("common.implementationSteps","خطوات تنفيذ المشروع")}),n.jsx("div",{className:"space-y-3",children:a.steps.map((_e,He)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:He+1}),n.jsx("div",{className:"bg-gray-50 p-3 rounded-lg flex-1",children:n.jsx("p",{className:"text-gray-700",children:_e})})]},He))})]})]}),p==="team"&&n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(dt,{className:"w-6 h-6 text-blue-600"}),e("common.team","فريق العمل")]}),z&&n.jsxs("button",{onClick:()=>b(!0),className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5"}),e("common.addStudents","إضافة طلاب")]})]}),A&&n.jsxs(re.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0},className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-4 flex items-center gap-2",children:[n.jsx(Le,{className:"w-5 h-5"}),A]}),k&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4 flex items-center gap-2",children:[n.jsx(Ge,{className:"w-5 h-5"}),k]}),d.length>0?n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(_e=>{var He,Ft,_r,Ut;return n.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all relative group",children:[z&&n.jsx("button",{onClick:()=>B(_e),className:"absolute top-3 left-3 p-2 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 transition-colors opacity-0 group-hover:opacity-100",title:"إزالة الطالب من المشروع",children:n.jsx(lE,{className:"w-4 h-4"})}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("img",{src:((He=_e.student)==null?void 0:He.avatar_url)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:((Ft=_e.student)==null?void 0:Ft.name)||"طالب",className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:((_r=_e.student)==null?void 0:_r.name)||"طالب غير معروف"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${_e.role==="leader"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:_e.role==="leader"?e("common.teamLeader","قائد الفريق"):e("common.member","عضو")}),n.jsx("span",{className:"text-xs text-gray-500",children:((Ut=_e.student)==null?void 0:Ut.grade)||""})]})]})]})]},_e.id)})}):n.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(dt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:e("common.noStudents","لا يوجد طلاب")}),n.jsx("p",{className:"text-gray-600",children:e("common.noStudentsInProject","لم يتم إضافة طلاب إلى هذا المشروع بعد")})]})]}),p==="tasks"&&n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[console.log("Rendering Tasks tab with projectTasks:",f),n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Le,{className:"w-6 h-6 text-blue-600"}),e("common.tasks","المهام")]}),z&&n.jsxs("button",{onClick:()=>g(!0),className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5"}),e("common.addTask","إضافة مهمة")]})]}),n.jsx(eI,{projectId:t||"",tasks:f||[],students:d||[],onTaskUpdated:se}),f&&f.length>0&&n.jsx(SF,{tasks:f,students:d})]}),p==="evaluation"&&n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx(lr,{className:"w-6 h-6 text-blue-600"}),e("common.evaluation","التقييم")]}),W||O?n.jsx(AF,{projectId:t||"",onSaved:G}):L||R?n.jsx(CF,{evaluation:L,teacherName:(L==null?void 0:L.teacherName)||e("common.teacher","المشرف")}):n.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(lr,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:e("common.noEvaluation","لا يوجد تقييم")}),n.jsx("p",{className:"text-gray-600",children:e("common.projectNotEvaluated","لم يتم تقييم المشروع بعد")})]})]}),p==="chat"&&n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx(rr,{className:"w-6 h-6 text-blue-600"}),e("common.chat","المحادثة")]}),n.jsx(Q8,{projectId:t||""})]}),p==="resources"&&n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx($0,{className:"w-6 h-6 text-blue-600"}),e("common.files","الملفات")]}),n.jsx("div",{className:"flex justify-between items-center mb-6",children:z&&n.jsxs("button",{onClick:()=>U(!0),className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(Pn,{className:"w-5 h-5"}),e("common.addFile","إضافة ملف")]})}),a.resources&&a.resources.length>0?n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.resources.map((_e,He)=>n.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:_e.type==="image"?n.jsx("img",{src:_e.url,alt:_e.name,className:"w-10 h-10 rounded-lg object-cover"}):_e.type==="video"?n.jsx(ar,{className:"w-5 h-5 text-blue-600"}):n.jsx(cr,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-800 line-clamp-1",children:_e.name}),n.jsx("p",{className:"text-xs text-gray-500",children:_e.uploadedAt?Ye(_e.uploadedAt.toDate?_e.uploadedAt.toDate():_e.uploadedAt):""})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("a",{href:_e.url,target:"_blank",rel:"noopener noreferrer",className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center gap-2 text-sm",children:[n.jsx(mr,{className:"w-4 h-4"}),e("common.view","عرض")]}),n.jsx("a",{href:_e.url,download:_e.name,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center gap-2 text-sm",children:n.jsx(Mr,{className:"w-4 h-4"})})]})]},He))}):n.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx($0,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:e("common.noFiles","لا توجد ملفات")}),n.jsx("p",{className:"text-gray-600",children:e("common.noFilesInProject","لم يتم إضافة ملفات إلى هذا المشروع بعد")}),n.jsx("p",{className:"text-gray-600 text-sm mt-2",children:e("common.addFilesViaChat","يمكنك إضافة ملفات من خلال المحادثة")})]})]})]}),m&&n.jsx(kF,{projectId:t||"",students:d,onClose:()=>g(!1),onSuccess:se}),v&&n.jsx(EF,{projectId:t||"",maxStudents:a.max_students||5,currentStudents:d,onClose:()=>b(!1),onSuccess:M}),F&&n.jsx(PF,{projectId:t||"",onClose:()=>U(!1),onSuccess:ne}),y&&j&&n.jsx(TF,{studentName:((Nt=j.student)==null?void 0:Nt.name)||"الطالب",studentRole:j.role,isLeader:j.role==="leader",onConfirm:pe,onCancel:ye,isRemoving:_})]}):n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ge,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"المشروع غير موجود"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم العثور على المشروع المطلوب"}),n.jsx(ke,{to:"/projects",className:"mt-4 inline-block px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"العودة إلى المشاريع"})]})})},qf=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),{user:o}=ut(),l=(o==null?void 0:o.role)==="admin",c=async()=>{try{a(!0),i(null),console.log("Fetching project ideas, user:",o==null?void 0:o.id,"role:",o==null?void 0:o.role,"isAdmin:",l);const g=l?await yO():await gO();console.log("Project ideas fetched:",(g==null?void 0:g.length)||0),t(g)}catch(g){console.error("Error fetching project ideas:",g),i(g instanceof Error?g.message:"حدث خطأ في تحميل أفكار المشاريع")}finally{a(!1)}},d=async g=>{try{a(!0),i(null);const v={...g,views:0,downloads:0,rating:4.5,status:"pending"},b=await vO(v);return l&&t(y=>[b,...y]),b}catch(v){throw console.error("Error adding project idea:",v),i(v instanceof Error?v.message:"حدث خطأ في إضافة فكرة المشروع"),v}finally{a(!1)}},u=async(g,v)=>{try{return a(!0),i(null),await bO(g,v),t(b=>b.map(y=>y.id===g?{...y,...v}:y)),!0}catch(b){throw console.error("Error updating project idea:",b),i(b instanceof Error?b.message:"حدث خطأ في تحديث فكرة المشروع"),b}finally{a(!1)}},f=async g=>{try{return a(!0),i(null),await jO(g),t(v=>v.filter(b=>b.id!==g)),!0}catch(v){throw console.error("Error deleting project idea:",v),i(v instanceof Error?v.message:"حدث خطأ في حذف فكرة المشروع"),v}finally{a(!1)}},x=async g=>{try{await wO(g),t(v=>v.map(b=>b.id===g?{...b,views:b.views+1}:b))}catch(v){console.error("Error incrementing views:",v)}},p=async g=>{try{await NO(g),t(v=>v.map(b=>b.id===g?{...b,downloads:b.downloads+1}:b))}catch(v){console.error("Error incrementing downloads:",v)}},h=async g=>{if(!l)throw new Error("Only admins can approve ideas");return await u(g,{status:"approved"})},m=async(g,v)=>{if(!l)throw new Error("Only admins can reject ideas");return await u(g,{status:"rejected",feedback:v})};return C.useEffect(()=>{o&&o.id&&(console.log("User available, fetching project ideas. User ID:",o.id,"Role:",o.role),c())},[o==null?void 0:o.id,o==null?void 0:o.role]),{projectIdeas:e,loading:r,error:s,fetchProjectIdeas:c,addIdea:d,editIdea:u,removeIdea:f,incrementViews:x,incrementDownloads:p,approveIdea:h,rejectIdea:m,isAdmin:l,getProjectIdeaById:async g=>{try{return await _O(g)}catch(v){throw console.error("Error fetching project idea by ID:",v),v}}}},IF=()=>{var q,K;const{t:e}=ft(),t=Rs(),{user:r}=ut(),{students:a}=uv(),{createProject:s}=Ii(),{getProjectIdeaById:i}=qf(),[o,l]=C.useState(1),[c,d]=C.useState([]),[u,f]=C.useState(""),[x,p]=C.useState(!1),[h,m]=C.useState(!1),[g,v]=C.useState(null),[b,y]=C.useState(null),N=(r==null?void 0:r.role)==="student"?"draft":"active",[j,w]=C.useState({title:"",description:"",problemSolved:"",category:"",subject:"",difficulty:"",duration:"",objectives:[""],materials:[""],steps:[""],due_date:"",maxStudents:5,status:N,selectedStudentIds:[]});C.useEffect(()=>{const O=new URLSearchParams(window.location.search).get("ideaId");O&&(async()=>{try{m(!0),v(null);const z=await i(O);z?(y(z),w(te=>{var ae,se,M;return{...te,title:z.title||"",description:z.description||"",category:z.category||"",subject:z.subject||"",difficulty:z.difficulty||"",duration:z.duration||"",objectives:(ae=z.objectives)!=null&&ae.length?z.objectives:[""],materials:(se=z.materials)!=null&&se.length?z.materials:[""],steps:(M=z.steps)!=null&&M.length?z.steps:[""]}})):v("لم يتم العثور على فكرة المشروع المطلوبة")}catch(z){console.error("Error fetching project idea:",z),v("حدث خطأ في تحميل فكرة المشروع")}finally{m(!1)}})()},[]),C.useEffect(()=>{w(T=>({...T,selectedStudentIds:c}))},[c]);const _=(T,O)=>{w(W=>({...W,[T]:O}))},S=(T,O,W)=>{w(z=>({...z,[T]:z[T].map((te,ae)=>ae===O?W:te)}))},k=T=>{w(O=>({...O,[T]:[...O[T],""]}))},E=(T,O)=>{w(W=>({...W,[T]:W[T].filter((z,te)=>te!==O)}))},A=T=>{d(O=>O.includes(T)?O.filter(W=>W!==T):U.length+O.length>=j.maxStudents?O:[...O,T])},P=async()=>{try{p(!0);let T=[...c];(r==null?void 0:r.role)==="student"&&(r!=null&&r.id)&&!T.includes(r.id)&&(T=[r.id,...c]),await s({...j,progress:0,due_date:j.due_date,selectedStudentIds:T}),t("/projects")}catch(T){console.error("Error creating project:",T),alert(e("createProject.errors.creationFailed"))}finally{p(!1)}},L=()=>{o<5&&l(o+1)},R=()=>{o>1&&l(o-1)},I=[{number:1,title:e("createProject.steps.basicInfo"),icon:cr},{number:2,title:e("createProject.steps.detailsObjectives"),icon:Mf},{number:3,title:e("createProject.steps.materialsSteps"),icon:bt},{number:4,title:e("createProject.steps.finalSettings"),icon:ot},{number:5,title:e("createProject.steps.addStudents"),icon:dt}],D=[{id:"stem",name:e("projects.categories.stem"),description:e("createProject.categories.stemDesc")},{id:"entrepreneurship",name:e("projects.categories.entrepreneurship"),description:e("createProject.categories.entrepreneurshipDesc")},{id:"volunteer",name:e("projects.categories.volunteer"),description:e("createProject.categories.volunteerDesc")},{id:"ethics",name:e("projects.categories.ethics"),description:e("createProject.categories.ethicsDesc")}],V=[{id:"beginner",name:e("projectIdeas.difficulties.beginner"),description:e("createProject.difficulties.beginnerDesc")},{id:"intermediate",name:e("projectIdeas.difficulties.intermediate"),description:e("createProject.difficulties.intermediateDesc")},{id:"advanced",name:e("projectIdeas.difficulties.advanced"),description:e("createProject.difficulties.advancedDesc")}],F=a.filter(T=>T.name.toLowerCase().includes(u.toLowerCase())||T.email.toLowerCase().includes(u.toLowerCase())),U=[];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[h&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6 flex items-center gap-3",children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800",children:"جاري تحميل فكرة المشروع..."}),n.jsx("p",{className:"text-blue-700 text-sm",children:"يتم تحضير البيانات لك"})]})]}),g&&n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6 flex items-start gap-3",children:[n.jsx(Ge,{className:"w-5 h-5 text-red-500 mt-0.5 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-red-800",children:"خطأ في تحميل فكرة المشروع"}),n.jsx("p",{className:"text-red-700 text-sm",children:g})]})]}),b&&!h&&!g&&n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 mb-6 flex items-start gap-3",children:[n.jsx(Le,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-green-800",children:"تم تحميل فكرة المشروع بنجاح"}),n.jsxs("p",{className:"text-green-700 text-sm",children:['تم تحميل بيانات فكرة المشروع "',b.title,'" وملء النموذج. يمكنك تعديل أي من هذه البيانات حسب احتياجاتك.']})]})]}),n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(ke,{to:"/projects",className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Cn,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:b?`إنشاء مشروع من فكرة: ${b.title}`:e("createProject.title")}),n.jsx("p",{className:"text-gray-600",children:b?"تم تحميل بيانات فكرة المشروع. يمكنك تعديل أي من هذه البيانات.":e("createProject.subtitle")})]})]}),n.jsx("div",{className:"flex items-center justify-between mb-6",children:I.map((T,O)=>n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:`flex items-center gap-3 ${O<I.length-1?"flex-1":""}`,children:[n.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${o>=T.number?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:n.jsx(T.icon,{className:"w-6 h-6"})}),n.jsx("div",{className:"hidden md:block",children:n.jsx("p",{className:`font-medium ${o>=T.number?"text-blue-600":"text-gray-600"}`,children:T.title})})]}),O<I.length-1&&n.jsx("div",{className:`hidden md:block flex-1 h-1 mx-4 ${o>T.number?"bg-blue-500":"bg-gray-200"}`})]},T.number))})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[o===1&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.basicInfo")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.startWithBasicInfo")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.title")," *"]}),n.jsx("input",{type:"text",value:j.title,onChange:T=>_("title",T.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.titlePlaceholder")})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.description")," *"]}),n.jsx("textarea",{value:j.description,onChange:T=>_("description",T.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.descriptionPlaceholder")})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.problemSolved")}),n.jsx("textarea",{value:j.problemSolved,onChange:T=>_("problemSolved",T.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.problemSolvedPlaceholder")})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.category")," *"]}),n.jsx("div",{className:"space-y-2",children:D.map(T=>n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"category",value:T.id,checked:j.category===T.id,onChange:O=>_("category",O.target.value),className:"text-blue-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:T.name}),n.jsx("p",{className:"text-sm text-gray-600",children:T.description})]})]},T.id))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.subject")," *"]}),n.jsx("input",{type:"text",value:j.subject,onChange:T=>_("subject",T.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.subjectPlaceholder")}),n.jsxs("div",{className:"mt-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.difficulty")," *"]}),n.jsx("div",{className:"space-y-2",children:V.map(T=>n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"difficulty",value:T.id,checked:j.difficulty===T.id,onChange:O=>_("difficulty",O.target.value),className:"text-blue-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:T.name}),n.jsx("p",{className:"text-sm text-gray-600",children:T.description})]})]},T.id))})]})]})]})]}),o===2&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.detailsObjectives")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.defineObjectives")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.duration")," *"]}),n.jsx("input",{type:"text",value:j.duration,onChange:T=>_("duration",T.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.durationPlaceholder")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.maxStudents")}),n.jsx("input",{type:"number",value:j.maxStudents,onChange:T=>_("maxStudents",parseInt(T.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1",max:"20"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.objectives")," *"]}),n.jsxs("div",{className:"space-y-3",children:[j.objectives.map((T,O)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:T,onChange:W=>S("objectives",O,W.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.objective")} ${O+1}`}),j.objectives.length>1&&n.jsx("button",{onClick:()=>E("objectives",O),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]},O)),n.jsxs("button",{onClick:()=>k("objectives"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(pt,{className:"w-4 h-4"}),e("createProject.form.addNewObjective")]})]})]})]}),o===3&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.materialsSteps")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.defineMaterialsSteps")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.materials")}),n.jsxs("div",{className:"space-y-3",children:[j.materials.map((T,O)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:T,onChange:W=>S("materials",O,W.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.material")} ${O+1}`}),j.materials.length>1&&n.jsx("button",{onClick:()=>E("materials",O),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]},O)),n.jsxs("button",{onClick:()=>k("materials"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(pt,{className:"w-4 h-4"}),e("createProject.form.addNewMaterial")]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.implementationSteps")}),n.jsxs("div",{className:"space-y-3",children:[j.steps.map((T,O)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium mt-2",children:O+1}),n.jsx("textarea",{value:T,onChange:W=>S("steps",O,W.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.step")} ${O+1}`,rows:2}),j.steps.length>1&&n.jsx("button",{onClick:()=>E("steps",O),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors mt-2",children:n.jsx(Qe,{className:"w-5 h-5"})})]},O)),n.jsxs("button",{onClick:()=>k("steps"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(pt,{className:"w-4 h-4"}),e("createProject.form.addNewStep")]})]})]})]}),o===4&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.finalSettings")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.setDeadlineStatus")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.deadline")}),n.jsx("input",{type:"date",value:j.due_date,onChange:T=>_("due_date",T.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.status")}),n.jsxs("select",{value:j.status,onChange:T=>_("status",T.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!0,children:[n.jsx("option",{value:"draft",children:e("projects.statuses.draft")}),n.jsx("option",{value:"active",children:e("projects.statuses.active")})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("createProject.projectSummary")}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("common.title"),":"]}),n.jsx("span",{className:"font-medium",children:j.title||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("common.category"),":"]}),n.jsx("span",{className:"font-medium",children:((q=D.find(T=>T.id===j.category))==null?void 0:q.name)||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.form.difficulty"),":"]}),n.jsx("span",{className:"font-medium",children:((K=V.find(T=>T.id===j.difficulty))==null?void 0:K.name)||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.form.duration"),":"]}),n.jsx("span",{className:"font-medium",children:j.duration||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.objectivesCount"),":"]}),n.jsx("span",{className:"font-medium",children:j.objectives.filter(T=>T.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.materialsCount"),":"]}),n.jsx("span",{className:"font-medium",children:j.materials.filter(T=>T.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.stepsCount"),":"]}),n.jsx("span",{className:"font-medium",children:j.steps.filter(T=>T.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"نسبة الإنجاز الأولية:"}),n.jsx("span",{className:"font-medium",children:"0/10"})]})]})]})]}),o===5&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.addStudents")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.chooseParticipatingStudents")})]}),n.jsxs("div",{className:"relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("createProject.searchStudentsPlaceholder"),value:u,onChange:T=>f(T.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),c.length>0&&n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-blue-800 font-medium",children:e("createProject.selectedStudents",{count:c.length,max:j.maxStudents})}),n.jsx("button",{onClick:()=>d([]),className:"text-blue-600 hover:text-blue-800 text-sm",children:e("common.clearAll")})]})}),n.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:F.length>0?F.map(T=>n.jsxs("div",{className:`flex items-center gap-4 p-4 border rounded-xl transition-all cursor-pointer hover:shadow-md ${c.includes(T.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>A(T.id),children:[n.jsx("input",{type:"checkbox",checked:c.includes(T.id),onChange:()=>A(T.id),disabled:!c.includes(T.id)&&U.length+c.length>=j.maxStudents,className:"text-blue-600"}),n.jsx("img",{src:T.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:T.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:T.name}),c.includes(T.id)&&n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e("createProject.selected")})]}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ma,{className:"w-4 h-4"}),T.email]}),T.grade&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(vi,{className:"w-4 h-4"}),T.grade]})]})]})]},T.id)):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(dt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:e("createProject.noStudents")}),n.jsx("p",{className:"text-gray-600",children:e(u?"createProject.noStudentsMatch":"createProject.noStudentsAvailable")})]})}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("createProject.importantInfo"),":"]}),n.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[n.jsxs("li",{children:["• ",e("createProject.onlySchoolStudents")]}),n.jsxs("li",{children:["• ",e("createProject.canAddUpTo",{max:j.maxStudents})]}),n.jsxs("li",{children:["• ",e("createProject.canModifyLater")]}),n.jsxs("li",{children:["• ",e("createProject.searchIncludesNameEmail")]})]})]})]}),n.jsxs("div",{className:"flex justify-between pt-6 border-t border-gray-200",children:[n.jsx("div",{children:o>1&&n.jsx("button",{onClick:R,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.previous")})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(ke,{to:"/projects",className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.cancel")}),o<5?n.jsx("button",{onClick:L,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("common.next")}):n.jsxs("button",{onClick:P,disabled:x,className:"px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Za,{className:"w-5 h-5"}),e(x?"createProject.creating":"createProject.createProject")]})]})]})]})]})},FF=()=>{var F,U;const{t:e}=ft(),t=Rs(),{id:r}=hE(),{user:a}=ut(),{students:s}=uv(),{updateProject:i}=Ii(),[o,l]=C.useState(1),[c,d]=C.useState([]),[u,f]=C.useState([]),[x,p]=C.useState(""),[h,m]=C.useState(!0),[g,v]=C.useState(null),[b,y]=C.useState([]);a==null||a.role,a==null||a.role,a==null||a.role,a==null||a.role;const[N,j]=C.useState({title:"",description:"",category:"",subject:"",difficulty:"",duration:"",objectives:[""],materials:[""],steps:[""],due_date:"",maxStudents:5,status:"draft",selectedStudentIds:[]});C.useEffect(()=>{(async()=>{var K,T,O;if(!r){v("Project ID is missing"),m(!1);return}try{m(!0),v(null);const W=await wE(r);if(!W){v("المشروع غير موجود"),m(!1);return}const z=await $f(r);y(z);const te=z.map(se=>se.student_id);f(te);let ae="";W.due_date&&(ae=new Date(W.due_date).toISOString().split("T")[0]),j({title:W.title||"",description:W.description||"",category:W.category||"",subject:W.subject||"",difficulty:W.difficulty||"",duration:W.duration||"",objectives:(K=W.objectives)!=null&&K.length?W.objectives:[""],materials:(T=W.materials)!=null&&T.length?W.materials:[""],steps:(O=W.steps)!=null&&O.length?W.steps:[""],due_date:ae,maxStudents:W.max_students||5,status:W.status||"draft",selectedStudentIds:te}),m(!1)}catch(W){console.error("Error fetching project data:",W),v(W instanceof Error?W.message:"حدث خطأ في تحميل بيانات المشروع"),m(!1)}})()},[r]),C.useEffect(()=>{if(a&&a.school_id&&s.length>0){const q=s.filter(K=>K.school_id===a.school_id);d(q)}},[a,s]),C.useEffect(()=>{j(q=>({...q,selectedStudentIds:u}))},[u]);const w=(q,K)=>{j(T=>({...T,[q]:K}))},_=(q,K,T)=>{j(O=>({...O,[q]:O[q].map((W,z)=>z===K?T:W)}))},S=q=>{j(K=>({...K,[q]:[...K[q],""]}))},k=(q,K)=>{j(T=>({...T,[q]:T[q].filter((O,W)=>W!==K)}))},E=q=>{f(K=>K.includes(q)?K.filter(T=>T!==q):K.length>=N.maxStudents?(alert(`لا يمكن إضافة أكثر من ${N.maxStudents} طلاب لهذا المشروع`),K):[...K,q])},A=async()=>{var q,K,T;if(!r){v("Project ID is missing");return}try{m(!0),v(null);const O={...N,objectives:((q=N.objectives)==null?void 0:q.filter(W=>W.trim()))||[],materials:((K=N.materials)==null?void 0:K.filter(W=>W.trim()))||[],steps:((T=N.steps)==null?void 0:T.filter(W=>W.trim()))||[],max_students:N.maxStudents,selectedStudentIds:u};await i(r,O),t("/projects")}catch(O){console.error("Error updating project:",O),v(O instanceof Error?O.message:"حدث خطأ في تحديث المشروع"),m(!1)}},P=()=>{o<5&&l(o+1)},L=()=>{o>1&&l(o-1)},R=[{number:1,title:e("createProject.steps.basicInfo"),icon:cr},{number:2,title:e("createProject.steps.detailsObjectives"),icon:Mf},{number:3,title:e("createProject.steps.materialsSteps"),icon:bt},{number:4,title:e("createProject.steps.finalSettings"),icon:ot},{number:5,title:e("createProject.steps.addStudents"),icon:dt}],I=[{id:"stem",name:e("projects.categories.stem"),description:e("createProject.categories.stemDesc")},{id:"entrepreneurship",name:e("projects.categories.entrepreneurship"),description:e("createProject.categories.entrepreneurshipDesc")},{id:"volunteer",name:e("projects.categories.volunteer"),description:e("createProject.categories.volunteerDesc")},{id:"ethics",name:e("projects.categories.ethics"),description:e("createProject.categories.ethicsDesc")}],D=[{id:"beginner",name:e("projectIdeas.difficulties.beginner"),description:e("createProject.difficulties.beginnerDesc")},{id:"intermediate",name:e("projectIdeas.difficulties.intermediate"),description:e("createProject.difficulties.intermediateDesc")},{id:"advanced",name:e("projectIdeas.difficulties.advanced"),description:e("createProject.difficulties.advancedDesc")}],V=c.filter(q=>{var K,T;return((K=q.name)==null?void 0:K.toLowerCase().includes(x.toLowerCase()))||((T=q.email)==null?void 0:T.toLowerCase().includes(x.toLowerCase()))||q.grade&&q.grade.toLowerCase().includes(x.toLowerCase())});return h?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):g?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ja,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:g}),n.jsx(ke,{to:"/projects",className:"mt-4 inline-block px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"العودة إلى المشاريع"})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(ke,{to:"/projects",className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Cn,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:e("editProject.title")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.subtitle")})]})]}),n.jsx("div",{className:"flex items-center justify-between mb-6",children:R.map((q,K)=>n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:`flex items-center gap-3 ${K<R.length-1?"flex-1":""}`,children:[n.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${o>=q.number?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:n.jsx(q.icon,{className:"w-6 h-6"})}),n.jsx("div",{className:"hidden md:block",children:n.jsx("p",{className:`font-medium ${o>=q.number?"text-blue-600":"text-gray-600"}`,children:q.title})})]}),K<R.length-1&&n.jsx("div",{className:`hidden md:block flex-1 h-1 mx-4 ${o>q.number?"bg-blue-500":"bg-gray-200"}`})]},q.number))})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[o===1&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.basicInfo")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.modifyBasicInfo")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.title")," *"]}),n.jsx("input",{type:"text",value:N.title,onChange:q=>w("title",q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.titlePlaceholder")})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.description")," *"]}),n.jsx("textarea",{value:N.description,onChange:q=>w("description",q.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.descriptionPlaceholder")})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.category")," *"]}),n.jsx("div",{className:"space-y-2",children:I.map(q=>n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"category",value:q.id,checked:N.category===q.id,onChange:K=>w("category",K.target.value),className:"text-blue-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:q.name}),n.jsx("p",{className:"text-sm text-gray-600",children:q.description})]})]},q.id))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.subject")," *"]}),n.jsx("input",{type:"text",value:N.subject,onChange:q=>w("subject",q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.subjectPlaceholder")}),n.jsxs("div",{className:"mt-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.difficulty")," *"]}),n.jsx("div",{className:"space-y-2",children:D.map(q=>n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"difficulty",value:q.id,checked:N.difficulty===q.id,onChange:K=>w("difficulty",K.target.value),className:"text-blue-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:q.name}),n.jsx("p",{className:"text-sm text-gray-600",children:q.description})]})]},q.id))})]})]})]})]}),o===2&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.detailsObjectives")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.modifyObjectives")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.duration")," *"]}),n.jsx("input",{type:"text",value:N.duration,onChange:q=>w("duration",q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.durationPlaceholder")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.maxStudents")}),n.jsx("input",{type:"number",value:N.maxStudents,onChange:q=>w("maxStudents",parseInt(q.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1",max:"20"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.objectives")," *"]}),n.jsxs("div",{className:"space-y-3",children:[N.objectives.map((q,K)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:q,onChange:T=>_("objectives",K,T.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.objective")} ${K+1}`}),N.objectives.length>1&&n.jsx("button",{onClick:()=>k("objectives",K),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]},K)),n.jsxs("button",{onClick:()=>S("objectives"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(pt,{className:"w-4 h-4"}),e("createProject.form.addNewObjective")]})]})]})]}),o===3&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.materialsSteps")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.modifyMaterialsSteps")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.materials")}),n.jsxs("div",{className:"space-y-3",children:[N.materials.map((q,K)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:q,onChange:T=>_("materials",K,T.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.material")} ${K+1}`}),N.materials.length>1&&n.jsx("button",{onClick:()=>k("materials",K),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]},K)),n.jsxs("button",{onClick:()=>S("materials"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(pt,{className:"w-4 h-4"}),e("createProject.form.addNewMaterial")]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.implementationSteps")}),n.jsxs("div",{className:"space-y-3",children:[N.steps.map((q,K)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium mt-2",children:K+1}),n.jsx("textarea",{value:q,onChange:T=>_("steps",K,T.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.step")} ${K+1}`,rows:2}),N.steps.length>1&&n.jsx("button",{onClick:()=>k("steps",K),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors mt-2",children:n.jsx(Qe,{className:"w-5 h-5"})})]},K)),n.jsxs("button",{onClick:()=>S("steps"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(pt,{className:"w-4 h-4"}),e("createProject.form.addNewStep")]})]})]})]}),o===4&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.finalSettings")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.modifyDeadlineStatus")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.deadline")}),n.jsx("input",{type:"date",value:N.due_date,onChange:q=>w("due_date",q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.status")}),n.jsxs("select",{value:N.status,onChange:q=>w("status",q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:(a==null?void 0:a.role)==="student"||(a==null?void 0:a.role)==="consultant",children:[n.jsx("option",{value:"draft",children:e("projects.statuses.draft")}),n.jsx("option",{value:"active",children:e("projects.statuses.active")}),n.jsx("option",{value:"completed",children:e("projects.statuses.completed")}),n.jsx("option",{value:"archived",children:e("projects.statuses.archived")})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("createProject.projectSummary")}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("common.title"),":"]}),n.jsx("span",{className:"font-medium",children:N.title||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("common.category"),":"]}),n.jsx("span",{className:"font-medium",children:((F=I.find(q=>q.id===N.category))==null?void 0:F.name)||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.form.difficulty"),":"]}),n.jsx("span",{className:"font-medium",children:((U=D.find(q=>q.id===N.difficulty))==null?void 0:U.name)||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.form.duration"),":"]}),n.jsx("span",{className:"font-medium",children:N.duration||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.objectivesCount"),":"]}),n.jsx("span",{className:"font-medium",children:N.objectives.filter(q=>q.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.materialsCount"),":"]}),n.jsx("span",{className:"font-medium",children:N.materials.filter(q=>q.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.stepsCount"),":"]}),n.jsx("span",{className:"font-medium",children:N.steps.filter(q=>q.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("editProject.studentsCount"),":"]}),n.jsxs("span",{className:"font-medium",children:[u.length," ",e("editProject.outOf")," ",N.maxStudents]})]})]})]})]}),o===5&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("editProject.manageStudents")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.addRemoveStudents")})]}),n.jsxs("div",{className:"relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("createProject.searchStudentsPlaceholder"),value:x,onChange:q=>p(q.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),u.length>0&&n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-blue-800 font-medium",children:e("createProject.selectedStudents",{count:u.length,max:N.maxStudents})}),n.jsx("button",{onClick:()=>f([]),className:"text-blue-600 hover:text-blue-800 text-sm",children:e("common.clearAll")})]})}),n.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:V.length>0?V.map(q=>n.jsxs("div",{className:`flex items-center gap-4 p-4 border rounded-xl transition-all cursor-pointer hover:shadow-md ${u.includes(q.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>E(q.id),children:[n.jsx("input",{type:"checkbox",checked:u.includes(q.id),onChange:()=>E(q.id),disabled:!u.includes(q.id)&&u.length>=N.maxStudents,className:"text-blue-600"}),n.jsx("img",{src:q.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:q.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:q.name}),u.includes(q.id)&&n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e("createProject.selected")})]}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ma,{className:"w-4 h-4"}),q.email]}),q.grade&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Xt,{className:"w-4 h-4"}),q.grade]})]})]})]},q.id)):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(dt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:e("createProject.noStudents")}),n.jsx("p",{className:"text-gray-600",children:e(x?"createProject.noStudentsMatch":"createProject.noStudentsAvailable")})]})}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("createProject.importantInfo"),":"]}),n.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[n.jsxs("li",{children:["• ",e("createProject.onlySchoolStudents")]}),n.jsxs("li",{children:["• ",e("createProject.canAddUpTo",{max:N.maxStudents})]}),n.jsxs("li",{children:["• ",e("editProject.changesWillAffect")]}),n.jsxs("li",{children:["• ",e("createProject.searchIncludesNameEmail")]})]})]})]}),n.jsxs("div",{className:"flex justify-between pt-6 border-t border-gray-200",children:[n.jsx("div",{children:o>1&&n.jsx("button",{onClick:L,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.previous")})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(ke,{to:"/projects",className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.cancel")}),o<5?n.jsx("button",{onClick:P,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("common.next")}):n.jsxs("button",{onClick:A,disabled:h,className:"px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Za,{className:"w-5 h-5"}),e(h?"editProject.saving":"editProject.saveChanges")]})]})]})]})]})},YE=({isOpen:e,onClose:t,onSubmit:r,editingIdea:a})=>{var y,N,j,w;const[s,i]=C.useState({title:"",description:"",category:"stem",difficulty:"beginner",duration:"",subject:"",image:"",objectives:[""],materials:[""],steps:[""],tags:[]}),[o,l]=C.useState(""),[c,d]=C.useState(!1),[u,f]=C.useState(null);C.useEffect(()=>{var _,S,k;i(a?{...a,objectives:(_=a.objectives)!=null&&_.length?a.objectives:[""],materials:(S=a.materials)!=null&&S.length?a.materials:[""],steps:(k=a.steps)!=null&&k.length?a.steps:[""],tags:a.tags||[]}:{title:"",description:"",category:"stem",difficulty:"beginner",duration:"",subject:"",image:"",objectives:[""],materials:[""],steps:[""],tags:[]}),l(""),f(null)},[a,e]);const x=(_,S)=>{i(k=>({...k,[_]:S}))},p=(_,S,k)=>{i(E=>{var A;return{...E,[_]:(A=E[_])==null?void 0:A.map((P,L)=>L===S?k:P)}})},h=_=>{i(S=>({...S,[_]:[...S[_]||[],""]}))},m=(_,S)=>{i(k=>{var E;return{...k,[_]:(E=k[_])==null?void 0:E.filter((A,P)=>P!==S)}})},g=()=>{o.trim()&&(i(_=>({..._,tags:[..._.tags||[],o.trim()]})),l(""))},v=_=>{i(S=>{var k;return{...S,tags:(k=S.tags)==null?void 0:k.filter((E,A)=>A!==_)}})},b=async _=>{var k,E,A;if(_.preventDefault(),!s.title||!s.description||!s.category||!s.difficulty){f("يرجى ملء جميع الحقول المطلوبة");return}const S={...s,objectives:((k=s.objectives)==null?void 0:k.filter(P=>P.trim()))||[],materials:((E=s.materials)==null?void 0:E.filter(P=>P.trim()))||[],steps:((A=s.steps)==null?void 0:A.filter(P=>P.trim()))||[]};d(!0),f(null);try{await r(S),t()}catch(P){console.error("Error submitting idea:",P),f(P instanceof Error?P.message:"حدث خطأ في حفظ فكرة المشروع")}finally{d(!1)}};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(jr,{className:"w-6 h-6 text-blue-600"}),a?"تعديل فكرة مشروع":"إضافة فكرة مشروع جديدة"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),u&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:u})]}),n.jsxs("form",{onSubmit:b,className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان المشروع *"}),n.jsx("input",{type:"text",value:s.title,onChange:_=>x("title",_.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل عنوان المشروع",required:!0})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف المشروع *"}),n.jsx("textarea",{value:s.description,onChange:_=>x("description",_.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اكتب وصفاً شاملاً للمشروع وأهدافه",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"فئة المشروع *"}),n.jsxs("select",{value:s.category,onChange:_=>x("category",_.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"stem",children:"العلوم والتقنية"}),n.jsx("option",{value:"entrepreneurship",children:"ريادة الأعمال"}),n.jsx("option",{value:"volunteer",children:"التطوع"}),n.jsx("option",{value:"ethics",children:"الأخلاق"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مستوى الصعوبة *"}),n.jsxs("select",{value:s.difficulty,onChange:_=>x("difficulty",_.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"beginner",children:"مبتدئ"}),n.jsx("option",{value:"intermediate",children:"متوسط"}),n.jsx("option",{value:"advanced",children:"متقدم"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدة المتوقعة"}),n.jsxs("div",{className:"relative",children:[n.jsx(xt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:s.duration,onChange:_=>x("duration",_.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"مثال: 6-8 أسابيع"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الموضوع/المادة"}),n.jsxs("div",{className:"relative",children:[n.jsx(bt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:s.subject,onChange:_=>x("subject",_.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"مثال: الفيزياء، البرمجة، التسويق"})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط الصورة"}),n.jsxs("div",{className:"relative",children:[n.jsx(sl,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"url",value:s.image,onChange:_=>x("image",_.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل رابط صورة المشروع"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"أهداف المشروع"}),n.jsxs("div",{className:"space-y-3",children:[(y=s.objectives)==null?void 0:y.map((_,S)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium",children:S+1}),n.jsx("input",{type:"text",value:_,onChange:k=>p("objectives",S,k.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`الهدف ${S+1}`}),s.objectives.length>1&&n.jsx("button",{type:"button",onClick:()=>m("objectives",S),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(nr,{className:"w-5 h-5"})})]},S)),n.jsxs("button",{type:"button",onClick:()=>h("objectives"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(pt,{className:"w-4 h-4"}),"إضافة هدف جديد"]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المواد والأدوات المطلوبة"}),n.jsxs("div",{className:"space-y-3",children:[(N=s.materials)==null?void 0:N.map((_,S)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:_,onChange:k=>p("materials",S,k.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`المادة ${S+1}`}),s.materials.length>1&&n.jsx("button",{type:"button",onClick:()=>m("materials",S),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(nr,{className:"w-5 h-5"})})]},S)),n.jsxs("button",{type:"button",onClick:()=>h("materials"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(pt,{className:"w-4 h-4"}),"إضافة مادة جديدة"]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"خطوات تنفيذ المشروع"}),n.jsxs("div",{className:"space-y-3",children:[(j=s.steps)==null?void 0:j.map((_,S)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-sm font-medium mt-2",children:S+1}),n.jsx("textarea",{value:_,onChange:k=>p("steps",S,k.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`الخطوة ${S+1}`,rows:2}),s.steps.length>1&&n.jsx("button",{type:"button",onClick:()=>m("steps",S),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors mt-2",children:n.jsx(nr,{className:"w-5 h-5"})})]},S)),n.jsxs("button",{type:"button",onClick:()=>h("steps"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(pt,{className:"w-4 h-4"}),"إضافة خطوة جديدة"]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكلمات المفتاحية"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(w=s.tags)==null?void 0:w.map((_,S)=>n.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-full",children:[n.jsx("span",{children:_}),n.jsx("button",{type:"button",onClick:()=>v(S),className:"w-4 h-4 rounded-full flex items-center justify-center hover:bg-blue-200",children:n.jsx(Qe,{className:"w-3 h-3"})})]},S))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(il,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:o,onChange:_=>l(_.target.value),onKeyPress:_=>_.key==="Enter"&&(_.preventDefault(),g()),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أضف كلمة مفتاحية"})]}),n.jsx("button",{type:"button",onClick:g,className:"px-4 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"إضافة"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:c?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Za,{className:"w-5 h-5"}),a?"حفظ التغييرات":"إضافة المشروع"]})})]})]})]})}):null},DF=()=>{const{t:e}=ft(),t=Rs(),{user:r}=ut(),a=(r==null?void 0:r.role)==="admin",{projectIdeas:s,loading:i,error:o,addIdea:l,incrementViews:c,incrementDownloads:d}=qf(),[u,f]=C.useState("all"),[x,p]=C.useState("all"),[h,m]=C.useState(""),[g,v]=C.useState(!1),[b,y]=C.useState(null),[N,j]=C.useState(!1),[w,_]=C.useState(!1),S=[{id:"all",name:e("projectIdeas.categories.all"),icon:bt,color:"from-gray-500 to-gray-600"},{id:"stem",name:e("projectIdeas.categories.stem"),icon:QC,color:"from-blue-500 to-blue-600"},{id:"entrepreneurship",name:e("projectIdeas.categories.entrepreneurship"),icon:As,color:"from-green-500 to-green-600"},{id:"volunteer",name:e("projectIdeas.categories.volunteer"),icon:Xa,color:"from-red-500 to-red-600"},{id:"ethics",name:e("projectIdeas.categories.ethics"),icon:ba,color:"from-purple-500 to-purple-600"}],k=[{id:"all",name:e("projectIdeas.difficulties.all")},{id:"beginner",name:e("projectIdeas.difficulties.beginner")},{id:"intermediate",name:e("projectIdeas.difficulties.intermediate")},{id:"advanced",name:e("projectIdeas.difficulties.advanced")}],E=s.filter(F=>{if(!a&&F.status!=="approved")return!1;const U=u==="all"||F.category===u,q=x==="all"||F.difficulty===x,K=F.title.toLowerCase().includes(h.toLowerCase())||F.description.toLowerCase().includes(h.toLowerCase());return U&&q&&K}),A=async F=>{try{await c(F);const U=s.find(q=>q.id===F);U&&y(U)}catch(U){console.error("Error incrementing views:",U)}},P=async F=>{var U,q,K,T;try{await d(F);const O=s.find(W=>W.id===F);if(O){const W=`
# ${O.title}

## الوصف
${O.description}

## الفئة
${V(O.category)}

## مستوى الصعوبة
${D(O.difficulty)}

## المدة المتوقعة
${O.duration||"غير محدد"}

## الموضوع/المادة
${O.subject||"غير محدد"}

## الأهداف
${((U=O.objectives)==null?void 0:U.map(se=>`- ${se}`).join(`
`))||"لا توجد أهداف محددة"}

## المواد المطلوبة
${((q=O.materials)==null?void 0:q.map(se=>`- ${se}`).join(`
`))||"لا توجد مواد محددة"}

## خطوات التنفيذ
${((K=O.steps)==null?void 0:K.map((se,M)=>`${M+1}. ${se}`).join(`
`))||"لا توجد خطوات محددة"}

## الكلمات المفتاحية
${((T=O.tags)==null?void 0:T.map(se=>`#${se}`).join(" "))||"لا توجد كلمات مفتاحية"}
        `,z=new Blob([W],{type:"text/plain;charset=utf-8"}),te=URL.createObjectURL(z),ae=document.createElement("a");ae.href=te,ae.download=`${O.title.replace(/\s+/g,"_")}.txt`,document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),URL.revokeObjectURL(te)}}catch(O){console.error("Error incrementing downloads:",O)}},L=F=>{t(`/projects/new?ideaId=${F}`)},R=async F=>{try{await l(F),j(!1),_(!0),setTimeout(()=>{_(!1)},5e3)}catch(U){throw console.error("Error adding idea:",U),U}},I=F=>{switch(F){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},D=F=>{switch(F){case"beginner":return e("projectIdeas.difficulties.beginner");case"intermediate":return e("projectIdeas.difficulties.intermediate");case"advanced":return e("projectIdeas.difficulties.advanced");default:return F}},V=F=>{switch(F){case"stem":return e("projectIdeas.categories.stem");case"entrepreneurship":return e("projectIdeas.categories.entrepreneurship");case"volunteer":return e("projectIdeas.categories.volunteer");case"ethics":return e("projectIdeas.categories.ethics");default:return F}};return i?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):o?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ja,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:o})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(jr,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("projectIdeas.title")}),n.jsx("p",{className:"opacity-90",children:e("projectIdeas.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:E.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("projectIdeas.stats.projectIdeas")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:S.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("projectIdeas.stats.differentCategories")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:k.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("projectIdeas.stats.difficultyLevels")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"100%"}),n.jsx("div",{className:"text-sm opacity-80",children:e("projectIdeas.stats.free")})]})]})]}),w&&n.jsxs(re.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(Le,{className:"w-6 h-6 text-green-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-green-800 mb-1",children:"تم إرسال فكرة المشروع بنجاح"}),n.jsx("p",{className:"text-green-700",children:"تم استلام فكرة المشروع وسيتم مراجعتها من قبل مدير النظام. سيتم نشرها بعد الموافقة عليها."})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("projectIdeas.searchPlaceholder"),value:h,onChange:F=>m(F.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>v(!g),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(nl,{className:"w-5 h-5"}),e("common.filter")]})]}),n.jsxs("div",{className:`mt-4 space-y-4 ${g?"block":"hidden lg:block"}`,children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("projectIdeas.filters.categories")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:S.map(F=>n.jsxs("button",{onClick:()=>f(F.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${u===F.id?`bg-gradient-to-r ${F.color} text-white shadow-lg`:"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(F.icon,{className:"w-4 h-4"}),F.name]},F.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("projectIdeas.filters.difficulty")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:k.map(F=>n.jsx("button",{onClick:()=>p(F.id),className:`px-4 py-2 rounded-xl transition-all ${x===F.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:F.name},F.id))})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("p",{className:"text-gray-600",children:[e("projectIdeas.showing")," ",E.length," ",e("projectIdeas.of")," ",a?s.length:E.length," ",e("projectIdeas.idea")]}),n.jsxs("button",{onClick:()=>j(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:[n.jsx(pt,{className:"w-4 h-4"}),e("projectIdeas.suggestNewIdea")]})]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map((F,U)=>n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:U*.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"relative h-48 overflow-hidden",children:[n.jsx("img",{src:F.image||"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=400",alt:F.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),n.jsx("div",{className:"absolute top-4 right-4",children:n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${I(F.difficulty)}`,children:D(F.difficulty)})}),n.jsxs("div",{className:"absolute top-4 left-4 flex gap-2",children:[n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(mr,{className:"w-3 h-3"}),F.views]}),n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(Mr,{className:"w-3 h-3"}),F.downloads]})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:F.rating})]}),n.jsx("span",{className:"text-gray-300",children:"•"}),n.jsx("span",{className:"text-sm text-gray-600",children:F.subject||V(F.category)})]}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 group-hover:text-blue-600 transition-colors",children:F.title}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-3 leading-relaxed",children:F.description}),n.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(xt,{className:"w-4 h-4"}),F.duration||e("resources.defaultDuration")]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(dt,{className:"w-4 h-4"}),e("projectIdeas.teamwork")]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-xl hover:bg-blue-600 transition-colors font-medium",onClick:()=>A(F.id),children:e("projectIdeas.viewDetails")}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",onClick:()=>P(F.id),children:n.jsx(Mr,{className:"w-4 h-4"})})]})]})]},F.id))}),E.length===0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(wt,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("projectIdeas.noResults")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("projectIdeas.tryChangingFilters")}),n.jsx("button",{onClick:()=>{f("all"),p("all"),m("")},className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("common.resetFilters")})]}),b&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsx(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:"relative h-64 bg-gradient-to-r from-blue-600 to-purple-600",children:[b.image?n.jsx("img",{src:b.image,alt:b.title,className:"w-full h-full object-cover opacity-50"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(jr,{className:"w-24 h-24 text-white opacity-20"})}),n.jsx("button",{onClick:()=>y(null),className:"absolute top-4 right-4 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-70 transition-colors",children:n.jsx(Qe,{className:"w-6 h-6"})}),n.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${I(b.difficulty)}`,children:D(b.difficulty)}),n.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:V(b.category)})]}),n.jsx("h2",{className:"text-2xl font-bold text-white",children:b.title})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"الوصف"}),n.jsx("p",{className:"text-gray-600 leading-relaxed mb-4",children:b.description}),b.tags&&b.tags.length>0&&n.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:b.tags.map((F,U)=>n.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded-lg",children:["#",F]},U))})]}),n.jsx("div",{children:n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"معلومات المشروع"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المدة المتوقعة"}),n.jsx("p",{className:"font-medium",children:b.duration||"غير محدد"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"الموضوع/المادة"}),n.jsx("p",{className:"font-medium",children:b.subject||"غير محدد"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"التقييم"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:b.rating})]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المشاهدات"}),n.jsx("p",{className:"font-medium",children:b.views})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"التنزيلات"}),n.jsx("p",{className:"font-medium",children:b.downloads})]})]})]})})]}),b.objectives&&b.objectives.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"أهداف المشروع"}),n.jsx("div",{className:"space-y-2",children:b.objectives.map((F,U)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center mt-0.5",children:n.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full"})}),n.jsx("p",{className:"text-gray-700",children:F})]},U))})]}),b.materials&&b.materials.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"المواد والأدوات المطلوبة"}),n.jsx("div",{className:"grid md:grid-cols-2 gap-2",children:b.materials.map((F,U)=>n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),n.jsx("span",{className:"text-gray-700",children:F})]},U))})]}),b.steps&&b.steps.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"خطوات تنفيذ المشروع"}),n.jsx("div",{className:"space-y-3",children:b.steps.map((F,U)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:U+1}),n.jsx("div",{className:"bg-gray-50 p-3 rounded-lg flex-1",children:n.jsx("p",{className:"text-gray-700",children:F})})]},U))})]}),n.jsxs("div",{className:"flex justify-between pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[n.jsx(mr,{className:"w-5 h-5"}),n.jsxs("span",{children:[b.views," مشاهدة"]})]}),n.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[n.jsx(Mr,{className:"w-5 h-5"}),n.jsxs("span",{children:[b.downloads," تنزيل"]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:()=>P(b.id),className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(Mr,{className:"w-5 h-5"}),"تنزيل"]}),n.jsxs("button",{onClick:()=>L(b.id),className:"px-6 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2",children:[n.jsx(ZC,{className:"w-5 h-5"}),"استخدم هذه الفكرة"]}),n.jsx("button",{onClick:()=>y(null),className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إغلاق"})]})]})]})]})})}),N&&n.jsx(YE,{isOpen:N,onClose:()=>j(!1),onSubmit:R,editingIdea:null}),n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-blue-50 border border-blue-200 rounded-2xl p-6",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(An,{className:"w-6 h-6 text-blue-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-blue-800 mb-2",children:"اقتراح فكرة مشروع جديدة"}),n.jsx("p",{className:"text-blue-700 mb-4",children:"يمكنك اقتراح فكرة مشروع جديدة ليتم إضافتها إلى قائمة أفكار المشاريع. سيتم مراجعة الفكرة من قبل مدير النظام قبل نشرها."}),n.jsxs("button",{onClick:()=>j(!0),className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 mx-auto",children:[n.jsx(pt,{className:"w-4 h-4"}),"اقتراح فكرة جديدة"]})]})]})})]})},JE=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),o=async()=>{try{a(!0);const h=Oe(he,"gallery_projects"),m=Me(h,ol("created_at","desc")),g=await Ie(m),v=await Promise.all(g.docs.map(async b=>{const y=b.data();let N="مدرسة غير معروفة";if(y.school_id)try{const j=Zt(he,"users",y.school_id),w=await Dt(j);w.exists()&&w.data().role==="school"&&(N=w.data().name||"مدرسة غير معروفة")}catch(j){console.error("Error fetching school name:",j)}return{id:b.id,title:y.title||"مشروع بدون عنوان",description:y.description||"لا يوجد وصف",category:y.category||"عام",students:y.students||[],school:N,schoolId:y.school_id||"",teacher:y.teacher||"مشرف غير معروف",completedAt:y.completed_at?new Date(y.completed_at.toDate()).toISOString():new Date().toISOString(),rating:y.rating||4.5,views:y.views||0,likes:y.likes||0,mediaUrl:y.media_url||"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=600",mediaType:y.media_type||"image",youtubeUrl:y.youtube_url,video:y.video,tags:y.tags||[],awards:y.awards||[],featured:y.featured||!1}}));t(v)}catch(h){console.error("Error fetching gallery projects:",h),i(h instanceof Error?h.message:"حدث خطأ في تحميل معرض المشاريع")}finally{a(!1)}},l=async h=>{try{const m=st(he,"gallery_projects",h);await sr(m,{views:So(1)}),t(g=>g.map(v=>v.id===h?{...v,views:v.views+1}:v))}catch(m){console.error("Error incrementing views:",m)}},c=async h=>{try{const m=st(he,"gallery_projects",h);await sr(m,{likes:So(1)}),t(g=>g.map(v=>v.id===h?{...v,likes:v.likes+1}:v))}catch(m){console.error("Error incrementing likes:",m)}},d=async h=>{try{console.log("Adding gallery project with data:",h);const m=Oe(he,"gallery_projects"),g=await Fa(m,{title:h.title,description:h.description,category:h.category,students:h.students,school_id:h.schoolId,teacher:h.teacher,completed_at:Ve(),rating:h.rating||4.5,views:0,likes:0,media_url:h.mediaUrl,media_type:h.mediaType,youtube_url:h.youtubeUrl,video:h.video,tags:h.tags||[],awards:h.awards||[],featured:h.featured||!1,created_at:Ve(),updated_at:Ve()});console.log("Gallery project added successfully with ID:",g.id);const v={id:g.id,title:h.title||"مشروع بدون عنوان",description:h.description||"لا يوجد وصف",category:h.category||"عام",students:h.students||[],school:h.school||"مدرسة غير معروفة",schoolId:h.schoolId||"",teacher:h.teacher||"مشرف غير معروف",completedAt:new Date().toISOString(),rating:h.rating||4.5,views:0,likes:0,mediaUrl:h.mediaUrl||"",mediaType:h.mediaType||"image",youtubeUrl:h.youtubeUrl,video:h.video,tags:h.tags||[],awards:h.awards||[],featured:h.featured||!1};return t(b=>[v,...b]),v}catch(m){throw console.error("Error adding gallery project:",m),m}},u=async(h,m)=>{try{const g=st(he,"gallery_projects",h);return await sr(g,{title:m.title,description:m.description,category:m.category,students:m.students,school_id:m.schoolId,teacher:m.teacher,media_url:m.mediaUrl,media_type:m.mediaType,youtube_url:m.youtubeUrl,video:m.video,tags:m.tags,awards:m.awards,featured:m.featured,updated_at:Ve()}),t(v=>v.map(b=>b.id===h?{...b,...m}:b)),{id:h,...m}}catch(g){throw console.error("Error updating gallery project:",g),g}},f=async h=>{try{const m=st(he,"gallery_projects",h);return await Da(m),t(g=>g.filter(v=>v.id!==h)),!0}catch(m){throw console.error("Error deleting gallery project:",m),m}},x=async h=>{try{console.log("Uploading media file:",h.name,"Size:",h.size,"Type:",h.type);const m=100*1024*1024;if(h.size>m)throw new Error("حجم الملف يتجاوز الحد الأقصى المسموح (100 ميجابايت)");let g;if(h.type.startsWith("image/"))g="image";else if(h.type.startsWith("video/"))g="video";else throw new Error("نوع الملف غير مدعوم. يرجى اختيار صورة أو فيديو");const v=mu(pu,`gallery/${Date.now()}_${h.name}`);console.log("Uploading to storage path:",`gallery/${Date.now()}_${h.name}`),await LP(v,h);const b=await sv(v);return console.log("Media uploaded successfully, URL:",b),{url:b,type:g}}catch(m){throw console.error("Error uploading media:",m),m}},p=h=>{try{console.log("Converting YouTube URL:",h);let m="";if(h.includes("youtube.com/watch")?m=new URL(h).searchParams.get("v")||"":h.includes("youtu.be/")?m=h.split("youtu.be/")[1].split("?")[0]:h.includes("youtube.com/embed/")?m=h.split("embed/")[1].split("?")[0]:h.includes("youtube.com/shorts/")&&(m=h.split("shorts/")[1].split("?")[0]),!m)throw new Error("رابط يوتيوب غير صالح");const g={embedUrl:`https://www.youtube.com/embed/${m}`,watchUrl:`https://www.youtube.com/watch?v=${m}`};return console.log("YouTube URL converted successfully:",g),g}catch(m){throw console.error("Error converting YouTube URL:",m),new Error("رابط يوتيوب غير صالح")}};return C.useEffect(()=>{o()},[]),{projects:e,loading:r,error:s,fetchGalleryProjects:o,incrementViews:l,incrementLikes:c,addGalleryProject:d,updateGalleryProject:u,deleteGalleryProject:f,uploadMedia:x,convertYouTubeUrl:p}},X1=({isOpen:e,onClose:t,onSuccess:r,editingProject:a})=>{const{user:s}=ut(),{addGalleryProject:i,updateGalleryProject:o,uploadMedia:l,convertYouTubeUrl:c}=JE(),[d,u]=C.useState([]),[f,x]=C.useState(""),[p,h]=C.useState(!1),[m,g]=C.useState({title:"",description:"",category:"stem",students:[""],teacher:"",mediaType:"image",mediaFile:null,youtubeUrl:"",tags:[""],awards:[""],featured:!1}),[v,b]=C.useState(null),y=C.useRef(null),[N,j]=C.useState(!1),[w,_]=C.useState(null),[S,k]=C.useState(null);C.useEffect(()=>{var V,F,U;if(!e){g({title:"",description:"",category:"stem",students:[""],teacher:"",mediaType:"image",mediaFile:null,youtubeUrl:"",tags:[""],awards:[""],featured:!1}),x(""),b(null),_(null),k(null);return}(s==null?void 0:s.role)==="admin"&&(async()=>{try{h(!0);const K=await ov();K&&K.length>0?u(K):u([])}catch(K){console.error("Error fetching schools:",K),u([])}finally{h(!1)}})(),a?(g({title:a.title||"",description:a.description||"",category:a.category||"stem",students:(V=a.students)!=null&&V.length?a.students:[""],teacher:a.teacher||"",mediaType:a.mediaType||"image",mediaFile:null,youtubeUrl:a.youtubeUrl||"",tags:(F=a.tags)!=null&&F.length?a.tags:[""],awards:(U=a.awards)!=null&&U.length?a.awards:[""],featured:a.featured||!1}),x(a.schoolId||""),b(a.mediaUrl||null)):(g({title:"",description:"",category:"stem",students:[""],teacher:"",mediaType:"image",mediaFile:null,youtubeUrl:"",tags:[""],awards:[""],featured:!1}),x(""),b(null))},[e,a,s==null?void 0:s.role]);const E=[{id:"stem",name:"العلوم والتقنية"},{id:"entrepreneurship",name:"ريادة الأعمال"},{id:"volunteer",name:"التطوع"},{id:"ethics",name:"الأخلاق"}],A=(V,F)=>{g(U=>({...U,[V]:F}))},P=(V,F,U)=>{g(q=>({...q,[V]:q[V].map((K,T)=>T===F?U:K)}))},L=V=>{g(F=>({...F,[V]:[...F[V],""]}))},R=(V,F)=>{g(U=>({...U,[V]:U[V].filter((q,K)=>K!==F)}))},I=V=>{const F=V.target.files&&V.target.files[0];F&&(g(U=>({...U,mediaFile:F})),b(URL.createObjectURL(F)))},D=async V=>{if(V.preventDefault(),!m.title||!m.description){_("يرجى ملء جميع الحقول المطلوبة");return}if(m.mediaType==="youtube"&&!m.youtubeUrl){_("يرجى إدخال رابط يوتيوب صالح");return}if((m.mediaType==="image"||m.mediaType==="video")&&!m.mediaFile){_("يرجى اختيار ملف للرفع");return}if(!s){_("يجب تسجيل الدخول أولاً");return}if(s.role!=="admin"&&s.role!=="school"){_("ليس لديك صلاحية لإضافة مشاريع للمعرض");return}j(!0),_(null),k(null);try{let F="",U={embedUrl:"",watchUrl:""};if(m.mediaType==="youtube"){if(!m.youtubeUrl.trim())throw new Error("يرجى إدخال رابط يوتيوب");U=c(m.youtubeUrl),F=U.embedUrl}else if(m.mediaFile){const O=await l(m.mediaFile);F=O.url,m.mediaType=O.type}else if(!a||a&&m.mediaFile)throw new Error("يرجى اختيار ملف للرفع");let q="",K="";if(s.role==="admin"){if(!f)throw new Error("يرجى اختيار المدرسة");const O=d.find(W=>W.id===f);if(!O)throw new Error("المدرسة المحددة غير صالحة");q=O.id,K=O.name}else if(s.role==="school")q=s.id,K=s.name||"مدرسة غير معروفة";else throw new Error("ليس لديك صلاحية لإضافة مشاريع للمعرض");const T={title:m.title,description:m.description,category:m.category,students:m.students.filter(O=>O.trim()),school:K,schoolId:q,teacher:m.teacher||(s==null?void 0:s.name)||"مشرف غير معروف",mediaUrl:F||(a==null?void 0:a.mediaUrl)||"",mediaType:m.mediaType,tags:m.tags.filter(O=>O.trim()),awards:m.awards.filter(O=>O.trim()),featured:m.featured,rating:(a==null?void 0:a.rating)||4.5};m.mediaType==="youtube"?(T.youtubeUrl=U.watchUrl,T.video=U.embedUrl):(T.youtubeUrl=null,T.video=null),console.log("Submitting gallery project data:",T),a?await o(a.id,T):await i(T),k("تم إضافة المشروع للمعرض بنجاح"),g({title:"",description:"",category:"stem",students:[""],teacher:"",mediaType:"image",mediaFile:null,youtubeUrl:"",tags:[""],awards:[""],featured:!1}),setTimeout(()=>{r(),t()},1500)}catch(F){console.error("Error adding gallery project:",F),_(F instanceof Error?F.message:"حدث خطأ في إضافة المشروع")}finally{j(!1)}};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(jo,{className:"w-6 h-6 text-pink-600"}),a?"تعديل مشروع المعرض":(s==null?void 0:s.role)==="school"?`إضافة مشروع لمعرض ${s.name}`:"إضافة مشروع للمعرض"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),w&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:w})]}),S&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Le,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:S})]}),(s==null?void 0:s.role)==="school"&&n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 mb-6",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Le,{className:"w-5 h-5 text-green-600"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-green-800",children:"صلاحيات المدرسة"}),n.jsx("p",{className:"text-green-700 text-sm",children:"يمكنك إضافة مشاريع طلاب مدرستك فقط إلى المعرض"})]})]})}),(s==null?void 0:s.role)==="admin"&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx(fa,{className:"w-5 h-5 text-blue-600"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800",children:"اختيار المدرسة"}),n.jsx("p",{className:"text-blue-700 text-sm",children:"اختر المدرسة التي ينتمي إليها هذا المشروع"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدرسة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(fa,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:f,onChange:V=>x(V.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:"اختر المدرسة"}),p&&n.jsx("option",{disabled:!0,children:"جاري تحميل المدارس..."}),!p&&d.length===0&&n.jsx("option",{disabled:!0,children:"لا توجد مدارس متاحة"}),!p&&d.map(V=>n.jsx("option",{value:V.id,children:V.name},V.id))]})]})]})]}),(s==null?void 0:s.role)==="school"&&n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(fa,{className:"w-5 h-5 text-blue-600"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800",children:"معلومات المدرسة"}),n.jsxs("p",{className:"text-blue-700 text-sm",children:["سيتم إضافة هذا المشروع لمعرض ",s.name]})]})]})}),n.jsxs("form",{onSubmit:D,className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان المشروع *"}),n.jsx("input",{type:"text",value:m.title,onChange:V=>A("title",V.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent",placeholder:"أدخل عنوان المشروع",required:!0})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف المشروع *"}),n.jsx("textarea",{value:m.description,onChange:V=>A("description",V.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent",placeholder:"اكتب وصفاً شاملاً للمشروع وإنجازاته",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"فئة المشروع *"}),n.jsx("select",{value:m.category,onChange:V=>A("category",V.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent",required:!0,children:E.map(V=>n.jsx("option",{value:V.id,children:V.name},V.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المشرف"}),n.jsxs("div",{className:"relative",children:[n.jsx(Xt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:m.teacher,onChange:V=>A("teacher",V.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent",placeholder:(s==null?void 0:s.role)==="school"&&s.name||"اسم المشرف"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الوسائط *"}),n.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${m.mediaType==="image"?"bg-pink-50 border-pink-500 text-pink-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"mediaType",value:"image",checked:m.mediaType==="image",onChange:()=>A("mediaType","image"),className:"sr-only"}),n.jsx(sl,{className:"w-5 h-5"}),n.jsx("span",{children:"صورة"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${m.mediaType==="video"?"bg-pink-50 border-pink-500 text-pink-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"mediaType",value:"video",checked:m.mediaType==="video",onChange:()=>A("mediaType","video"),className:"sr-only"}),n.jsx(ar,{className:"w-5 h-5"}),n.jsx("span",{children:"فيديو"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${m.mediaType==="youtube"?"bg-pink-50 border-pink-500 text-pink-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"mediaType",value:"youtube",checked:m.mediaType==="youtube",onChange:()=>A("mediaType","youtube"),className:"sr-only"}),n.jsx(fu,{className:"w-5 h-5"}),n.jsx("span",{children:"يوتيوب"})]})]}),m.mediaType==="youtube"?n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط يوتيوب *"}),n.jsx("input",{type:"url",value:m.youtubeUrl,onChange:V=>A("youtubeUrl",V.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent",placeholder:"https://www.youtube.com/watch?v=...",required:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"يمكنك إدخال رابط المشاهدة العادي أو رابط التضمين"})]}):n.jsxs("div",{className:"space-y-4",children:[v&&n.jsxs("div",{className:"relative w-full h-48 rounded-xl overflow-hidden border border-gray-300",children:[m.mediaType==="image"?n.jsx("img",{src:v,alt:"Media Preview",className:"w-full h-full object-cover"}):n.jsx("video",{src:v,controls:!0,className:"w-full h-full object-cover"}),n.jsx("button",{type:"button",onClick:()=>{b(null),g(V=>({...V,mediaFile:null})),y.current&&(y.current.value="")},className:"absolute top-2 right-2 p-1 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70",children:n.jsx(Qe,{className:"w-4 h-4"})})]}),n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a&&!m.mediaFile?`تغيير ${m.mediaType==="image"?"الصورة":"الفيديو"}`:`رفع ${m.mediaType==="image"?"صورة":"فيديو"} *`}),n.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center cursor-pointer hover:border-pink-500 transition-colors",onClick:()=>{var V;return(V=y.current)==null?void 0:V.click()},children:[n.jsx("input",{type:"file",accept:m.mediaType==="image"?"image/*":"video/*",onChange:I,className:"hidden",id:"media-upload",ref:y}),!v&&n.jsxs(n.Fragment,{children:[n.jsx(Pn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:m.mediaFile?m.mediaFile.name:`اسحب وأفلت ${m.mediaType==="image"?"الصورة":"الفيديو"} هنا أو اضغط للاختيار`}),n.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["الحد الأقصى للحجم: ",m.mediaType==="image"?"10MB":"100MB"]})]})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"أسماء الطلاب المشاركين"}),n.jsxs("div",{className:"space-y-3",children:[m.students.map((V,F)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:V,onChange:U=>P("students",F,U.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent",placeholder:`الطالب ${F+1}`}),m.students.length>1&&n.jsx("button",{type:"button",onClick:()=>R("students",F),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]},F)),n.jsxs("button",{type:"button",onClick:()=>L("students"),className:"flex items-center gap-2 px-4 py-2 text-pink-600 hover:bg-pink-100 rounded-lg transition-colors",children:[n.jsx(dt,{className:"w-4 h-4"}),"إضافة طالب"]})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"أدخل أسماء الطلاب المشاركين في المشروع"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكلمات المفتاحية"}),n.jsxs("div",{className:"space-y-3",children:[m.tags.map((V,F)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:V,onChange:U=>P("tags",F,U.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent",placeholder:`كلمة مفتاحية ${F+1}`}),m.tags.length>1&&n.jsx("button",{type:"button",onClick:()=>R("tags",F),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]},F)),n.jsxs("button",{type:"button",onClick:()=>L("tags"),className:"flex items-center gap-2 px-4 py-2 text-pink-600 hover:bg-pink-100 rounded-lg transition-colors",children:[n.jsx(il,{className:"w-4 h-4"}),"إضافة كلمة مفتاحية"]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الجوائز والإنجازات (اختياري)"}),n.jsxs("div",{className:"space-y-3",children:[m.awards.map((V,F)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:V,onChange:U=>P("awards",F,U.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent",placeholder:`جائزة ${F+1}`}),m.awards.length>1&&n.jsx("button",{type:"button",onClick:()=>R("awards",F),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]},F)),n.jsxs("button",{type:"button",onClick:()=>L("awards"),className:"flex items-center gap-2 px-4 py-2 text-pink-600 hover:bg-pink-100 rounded-lg transition-colors",children:[n.jsx(lr,{className:"w-4 h-4"}),"إضافة جائزة"]})]})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"featured",checked:m.featured,onChange:V=>A("featured",V.target.checked),className:"w-4 h-4 text-pink-600 border-gray-300 rounded focus:ring-pink-500"}),n.jsx("label",{htmlFor:"featured",className:"mr-2 block text-sm text-gray-900",children:"عرض كمشروع مميز"})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:N,className:"px-6 py-3 bg-pink-500 text-white rounded-xl hover:bg-pink-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:N?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الإضافة..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Za,{className:"w-5 h-5"}),a?"حفظ التغييرات":"إضافة للمعرض"]})})]})]})]})}):null},QE=({isOpen:e,onClose:t,onConfirm:r,title:a,isDeleting:s})=>e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Ge,{className:"w-6 h-6 text-red-600"}),"تأكيد الحذف"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700",children:"هل أنت متأكد من حذف فكرة المشروع التالية؟"}),n.jsxs("p",{className:"font-semibold text-gray-800 mt-2",children:['"',a,'"']}),n.jsx("p",{className:"text-red-600 text-sm mt-4",children:"هذا الإجراء لا يمكن التراجع عنه."})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:r,disabled:s,className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحذف..."]}):n.jsxs(n.Fragment,{children:[n.jsx(nr,{className:"w-5 h-5"}),"تأكيد الحذف"]})})]})]})}):null,RF=()=>{const{user:e}=ut(),{projects:t,loading:r,error:a,incrementViews:s,incrementLikes:i,fetchGalleryProjects:o,deleteGalleryProject:l}=JE(),[c,d]=C.useState("all"),[u,f]=C.useState(""),[x,p]=C.useState(!1),[h,m]=C.useState(!1),[g,v]=C.useState([]),[b,y]=C.useState(!1),[N,j]=C.useState(null),[w,_]=C.useState(null),[S,k]=C.useState(!1),[E,A]=C.useState(null),[P,L]=C.useState(!1),R=[{id:"all",name:"جميع المشاريع"},{id:"stem",name:"العلوم والتقنية"},{id:"entrepreneurship",name:"ريادة الأعمال"},{id:"volunteer",name:"التطوع"},{id:"ethics",name:"الأخلاق"}],I=t.filter(O=>{const W=c==="all"||O.category===c,z=O.title.toLowerCase().includes(u.toLowerCase())||O.description.toLowerCase().includes(u.toLowerCase())||O.school.toLowerCase().includes(u.toLowerCase())||O.students.some(te=>te.toLowerCase().includes(u.toLowerCase()));return W&&z}),D=async O=>{try{await s(O);const W=t.find(z=>z.id===O);W&&_(W)}catch(W){console.error("Error incrementing views:",W)}},V=async O=>{try{g.includes(O)||(await i(O),v(W=>[...W,O]))}catch(W){console.error("Error incrementing likes:",W)}},F=O=>{switch(O){case"stem":return"العلوم والتقنية";case"entrepreneurship":return"ريادة الأعمال";case"volunteer":return"التطوع";case"ethics":return"الأخلاق";default:return O}},U=O=>{j(O),y(!0)},q=O=>{A(O),k(!0)},K=async()=>{if(E){L(!0);try{await l(E.id),k(!1),o()}catch(O){console.error("Error deleting project:",O)}finally{L(!1),A(null)}}},T=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="school";return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-pink-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ge,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-pink-600 to-rose-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(jo,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"معرض المشاريع"}),n.jsx("p",{className:"opacity-90",children:"استكشف المشاريع المميزة والملهمة من طلابنا"})]})]}),T&&n.jsxs("button",{onClick:()=>m(!0),className:"bg-white text-pink-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5"}),"إضافة مشروع"]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:"مشروع مميز"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(O=>O.featured).length}),n.jsx("div",{className:"text-sm opacity-80",children:"مشروع مختار"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.reduce((O,W)=>O+W.views,0).toLocaleString()}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي المشاهدات"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:R.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:"فئة مختلفة"})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في المشاريع...",value:u,onChange:O=>f(O.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>p(!x),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(nl,{className:"w-5 h-5"}),"الفلاتر"]})]}),n.jsxs("div",{className:`${x?"block":"hidden lg:block"}`,children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"الفئات"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:R.map(O=>n.jsx("button",{onClick:()=>d(O.id),className:`px-4 py-2 rounded-xl transition-all ${c===O.id?"bg-pink-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:O.name},O.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:["عرض ",I.length," من أصل ",t.length," مشروع"]})}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:I.map((O,W)=>{const z=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="school"&&(e==null?void 0:e.schoolId)===O.schoolId,te=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="school"&&(e==null?void 0:e.schoolId)===O.schoolId;return n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:W*.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"relative h-48 overflow-hidden",children:[O.mediaType==="youtube"&&O.video?n.jsx("iframe",{src:O.video,title:O.title,className:"w-full h-full",frameBorder:"0",allowFullScreen:!0}):O.mediaType==="video"?n.jsx("video",{src:O.mediaUrl,className:"w-full h-full object-cover",controls:!0}):n.jsx("img",{src:O.mediaUrl,alt:O.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),O.featured&&n.jsxs("div",{className:"absolute top-4 right-4 bg-yellow-500 text-white px-2 py-1 rounded-lg text-sm font-medium flex items-center gap-1",children:[n.jsx(lr,{className:"w-3 h-3"}),"مميز"]}),n.jsxs("div",{className:"absolute top-4 left-4 flex gap-2",children:[n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(mr,{className:"w-3 h-3"}),O.views]}),n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(Xa,{className:"w-3 h-3"}),O.likes]})]}),n.jsx("div",{className:"absolute bottom-4 right-4",children:n.jsx("span",{className:"px-2 py-1 bg-pink-100 text-pink-800 rounded-lg text-xs font-medium",children:F(O.category)})})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:O.rating})]}),n.jsx("span",{className:"text-gray-300",children:"•"}),n.jsx("span",{className:"text-sm text-gray-600",children:Ye(O.completedAt)})]}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 group-hover:text-pink-600 transition-colors",children:O.title}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-3 leading-relaxed",children:O.description}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(dt,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"الطلاب المشاركون:"})]}),n.jsxs("div",{className:"flex flex-wrap gap-1",children:[O.students.slice(0,3).map((ae,se)=>n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-lg",children:ae},se)),O.students.length>3&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",O.students.length-3]})]})]}),n.jsxs("div",{className:"mb-4 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(fa,{className:"w-4 h-4"}),n.jsx("span",{children:O.school})]}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(dt,{className:"w-4 h-4"}),n.jsxs("span",{children:["المشرف: ",O.teacher]})]})]}),O.tags&&O.tags.length>0&&n.jsx("div",{className:"mb-4",children:n.jsxs("div",{className:"flex flex-wrap gap-1",children:[O.tags.slice(0,3).map((ae,se)=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["#",ae]},se)),O.tags.length>3&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",O.tags.length-3]})]})}),O.awards&&O.awards.length>0&&n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(lr,{className:"w-4 h-4 text-yellow-500"}),n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"الجوائز:"})]}),n.jsx("div",{className:"flex flex-wrap gap-1",children:O.awards.map((ae,se)=>n.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-lg",children:ae},se))})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[(z||te)&&n.jsxs("div",{className:"flex gap-2",children:[z&&n.jsx("button",{onClick:ae=>{ae.preventDefault(),U(O)},className:"p-2 rounded-lg bg-blue-100 text-blue-600 hover:bg-blue-200 transition-colors",title:"تعديل",children:n.jsx(Ia,{className:"w-4 h-4"})}),te&&n.jsx("button",{onClick:ae=>{ae.preventDefault(),q(O)},className:"p-2 rounded-lg bg-red-100 text-red-600 hover:bg-red-200 transition-colors",title:"حذف",children:n.jsx(nr,{className:"w-4 h-4"})})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>V(O.id),className:`p-2 rounded-lg transition-colors ${g.includes(O.id)?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600"}`,children:n.jsx(Xa,{className:"w-4 h-4"})}),O.mediaType==="youtube"&&O.youtubeUrl&&n.jsx("a",{href:O.youtubeUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600 transition-colors",children:n.jsx(_o,{className:"w-4 h-4"})})]}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs("button",{onClick:()=>D(O.id),className:"px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition-colors text-sm font-medium flex items-center gap-2",children:[n.jsx(mr,{className:"w-4 h-4"}),"عرض التفاصيل"]})})]})]})]},O.id)})}),I.length===0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(jo,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لا توجد مشاريع"}),n.jsx("p",{className:"text-gray-600 mb-4",children:t.length===0?"لم يتم إضافة أي مشاريع للمعرض بعد":"لم يتم العثور على مشاريع تطابق معايير البحث"}),n.jsxs("div",{className:"flex justify-center gap-4",children:[T&&n.jsxs("button",{onClick:()=>m(!0),className:"px-6 py-2 bg-pink-500 text-white rounded-xl hover:bg-pink-600 transition-colors flex items-center gap-2",children:[n.jsx(pt,{className:"w-4 h-4"}),"إضافة مشروع جديد"]}),t.length>0&&n.jsx("button",{onClick:()=>{d("all"),f("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إعادة تعيين الفلاتر"})]})]}),w&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsx(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:"relative h-64 bg-gradient-to-r from-pink-600 to-rose-600",children:[w.mediaType==="youtube"&&w.video?n.jsx("iframe",{src:w.video,title:w.title,className:"w-full h-full opacity-80",frameBorder:"0",allowFullScreen:!0}):w.mediaType==="video"?n.jsx("video",{src:w.mediaUrl,className:"w-full h-full object-cover opacity-80",controls:!0}):n.jsx("img",{src:w.mediaUrl,alt:w.title,className:"w-full h-full object-cover opacity-80"}),n.jsx("button",{onClick:()=>_(null),className:"absolute top-4 right-4 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-70 transition-colors",children:n.jsx(Qe,{className:"w-6 h-6"})}),n.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"px-3 py-1 bg-pink-100 text-pink-800 rounded-full text-xs font-medium",children:F(w.category)}),w.featured&&n.jsxs("span",{className:"px-3 py-1 bg-yellow-500 text-white rounded-full text-xs font-medium flex items-center gap-1",children:[n.jsx(lr,{className:"w-3 h-3"}),"مميز"]})]}),n.jsx("h2",{className:"text-2xl font-bold text-white",children:w.title})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"وصف المشروع"}),n.jsx("p",{className:"text-gray-600 leading-relaxed mb-4",children:w.description}),n.jsxs("div",{className:"mb-4",children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"الطلاب المشاركون:"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:w.students.map((O,W)=>n.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-lg",children:O},W))})]}),w.tags&&w.tags.length>0&&n.jsxs("div",{className:"mb-4",children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"الكلمات المفتاحية:"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:w.tags.map((O,W)=>n.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded-lg",children:["#",O]},W))})]}),w.awards&&w.awards.length>0&&n.jsxs("div",{className:"mb-4",children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"الجوائز والإنجازات:"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:w.awards.map((O,W)=>n.jsxs("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 text-sm rounded-lg flex items-center gap-1",children:[n.jsx(lr,{className:"w-3 h-3"}),O]},W))})]})]}),n.jsx("div",{children:n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"معلومات المشروع"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المدرسة"}),n.jsx("p",{className:"font-medium",children:w.school})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المشرف"}),n.jsx("p",{className:"font-medium",children:w.teacher})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"تاريخ الإكمال"}),n.jsx("p",{className:"font-medium",children:Ye(w.completedAt)})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"التقييم"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:w.rating})]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المشاهدات"}),n.jsx("p",{className:"font-medium",children:w.views})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"الإعجابات"}),n.jsx("p",{className:"font-medium",children:w.likes})]})]})]})})]}),n.jsxs("div",{className:"flex justify-between pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[n.jsx(mr,{className:"w-5 h-5"}),n.jsxs("span",{children:[w.views," مشاهدة"]})]}),n.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[n.jsx(Xa,{className:"w-5 h-5"}),n.jsxs("span",{children:[w.likes," إعجاب"]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:()=>V(w.id),className:`px-6 py-2 rounded-xl transition-colors flex items-center gap-2 ${g.includes(w.id)?"bg-red-500 text-white":"bg-red-100 text-red-600 hover:bg-red-500 hover:text-white"}`,children:[n.jsx(Xa,{className:"w-5 h-5"}),"إعجاب"]}),w.mediaType==="youtube"&&w.youtubeUrl&&n.jsxs("a",{href:w.youtubeUrl,target:"_blank",rel:"noopener noreferrer",className:"px-6 py-2 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors flex items-center gap-2",children:[n.jsx(_o,{className:"w-5 h-5"}),"مشاهدة على يوتيوب"]}),n.jsx("button",{onClick:()=>_(null),className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إغلاق"})]})]})]})]})})}),n.jsx(X1,{isOpen:h,onClose:()=>m(!1),onSuccess:()=>{m(!1)}})]}),b&&n.jsx(X1,{isOpen:b,onClose:()=>y(!1),onSuccess:()=>{y(!1),o()},editingProject:N}),S&&E&&n.jsx(QE,{isOpen:S,onClose:()=>k(!1),onConfirm:K,title:E.title,isDeleting:P})]})},MF=async()=>{try{const e=await Ie(Oe(he,"store_items")),t=[];return e.forEach(r=>{const a=r.data();t.push({id:r.id,name:a.name||"",description:a.description||"",price:a.price||0,originalPrice:a.original_price,category:a.category||"",features:a.features||[],tags:a.tags||[],image:a.image_url||"",rating:a.rating||5,reviews:a.reviews_count||0,views:a.views_count||0,inStock:a.in_stock||!1,stockQuantity:a.stock_quantity||0,discount:a.discount_percentage,featured:a.featured||!1})}),t}catch(e){throw console.error("Error fetching store items from Firestore:",e),e}},Wf=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),o=async()=>{try{a(!0),i(null),console.log("Fetching store items...");const x=await MF();console.log(`Found ${x.length} store items`),t(x)}catch(x){console.error("Error fetching store items:",x),i(x instanceof Error?x.message:"حدث خطأ في تحميل المنتجات")}finally{a(!1)}},l=async x=>{try{const p=st(he,"store_items",x);await sr(p,{views_count:So(1)}),t(h=>h.map(m=>m.id===x?{...m,views:m.views+1}:m))}catch(p){console.error("Error incrementing views:",p)}},c=async x=>{try{a(!0),i(null);const p={name:x.name,description:x.description,price:x.price,original_price:x.originalPrice??null,category:x.category,features:x.features||[],tags:x.tags||[],image_url:x.image,rating:x.rating||5,reviews_count:0,views_count:0,in_stock:x.inStock,stock_quantity:x.stockQuantity||0,discount_percentage:x.discount??null,featured:x.featured||!1,created_at:Ve(),updated_at:Ve()},m={id:(await Fa(Oe(he,"store_items"),p)).id,name:x.name,description:x.description,price:x.price,originalPrice:x.originalPrice,category:x.category,features:x.features||[],tags:x.tags||[],image:x.image,rating:x.rating||5,reviews:0,views:0,inStock:x.inStock,stockQuantity:x.stockQuantity||0,discount:x.discount,featured:x.featured||!1};return t(g=>[m,...g]),m}catch(p){throw console.error("Error creating store item:",p),i(p instanceof Error?p.message:"حدث خطأ في إضافة المنتج"),p}finally{a(!1)}},d=async(x,p)=>{try{a(!0),i(null);const h=st(he,"store_items",x),m={updated_at:Ve()};return p.name!==void 0&&(m.name=p.name),p.description!==void 0&&(m.description=p.description),p.price!==void 0&&(m.price=p.price),p.originalPrice!==void 0&&(m.original_price=p.originalPrice??null),p.category!==void 0&&(m.category=p.category),p.features!==void 0&&(m.features=p.features),p.tags!==void 0&&(m.tags=p.tags),p.image!==void 0&&(m.image_url=p.image),p.rating!==void 0&&(m.rating=p.rating),p.inStock!==void 0&&(m.in_stock=p.inStock),p.stockQuantity!==void 0&&(m.stock_quantity=p.stockQuantity),p.discount!==void 0&&(m.discount_percentage=p.discount??null),p.featured!==void 0&&(m.featured=p.featured),await sr(h,m),t(g=>g.map(v=>v.id===x?{...v,...p}:v)),{id:x,...p}}catch(h){throw console.error("Error updating store item:",h),i(h instanceof Error?h.message:"حدث خطأ في تحديث المنتج"),h}finally{a(!1)}},u=async x=>{try{a(!0),i(null);const p=st(he,"store_items",x);return await Da(p),t(h=>h.filter(m=>m.id!==x)),!0}catch(p){throw console.error("Error deleting store item:",p),i(p instanceof Error?p.message:"حدث خطأ في حذف المنتج"),p}finally{a(!1)}},f=async()=>{try{a(!0),i(null),console.log("Deleting all store items...");const x=Oe(he,"store_items"),p=await Ie(x);if(p.empty)return console.log("No store items to delete"),0;let h=0;for(const m of p.docs)await Da(m.ref),h++;return console.log(`Successfully deleted ${h} store items`),t([]),h}catch(x){throw console.error("Error deleting all store items:",x),i(x instanceof Error?x.message:"حدث خطأ في حذف جميع المنتجات"),x}finally{a(!1)}};return C.useEffect(()=>{o()},[]),{storeItems:e,loading:r,error:s,fetchStoreItems:o,incrementViews:l,createStoreItem:c,updateStoreItem:d,deleteStoreItem:u,deleteAllStoreItems:f}},LF=({isOpen:e,onClose:t,onSubmit:r,editingItem:a})=>{var S,k;const[s,i]=C.useState({name:"",description:"",price:0,originalPrice:void 0,category:"electronics",features:[""],tags:[],image:"",rating:5,inStock:!0,stockQuantity:1,discount:void 0,featured:!1}),[o,l]=C.useState(""),[c,d]=C.useState(""),[u,f]=C.useState(!1),[x,p]=C.useState(null),[h,m]=C.useState(null);C.useEffect(()=>{var E;i(a?{...a,features:(E=a.features)!=null&&E.length?a.features:[""],tags:a.tags||[]}:{name:"",description:"",price:0,originalPrice:void 0,category:"electronics",features:[""],tags:[],image:"",rating:5,inStock:!0,stockQuantity:1,discount:void 0,featured:!1}),l(""),d(""),p(null),m(null)},[a,e]);const g=[{id:"electronics",name:"الإلكترونيات"},{id:"tools",name:"الأدوات"},{id:"materials",name:"المواد"},{id:"books",name:"الكتب"},{id:"software",name:"البرمجيات"}],v=(E,A)=>{i(P=>({...P,[E]:A}))},b=(E,A)=>{i(P=>{var L;return{...P,features:((L=P.features)==null?void 0:L.map((R,I)=>I===E?A:R))||[]}})},y=()=>{c.trim()?(i(E=>({...E,features:[...E.features||[],c.trim()]})),d("")):i(E=>({...E,features:[...E.features||[],""]}))},N=E=>{i(A=>{var P;return{...A,features:((P=A.features)==null?void 0:P.filter((L,R)=>R!==E))||[]}})},j=()=>{o.trim()&&(i(E=>({...E,tags:[...E.tags||[],o.trim()]})),l(""))},w=E=>{i(A=>{var P;return{...A,tags:((P=A.tags)==null?void 0:P.filter((L,R)=>R!==E))||[]}})},_=async E=>{var P;if(E.preventDefault(),!s.name||!s.description||!s.price||!s.category||!s.image){p("يرجى ملء جميع الحقول المطلوبة");return}const A={...s,features:((P=s.features)==null?void 0:P.filter(L=>L.trim()))||[]};f(!0),p(null),m(null);try{await r(A),m(a?"تم تحديث المنتج بنجاح":"تم إضافة المنتج بنجاح"),setTimeout(()=>{t()},1500)}catch(L){console.error("Error submitting store item:",L),p(L instanceof Error?L.message:"حدث خطأ في حفظ المنتج")}finally{f(!1)}};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(zr,{className:"w-6 h-6 text-purple-600"}),a?"تعديل منتج":"إضافة منتج جديد"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),x&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:x})]}),h&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Le,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:h})]}),n.jsxs("form",{onSubmit:_,className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اسم المنتج *"}),n.jsx("input",{type:"text",value:s.name,onChange:E=>v("name",E.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل اسم المنتج",required:!0})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف المنتج *"}),n.jsx("textarea",{value:s.description,onChange:E=>v("description",E.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"اكتب وصفاً تفصيلياً للمنتج",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الفئة *"}),n.jsx("select",{value:s.category,onChange:E=>v("category",E.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:g.map(E=>n.jsx("option",{value:E.id,children:E.name},E.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط الصورة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(sl,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"url",value:s.image,onChange:E=>v("image",E.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل رابط صورة المنتج",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"السعر *"}),n.jsxs("div",{className:"relative",children:[n.jsx(hu,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:s.price,onChange:E=>v("price",parseFloat(E.target.value)||0),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل سعر المنتج",min:"0",step:"0.01",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"السعر الأصلي (اختياري)"}),n.jsxs("div",{className:"relative",children:[n.jsx(hu,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:s.originalPrice||"",onChange:E=>v("originalPrice",E.target.value?parseFloat(E.target.value):void 0),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل السعر الأصلي قبل الخصم",min:"0",step:"0.01"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نسبة الخصم (اختياري)"}),n.jsxs("div",{className:"relative",children:[n.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:"%"}),n.jsx("input",{type:"number",value:s.discount||"",onChange:E=>v("discount",E.target.value?parseFloat(E.target.value):void 0),className:"w-full px-4 py-3 pr-10 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل نسبة الخصم",min:"0",max:"100"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التقييم"}),n.jsxs("div",{className:"relative",children:[n.jsx(lt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:s.rating,onChange:E=>v("rating",parseFloat(E.target.value)||5),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل تقييم المنتج",min:"1",max:"5",step:"0.1"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكمية المتوفرة"}),n.jsxs("div",{className:"relative",children:[n.jsx(Lf,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:s.stockQuantity,onChange:E=>v("stockQuantity",parseInt(E.target.value)||0),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل الكمية المتوفرة",min:"0"})]})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"inStock",checked:s.inStock,onChange:E=>v("inStock",E.target.checked),className:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),n.jsx("label",{htmlFor:"inStock",className:"mr-2 block text-sm text-gray-900",children:"متوفر في المخزون"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"featured",checked:s.featured,onChange:E=>v("featured",E.target.checked),className:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),n.jsx("label",{htmlFor:"featured",className:"mr-2 block text-sm text-gray-900",children:"منتج مميز"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مميزات المنتج"}),n.jsxs("div",{className:"space-y-3",children:[(S=s.features)==null?void 0:S.map((E,A)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:E,onChange:P=>b(A,P.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:`الميزة ${A+1}`}),s.features&&s.features.length>1&&n.jsx("button",{type:"button",onClick:()=>N(A),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(nr,{className:"w-5 h-5"})})]},A)),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:c,onChange:E=>d(E.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل ميزة جديدة"}),n.jsx("button",{type:"button",onClick:y,className:"px-4 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:n.jsx(pt,{className:"w-5 h-5"})})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكلمات المفتاحية"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(k=s.tags)==null?void 0:k.map((E,A)=>n.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-purple-100 text-purple-800 rounded-full",children:[n.jsx("span",{children:E}),n.jsx("button",{type:"button",onClick:()=>w(A),className:"w-4 h-4 rounded-full flex items-center justify-center hover:bg-purple-200",children:n.jsx(Qe,{className:"w-3 h-3"})})]},A))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(il,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:o,onChange:E=>l(E.target.value),onKeyPress:E=>E.key==="Enter"&&(E.preventDefault(),j()),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أضف كلمة مفتاحية"})]}),n.jsx("button",{type:"button",onClick:j,className:"px-4 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:"إضافة"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:u,className:"px-6 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:u?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Za,{className:"w-5 h-5"}),a?"حفظ التغييرات":"إضافة المنتج"]})})]})]})]})}):null},Y1=({isOpen:e,onClose:t,onConfirm:r,itemName:a,isDeleting:s})=>e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Ge,{className:"w-6 h-6 text-red-600"}),"تأكيد الحذف"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700",children:"هل أنت متأكد من حذف المنتج التالي؟"}),n.jsxs("p",{className:"font-semibold text-gray-800 mt-2",children:['"',a,'"']}),n.jsx("p",{className:"text-red-600 text-sm mt-4",children:"هذا الإجراء لا يمكن التراجع عنه."})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:r,disabled:s,className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحذف..."]}):n.jsxs(n.Fragment,{children:[n.jsx(nr,{className:"w-5 h-5"}),"تأكيد الحذف"]})})]})]})}):null,$F=({isOpen:e,onClose:t,item:r,onAddToCart:a,onToggleWishlist:s,isInWishlist:i})=>{const{t:o}=ft();if(!e||!r)return null;const l=async()=>{const c={title:r.name,text:r.description,url:window.location.href};if(navigator.share)try{await navigator.share(c)}catch{try{await navigator.clipboard.writeText(window.location.href),alert("تم نسخ رابط المنتج إلى الحافظة")}catch(u){console.error("Error copying to clipboard:",u),alert("حدث خطأ في المشاركة")}}else try{await navigator.clipboard.writeText(window.location.href),alert("تم نسخ رابط المنتج إلى الحافظة")}catch(d){console.error("Error copying to clipboard:",d),alert("حدث خطأ في المشاركة")}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsx(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"relative",children:[n.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-10 p-2 bg-white rounded-full shadow-md hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-0",children:[n.jsx("div",{className:"h-full bg-gray-100 flex items-center justify-center p-8",children:n.jsx("img",{src:r.image,alt:r.name,className:"max-w-full max-h-[400px] object-contain"})}),n.jsxs("div",{className:"p-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm",children:r.category==="electronics"?o("store.categories.electronics"):r.category==="tools"?o("store.categories.tools"):r.category==="materials"?o("store.categories.materials"):r.category==="books"?o("store.categories.books"):r.category==="software"?o("store.categories.software"):r.category}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-5 h-5 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:r.rating}),n.jsxs("span",{className:"text-gray-500",children:["(",r.reviews," ",o("store.reviews"),")"]})]})]}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:r.name}),n.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[n.jsxs("span",{className:"text-3xl font-bold text-purple-600",children:[r.price," ",o("store.currency")]}),r.originalPrice&&n.jsxs("span",{className:"text-xl text-gray-400 line-through",children:[r.originalPrice," ",o("store.currency")]}),r.discount&&n.jsxs("span",{className:"px-2 py-1 bg-red-500 text-white rounded-lg text-sm font-medium",children:["-",r.discount,"%"]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"الوصف"}),n.jsx("p",{className:"text-gray-600 leading-relaxed",children:r.description})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"المميزات"}),n.jsx("ul",{className:"space-y-2",children:r.features.map((c,d)=>n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(Le,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),n.jsx("span",{className:"text-gray-700",children:c})]},d))})]}),r.tags&&r.tags.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"الكلمات المفتاحية"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:r.tags.map((c,d)=>n.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center gap-1",children:[n.jsx(il,{className:"w-3 h-3"}),c]},d))})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[n.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${r.inStock?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.inStock?o("store.inStock"):o("store.outOfStock")}),r.inStock&&n.jsxs("span",{className:"text-sm text-gray-600",children:["(",r.stockQuantity," قطعة متوفرة)"]})]}),n.jsxs("div",{className:"flex gap-3 mb-6",children:[n.jsxs("button",{onClick:()=>a(r.id),disabled:!r.inStock,className:"flex-1 bg-purple-500 text-white py-3 px-4 rounded-xl hover:bg-purple-600 transition-colors font-medium disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[n.jsx(zr,{className:"w-5 h-5"}),o("store.addToCart")]}),n.jsx("button",{onClick:()=>s(r.id),className:`p-3 rounded-xl transition-colors ${i?"bg-red-500 text-white":"bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600"}`,children:n.jsx(Xa,{className:"w-5 h-5"})}),n.jsx("button",{onClick:l,className:"p-3 bg-gray-100 text-gray-600 rounded-xl hover:bg-gray-200 transition-colors",children:n.jsx(cE,{className:"w-5 h-5"})})]}),n.jsxs(ke,{to:"/cart",className:"w-full py-3 px-4 bg-gray-800 text-white rounded-xl hover:bg-gray-900 transition-colors font-medium flex items-center justify-center gap-2 mb-6",children:[n.jsx(zr,{className:"w-5 h-5"}),"الذهاب إلى سلة التسوق"]}),n.jsxs("div",{className:"border-t border-gray-200 pt-6 space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:n.jsx(hc,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"شحن مجاني"}),n.jsx("p",{className:"text-sm text-gray-600",children:"للطلبات فوق 200 ريال"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:n.jsx(Lf,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"ضمان الجودة"}),n.jsx("p",{className:"text-sm text-gray-600",children:"ضمان استرجاع لمدة 30 يوم"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(xt,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"توصيل سريع"}),n.jsx("p",{className:"text-sm text-gray-600",children:"خلال 2-5 أيام عمل"})]})]})]})]})]})]})})})},BF=()=>{const{t:e}=ft(),{user:t}=ut(),r=(t==null?void 0:t.role)==="admin",{storeItems:a,loading:s,error:i,incrementViews:o,createStoreItem:l,updateStoreItem:c,deleteStoreItem:d,deleteAllStoreItems:u}=Wf(),{cart:f,wishlist:x,addToCart:p,removeFromCart:h,toggleWishlist:m,getTotalItems:g,getTotalPrice:v}=dv(),[b,y]=C.useState("all"),[N,j]=C.useState(""),[w,_]=C.useState(!1),[S,k]=C.useState(null),[E,A]=C.useState(!1),[P,L]=C.useState(!1),[R,I]=C.useState(null),[D,V]=C.useState(!1),[F,U]=C.useState(!1),[q,K]=C.useState(!1),[T,O]=C.useState(!1),[W,z]=C.useState(null);C.useEffect(()=>{r&&K(!0)},[r]);const te=[{id:"all",name:e("store.categories.all")},{id:"electronics",name:e("store.categories.electronics")},{id:"tools",name:e("store.categories.tools")},{id:"materials",name:e("store.categories.materials")},{id:"books",name:e("store.categories.books")},{id:"software",name:e("store.categories.software")}],ae=a.filter(de=>{const xe=b==="all"||de.category===b,We=de.name.toLowerCase().includes(N.toLowerCase())||de.description.toLowerCase().includes(N.toLowerCase());return xe&&We}),se=de=>{o(de);const xe=a.find(We=>We.id===de);xe&&(z(xe),O(!0))},M=()=>{k(null),_(!0)},G=de=>{k(de),_(!0)},ne=de=>{I(de),A(!0)},B=()=>{L(!0)},pe=async()=>{if(R){V(!0);try{await d(R.id),A(!1)}catch(de){console.error("Error deleting item:",de)}finally{V(!1),I(null)}}},ye=async()=>{U(!0);try{await u(),L(!1)}catch(de){console.error("Error deleting all items:",de)}finally{U(!1)}},Te=async de=>{S?await c(S.id,de):await l(de)};return s?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-500"})}):i?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ja,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:i})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(zr,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("store.title")}),n.jsx("p",{className:"opacity-90",children:e("store.subtitle")})]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[r&&n.jsxs("button",{onClick:()=>K(!q),className:"bg-white bg-opacity-20 text-white px-4 py-2 rounded-xl hover:bg-opacity-30 transition-all duration-200 backdrop-blur-sm flex items-center gap-2",children:[n.jsx(wo,{className:"w-5 h-5"}),q?"وضع المستخدم":"وضع الإدارة"]}),!q&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"relative",children:n.jsxs("button",{className:"bg-white bg-opacity-20 text-white px-4 py-2 rounded-xl hover:bg-opacity-30 transition-all duration-200 backdrop-blur-sm flex items-center gap-2",children:[n.jsx(Xa,{className:"w-5 h-5"}),e("store.wishlist")," (",x.length,")"]})}),n.jsxs("div",{className:"relative",children:[n.jsxs(ke,{to:"/cart",className:"bg-white text-purple-600 px-4 py-2 rounded-xl hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(zr,{className:"w-5 h-5"}),e("store.cart")," (",g(),")"]}),g()>0&&n.jsx("span",{className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:g()})]})]}),r&&q&&n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:M,className:"bg-white text-purple-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5"}),"إضافة منتج جديد"]}),n.jsxs("button",{onClick:B,className:"bg-red-500 text-white px-6 py-3 rounded-xl font-medium hover:bg-red-600 transition-all duration-200 flex items-center gap-2",children:[n.jsx(nr,{className:"w-5 h-5"}),"حذف جميع المنتجات"]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:a.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("store.stats.availableProducts")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:te.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("store.stats.categories")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"24/7"}),n.jsx("div",{className:"text-sm opacity-80",children:e("store.stats.customerSupport")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e("store.stats.freeShipping")}),n.jsx("div",{className:"text-sm opacity-80",children:e("store.stats.shipping")})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-4",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("store.searchPlaceholder"),value:N,onChange:de=>j(de.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("store.filters.categories")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:te.map(de=>n.jsx("button",{onClick:()=>y(de.id),className:`px-4 py-2 rounded-xl transition-all ${b===de.id?"bg-purple-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:de.name},de.id))})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("p",{className:"text-gray-600",children:[e("store.showing")," ",ae.length," ",e("store.of")," ",a.length," ",e("store.product")]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-sm text-gray-600",children:[e("store.sortBy"),":"]}),n.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[n.jsx("option",{children:e("store.sortOptions.newest")}),n.jsx("option",{children:e("store.sortOptions.priceLowToHigh")}),n.jsx("option",{children:e("store.sortOptions.priceHighToLow")}),n.jsx("option",{children:e("store.sortOptions.rating")})]})]})]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:ae.map((de,xe)=>n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:xe*.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"relative h-48 overflow-hidden",children:[n.jsx("img",{src:de.image,alt:de.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),de.discount&&n.jsxs("div",{className:"absolute top-4 right-4 bg-red-500 text-white px-2 py-1 rounded-lg text-sm font-medium",children:["-",de.discount,"%"]}),n.jsx("div",{className:"absolute top-4 left-4",children:q?n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:()=>G(de),className:"p-2 rounded-full bg-white bg-opacity-80 text-blue-600 hover:bg-blue-500 hover:text-white transition-all",children:n.jsx(Ia,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>ne(de),className:"p-2 rounded-full bg-white bg-opacity-80 text-red-600 hover:bg-red-500 hover:text-white transition-all",children:n.jsx(nr,{className:"w-4 h-4"})})]}):n.jsx("button",{onClick:()=>m(de.id),className:`p-2 rounded-full transition-all ${x.includes(de.id)?"bg-red-500 text-white":"bg-white bg-opacity-80 text-gray-600 hover:bg-red-500 hover:text-white"}`,children:n.jsx(Xa,{className:"w-4 h-4"})})}),n.jsx("div",{className:"absolute bottom-4 left-4",children:n.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${de.inStock?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:de.inStock?e("store.inStock"):e("store.outOfStock")})})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:de.rating})]}),n.jsx("span",{className:"text-gray-300",children:"•"}),n.jsxs("span",{className:"text-sm text-gray-600",children:["(",de.reviews," ",e("store.reviews"),")"]})]}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 group-hover:text-purple-600 transition-colors",children:de.name}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-2 leading-relaxed",children:de.description}),n.jsx("div",{className:"mb-4",children:n.jsxs("div",{className:"flex flex-wrap gap-1",children:[de.features.slice(0,2).map((We,Nt)=>n.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:We},Nt)),de.features.length>2&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",de.features.length-2," ",e("store.more")]})]})}),n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsxs("span",{className:"text-2xl font-bold text-purple-600",children:[de.price," ",e("store.currency")]}),de.originalPrice&&n.jsxs("span",{className:"text-lg text-gray-400 line-through",children:[de.originalPrice," ",e("store.currency")]})]}),n.jsx("div",{className:"flex gap-2",children:q?n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>G(de),className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-xl hover:bg-blue-600 transition-colors font-medium flex items-center justify-center gap-2",children:[n.jsx(Ia,{className:"w-4 h-4"}),"تعديل"]}),n.jsx("button",{onClick:()=>ne(de),className:"px-4 py-2 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors",children:n.jsx(nr,{className:"w-4 h-4"})})]}):n.jsxs(n.Fragment,{children:[f[de.id]?n.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[n.jsx("button",{onClick:()=>h(de.id),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:n.jsx(dE,{className:"w-4 h-4"})}),n.jsx("span",{className:"flex-1 text-center font-medium",children:f[de.id]}),n.jsx("button",{onClick:()=>p(de.id),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:n.jsx(pt,{className:"w-4 h-4"})})]}):n.jsxs("button",{onClick:()=>p(de.id),disabled:!de.inStock,className:"flex-1 bg-purple-500 text-white py-2 px-4 rounded-xl hover:bg-purple-600 transition-colors font-medium disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[n.jsx(zr,{className:"w-4 h-4"}),e("store.addToCart")]}),n.jsx("button",{onClick:()=>se(de.id),className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:n.jsx(mr,{className:"w-4 h-4"})})]})})]})]},de.id))}),ae.length===0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(wt,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("store.noProductsFound")}),n.jsx("p",{className:"text-gray-600 mb-4",children:a.length===0?e("store.noProductsInStore"):e("store.tryChangingFilters")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[r&&q&&n.jsxs("button",{onClick:M,className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-2",children:[n.jsx(pt,{className:"w-4 h-4"}),"إضافة منتج جديد"]}),a.length>0&&n.jsx("button",{onClick:()=>{y("all"),j("")},className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:e("common.resetFilters")})]})]}),!q&&g()>0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"fixed bottom-6 right-6 bg-white rounded-2xl shadow-2xl p-6 border border-gray-200 z-50",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("store.cartSummary")}),n.jsxs("div",{className:"space-y-2 mb-4",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{children:[e("store.numberOfProducts"),":"]}),n.jsx("span",{className:"font-medium",children:g()})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{children:[e("store.total"),":"]}),n.jsxs("span",{className:"font-bold text-purple-600",children:[v(a).toFixed(2)," ",e("store.currency")]})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(ke,{to:"/cart",className:"flex-1 bg-purple-500 text-white py-2 px-4 rounded-xl hover:bg-purple-600 transition-colors font-medium",children:e("store.checkout")}),n.jsx(ke,{to:"/cart",className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("store.viewCart")})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gray-50 rounded-2xl p-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6 text-center",children:e("store.whyChooseUs")}),n.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(hc,{className:"w-8 h-8 text-green-600"})}),n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:e("store.features.freeShipping")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("store.features.freeShippingDesc")})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(ba,{className:"w-8 h-8 text-blue-600"})}),n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:e("store.features.qualityGuarantee")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("store.features.qualityGuaranteeDesc")})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(ti,{className:"w-8 h-8 text-purple-600"})}),n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:e("store.features.securePayment")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("store.features.securePaymentDesc")})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(Lf,{className:"w-8 h-8 text-orange-600"})}),n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:e("store.features.easyReturns")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("store.features.easyReturnsDesc")})]})]})]}),n.jsx(LF,{isOpen:w,onClose:()=>_(!1),onSubmit:Te,editingItem:S}),n.jsx(Y1,{isOpen:E,onClose:()=>A(!1),onConfirm:pe,itemName:(R==null?void 0:R.name)||"",isDeleting:D}),n.jsx(Y1,{isOpen:P,onClose:()=>L(!1),onConfirm:ye,itemName:"جميع المنتجات",isDeleting:F}),n.jsx($F,{isOpen:T,onClose:()=>O(!1),item:W,onAddToCart:p,onToggleWishlist:m,isInWishlist:W?x.includes(W.id):!1})]})},ZE=30,_g=200,eT=.15,UF=()=>{const{t:e}=ft(),{cart:t,wishlist:r,addToCart:a,removeFromCart:s,updateQuantity:i,clearCart:o,toggleWishlist:l,getTotalItems:c,getTotalPrice:d}=dv(),{storeItems:u,loading:f,error:x}=Wf(),[p,h]=C.useState(""),[m,g]=C.useState(null),[v,b]=C.useState(null),[y,N]=C.useState(!1),[j,w]=C.useState(0),_=Object.entries(t).map(([R,I])=>({item:u.find(V=>V.id===R),quantity:I})).filter(({item:R})=>R!==void 0),S=d(u),k=S>_g?0:ZE,E=S*eT,A=S+k+E-j,P=R=>{window.confirm("هل أنت متأكد من حذف هذا المنتج من السلة؟")&&i(R,0)},L=()=>{if(!p.trim()){g("يرجى إدخال كود الخصم");return}N(!0),g(null),b(null),setTimeout(()=>{if(p.toUpperCase()==="DISCOUNT20"){const R=S*.2;w(R),b("تم تطبيق الخصم بنجاح!")}else g("كود الخصم غير صالح");N(!1)},1e3)};return f?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-500"})}):x?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ge,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:x})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(zr,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"سلة التسوق"}),n.jsx("p",{className:"opacity-90",children:"مراجعة وإدارة منتجاتك"})]})]})}),n.jsx("div",{className:"flex items-center",children:n.jsxs(ke,{to:"/store",className:"flex items-center gap-2 text-purple-600 hover:text-purple-800 transition-colors",children:[n.jsx(Cn,{className:"w-5 h-5"}),n.jsx("span",{children:"العودة إلى المتجر"})]})}),n.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[n.jsx("div",{className:"lg:col-span-2",children:n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:["المنتجات (",c(),")"]}),_.length>0&&n.jsxs("button",{onClick:()=>o(),className:"text-red-600 hover:text-red-800 transition-colors text-sm flex items-center gap-1",children:[n.jsx(nr,{className:"w-4 h-4"}),"حذف الكل"]})]}),_.length>0?n.jsx("div",{className:"space-y-4",children:_.map(({item:R,quantity:I})=>R&&n.jsxs("div",{className:"flex items-center gap-4 p-4 border border-gray-200 rounded-xl hover:shadow-md transition-all",children:[n.jsx("div",{className:"w-20 h-20 rounded-lg overflow-hidden flex-shrink-0",children:n.jsx("img",{src:R.image,alt:R.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"font-medium text-gray-800 mb-1",children:R.name}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 mb-2",children:[n.jsxs("span",{children:["الفئة: ",R.category==="electronics"?e("store.categories.electronics"):R.category==="tools"?e("store.categories.tools"):R.category==="materials"?e("store.categories.materials"):R.category==="books"?e("store.categories.books"):R.category==="software"?e("store.categories.software"):R.category]}),R.inStock?n.jsx("span",{className:"text-green-600",children:"متوفر"}):n.jsx("span",{className:"text-red-600",children:"غير متوفر"})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>s(R.id),className:"p-1 border border-gray-300 rounded hover:bg-gray-100 transition-colors",children:n.jsx(dE,{className:"w-4 h-4"})}),n.jsx("span",{className:"w-8 text-center",children:I}),n.jsx("button",{onClick:()=>a(R.id),className:"p-1 border border-gray-300 rounded hover:bg-gray-100 transition-colors",children:n.jsx(pt,{className:"w-4 h-4"})})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>l(R.id),className:`p-1 rounded transition-colors ${r.includes(R.id)?"text-red-600 hover:text-red-800":"text-gray-400 hover:text-red-600"}`,children:n.jsx(Xa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>P(R.id),className:"p-1 text-gray-400 hover:text-red-600 transition-colors",children:n.jsx(nr,{className:"w-4 h-4"})})]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[R.price," ",e("store.currency")]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["الإجمالي: ",(R.price*I).toFixed(2)," ",e("store.currency")]})]})]},R.id))}):n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(zr,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"سلة التسوق فارغة"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"لم تقم بإضافة أي منتجات إلى سلة التسوق بعد"}),n.jsxs(ke,{to:"/store",className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors inline-flex items-center gap-2",children:[n.jsx(zr,{className:"w-4 h-4"}),"تسوق الآن"]})]}),_.length>10&&n.jsx("div",{className:"flex justify-center mt-6",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:n.jsx(Gl,{className:"w-5 h-5"})}),n.jsx("span",{className:"px-4 py-2",children:"صفحة 1 من 2"}),n.jsx("button",{className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50",children:n.jsx(Kl,{className:"w-5 h-5"})})]})})]})}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"ملخص الطلب"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"المجموع الفرعي"}),n.jsxs("span",{className:"font-medium",children:[S.toFixed(2)," ",e("store.currency")]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الشحن"}),k===0?n.jsx("span",{className:"text-green-600",children:"مجاني"}):n.jsxs("span",{className:"font-medium",children:[k.toFixed(2)," ",e("store.currency")]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"ضريبة القيمة المضافة (15%)"}),n.jsxs("span",{className:"font-medium",children:[E.toFixed(2)," ",e("store.currency")]})]}),j>0&&n.jsxs("div",{className:"flex justify-between text-green-600",children:[n.jsx("span",{children:"الخصم"}),n.jsxs("span",{className:"font-medium",children:["-",j.toFixed(2)," ",e("store.currency")]})]}),n.jsx("div",{className:"border-t border-gray-200 pt-4 mt-2",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-lg font-bold text-gray-800",children:"الإجمالي"}),n.jsxs("span",{className:"text-lg font-bold text-purple-600",children:[A.toFixed(2)," ",e("store.currency")]})]})})]}),n.jsxs("div",{className:"mt-6",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"كود الخصم"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:p,onChange:R=>h(R.target.value),placeholder:"أدخل كود الخصم",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),n.jsx("button",{onClick:L,disabled:y,className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:y?"جاري التطبيق...":"تطبيق"})]}),m&&n.jsx("p",{className:"mt-2 text-sm text-red-600",children:m}),v&&n.jsx("p",{className:"mt-2 text-sm text-green-600",children:v}),n.jsx("p",{className:"mt-2 text-xs text-gray-500",children:'جرب كود "DISCOUNT20" للحصول على خصم 20%'})]}),n.jsxs(ke,{to:"/checkout",className:`w-full mt-6 px-6 py-3 bg-purple-600 text-white rounded-xl font-medium flex items-center justify-center gap-2 ${_.length===0?"opacity-50 cursor-not-allowed pointer-events-none":"hover:bg-purple-700 transition-colors"}`,children:[n.jsx(ti,{className:"w-5 h-5"}),"المتابعة للدفع"]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"معلومات الشحن"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:n.jsx(hc,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"شحن مجاني"}),n.jsxs("p",{className:"text-sm text-gray-600",children:["للطلبات فوق ",_g," ريال"]})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:n.jsx(Lf,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"توصيل سريع"}),n.jsx("p",{className:"text-sm text-gray-600",children:"خلال 2-5 أيام عمل"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(ba,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"ضمان الجودة"}),n.jsx("p",{className:"text-sm text-gray-600",children:"ضمان استرجاع لمدة 30 يوم"})]})]})]})]})]})]})]})},qF=()=>{const{t:e}=ft(),t=Rs(),{user:r}=ut(),{cart:a,clearCart:s,getTotalItems:i,getTotalPrice:o}=dv(),{storeItems:l,loading:c,error:d}=Wf(),[u,f]=C.useState({fullName:(r==null?void 0:r.name)||"",email:(r==null?void 0:r.email)||"",phone:(r==null?void 0:r.phone)||"",address:"",city:"",postalCode:"",country:"Saudi Arabia",notes:"",saveInfo:!0,paymentMethod:"credit-card",cardNumber:"",cardName:"",cardExpiry:"",cardCvv:"",agreeToTerms:!1}),[x,p]=C.useState(!1),[h,m]=C.useState(null),[g,v]=C.useState(!1),[b,y]=C.useState(null),[N,j]=C.useState(!0),[w,_]=C.useState(!0),[S,k]=C.useState(!0),E=Object.entries(a).map(([q,K])=>({item:l.find(O=>O.id===q),quantity:K})).filter(({item:q})=>q!==void 0),A=o(l),P=A>_g?0:ZE,L=A*eT,R=A+P+L,I=(q,K)=>{f(T=>({...T,[q]:K}))},D=()=>{if(!u.fullName||!u.email||!u.phone||!u.address||!u.city)return m("يرجى ملء جميع الحقول المطلوبة"),!1;if(!u.agreeToTerms)return m("يجب الموافقة على الشروط والأحكام للمتابعة"),!1;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.email))return m("يرجى إدخال بريد إلكتروني صحيح"),!1;if(!/^\d{9,15}$/.test(u.phone.replace(/\D/g,"")))return m("يرجى إدخال رقم هاتف صحيح"),!1;if(u.paymentMethod==="credit-card"){if(!u.cardNumber||!u.cardName||!u.cardExpiry||!u.cardCvv)return m("يرجى إدخال جميع تفاصيل بطاقة الائتمان"),!1;if(!/^\d{16}$/.test(u.cardNumber.replace(/\D/g,"")))return m("يرجى إدخال رقم بطاقة صحيح (16 رقم)"),!1;if(!/^(0[1-9]|1[0-2])\/([0-9]{2})$/.test(u.cardExpiry))return m("يرجى إدخال تاريخ انتهاء صلاحية صحيح (MM/YY)"),!1;if(!/^\d{3,4}$/.test(u.cardCvv))return m("يرجى إدخال رمز CVV صحيح (3-4 أرقام)"),!1}return m(null),!0},V=async q=>{if(q.preventDefault(),!!D()){p(!0);try{await new Promise(T=>setTimeout(T,2e3));const K=Math.floor(1e5+Math.random()*9e5).toString();y(K),s(),v(!0)}catch(K){console.error("Error processing order:",K),m("حدث خطأ أثناء معالجة الطلب. يرجى المحاولة مرة أخرى.")}finally{p(!1)}}},F=q=>{const T=q.replace(/\s+/g,"").replace(/[^0-9]/gi,"").match(/\d{4,16}/g),O=T&&T[0]||"",W=[];for(let z=0,te=O.length;z<te;z+=4)W.push(O.substring(z,z+4));return W.length?W.join(" "):q},U=q=>{const K=q.replace(/\s+/g,"").replace(/[^0-9]/gi,"");return K.length>=2?`${K.substring(0,2)}/${K.substring(2,4)}`:K};return c?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-500"})}):d?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ge,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:d})]})}):E.length===0&&!g?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(zr,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"سلة التسوق فارغة"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"يرجى إضافة منتجات إلى سلة التسوق قبل المتابعة للدفع"}),n.jsxs(ke,{to:"/store",className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors inline-flex items-center gap-2",children:[n.jsx(zr,{className:"w-4 h-4"}),"تسوق الآن"]})]})}):g?n.jsxs("div",{className:"space-y-6",children:[n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-green-600 to-teal-600 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Le,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"تم إتمام الطلب بنجاح"}),n.jsx("p",{className:"opacity-90",children:"شكراً لك على الطلب!"})]})]})}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-8 text-center",children:[n.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:n.jsx(Le,{className:"w-12 h-12 text-green-600"})}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"تم استلام طلبك"}),n.jsxs("p",{className:"text-gray-600 mb-6",children:["لقد تم استلام طلبك بنجاح وسيتم معالجته في أقرب وقت ممكن.",n.jsx("br",{}),"سيتم إرسال تأكيد الطلب إلى بريدك الإلكتروني."]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 mb-6 inline-block",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["رقم الطلب: #",b]}),n.jsx("p",{className:"text-gray-600",children:"يرجى الاحتفاظ بهذا الرقم للرجوع إليه في المستقبل"})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[n.jsx(ke,{to:"/store",className:"px-6 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:"العودة إلى المتجر"}),n.jsx("button",{onClick:()=>t("/"),className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"الذهاب إلى الصفحة الرئيسية"})]})]})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ti,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"إتمام الطلب"}),n.jsx("p",{className:"opacity-90",children:"أدخل بيانات الشحن والدفع"})]})]})}),n.jsx("div",{className:"flex items-center",children:n.jsxs(ke,{to:"/cart",className:"flex items-center gap-2 text-purple-600 hover:text-purple-800 transition-colors",children:[n.jsx(Cn,{className:"w-5 h-5"}),n.jsx("span",{children:"العودة إلى سلة التسوق"})]})}),n.jsx("form",{onSubmit:V,children:n.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[h&&n.jsxs(re.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:h})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between cursor-pointer",onClick:()=>j(!N),children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(hc,{className:"w-5 h-5 text-purple-600"})}),n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"معلومات الشحن"})]}),N?n.jsx(B0,{className:"w-5 h-5 text-gray-500"}):n.jsx(U0,{className:"w-5 h-5 text-gray-500"})]}),N&&n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الاسم الكامل *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Xt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.fullName,onChange:q=>I("fullName",q.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل الاسم الكامل",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البريد الإلكتروني *"}),n.jsxs("div",{className:"relative",children:[n.jsx(ma,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:u.email,onChange:q=>I("email",q.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل البريد الإلكتروني",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الهاتف *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Cr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"tel",value:u.phone,onChange:q=>I("phone",q.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل رقم الهاتف",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدينة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(ks,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.city,onChange:q=>I("city",q.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل المدينة",required:!0})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العنوان *"}),n.jsxs("div",{className:"relative",children:[n.jsx(sE,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.address,onChange:q=>I("address",q.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل العنوان بالتفصيل",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الرمز البريدي"}),n.jsxs("div",{className:"relative",children:[n.jsx(fd,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.postalCode,onChange:q=>I("postalCode",q.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل الرمز البريدي"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الدولة"}),n.jsxs("div",{className:"relative",children:[n.jsx(yi,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:u.country,onChange:q=>I("country",q.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[n.jsx("option",{value:"Saudi Arabia",children:"المملكة العربية السعودية"}),n.jsx("option",{value:"United Arab Emirates",children:"الإمارات العربية المتحدة"}),n.jsx("option",{value:"Kuwait",children:"الكويت"}),n.jsx("option",{value:"Bahrain",children:"البحرين"}),n.jsx("option",{value:"Oman",children:"عمان"}),n.jsx("option",{value:"Qatar",children:"قطر"})]})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ملاحظات إضافية"}),n.jsx("textarea",{value:u.notes,onChange:q=>I("notes",q.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أي ملاحظات خاصة بالطلب أو الشحن"})]})]}),n.jsx("div",{className:"mt-4",children:n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",checked:u.saveInfo,onChange:q=>I("saveInfo",q.target.checked),className:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),n.jsx("span",{className:"mr-2 text-sm text-gray-700",children:"حفظ هذه المعلومات للطلبات القادمة"})]})})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between cursor-pointer",onClick:()=>_(!w),children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(ti,{className:"w-5 h-5 text-purple-600"})}),n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"طريقة الدفع"})]}),w?n.jsx(B0,{className:"w-5 h-5 text-gray-500"}):n.jsx(U0,{className:"w-5 h-5 text-gray-500"})]}),w&&n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"space-y-4 mb-6",children:[n.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"credit-card",checked:u.paymentMethod==="credit-card",onChange:()=>I("paymentMethod","credit-card"),className:"text-purple-600"}),n.jsxs("div",{className:"mr-3",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"بطاقة ائتمان"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Visa, Mastercard, American Express"})]}),n.jsxs("div",{className:"mr-auto flex gap-2",children:[n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Visa_Inc._logo.svg/2560px-Visa_Inc._logo.svg.png",alt:"Visa",className:"h-6"}),n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Mastercard-logo.svg/1280px-Mastercard-logo.svg.png",alt:"Mastercard",className:"h-6"}),n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/American_Express_logo_%282018%29.svg/1200px-American_Express_logo_%282018%29.svg.png",alt:"American Express",className:"h-6"})]})]}),n.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"mada",checked:u.paymentMethod==="mada",onChange:()=>I("paymentMethod","mada"),className:"text-purple-600"}),n.jsxs("div",{className:"mr-3",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"مدى"}),n.jsx("p",{className:"text-sm text-gray-600",children:"الدفع ببطاقة مدى"})]}),n.jsx("div",{className:"mr-auto",children:n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/ar/b/b0/Mada_Logo.png",alt:"Mada",className:"h-6"})})]}),n.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"apple-pay",checked:u.paymentMethod==="apple-pay",onChange:()=>I("paymentMethod","apple-pay"),className:"text-purple-600"}),n.jsxs("div",{className:"mr-3",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"Apple Pay"}),n.jsx("p",{className:"text-sm text-gray-600",children:"الدفع باستخدام Apple Pay"})]}),n.jsx("div",{className:"mr-auto",children:n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/b/b0/Apple_Pay_logo.svg/2560px-Apple_Pay_logo.svg.png",alt:"Apple Pay",className:"h-6"})})]}),n.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"cash-on-delivery",checked:u.paymentMethod==="cash-on-delivery",onChange:()=>I("paymentMethod","cash-on-delivery"),className:"text-purple-600"}),n.jsxs("div",{className:"mr-3",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"الدفع عند الاستلام"}),n.jsx("p",{className:"text-sm text-gray-600",children:"ادفع نقداً عند استلام الطلب"})]})]})]}),u.paymentMethod==="credit-card"&&n.jsxs("div",{className:"space-y-4 border-t border-gray-200 pt-4",children:[n.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"تفاصيل البطاقة"}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم البطاقة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(ti,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.cardNumber,onChange:q=>I("cardNumber",F(q.target.value)),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"XXXX XXXX XXXX XXXX",maxLength:19,required:u.paymentMethod==="credit-card"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الاسم على البطاقة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Xt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.cardName,onChange:q=>I("cardName",q.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"الاسم كما يظهر على البطاقة",required:u.paymentMethod==="credit-card"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الانتهاء *"}),n.jsx("input",{type:"text",value:u.cardExpiry,onChange:q=>I("cardExpiry",U(q.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"MM/YY",maxLength:5,required:u.paymentMethod==="credit-card"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رمز الأمان (CVV) *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Yn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.cardCvv,onChange:q=>I("cardCvv",q.target.value.replace(/\D/g,"").slice(0,4)),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"XXX",maxLength:4,required:u.paymentMethod==="credit-card"})]})]})]})]}),n.jsx("div",{className:"mt-6 bg-gray-50 p-4 rounded-xl",children:n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(Yn,{className:"w-4 h-4 text-green-600"}),n.jsx("span",{children:"جميع المعاملات مشفرة وآمنة. بياناتك محمية."})]})})]})]}),n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("input",{type:"checkbox",id:"agreeToTerms",checked:u.agreeToTerms,onChange:q=>I("agreeToTerms",q.target.checked),className:"mt-1 w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500",required:!0}),n.jsxs("label",{htmlFor:"agreeToTerms",className:"text-sm text-gray-700",children:["أوافق على ",n.jsx("a",{href:"#",className:"text-purple-600 hover:underline",children:"الشروط والأحكام"})," و ",n.jsx("a",{href:"#",className:"text-purple-600 hover:underline",children:"سياسة الخصوصية"})]})]})})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between cursor-pointer",onClick:()=>k(!S),children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(zr,{className:"w-5 h-5 text-purple-600"})}),n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"ملخص الطلب"})]}),S?n.jsx(B0,{className:"w-5 h-5 text-gray-500"}):n.jsx(U0,{className:"w-5 h-5 text-gray-500"})]}),S&&n.jsxs("div",{className:"p-6",children:[n.jsx("div",{className:"space-y-4 mb-6",children:E.map(({item:q,quantity:K})=>q&&n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-16 h-16 rounded-lg overflow-hidden flex-shrink-0",children:n.jsx("img",{src:q.image,alt:q.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-medium text-gray-800 text-sm",children:q.name}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-sm text-gray-500",children:["الكمية: ",K]}),n.jsxs("span",{className:"font-medium text-purple-600",children:[(q.price*K).toFixed(2)," ",e("store.currency")]})]})]})]},q.id))}),n.jsxs("div",{className:"space-y-3 border-t border-gray-200 pt-4",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"المجموع الفرعي"}),n.jsxs("span",{className:"font-medium",children:[A.toFixed(2)," ",e("store.currency")]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الشحن"}),P===0?n.jsx("span",{className:"text-green-600",children:"مجاني"}):n.jsxs("span",{className:"font-medium",children:[P.toFixed(2)," ",e("store.currency")]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"ضريبة القيمة المضافة (15%)"}),n.jsxs("span",{className:"font-medium",children:[L.toFixed(2)," ",e("store.currency")]})]}),n.jsx("div",{className:"border-t border-gray-200 pt-3 mt-2",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-lg font-bold text-gray-800",children:"الإجمالي"}),n.jsxs("span",{className:"text-lg font-bold text-purple-600",children:[R.toFixed(2)," ",e("store.currency")]})]})})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("button",{type:"submit",disabled:x,className:"w-full px-6 py-3 bg-purple-600 text-white rounded-xl hover:bg-purple-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:x?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"جاري معالجة الطلب..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ti,{className:"w-5 h-5"}),"إتمام الطلب"]})}),n.jsxs("div",{className:"mt-4 flex items-center justify-center gap-4 text-sm text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ba,{className:"w-4 h-4"}),n.jsx("span",{children:"دفع آمن"})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(hc,{className:"w-4 h-4"}),n.jsx("span",{children:"شحن سريع"})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Le,{className:"w-4 h-4"}),n.jsx("span",{children:"ضمان الجودة"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6",children:[n.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"بحاجة إلى مساعدة؟"}),n.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"إذا كان لديك أي أسئلة أو استفسارات حول طلبك، يرجى التواصل مع فريق خدمة العملاء."}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors text-sm",children:"اتصل بنا"}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors text-sm",children:"الأسئلة الشائعة"})]})]})]})]})})]})},WF=[{icon:jr,titleKey:"aiAssistant.features.projectIdeas.title",descriptionKey:"aiAssistant.features.projectIdeas.description",color:"from-yellow-400 to-orange-500"},{icon:tP,titleKey:"aiAssistant.features.programming.title",descriptionKey:"aiAssistant.features.programming.description",color:"from-blue-500 to-purple-600"},{icon:rP,titleKey:"aiAssistant.features.problemSolving.title",descriptionKey:"aiAssistant.features.problemSolving.description",color:"from-green-500 to-teal-600"},{icon:bt,titleKey:"aiAssistant.features.research.title",descriptionKey:"aiAssistant.features.research.description",color:"from-indigo-500 to-blue-600"},{icon:No,titleKey:"aiAssistant.features.design.title",descriptionKey:"aiAssistant.features.design.description",color:"from-pink-500 to-rose-600"},{icon:yi,titleKey:"aiAssistant.features.languages.title",descriptionKey:"aiAssistant.features.languages.description",color:"from-purple-500 to-pink-600"}],HF=["aiAssistant.quickPrompts.aiProject","aiAssistant.quickPrompts.programming","aiAssistant.quickPrompts.mathProblem","aiAssistant.quickPrompts.entrepreneurship","aiAssistant.quickPrompts.presentation","aiAssistant.quickPrompts.timeManagement"],zF=[{id:"1",type:"user",message:"aiAssistant.mockConversation.user1",timestamp:"2024-01-21T10:00:00Z"},{id:"2",type:"assistant",message:"aiAssistant.mockConversation.assistant1",timestamp:"2024-01-21T10:00:30Z"},{id:"3",type:"user",message:"aiAssistant.mockConversation.user2",timestamp:"2024-01-21T10:01:00Z"},{id:"4",type:"assistant",message:"aiAssistant.mockConversation.assistant2",timestamp:"2024-01-21T10:01:45Z"}],VF=()=>{const{t:e}=ft(),[t,r]=C.useState(zF.map(f=>({...f,message:e(f.message)}))),[a,s]=C.useState(""),[i,o]=C.useState(!1),l="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",c=async()=>{var x;if(!a.trim())return;const f={id:Date.now().toString(),type:"user",message:a,timestamp:new Date().toISOString()};r(p=>[...p,f]),s(""),o(!0);try{const p=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({model:"gpt-4o-mini",messages:[{role:"system",content:"أنت مساعد ذكي مفيد ومتخصص في مساعدة الطلاب والمشرفين في المشاريع التعليمية. تجيب باللغة العربية بطريقة واضحة ومفيدة."},{role:"user",content:f.message}],max_tokens:500,temperature:.7})});if(!p.ok){const v=await p.json();throw new Error(((x=v.error)==null?void 0:x.message)||"فشل في الحصول على استجابة من OpenAI")}const m=(await p.json()).choices[0].message.content,g={id:(Date.now()+1).toString(),type:"assistant",message:m,timestamp:new Date().toISOString()};r(v=>[...v,g])}catch(p){console.error("Error getting AI response:",p);const h={id:(Date.now()+1).toString(),type:"assistant",message:"حدث خطأ في الاتصال بالمساعد الذكي: "+p.message,timestamp:new Date().toISOString()};r(m=>[...m,h])}finally{o(!1)}},d=f=>{s(e(f))},u=f=>new Date(f).toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"});return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(js,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("aiAssistant.title")}),n.jsx("p",{className:"opacity-90",children:e("aiAssistant.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"24/7"}),n.jsx("div",{className:"text-sm opacity-80",children:e("aiAssistant.stats.alwaysAvailable")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"∞"}),n.jsx("div",{className:"text-sm opacity-80",children:e("aiAssistant.stats.unlimitedQuestions")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"6"}),n.jsx("div",{className:"text-sm opacity-80",children:e("aiAssistant.stats.specializations")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"AI"}),n.jsx("div",{className:"text-sm opacity-80",children:e("aiAssistant.stats.artificialIntelligence")})]})]})]}),n.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[n.jsxs(re.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.1},className:"lg:col-span-1 space-y-4",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(eP,{className:"w-5 h-5 text-purple-600"}),e("aiAssistant.howCanIHelp")]}),n.jsx("div",{className:"space-y-3",children:WF.map((f,x)=>n.jsx(re.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,delay:x*.1},className:"group cursor-pointer",children:n.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl hover:bg-gray-50 transition-colors",children:[n.jsx("div",{className:`w-10 h-10 bg-gradient-to-r ${f.color} rounded-lg flex items-center justify-center flex-shrink-0`,children:n.jsx(f.icon,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 group-hover:text-purple-600 transition-colors",children:e(f.titleKey)}),n.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:e(f.descriptionKey)})]})]})},x))})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("aiAssistant.quickPrompts.title")}),n.jsx("div",{className:"space-y-2",children:HF.map((f,x)=>n.jsx("button",{onClick:()=>d(f),className:"w-full text-right p-3 text-sm text-gray-700 hover:bg-purple-50 hover:text-purple-700 rounded-lg transition-colors",children:e(f)},x))})]})]}),n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"lg:col-span-3",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg h-[600px] flex flex-col",children:[n.jsx("div",{className:"p-6 border-b border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:n.jsx(js,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:e("aiAssistant.chatHeader.title")}),n.jsxs("p",{className:"text-sm text-green-600 flex items-center gap-1",children:[n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e("aiAssistant.chatHeader.online")]})]})]})}),n.jsxs("div",{className:"flex-1 p-6 overflow-y-auto space-y-4",children:[t.map(f=>n.jsx(re.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:`flex ${f.type==="user"?"justify-end":"justify-start"}`,children:n.jsxs("div",{className:`flex gap-3 max-w-[80%] ${f.type==="user"?"flex-row-reverse":""}`,children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${f.type==="user"?"bg-blue-500":"bg-gradient-to-r from-purple-500 to-pink-500"}`,children:f.type==="user"?n.jsx(Xt,{className:"w-4 h-4 text-white"}):n.jsx(js,{className:"w-4 h-4 text-white"})}),n.jsxs("div",{className:`rounded-2xl p-4 ${f.type==="user"?"bg-blue-500 text-white":"bg-gray-100 text-gray-800"}`,children:[n.jsx("p",{className:"whitespace-pre-line leading-relaxed",children:f.message}),n.jsx("p",{className:`text-xs mt-2 ${f.type==="user"?"text-blue-100":"text-gray-500"}`,children:u(f.timestamp)})]})]})},f.id)),i&&n.jsx(re.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex justify-start",children:n.jsxs("div",{className:"flex gap-3 max-w-[80%]",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0",children:n.jsx(js,{className:"w-4 h-4 text-white"})}),n.jsx("div",{className:"bg-gray-100 rounded-2xl p-4",children:n.jsxs("div",{className:"flex gap-1",children:[n.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),n.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),n.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})})]}),n.jsxs("div",{className:"p-6 border-t border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{className:"p-3 rounded-xl bg-gray-100 hover:bg-gray-200 transition-colors",children:n.jsx(oE,{className:"w-5 h-5 text-gray-600"})}),n.jsx("div",{className:"flex-1 relative",children:n.jsx("input",{type:"text",value:a,onChange:f=>s(f.target.value),onKeyPress:f=>f.key==="Enter"&&c(),placeholder:e("aiAssistant.inputPlaceholder"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"})}),n.jsx("button",{className:"p-3 rounded-xl bg-gray-100 hover:bg-gray-200 transition-colors",children:n.jsx(aP,{className:"w-5 h-5 text-gray-600"})}),n.jsx("button",{onClick:c,disabled:!a.trim(),className:"p-3 rounded-xl bg-purple-500 hover:bg-purple-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:n.jsx(Df,{className:"w-5 h-5 text-white"})})]}),n.jsx("div",{className:"mt-3 text-center",children:n.jsx("p",{className:"text-xs text-gray-500",children:e("aiAssistant.disclaimer")})})]})]})})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(nP,{className:"w-6 h-6 text-purple-600"}),e("aiAssistant.tips.title")]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-white rounded-xl p-4",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:e("aiAssistant.tips.beSpecific.title")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("aiAssistant.tips.beSpecific.description")})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:e("aiAssistant.tips.provideContext.title")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("aiAssistant.tips.provideContext.description")})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:e("aiAssistant.tips.askForExamples.title")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("aiAssistant.tips.askForExamples.description")})]})]})]})]})},fv=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),o=async p=>{try{a(!0);const h=Oe(he,"learning_resources");let m;p?m=Me(h,De("type","==",p),ri(50)):m=Me(h,ol("created_at","desc"),ri(50));let v=(await Ie(m)).docs.map(b=>{const y=b.data();return{id:b.id,title:y.title,description:y.description,type:y.type,category:y.category,author:y.author,duration:y.duration,difficulty:y.difficulty,rating:y.rating||4.5,views:y.views_count||0,likes:y.likes_count||0,thumbnail:y.thumbnail,contentUrl:y.contentUrl||y.content_url,watchUrl:y.watch_url||y.contentUrl||y.content_url,embedUrl:y.embed_url||y.videoUrl||y.video_url,tags:y.tags||[],featured:y.featured||!1,createdAt:y.created_at?new Date(y.created_at.toDate()).toISOString():new Date().toISOString(),lessons:y.lessons,certificate:y.certificate,fileSize:y.fileSize||y.file_size,episodes:y.episodes,downloadUrl:y.downloadUrl||y.download_url,videoUrl:y.videoUrl||y.video_url}});p&&(v=v.sort((b,y)=>new Date(y.createdAt).getTime()-new Date(b.createdAt).getTime())),t(v)}catch(h){console.error("Error fetching learning resources:",h),i(h instanceof Error?h.message:"حدث خطأ في تحميل المصادر التعليمية")}finally{a(!1)}},l=async p=>{try{const h=st(he,"learning_resources",p);await sr(h,{views_count:So(1)}),t(m=>m.map(g=>g.id===p?{...g,views:g.views+1}:g))}catch(h){console.error("Error incrementing views:",h)}},c=async p=>{try{const h=st(he,"learning_resources",p);await sr(h,{likes_count:So(1)}),t(m=>m.map(g=>g.id===p?{...g,likes:g.likes+1}:g))}catch(h){console.error("Error incrementing likes:",h)}},d=async p=>{try{const h=Oe(he,"learning_resources");let m=p.watchUrl,g=p.embedUrl;if(p.type==="video"&&p.videoUrl){if(p.videoUrl.includes("embed")&&!m){const y=p.videoUrl.split("/").pop();y&&(m=`https://www.youtube.com/watch?v=${y}`)}if(p.videoUrl.includes("watch")&&!g){const y=new URL(p.videoUrl).searchParams.get("v");y&&(g=`https://www.youtube.com/embed/${y}`)}}const v={title:p.title||"",description:p.description||"",type:p.type||"video",category:p.category||"",author:p.author||"",duration:p.duration||null,difficulty:p.difficulty||null,rating:p.rating||4.5,views_count:0,likes_count:0,thumbnail:p.thumbnail||null,content_url:m||p.contentUrl||null,video_url:g||p.videoUrl||null,watch_url:m||p.watchUrl||p.contentUrl||null,embed_url:g||p.embedUrl||p.videoUrl||null,tags:p.tags||[],featured:p.featured||!1,created_at:Ve(),updated_at:Ve()};p.type==="course"?(v.lessons=p.lessons,v.certificate=p.certificate):p.type==="template"?(v.file_size=p.fileSize,v.download_url=p.downloadUrl):p.type==="podcast"&&(v.episodes=p.episodes);const b=await Fa(h,v);return await o(),{id:b.id,...v}}catch(h){throw console.error("Error creating learning resource:",h),h}},u=async(p,h)=>{try{const m=st(he,"learning_resources",p);let g=h.watchUrl,v=h.embedUrl;if(h.type==="video"&&h.videoUrl){if(h.videoUrl.includes("embed")&&!g){const y=h.videoUrl.split("/").pop();y&&(g=`https://www.youtube.com/watch?v=${y}`)}if(h.videoUrl.includes("watch")&&!v){const y=new URL(h.videoUrl).searchParams.get("v");y&&(v=`https://www.youtube.com/embed/${y}`)}}const b={updated_at:Ve()};return h.title!==void 0&&(b.title=h.title),h.description!==void 0&&(b.description=h.description),h.type!==void 0&&(b.type=h.type),h.category!==void 0&&(b.category=h.category),h.author!==void 0&&(b.author=h.author),h.duration!==void 0&&(b.duration=h.duration),h.difficulty!==void 0&&(b.difficulty=h.difficulty),h.thumbnail!==void 0&&(b.thumbnail=h.thumbnail),h.contentUrl!==void 0&&(b.content_url=h.contentUrl),h.videoUrl!==void 0&&(b.video_url=h.videoUrl),g!==void 0&&(b.watch_url=g),v!==void 0&&(b.embed_url=v),h.tags!==void 0&&(b.tags=h.tags),h.featured!==void 0&&(b.featured=h.featured),h.type==="course"?(h.lessons!==void 0&&(b.lessons=h.lessons),h.certificate!==void 0&&(b.certificate=h.certificate)):h.type==="template"?(h.fileSize!==void 0&&(b.file_size=h.fileSize),h.downloadUrl!==void 0&&(b.download_url=h.downloadUrl)):h.type==="podcast"&&h.episodes!==void 0&&(b.episodes=h.episodes),await sr(m,b),await o(),{id:p,...h}}catch(m){throw console.error("Error updating learning resource:",m),m}},f=async p=>{try{const h=st(he,"learning_resources",p);return await Da(h),t(m=>m.filter(g=>g.id!==p)),!0}catch(h){throw console.error("Error deleting learning resource:",h),h}},x=async()=>{try{const p=await kO();return await o(),p}catch(p){throw console.error("Error cleaning up duplicate resources:",p),p}};return C.useEffect(()=>{o()},[]),{resources:e,loading:r,error:s,fetchResources:o,incrementViews:l,incrementLikes:c,createResource:d,updateResource:u,deleteResource:f,cleanupDuplicateResources:x}},GF=()=>{const{t:e}=ft(),{resources:t,loading:r,error:a,incrementViews:s,incrementLikes:i}=fv(),[o,l]=C.useState("all"),[c,d]=C.useState("all"),[u,f]=C.useState(""),[x,p]=C.useState([]),h=[{id:"all",name:e("resources.types.all"),icon:bt},{id:"article",name:e("resources.types.article"),icon:cr},{id:"video",name:e("resources.types.video"),icon:ar},{id:"course",name:e("resources.types.course"),icon:_o},{id:"template",name:e("resources.types.template"),icon:Mr},{id:"podcast",name:e("resources.types.podcast"),icon:i1},{id:"link",name:e("resources.types.link"),icon:fu}],m=[{id:"all",name:e("resources.categories.all")},{id:"project-management",name:e("resources.categories.projectManagement")},{id:"programming",name:e("resources.categories.programming")},{id:"design",name:e("resources.categories.design")},{id:"entrepreneurship",name:e("resources.categories.entrepreneurship")},{id:"stem",name:e("resources.categories.stem")},{id:"soft-skills",name:e("resources.categories.softSkills")}],g=t.filter(w=>{const _=o==="all"||w.type===o,S=c==="all"||w.category===c,k=w.title.toLowerCase().includes(u.toLowerCase())||w.description.toLowerCase().includes(u.toLowerCase())||w.tags.some(E=>E.toLowerCase().includes(u.toLowerCase()));return _&&S&&k}),v=w=>{x.includes(w)?p(_=>_.filter(S=>S!==w)):(p(_=>[..._,w]),i(w))},b=w=>{s(w)},y=w=>{const _=h.find(S=>S.id===w);return _?_.icon:cr},N=w=>{switch(w){case"مبتدئ":case"beginner":return"bg-green-100 text-green-800";case"متوسط":case"intermediate":return"bg-yellow-100 text-yellow-800";case"متقدم":case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},j=w=>{switch(w){case"مبتدئ":case"beginner":return e("resources.difficulties.beginner");case"متوسط":case"intermediate":return e("resources.difficulties.intermediate");case"متقدم":case"advanced":return e("resources.difficulties.advanced");default:return w}};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ja,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(bt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("resources.title")}),n.jsx("p",{className:"opacity-90",children:e("resources.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("resources.stats.learningResource")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:h.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("resources.stats.contentType")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:m.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("resources.stats.specialtyCategory")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"100%"}),n.jsx("div",{className:"text-sm opacity-80",children:e("resources.stats.free")})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("resources.searchPlaceholder"),value:u,onChange:w=>f(w.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]})}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("resources.filters.contentType")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:h.map(w=>n.jsxs("button",{onClick:()=>l(w.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${o===w.id?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(w.icon,{className:"w-4 h-4"}),w.name]},w.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("resources.filters.category")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(w=>n.jsx("button",{onClick:()=>d(w.id),className:`px-4 py-2 rounded-xl transition-all ${c===w.id?"bg-teal-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:w.name},w.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("resources.showing")," ",g.length," ",e("resources.of")," ",t.length," ",e("resources.resource")]})}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map((w,_)=>{var k;const S=y(w.type);return n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:_*.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"relative h-48 overflow-hidden",children:[n.jsx("img",{src:w.thumbnail||"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=400",alt:w.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),w.featured&&n.jsx("div",{className:"absolute top-4 right-4 bg-yellow-500 text-white px-2 py-1 rounded-lg text-sm font-medium",children:e("resources.featured")}),n.jsx("div",{className:"absolute top-4 left-4",children:n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(S,{className:"w-3 h-3"}),(k=h.find(E=>E.id===w.type))==null?void 0:k.name]})}),n.jsxs("div",{className:"absolute bottom-4 left-4 flex gap-2",children:[n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(mr,{className:"w-3 h-3"}),w.views.toLocaleString()]}),n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(Xa,{className:"w-3 h-3"}),w.likes]})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:w.rating})]}),n.jsx("span",{className:"text-gray-300",children:"•"}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${N(w.difficulty||"beginner")}`,children:j(w.difficulty||"beginner")})]}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 group-hover:text-emerald-600 transition-colors line-clamp-2",children:w.title}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-3 leading-relaxed",children:w.description}),n.jsxs("div",{className:"flex flex-wrap gap-1 mb-4",children:[w.tags.slice(0,3).map((E,A)=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["#",E]},A)),w.tags.length>3&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",w.tags.length-3," ",e("resources.more")]})]}),n.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(xt,{className:"w-4 h-4"}),w.duration||e("resources.defaultDuration")]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(dt,{className:"w-4 h-4"}),w.author]})]}),w.type==="course"&&w.lessons&&n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 mb-4",children:[n.jsxs("span",{children:[w.lessons," ",e("resources.lesson")]}),w.certificate&&n.jsx("span",{children:e("resources.certifiedCourse")})]}),w.type==="template"&&w.fileSize&&n.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:[e("resources.fileSize"),": ",w.fileSize]}),w.type==="podcast"&&w.episodes&&n.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:[w.episodes," ",e("resources.episode")]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>v(w.id),className:`p-2 rounded-lg transition-colors ${x.includes(w.id)?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600"}`,children:n.jsx(Xa,{className:"w-4 h-4"})}),n.jsx("button",{className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-blue-100 hover:text-blue-600 transition-colors",children:n.jsx(cE,{className:"w-4 h-4"})}),(w.type==="template"||w.downloadUrl)&&n.jsx("button",{className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-green-100 hover:text-green-600 transition-colors",children:n.jsx(Mr,{className:"w-4 h-4"})})]}),w.type==="video"?n.jsxs("a",{href:w.watchUrl||w.contentUrl||"#",target:"_blank",rel:"noopener noreferrer",onClick:()=>b(w.id),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors text-sm font-medium flex items-center gap-2",children:[n.jsx(_o,{className:"w-4 h-4"}),e("resources.actions.watch")]}):n.jsxs("button",{onClick:()=>b(w.id),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors text-sm font-medium flex items-center gap-2",children:[w.type==="course"&&n.jsx(bt,{className:"w-4 h-4"}),w.type==="template"&&n.jsx(Mr,{className:"w-4 h-4"}),w.type==="podcast"&&n.jsx(i1,{className:"w-4 h-4"}),w.type==="article"&&n.jsx(cr,{className:"w-4 h-4"}),w.type==="link"&&n.jsx(fu,{className:"w-4 h-4"}),w.type==="course"&&e("resources.actions.startCourse"),w.type==="template"&&e("resources.actions.download"),w.type==="podcast"&&e("resources.actions.listen"),w.type==="article"&&e("resources.actions.read"),w.type==="link"&&e("resources.actions.visit")]})]})]})]},w.id)})}),g.length===0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(wt,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("resources.noResourcesFound")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("resources.tryChangingFilters")}),n.jsx("button",{onClick:()=>{l("all"),d("all"),f("")},className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:e("common.resetFilters")})]})]})},KF=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),{user:o}=ut(),l=async()=>{if(o)try{a(!0),console.log("🔍 Fetching IP requests for user:",{userId:o.id,userRole:o.role,userEmail:o.email});const u=Oe(he,"intellectual_property");let f;if(o.role==="student")console.log("👨‍🎓 Student role detected, querying with student_id:",o.id),f=Me(u,De("student_id","==",o.id));else if(o.role==="teacher"){console.log("👩‍🏫 Teacher role detected, fetching students from school:",o.school_id);const h=Oe(he,"users"),m=Me(h,De("role","==","student"),De("school_id","==",o.school_id)),v=(await Ie(m)).docs.map(b=>b.id);if(console.log("👩‍🏫 Found student IDs for teacher:",v),v.length>0)f=Me(u,De("student_id","in",v));else{console.log("👩‍🏫 No students found for teacher, returning empty array"),t([]),a(!1);return}}else console.log("👑 Admin role detected, fetching all IP requests"),f=u;const x=await Ie(f);console.log("📊 IP query results:",{totalDocuments:x.size,isEmpty:x.empty});const p=await Promise.all(x.docs.map(async h=>{const m=h.data();console.log("📄 Processing IP document:",{docId:h.id,studentId:m.student_id,title:m.title,status:m.status});let g={id:m.student_id,name:"طالب غير معروف",avatar:"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",school:"مدرسة غير معروفة"};if(m.student_id){const b=st(he,"users",m.student_id),y=await Dt(b);if(y.exists()){const N=y.data();if(g.name=N.name,g.avatar=N.avatar_url||g.avatar,N.school_id){const j=st(he,"schools",N.school_id),w=await Dt(j);w.exists()&&(g.school=w.data().name)}}}let v=null;if(m.project_id){const b=st(he,"projects",m.project_id),y=await Dt(b);if(y.exists()){const N=y.data();v={id:y.id,title:N.title}}}return{id:h.id,title:m.title,description:m.description,type:m.type,status:m.status,student:g,project:v,submittedAt:m.submitted_at?new Date(m.submitted_at.toDate()).toISOString():new Date().toISOString(),reviewedAt:m.reviewed_at?new Date(m.reviewed_at.toDate()).toISOString():void 0,documents:m.documents||[],tags:m.tags||[],certificateNumber:m.certificate_number,rejectionReason:m.rejection_reason,estimatedReviewDate:m.estimated_review_date?new Date(m.estimated_review_date.toDate()).toISOString():void 0}}));console.log("✅ Final IP data processed:",{totalItems:p.length,items:p.map(h=>({id:h.id,title:h.title,studentId:h.student.id,status:h.status}))}),t(p)}catch(u){console.error("Error fetching intellectual properties:",u),i(u instanceof Error?u.message:"حدث خطأ في تحميل طلبات الملكية الفكرية")}finally{a(!1)}},c=async u=>{var f;if(!o)throw new Error("يجب تسجيل الدخول أولاً");try{console.log("📝 Creating new IP request:",{userId:o.id,userRole:o.role,ipTitle:u.title,ipType:u.type});const x=Oe(he,"intellectual_property"),p={student_id:o.id,project_id:(f=u.project)==null?void 0:f.id,title:u.title,description:u.description,type:u.type,status:"pending",documents:u.documents||[],tags:u.tags||[],submitted_at:Ve(),estimated_review_date:la.fromDate(new Date(Date.now()+10080*60*1e3))};console.log("💾 Saving IP document with data:",{student_id:p.student_id,title:p.title,type:p.type,status:p.status});const h=await Fa(x,p);return console.log("✅ IP document created successfully with ID:",h.id),await l(),{id:h.id,...p}}catch(x){throw console.error("❌ Error creating intellectual property:",x),console.error("Error creating intellectual property:",x),x}},d=async(u,f)=>{try{const x=st(he,"intellectual_property",u),p={};f.status&&(p.status=f.status,f.status==="approved"?(p.reviewed_at=Ve(),f.certificateNumber&&(p.certificate_number=f.certificateNumber)):f.status==="rejected"&&(p.reviewed_at=Ve(),f.rejectionReason&&(p.rejection_reason=f.rejectionReason))),f.documents&&(p.documents=f.documents),f.tags&&(p.tags=f.tags),await sr(x,p),await l()}catch(x){throw console.error("Error updating intellectual property:",x),x}};return C.useEffect(()=>{o&&l()},[o]),{intellectualProperties:e,loading:r,error:s,fetchIntellectualProperties:l,createIntellectualProperty:c,updateIntellectualProperty:d}},XF=({isOpen:e,onClose:t,onSubmit:r})=>{var k,E,A;const{t:a}=ft(),{projects:s}=Ii(),[i,o]=C.useState({title:"",description:"",type:"invention",documents:[],tags:[],project:null}),[l,c]=C.useState(""),[d,u]=C.useState(""),[f,x]=C.useState(!1),[p,h]=C.useState(null),[m,g]=C.useState(null);C.useEffect(()=>{e&&(o({title:"",description:"",type:"invention",documents:[],tags:[],project:null}),c(""),u(""),h(null),g(null))},[e]);const v=[{id:"invention",name:a("intellectualProperty.types.invention"),icon:jr,color:"from-yellow-400 to-orange-500"},{id:"design",name:a("intellectualProperty.types.design"),icon:No,color:"from-pink-500 to-rose-600"},{id:"software",name:a("intellectualProperty.types.software"),icon:fg,color:"from-blue-500 to-purple-600"},{id:"research",name:a("intellectualProperty.types.research"),icon:bt,color:"from-green-500 to-teal-600"}],b=s.filter(P=>P.status==="active"||P.status==="completed"),y=(P,L)=>{o(R=>({...R,[P]:L}))},N=()=>{l.trim()&&(o(P=>({...P,tags:[...P.tags||[],l.trim()]})),c(""))},j=P=>{o(L=>{var R;return{...L,tags:(R=L.tags)==null?void 0:R.filter((I,D)=>D!==P)}})},w=()=>{d.trim()&&(o(P=>({...P,documents:[...P.documents||[],{name:d.trim(),size:"1.2 MB"}]})),u(""))},_=P=>{o(L=>{var R;return{...L,documents:(R=L.documents)==null?void 0:R.filter((I,D)=>D!==P)}})},S=async P=>{if(P.preventDefault(),!i.title||!i.description||!i.type){h("يرجى ملء جميع الحقول المطلوبة");return}x(!0),h(null),g(null);try{await r(i),g("تم إرسال طلب الملكية الفكرية بنجاح"),setTimeout(()=>{t()},1500)}catch(L){console.error("Error submitting intellectual property:",L),h(L instanceof Error?L.message:"حدث خطأ في إرسال طلب الملكية الفكرية")}finally{x(!1)}};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(jr,{className:"w-6 h-6 text-purple-600"}),a("intellectualProperty.newRegistration")]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),p&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:p})]}),m&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Le,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:m})]}),n.jsxs("form",{onSubmit:S,className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان الملكية الفكرية *"}),n.jsx("input",{type:"text",value:i.title,onChange:P=>y("title",P.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل عنوان الاختراع أو التصميم أو البحث",required:!0})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف تفصيلي *"}),n.jsx("textarea",{value:i.description,onChange:P=>y("description",P.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"اكتب وصفاً تفصيلياً للملكية الفكرية، كيف تعمل، وما هي فوائدها",required:!0})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الملكية الفكرية *"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:v.map(P=>n.jsxs("label",{className:`flex flex-col items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${i.type===P.id?"bg-purple-50 border-purple-500 text-purple-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"type",value:P.id,checked:i.type===P.id,onChange:()=>y("type",P.id),className:"sr-only"}),n.jsx("div",{className:`w-12 h-12 bg-gradient-to-r ${P.color} rounded-xl flex items-center justify-center`,children:n.jsx(P.icon,{className:"w-6 h-6 text-white"})}),n.jsx("span",{className:"font-medium text-sm text-center",children:P.name})]},P.id))})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المشروع المرتبط (اختياري)"}),n.jsxs("div",{className:"relative",children:[n.jsx(Xl,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:((k=i.project)==null?void 0:k.id)||"",onChange:P=>{const L=b.find(R=>R.id===P.target.value);y("project",L?{id:L.id,title:L.title}:null)},className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"اختر مشروع (اختياري)"}),b.map(P=>n.jsx("option",{value:P.id,children:P.title},P.id))]})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المستندات المرفقة"}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Pn,{className:"w-5 h-5 text-blue-500 mt-1"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"المستندات المطلوبة"}),n.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[n.jsx("li",{children:"• وصف تفصيلي للاختراع أو التصميم"}),n.jsx("li",{children:"• رسومات أو صور توضيحية"}),n.jsx("li",{children:"• شهادات أو أوراق ثبوتية (إن وجدت)"}),n.jsx("li",{children:"• أي مستندات داعمة أخرى"})]})]})]})}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(E=i.documents)==null?void 0:E.map((P,L)=>n.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-purple-100 text-purple-800 rounded-lg",children:[n.jsx(cr,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:P.name}),n.jsxs("span",{className:"text-xs text-purple-600",children:["(",P.size,")"]}),n.jsx("button",{type:"button",onClick:()=>_(L),className:"w-4 h-4 rounded-full flex items-center justify-center hover:bg-purple-200",children:n.jsx(Qe,{className:"w-3 h-3"})})]},L))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(cr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:d,onChange:P=>u(P.target.value),onKeyPress:P=>P.key==="Enter"&&(P.preventDefault(),w()),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"اسم المستند (مثال: وصف الاختراع.pdf)"})]}),n.jsx("button",{type:"button",onClick:w,className:"px-4 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:n.jsx(pt,{className:"w-5 h-5"})})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ملاحظة: في النسخة الحالية، يتم إدخال أسماء المستندات فقط. سيتم إضافة ميزة رفع الملفات لاحقاً."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكلمات المفتاحية"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(A=i.tags)==null?void 0:A.map((P,L)=>n.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-purple-100 text-purple-800 rounded-full",children:[n.jsx("span",{children:P}),n.jsx("button",{type:"button",onClick:()=>j(L),className:"w-4 h-4 rounded-full flex items-center justify-center hover:bg-purple-200",children:n.jsx(Qe,{className:"w-3 h-3"})})]},L))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(il,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:l,onChange:P=>c(P.target.value),onKeyPress:P=>P.key==="Enter"&&(P.preventDefault(),N()),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أضف كلمة مفتاحية (مثال: ذكي، مبتكر، بيئي)"})]}),n.jsx("button",{type:"button",onClick:N,className:"px-4 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:"إضافة"})]})]}),n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Ge,{className:"w-5 h-5 text-yellow-600 mt-1"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-yellow-800 mb-1",children:"معلومات مهمة"}),n.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[n.jsx("li",{children:"• سيتم مراجعة طلبك من قبل خبراء الملكية الفكرية"}),n.jsx("li",{children:"• قد تستغرق عملية المراجعة من 7 إلى 14 يوم عمل"}),n.jsx("li",{children:"• ستتلقى إشعاراً عبر البريد الإلكتروني عند اكتمال المراجعة"}),n.jsx("li",{children:"• تأكد من دقة جميع المعلومات المقدمة"})]})]})]})}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:a("common.cancel")}),n.jsx("button",{type:"submit",disabled:f,className:"px-6 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:f?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الإرسال..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Za,{className:"w-5 h-5"}),"إرسال الطلب"]})})]})]})]})}):null},YF=()=>{const{t:e}=ft(),{intellectualProperties:t,loading:r,error:a,createIntellectualProperty:s}=KF(),[i,o]=C.useState("all"),[l,c]=C.useState("all"),[d,u]=C.useState(""),[f,x]=C.useState(!1),p=[{id:"all",name:e("intellectualProperty.types.all"),icon:bt,color:"from-gray-500 to-gray-600"},{id:"invention",name:e("intellectualProperty.types.invention"),icon:jr,color:"from-yellow-400 to-orange-500"},{id:"design",name:e("intellectualProperty.types.design"),icon:No,color:"from-pink-500 to-rose-600"},{id:"software",name:e("intellectualProperty.types.software"),icon:fg,color:"from-blue-500 to-purple-600"},{id:"research",name:e("intellectualProperty.types.research"),icon:bt,color:"from-green-500 to-teal-600"}],h=[{id:"all",name:e("intellectualProperty.statuses.all"),color:"bg-gray-100 text-gray-800",icon:bt},{id:"pending",name:e("intellectualProperty.statuses.pending"),color:"bg-yellow-100 text-yellow-800",icon:xt},{id:"approved",name:e("intellectualProperty.statuses.approved"),color:"bg-green-100 text-green-800",icon:Le},{id:"rejected",name:e("intellectualProperty.statuses.rejected"),color:"bg-red-100 text-red-800",icon:un}],m=t.filter(y=>{const N=i==="all"||y.type===i,j=l==="all"||y.status===l,w=y.title.toLowerCase().includes(d.toLowerCase())||y.description.toLowerCase().includes(d.toLowerCase())||y.tags.some(_=>_.toLowerCase().includes(d.toLowerCase()));return N&&j&&w}),g=y=>h.find(j=>j.id===y)||{name:y,color:"bg-gray-100 text-gray-800",icon:ja},v=y=>p.find(j=>j.id===y)||{name:y,icon:cr,color:"from-gray-400 to-gray-500"},b=y=>y;return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ja,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-purple-600 to-indigo-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ba,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("intellectualProperty.title")}),n.jsx("p",{className:"opacity-90",children:e("intellectualProperty.subtitle")})]})]}),n.jsxs("button",{onClick:()=>x(!0),className:"bg-white text-purple-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5"}),e("intellectualProperty.newRegistration")]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("intellectualProperty.stats.totalRequests")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(y=>y.status==="approved").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("intellectualProperty.stats.approved")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(y=>y.status==="pending").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("intellectualProperty.stats.underReview")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:p.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("intellectualProperty.stats.protectionTypes")})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("intellectualProperty.searchPlaceholder"),value:d,onChange:y=>u(y.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("intellectualProperty.filters.propertyType")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(y=>n.jsxs("button",{onClick:()=>o(y.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${i===y.id?"bg-purple-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[y.icon&&n.jsx(y.icon,{className:"w-4 h-4"}),y.name]},y.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("intellectualProperty.filters.requestStatus")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:h.map(y=>n.jsxs("button",{onClick:()=>c(y.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${l===y.id?"bg-indigo-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[y.icon&&n.jsx(y.icon,{className:"w-4 h-4"}),y.name]},y.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("intellectualProperty.showing")," ",m.length," ",e("intellectualProperty.of")," ",t.length," ",e("intellectualProperty.request")]})}),n.jsx("div",{className:"space-y-4",children:m.map((y,N)=>{const j=g(y.status),w=v(y.type);return n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:N*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[n.jsx("div",{className:`w-16 h-16 bg-gradient-to-r ${w.color} rounded-2xl flex items-center justify-center flex-shrink-0`,children:n.jsx(w.icon,{className:"w-8 h-8 text-white"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:y.title}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${j.color}`,children:j.name})]}),n.jsx("p",{className:"text-gray-600 mb-3 leading-relaxed",children:y.description}),n.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:y.tags.map((_,S)=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["#",_]},S))}),n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("img",{src:y.student.avatar,alt:y.student.name,className:"w-10 h-10 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:y.student.name}),n.jsx("p",{className:"text-sm text-gray-500",children:y.student.school})]})]}),y.project&&n.jsxs("div",{className:"text-sm text-gray-500 mb-3",children:[n.jsxs("span",{children:[e("intellectualProperty.relatedProject"),": "]}),n.jsx("span",{className:"text-purple-600 hover:text-purple-800 cursor-pointer",children:y.project.title})]}),n.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ot,{className:"w-4 h-4"}),n.jsxs("span",{children:[e("intellectualProperty.submissionDate"),": ",Ye(y.submittedAt)]})]}),y.reviewedAt&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Le,{className:"w-4 h-4"}),n.jsxs("span",{children:[e("intellectualProperty.reviewDate"),": ",Ye(y.reviewedAt)]})]}),y.estimatedReviewDate&&!y.reviewedAt&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(xt,{className:"w-4 h-4"}),n.jsxs("span",{children:[e("intellectualProperty.estimatedReview"),": ",Ye(y.estimatedReviewDate)]})]})]})]})]}),y.certificateNumber&&n.jsx("div",{className:"text-right",children:n.jsxs("div",{className:"bg-green-100 text-green-800 px-3 py-2 rounded-lg text-sm font-medium",children:[e("intellectualProperty.certificateNumber"),": ",y.certificateNumber]})})]}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("intellectualProperty.attachedDocuments"),":"]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-2",children:y.documents.map((_,S)=>n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[n.jsx(cr,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:_.name}),n.jsx("p",{className:"text-xs text-gray-500",children:b(_.size)})]}),n.jsx("button",{className:"p-1 rounded hover:bg-gray-200 transition-colors",children:n.jsx(Mr,{className:"w-4 h-4 text-gray-500"})})]},S))})]}),y.status==="rejected"&&y.rejectionReason&&n.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[n.jsxs("h4",{className:"font-medium text-red-800 mb-2 flex items-center gap-2",children:[n.jsx(un,{className:"w-4 h-4"}),e("intellectualProperty.rejectionReason"),":"]}),n.jsx("p",{className:"text-red-700 text-sm",children:y.rejectionReason})]}),n.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors text-sm",children:[n.jsx(mr,{className:"w-4 h-4"}),e("intellectualProperty.actions.viewDetails")]}),y.status==="approved"&&n.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-sm",children:[n.jsx(Mr,{className:"w-4 h-4"}),e("intellectualProperty.actions.downloadCertificate")]}),y.status==="rejected"&&n.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors text-sm",children:[n.jsx(Pn,{className:"w-4 h-4"}),e("intellectualProperty.actions.resubmit")]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:[e("intellectualProperty.protectionType"),": ",w.name]})]})]},y.id)})}),m.length===0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ba,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("intellectualProperty.noRequests")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("intellectualProperty.noRequestsFound")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs("button",{onClick:()=>x(!0),className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-2",children:[n.jsx(pt,{className:"w-4 h-4"}),e("intellectualProperty.newRegistration")]}),n.jsx("button",{onClick:()=>{o("all"),c("all"),u("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.resetFilters")})]})]}),n.jsx(XF,{isOpen:f,onClose:()=>x(!1),onSubmit:async y=>{try{await s(y),x(!1)}catch(N){throw console.error("Error creating intellectual property:",N),N}}}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:e("intellectualProperty.importantInfo.title")}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2",children:[e("intellectualProperty.importantInfo.availableTypes"),":"]}),n.jsxs("ul",{className:"space-y-2 text-gray-600",children:[n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(jr,{className:"w-4 h-4 text-yellow-500"}),e("intellectualProperty.importantInfo.inventions")]}),n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(fg,{className:"w-4 h-4 text-blue-500"}),e("intellectualProperty.importantInfo.software")]}),n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(No,{className:"w-4 h-4 text-pink-500"}),e("intellectualProperty.importantInfo.designs")]}),n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(bt,{className:"w-4 h-4 text-green-500"}),e("intellectualProperty.importantInfo.research")]})]})]}),n.jsxs("div",{children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2",children:[e("intellectualProperty.importantInfo.registrationSteps"),":"]}),n.jsxs("ol",{className:"space-y-2 text-gray-600",children:[n.jsxs("li",{children:["1. ",e("intellectualProperty.importantInfo.step1")]}),n.jsxs("li",{children:["2. ",e("intellectualProperty.importantInfo.step2")]}),n.jsxs("li",{children:["3. ",e("intellectualProperty.importantInfo.step3")]}),n.jsxs("li",{children:["4. ",e("intellectualProperty.importantInfo.step4")]})]})]})]})]})]})},JF=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),{user:o}=ut(),l=async()=>{if(!o){console.log("👤 No authenticated user found, skipping user fetch"),t([]),a(!1);return}try{try{a(!0),i(null),console.log("🔍 Starting user fetch process:",{currentUserRole:o.role,currentUserId:o.id,currentUserSchoolId:o.school_id,timestamp:new Date().toISOString()});const h=Oe(he,"users");console.log("📊 Executing school queries...");let m=Me(h,ol("created_at","desc"),ri(100)),g=[];if(o.role==="school"&&o.id){console.log("🏫 School user detected, fetching school profile and associated users...");const y=await Ie(Me(h,De("id","==",o.id))),N=await Ie(Me(h,De("school_id","==",o.id),ri(100)));console.log("📈 School query results:",{schoolSelfCount:y.size,associatedUsersCount:N.size,totalDocs:y.size+N.size}),m=Me(h,De("school_id","==",o.id),ri(100))}else if(o.role==="teacher"&&o.school_id){console.log("👩‍🏫 Teacher user detected, fetching students from school:",o.school_id),m=Me(h,De("school_id","==",o.school_id),De("role","==","student"),ri(100));const y=await Ie(m);console.log("📈 Teacher query results:",{studentsCount:y.size,schoolId:o.school_id})}else if(o.role!=="admin"){console.log("👨‍🎓 Student or other non-admin user detected, no users to fetch"),t([]),a(!1);return}const v=await Ie(m);if(o.role==="admin"){console.log("👑 Admin user detected, fetching ALL users...");try{const y=await Ie(h);console.log("📈 Admin query results:",{totalUsersCount:y.size,isEmpty:y.empty}),g=y.docs}catch(y){throw console.error("❌ Error in admin query:",y),y}}else g=v.docs;if(console.log("📋 Total user documents to process:",g.length),g.length===0){console.log("⚠️ No user documents found to process"),t([]),a(!1);return}const b=await Promise.all(g.map(async y=>{var E;const N=y.data();let j="غير محدد",w="غير محدد";if(N.school_id){console.log("🏫 Fetching school data for school_id:",N.school_id);try{const A=await Dt(st(he,"users",N.school_id));if(console.log("🏫 School document query result:",{schoolId:N.school_id,exists:A.exists(),isSchoolRole:A.exists()?((E=A.data())==null?void 0:E.role)==="school":!1}),A.exists()&&A.data().role==="school"){const P=A.data();j=P.name||"مدرسة غير معروفة",w=P.city||P.location||"غير محدد",console.log("🏫 School data extracted:",{schoolName:j,schoolCity:w,schoolId:N.school_id})}}catch(A){console.error("❌ Error fetching school data for user:",y.id,A)}}let _=0,S=0;if(N.role==="student"){console.log("👨‍🎓 Fetching project count for student:",y.id);const A=Oe(he,"project_students"),P=Me(A,De("student_id","==",y.id)),L=await Ie(P),R=L.docs.map(I=>I.data().project_id);if(console.log("📊 Student project data:",{studentId:y.id,projectStudentRecords:L.size,uniqueProjectIds:R.length}),R.length>0)for(const I of R)try{const D=await Dt(st(he,"projects",I));D.exists()&&(_++,D.data().status==="completed"&&S++)}catch(D){console.error("❌ Error fetching project for student:",I,D)}}else if(N.role==="teacher"){console.log("👩‍🏫 Fetching project count for teacher:",y.id);const A=Oe(he,"projects"),P=Me(A,De("teacher_id","==",y.id)),L=await Ie(P);if(_=L.size,console.log("📊 Teacher project data:",{teacherId:y.id,projectsCount:L.size}),N.school_id){const R=Oe(he,"users"),I=Me(R,De("role","==","student"),De("school_id","==",N.school_id)),D=await Ie(I);N.studentsCount=D.size,console.log("📊 Teacher students count:",{teacherId:y.id,schoolId:N.school_id,studentsCount:D.size})}}else if(N.role==="school"){console.log("🏫 Fetching counts for school:",y.id);const A=Me(Oe(he,"users"),De("role","==","teacher"),De("school_id","==",y.id)),P=Me(Oe(he,"users"),De("role","==","student"),De("school_id","==",y.id)),[L,R]=await Promise.all([Ie(A),Ie(P)]);N.teachersCount=L.size,N.studentsCount=R.size,console.log("📊 School counts:",{schoolId:y.id,teachersCount:L.size,studentsCount:R.size})}const k={id:y.id,name:N.name||"",email:N.email||"",role:N.role||"student",avatar:N.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",school:j,school_id:N.school_id,schoolCity:w,grade:N.grade,subject:N.subject,experience:N.experience_years?`${N.experience_years} سنوات`:void 0,joinedAt:N.created_at?new Date(N.created_at.toDate()).toISOString():new Date().toISOString(),lastActive:N.last_active_at?new Date(N.last_active_at.toDate()).toISOString():new Date().toISOString(),projectsCount:_,completedProjects:S,studentsCount:N.studentsCount,teachersCount:N.teachersCount,status:N.status||"active",location:N.city||N.location||"غير محدد",department:N.department,permissions:N.permissions,type:N.type,establishedYear:N.established_year,certifications:N.certifications,phone:N.phone};return console.log("✅ Processed user:",{id:k.id,name:k.name,role:k.role,school:k.school,schoolCity:k.schoolCity,status:k.status}),k}));console.log("📊 Final users data summary:",{totalProcessedUsers:b.length,usersByRole:{students:b.filter(y=>y.role==="student").length,teachers:b.filter(y=>y.role==="teacher").length,schools:b.filter(y=>y.role==="school").length,consultants:b.filter(y=>y.role==="consultant").length,admins:b.filter(y=>y.role==="admin").length},usersByStatus:{active:b.filter(y=>y.status==="active").length,pending:b.filter(y=>y.status==="pending").length,inactive:b.filter(y=>y.status==="inactive").length}}),t(b)}catch(h){console.error("❌ Critical error in fetchUsers:",{error:h,errorMessage:h instanceof Error?h.message:"Unknown error",currentUserRole:o==null?void 0:o.role,currentUserId:o==null?void 0:o.id,timestamp:new Date().toISOString()}),i(h instanceof Error?h.message:"حدث خطأ في تحميل المستخدمين")}finally{a(!1),console.log("🏁 User fetch process completed")}}catch(h){console.error("❌ Critical error in fetchUsers:",{error:h,errorMessage:h instanceof Error?h.message:"Unknown error",currentUserRole:o==null?void 0:o.role,currentUserId:o==null?void 0:o.id,timestamp:new Date().toISOString()}),i(h instanceof Error?h.message:"حدث خطأ في تحميل المستخدمين")}finally{a(!1),console.log("🏁 User fetch process completed")}},c=async h=>{console.log("🚀 Starting addUser process:",{userName:h.name,userEmail:h.email,userRole:h.role,hasPassword:!!h.password,timestamp:new Date().toISOString()});try{console.log("🔐 Creating Firebase Auth user...");const g=(await xE(Sa,h.email,h.password)).user.uid;console.log("✅ Firebase Auth user created successfully:",{userId:g,email:h.email}),console.log("📋 Preparing user profile data for Firestore...");const v={name:h.name,email:h.email,phone:h.phone||"",bio:h.bio||"",role:h.role,status:h.status||"active",created_at:Ve(),updated_at:Ve(),...h.school_id&&{school_id:h.school_id},...h.grade&&{grade:h.grade},...h.subject&&{subject:h.subject},...h.schoolIdNumber&&{schoolIdNumber:h.schoolIdNumber},...h.specializations&&{specializations:h.specializations},...h.experience_years!==void 0&&{experience_years:h.experience_years},...h.hourly_rate!==void 0&&{hourly_rate:h.hourly_rate},...h.languages&&{languages:h.languages},...h.city&&{city:h.city},...h.location&&{location:h.location}};return console.log("📤 Saving user profile to Firestore:",{userId:g,profileData:{name:v.name,email:v.email,role:v.role,school_id:v.school_id,status:v.status}}),await hg(st(he,"users",g),v),console.log("✅ User profile saved to Firestore successfully"),console.log("🔄 Refreshing users list..."),await l(),console.log("✅ Users list refreshed successfully"),{success:!0,userId:g}}catch(m){throw console.error("Error adding user:",m),console.log("❌ Detailed error in addUser:",{error:m,errorCode:m.code,errorMessage:m.message,userData:{name:h.name,email:h.email,role:h.role,school_id:h.school_id}}),m}},d=async(h,m)=>{try{console.log("🔄 Starting user update process:",{userId:h,hasPassword:!!m.password,userName:m.name});const g={name:m.name,phone:m.phone||"",bio:m.bio||"",role:m.role,status:m.status,updated_at:Ve(),...m.school_id&&{school_id:m.school_id},...m.grade&&{grade:m.grade},...m.subject&&{subject:m.subject},...m.schoolIdNumber&&{schoolIdNumber:m.schoolIdNumber},...m.specializations&&{specializations:m.specializations},...m.experience_years!==void 0&&{experience_years:m.experience_years},...m.hourly_rate!==void 0&&{hourly_rate:m.hourly_rate},...m.languages&&{languages:m.languages},...m.city&&{city:m.city},...m.location&&{location:m.location}};if(await lv(h,g),console.log("✅ User profile updated successfully"),m.password&&m.password.trim()!=="")throw console.log("🔐 Password update requested for user:",h),console.warn("⚠️ Password update for other users requires Firebase Admin SDK."),console.log('💡 Recommendation: Use "Send Password Reset Email" feature instead'),new Error('تحديث كلمة المرور لمستخدم آخر يتطلب إرسال رابط إعادة تعيين كلمة المرور عبر البريد الإلكتروني. يُنصح باستخدام خاصية "إرسال رابط إعادة تعيين كلمة المرور" بدلاً من ذلك.');return await l(),{success:!0}}catch(g){throw console.error("Error updating user:",g),g}},u=async h=>{try{return await EO(h),await l(),{success:!0}}catch(m){throw console.error("Error deleting user:",m),m}},f=async h=>{try{return await h1(h,"active"),await l(),{success:!0}}catch(m){throw console.error("Error activating user:",m),m}},x=async h=>{try{return await h1(h,"inactive"),await l(),{success:!0}}catch(m){throw console.error("Error deactivating user:",m),m}},p=async h=>{try{console.log("📧 Sending password reset email to:",h);const m=await cv(h);return m.success?console.log("✅ Password reset email sent successfully"):console.error("❌ Failed to send password reset email:",m.message),m}catch(m){throw console.error("Error sending password reset email:",m),m}};return C.useEffect(()=>{o?(console.log("🔄 useUsers effect triggered, user available:",{userId:o.id,userRole:o.role,userEmail:o.email}),l()):console.log("⏳ useUsers effect triggered but no user available yet")},[o]),{users:e,loading:r,error:s,fetchUsers:l,addUser:c,editUser:d,removeUser:u,activateUser:f,deactivateUser:x,sendPasswordReset:p}},QF=({isOpen:e,onClose:t,onSubmit:r,editingUser:a=null,isEditing:s=!1})=>{const[i,o]=C.useState({name:"",email:"",phone:"",bio:"",role:"student",password:"",confirmPassword:"",school_id:"",grade:"",subject:"",schoolIdNumber:"",specializations:[],experience_years:0,hourly_rate:150,languages:["العربية"],status:"active",otherSpecialization:"",city:"",location:""}),[l,c]=C.useState([]),[d,u]=C.useState(!1),[f,x]=C.useState(!1),[p,h]=C.useState(!1),[m,g]=C.useState(null),[v,b]=C.useState(null),[y,N]=C.useState(!1),[j,w]=C.useState(null),[_,S]=C.useState(null),k=["الذكاء الاصطناعي","تعلم الآلة","الروبوتات","تطوير التطبيقات","تطوير الويب","قواعد البيانات","الأمن السيبراني","الشبكات","التصميم الجرافيكي","تجربة المستخدم","التسويق الرقمي","ريادة الأعمال","إدارة المشاريع","العلوم","الرياضيات","الفيزياء","الكيمياء","الأحياء","الهندسة الميكانيكية","الهندسة الكهربائية","الهندسة المدنية","الطب العام","طب الأطفال","الجراحة العامة","أخرى"],E=["العربية","الإنجليزية","الفرنسية","الإسبانية","الألمانية","الصينية","اليابانية","الروسية","الهندية","البرتغالية"],A=[{id:"active",name:"نشط",color:"bg-green-100 text-green-800"},{id:"pending",name:"قيد المراجعة",color:"bg-yellow-100 text-yellow-800"},{id:"inactive",name:"غير نشط",color:"bg-gray-100 text-gray-800"},{id:"suspended",name:"موقوف",color:"bg-red-100 text-red-800"}];C.useEffect(()=>{e&&(async()=>{try{u(!0);const U=await ov();U&&U.length>0?c(U):c([])}catch(U){console.error("Error fetching schools:",U),c([])}finally{u(!1)}})()},[e]),C.useEffect(()=>{e&&(o(a&&s?{name:a.name||"",email:a.email||"",phone:a.phone||"",bio:a.bio||"",role:a.role||"student",password:"",confirmPassword:"",school_id:a.school_id||"",grade:a.grade||"",subject:a.subject||"",schoolIdNumber:a.schoolIdNumber||"",specializations:a.specializations||[],experience_years:a.experience_years||0,hourly_rate:a.hourly_rate||150,languages:a.languages||["العربية"],status:a.status||"active",otherSpecialization:"",city:a.city||a.location||"",location:a.location||a.city||""}:{name:"",email:"",phone:"",bio:"",role:"student",password:"",confirmPassword:"",school_id:"",grade:"",subject:"",schoolIdNumber:"",specializations:[],experience_years:0,hourly_rate:150,languages:["العربية"],status:"active",otherSpecialization:"",city:"",location:""}),g(null),b(null))},[e,a,s]);const P=(F,U)=>{o(q=>({...q,[F]:U}))},L=F=>{o(U=>({...U,specializations:U.specializations.includes(F)?U.specializations.filter(q=>q!==F):[...U.specializations,F]}))},R=F=>{o(U=>({...U,languages:U.languages.includes(F)?U.languages.filter(q=>q!==F):[...U.languages,F]}))},I=()=>{if(console.log("🔍 Starting form validation..."),console.log("📋 Form data to validate:",{name:i.name,email:i.email,role:i.role,hasPassword:!!i.password,passwordLength:i.password.length,hasConfirmPassword:!!i.confirmPassword,school_id:i.school_id,isEditing:s}),!i.name||!i.email||!i.role)return console.log("❌ Validation failed: Missing required fields"),g("يرجى ملء جميع الحقول المطلوبة"),!1;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email))return console.log("❌ Validation failed: Invalid email format"),g("يرجى إدخال بريد إلكتروني صالح"),!1;if(!s){if(!i.password||i.password.length<6)return console.log("❌ Validation failed: Password too short or missing"),g("يجب أن تكون كلمة المرور 6 أحرف على الأقل"),!1;if(i.password!==i.confirmPassword)return console.log("❌ Validation failed: Passwords do not match"),g("كلمات المرور غير متطابقة"),!1}if(s&&i.password){if(i.password.length<6)return console.log("❌ Validation failed: New password too short"),g("يجب أن تكون كلمة المرور 6 أحرف على الأقل"),!1;if(i.password!==i.confirmPassword)return console.log("❌ Validation failed: New passwords do not match"),g("كلمات المرور غير متطابقة"),!1}return(i.role==="student"||i.role==="teacher")&&!i.school_id?(console.log("❌ Validation failed: School required for student/teacher"),g("يرجى اختيار المدرسة"),!1):(console.log("✅ Form validation passed successfully"),!0)},D=async()=>{if(!i.email){S("البريد الإلكتروني مطلوب لإرسال رابط إعادة تعيين كلمة المرور");return}N(!0),S(null),w(null);try{const F=await cv(i.email);F.success?(w(F.message),setTimeout(()=>{w(null)},5e3)):S(F.message)}catch(F){console.error("Error sending password reset email:",F),S(F instanceof Error?F.message:"حدث خطأ في إرسال رابط إعادة تعيين كلمة المرور")}finally{N(!1)}},V=async F=>{if(F.preventDefault(),console.log("🚀 Form submission started:",{isEditing:s,userRole:i.role,userName:i.name,userEmail:i.email,timestamp:new Date().toISOString()}),!I()){console.log("❌ Form submission stopped: Validation failed");return}h(!0),g(null),b(null),console.log("📤 Preparing user data for submission...");try{let U=[...i.specializations];i.specializations.includes("أخرى")&&i.otherSpecialization.trim()&&(U=U.filter(K=>K!=="أخرى"),U.push(i.otherSpecialization.trim()));const q={...i,specializations:U};s&&!i.password&&(delete q.password,delete q.confirmPassword),console.log("📋 Final user data prepared:",{name:q.name,email:q.email,role:q.role,school_id:q.school_id,hasPassword:!!q.password,specializations:q.specializations,status:q.status,isEditing:s}),console.log("📡 Calling onSubmit function..."),await r(q),console.log("✅ onSubmit completed successfully"),b(s?"تم تحديث المستخدم بنجاح":"تم إنشاء المستخدم بنجاح"),console.log("🎉 User operation completed successfully"),setTimeout(()=>{console.log("🚪 Closing modal after success"),t()},1500)}catch(U){console.error("Error submitting user form:",U),console.log("❌ Detailed error in form submission:",{error:U,errorMessage:U instanceof Error?U.message:"Unknown error",errorStack:U instanceof Error?U.stack:"No stack trace",formData:{name:i.name,email:i.email,role:i.role,school_id:i.school_id}}),g(U instanceof Error?U.message:"حدث خطأ في حفظ بيانات المستخدم")}finally{h(!1),console.log("🏁 Form submission process completed")}};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(uu,{className:"w-6 h-6 text-blue-600"}),s?"تعديل مستخدم":"إضافة مستخدم جديد"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),m&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:m})]}),v&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Le,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:v})]}),n.jsxs("form",{onSubmit:V,className:"space-y-6",children:[n.jsxs("div",{className:"bg-blue-50 rounded-xl p-4",children:[n.jsxs("h4",{className:"text-lg font-semibold text-blue-800 mb-4 flex items-center gap-2",children:[n.jsx(Xt,{className:"w-5 h-5"}),"المعلومات الأساسية"]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الاسم الكامل *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Xt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:i.name,onChange:F=>P("name",F.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل الاسم الكامل",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدينة"}),n.jsxs("div",{className:"relative",children:[n.jsx(fd,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:i.city,onChange:F=>P("city",F.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل المدينة"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البريد الإلكتروني *"}),n.jsxs("div",{className:"relative",children:[n.jsx(ma,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:i.email,onChange:F=>P("email",F.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل البريد الإلكتروني",required:!0,disabled:s})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الهاتف"}),n.jsxs("div",{className:"relative",children:[n.jsx(Cr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"tel",value:i.phone,onChange:F=>P("phone",F.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"05xxxxxxxx"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الحساب *"}),n.jsxs("select",{value:i.role,onChange:F=>P("role",F.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"student",children:"طالب"}),n.jsx("option",{value:"teacher",children:"مشرف"}),n.jsx("option",{value:"school",children:"مدرسة"}),n.jsx("option",{value:"consultant",children:"مستشار"}),n.jsx("option",{value:"admin",children:"مدير"})]})]}),s&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"حالة الحساب"}),n.jsx("select",{value:i.status,onChange:F=>P("status",F.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:A.map(F=>n.jsx("option",{value:F.id,children:F.name},F.id))})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(Yn,{className:"w-5 h-5"}),s?"إدارة كلمة المرور":"كلمة المرور *"]}),s?n.jsxs("div",{className:"space-y-4",children:[j&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(Le,{className:"w-5 h-5"}),n.jsx("span",{children:j})]}),_&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(Ge,{className:"w-5 h-5"}),n.jsx("span",{children:_})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("p",{className:"text-sm text-blue-800 mb-3",children:"لتحديث كلمة مرور المستخدم، يمكنك إرسال رابط إعادة تعيين كلمة المرور إلى بريده الإلكتروني."}),n.jsx("button",{type:"button",onClick:D,disabled:y||!i.email,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:y?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الإرسال..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Df,{className:"w-4 h-4"}),"إرسال رابط إعادة تعيين كلمة المرور"]})})]})]}):n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"كلمة المرور *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Yn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:f?"text":"password",value:i.password,onChange:F=>P("password",F.target.value),className:"w-full pr-12 pl-12 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل كلمة المرور",required:!0}),n.jsx("button",{type:"button",onClick:()=>x(!f),className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:f?n.jsx(Ff,{className:"w-5 h-5"}):n.jsx(mr,{className:"w-5 h-5"})})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"يجب أن تكون 6 أحرف على الأقل"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تأكيد كلمة المرور *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Yn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:f?"text":"password",value:i.confirmPassword,onChange:F=>P("confirmPassword",F.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أعد إدخال كلمة المرور",required:!0})]})]})]})]}),(i.role==="student"||i.role==="teacher")&&n.jsxs("div",{className:"bg-green-50 rounded-xl p-4",children:[n.jsxs("h4",{className:"text-lg font-semibold text-green-800 mb-4 flex items-center gap-2",children:[n.jsx(ks,{className:"w-5 h-5"}),"معلومات المدرسة"]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدرسة *"}),n.jsxs("select",{value:i.school_id,onChange:F=>P("school_id",F.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:d,children:[n.jsx("option",{value:"",children:d?"جاري التحميل...":"اختر المدرسة"}),l.map(F=>n.jsx("option",{value:F.id,children:F.name},F.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الرقم المدرسي"}),n.jsx("input",{type:"text",value:i.schoolIdNumber,onChange:F=>P("schoolIdNumber",F.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل الرقم المدرسي"})]}),i.role==="student"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الصف الدراسي"}),n.jsxs("select",{value:i.grade,onChange:F=>P("grade",F.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"اختر الصف"}),n.jsx("option",{value:"1",children:"الأول الابتدائي"}),n.jsx("option",{value:"2",children:"الثاني الابتدائي"}),n.jsx("option",{value:"3",children:"الثالث الابتدائي"}),n.jsx("option",{value:"4",children:"الرابع الابتدائي"}),n.jsx("option",{value:"5",children:"الخامس الابتدائي"}),n.jsx("option",{value:"6",children:"السادس الابتدائي"}),n.jsx("option",{value:"7",children:"الأول المتوسط"}),n.jsx("option",{value:"8",children:"الثاني المتوسط"}),n.jsx("option",{value:"9",children:"الثالث المتوسط"}),n.jsx("option",{value:"10",children:"الأول الثانوي"}),n.jsx("option",{value:"11",children:"الثاني الثانوي"}),n.jsx("option",{value:"12",children:"الثالث الثانوي"})]})]}),i.role==="teacher"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المادة التدريسية"}),n.jsxs("div",{className:"relative",children:[n.jsx(bt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:i.subject,onChange:F=>P("subject",F.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"مثل: الرياضيات، العلوم، اللغة العربية"})]})]})]})]}),i.role==="consultant"&&n.jsxs("div",{className:"bg-purple-50 rounded-xl p-4",children:[n.jsxs("h4",{className:"text-lg font-semibold text-purple-800 mb-4 flex items-center gap-2",children:[n.jsx(As,{className:"w-5 h-5"}),"معلومات المستشار"]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"التخصصات *"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-3",children:k.map(F=>n.jsxs("label",{className:"flex items-center space-x-2 space-x-reverse cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:i.specializations.includes(F),onChange:()=>L(F),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),n.jsx("span",{className:"text-sm text-gray-700",children:F})]},F))}),i.specializations.includes("أخرى")&&n.jsx("div",{className:"mt-3",children:n.jsx("input",{type:"text",value:i.otherSpecialization,onChange:F=>P("otherSpecialization",F.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"حدد التخصص الآخر"})})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سنوات الخبرة"}),n.jsxs("div",{className:"relative",children:[n.jsx(lr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",min:"0",max:"50",value:i.experience_years,onChange:F=>P("experience_years",parseInt(F.target.value)||0),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"0"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"السعر بالساعة (ريال)"}),n.jsxs("div",{className:"relative",children:[n.jsx(hu,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",min:"50",max:"1000",step:"25",value:i.hourly_rate,onChange:F=>P("hourly_rate",parseInt(F.target.value)||150),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"150"})]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[n.jsx(uE,{className:"w-4 h-4"}),"اللغات"]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 border border-gray-200 rounded-lg p-3",children:E.map(F=>n.jsxs("label",{className:"flex items-center space-x-2 space-x-reverse cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:i.languages.includes(F),onChange:()=>R(F),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),n.jsx("span",{className:"text-sm text-gray-700",children:F})]},F))})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نبذة شخصية"}),n.jsx("textarea",{value:i.bio,onChange:F=>P("bio",F.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"اكتب نبذة مختصرة عن نفسك..."})]}),n.jsxs("div",{className:"flex gap-4 pt-6 border-t",children:[n.jsx("button",{type:"button",onClick:t,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",disabled:p,children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:p,className:"flex-1 bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:p?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Za,{className:"w-5 h-5"}),s?"حفظ التغييرات":"إنشاء الحساب"]})})]})]})]})}):null};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Nu={};Nu.version="0.18.5";var tT=1252,ZF=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],hv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},mv=function(e){ZF.indexOf(e)!=-1&&(tT=hv[0]=e)};function eD(){mv(1252)}var fn=function(e){mv(e)};function xv(){fn(1200),eD()}function J1(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function tD(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function rT(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ul=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?tD(e.slice(2)):t==254&&r==255?rT(e.slice(2)):t==65279?e.slice(1):e},Ld=function(t){return String.fromCharCode(t)},Q1=function(t){return String.fromCharCode(t)},gc,ws="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function yc(e){for(var t="",r=0,a=0,s=0,i=0,o=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,a=e.charCodeAt(d++),o=(r&3)<<4|a>>4,s=e.charCodeAt(d++),l=(a&15)<<2|s>>6,c=s&63,isNaN(a)?l=c=64:isNaN(s)&&(c=64),t+=ws.charAt(i)+ws.charAt(o)+ws.charAt(l)+ws.charAt(c);return t}function Ra(e){var t="",r=0,a=0,s=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=ws.indexOf(e.charAt(d++)),o=ws.indexOf(e.charAt(d++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=ws.indexOf(e.charAt(d++)),a=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(a)),c=ws.indexOf(e.charAt(d++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var nt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ls=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Os(e){return nt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Z1(e){return nt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Aa=function(t){return nt?ls(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Hf(e){if(typeof ArrayBuffer>"u")return Aa(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Ls(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function rD(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function pv(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return pv(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Rr=nt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ls(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function aD(e){for(var t=[],r=0,a=e.length+250,s=Os(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>a&&(t.push(s.slice(0,r)),r=0,s=Os(65535),a=65530)}return t.push(s.slice(0,r)),Rr(t)}var ha=/\u0000/g,ql=/[\u0001-\u0006]/g;function fo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function hn(e,t){var r=""+e;return r.length>=t?r:ir("0",t-r.length)+r}function gv(e,t){var r=""+e;return r.length>=t?r:ir(" ",t-r.length)+r}function _u(e,t){var r=""+e;return r.length>=t?r:r+ir(" ",t-r.length)}function nD(e,t){var r=""+Math.round(e);return r.length>=t?r:ir("0",t-r.length)+r}function sD(e,t){var r=""+e;return r.length>=t?r:ir("0",t-r.length)+r}var ej=Math.pow(2,32);function Ji(e,t){if(e>ej||e<-ej)return nD(e,t);var r=Math.round(e);return sD(r,t)}function Su(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var tj=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],K0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function iD(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Be={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},rj={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},oD={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ku(e,t,r){for(var a=e<0?-1:1,s=e*a,i=0,o=1,l=0,c=1,d=0,u=0,f=Math.floor(s);d<t&&(f=Math.floor(s),l=f*o+i,u=f*d+c,!(s-f<5e-8));)s=1/(s-f),i=o,o=l,c=d,d=u;if(u>t&&(d>t?(u=c,l=i):(u=d,l=o)),!r)return[0,a*l,u];var x=Math.floor(a*l/u);return[x,a*l-x*u,u]}function ai(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),i=0,o=[],l={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(a+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++a,++l.D)),a===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),r&&(i=hD(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=i,l}var aT=new Date(1899,11,31,0,0,0),lD=aT.getTime(),cD=new Date(1900,2,1,0,0,0);function nT(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=cD&&(r+=1440*60*1e3),(r-(lD+(e.getTimezoneOffset()-aT.getTimezoneOffset())*6e4))/(1440*60*1e3)}function yv(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function dD(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function uD(e){var t=e<0?12:11,r=yv(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function fD(e){var t=yv(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function vc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=uD(e):t===10?r=e.toFixed(10).substr(0,12):r=fD(e),yv(dD(r.toUpperCase()))}function ji(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):vc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return en(14,nT(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function hD(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function mD(e,t,r,a){var s="",i=0,o=0,l=r.y,c,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return K0[r.m-1][1];case 5:return K0[r.m-1][0];default:return K0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return tj[r.q][0];default:return tj[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?hn(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(s=hn(i,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=l,d=1;break}var u=d>0?hn(c,d):"";return u}function Ns(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var sT=/%/g;function xD(e,t,r){var a=t.replace(sT,""),s=t.length-a.length;return Jn(e,a,r*Math.pow(10,2*s))+ir("%",s)}function pD(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Jn(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function iT(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+iT(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var oT=/# (\?+)( ?)\/( ?)(\d+)/;function gD(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),i=Math.floor(s/a),o=s-i*a,l=a;return r+(i===0?"":""+i)+" "+(o===0?ir(" ",e[1].length+1+e[4].length):gv(o,e[1].length)+e[2]+"/"+e[3]+hn(l,e[4].length))}function yD(e,t,r){return r+(t===0?"":""+t)+ir(" ",e[1].length+2+e[4].length)}var lT=/^#*0*\.([0#]+)/,cT=/\).*[0#]/,dT=/\(###\) ###\\?-####/;function ia(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function aj(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function nj(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function vD(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function bD(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function qa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(cT)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?qa("n",a,r):"("+qa("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return pD(e,t,r);if(t.indexOf("%")!==-1)return xD(e,t,r);if(t.indexOf("E")!==-1)return iT(t,r);if(t.charCodeAt(0)===36)return"$"+qa(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Ji(c,t.length);if(t.match(/^[#?]+$/))return s=Ji(r,0),s==="0"&&(s=""),s.length>t.length?s:ia(t.substr(0,t.length-s.length))+s;if(i=t.match(oT))return gD(i,c,d);if(t.match(/^#+0+$/))return d+Ji(c,t.length-t.indexOf("0"));if(i=t.match(lT))return s=aj(r,i[1].length).replace(/^([^\.]+)$/,"$1."+ia(i[1])).replace(/\.$/,"."+ia(i[1])).replace(/\.(\d*)$/,function(h,m){return"."+m+ir("0",ia(i[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+aj(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Ns(Ji(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+qa(e,t,-r):Ns(""+(Math.floor(r)+vD(r,i[1].length)))+"."+hn(nj(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return qa(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=fo(qa(e,t.replace(/[\\-]/g,""),r)),o=0,fo(fo(t.replace(/\\/g,"")).replace(/[0#]/g,function(h){return o<s.length?s.charAt(o++):h==="0"?"0":""}));if(t.match(dT))return s=qa(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=ku(c,Math.pow(10,o)-1,!1),s=""+d,u=Jn("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=_u(l[2],o),u.length<i[4].length&&(u=ia(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=ku(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?gv(l[1],o)+i[2]+"/"+i[3]+_u(l[2],o):ir(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=Ji(r,0),t.length<=s.length?s:ia(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,x=t.length-s.length-f;return ia(t.substr(0,f)+s+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=nj(r,i[1].length),r<0?"-"+qa(e,t,-r):Ns(bD(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(h){return"00,"+(h.length<3?hn(0,3-h.length):"")+h})+"."+hn(o,i[1].length);switch(t){case"###,##0.00":return qa(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Ns(Ji(c,0));return p!=="0"?d+p:"";case"###,###.00":return qa(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return qa(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function jD(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Jn(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function wD(e,t,r){var a=t.replace(sT,""),s=t.length-a.length;return Jn(e,a,r*Math.pow(10,2*s))+ir("%",s)}function uT(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+uT(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function bn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(cT)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?bn("n",a,r):"("+bn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return jD(e,t,r);if(t.indexOf("%")!==-1)return wD(e,t,r);if(t.indexOf("E")!==-1)return uT(t,r);if(t.charCodeAt(0)===36)return"$"+bn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+hn(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:ia(t.substr(0,t.length-s.length))+s;if(i=t.match(oT))return yD(i,c,d);if(t.match(/^#+0+$/))return d+hn(c,t.length-t.indexOf("0"));if(i=t.match(lT))return s=(""+r).replace(/^([^\.]+)$/,"$1."+ia(i[1])).replace(/\.$/,"."+ia(i[1])),s=s.replace(/\.(\d*)$/,function(h,m){return"."+m+ir("0",ia(i[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Ns(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+bn(e,t,-r):Ns(""+r)+"."+ir("0",i[1].length);if(i=t.match(/^#,#*,#0/))return bn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=fo(bn(e,t.replace(/[\\-]/g,""),r)),o=0,fo(fo(t.replace(/\\/g,"")).replace(/[0#]/g,function(h){return o<s.length?s.charAt(o++):h==="0"?"0":""}));if(t.match(dT))return s=bn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=ku(c,Math.pow(10,o)-1,!1),s=""+d,u=Jn("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=_u(l[2],o),u.length<i[4].length&&(u=ia(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=ku(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?gv(l[1],o)+i[2]+"/"+i[3]+_u(l[2],o):ir(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:ia(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,x=t.length-s.length-f;return ia(t.substr(0,f)+s+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+bn(e,t,-r):Ns(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(h){return"00,"+(h.length<3?hn(0,3-h.length):"")+h})+"."+hn(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Ns(""+c);return p!=="0"?d+p:"";default:if(t.match(/\.[0#?]*$/))return bn(e,t.slice(0,t.lastIndexOf(".")),r)+ia(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Jn(e,t,r){return(r|0)===r?bn(e,t,r):qa(e,t,r)}function ND(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var fT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ll(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Su(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(fT))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function _D(e,t,r,a){for(var s=[],i="",o=0,l="",c="t",d,u,f,x="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Su(e,o))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(f=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++o;break;case"\\":var p=e.charAt(++o),h=p==="("||p===")"?p:"t";s[s.length]={t:h,v:p},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=ai(t,r,e.charAt(o+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=ai(t,r),d==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=x),s[s.length]={t:l,v:i},c=l;break;case"A":case"a":case"上":var m={t:l,v:l};if(d==null&&(d=ai(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(m.v=d.H>=12?"P":"A"),m.t="T",x="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(m.v=d.H>=12?"PM":"AM"),m.t="T",o+=5,x="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(d!=null&&(m.v=d.H>=12?"下午":"上午"),m.t="T",o+=5,x="h"):(m.t="t",++o),d==null&&m.t==="T")return"";s[s.length]=m,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(fT)){if(d==null&&(d=ai(t,r),d==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",ll(e)||(s[s.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;s[s.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;s[s.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:a===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++o;break}var g=0,v=0,b;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=x,c="h",g<1&&(g=1);break;case"s":(b=s[o].v.match(/\.0+$/))&&(v=Math.max(v,b[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[o].v.match(/[Hh]/)&&(g=1),g<2&&s[o].v.match(/[Mm]/)&&(g=2),g<3&&s[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var y="",N;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=mD(s[o].t.charCodeAt(0),s[o].v,d,v),s[o].t="t";break;case"n":case"?":for(N=o+1;s[N]!=null&&((l=s[N].t)==="?"||l==="D"||(l===" "||l==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[o].v+=s[N].v,s[N]={v:"",t:";"},++N;y+=s[o].v,o=N-1;break;case"G":s[o].t="t",s[o].v=ji(t,r);break}var j="",w,_;if(y.length>0){y.charCodeAt(0)==40?(w=t<0&&y.charCodeAt(0)===45?-t:t,_=Jn("n",y,w)):(w=t<0&&a>1?-t:t,_=Jn("n",y,w),w<0&&s[0]&&s[0].t=="t"&&(_=_.substr(1),s[0].v="-"+s[0].v)),N=_.length-1;var S=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){S=o;break}var k=s.length;if(S===s.length&&_.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(N>=s[o].v.length-1?(N-=s[o].v.length,s[o].v=_.substr(N+1,s[o].v.length)):N<0?s[o].v="":(s[o].v=_.substr(0,N+1),N=-1),s[o].t="t",k=o);N>=0&&k<s.length&&(s[k].v=_.substr(0,N+1)+s[k].v)}else if(S!==s.length&&_.indexOf("E")===-1){for(N=_.indexOf(".")-1,o=S;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(u=s[o].v.indexOf(".")>-1&&o===S?s[o].v.indexOf(".")-1:s[o].v.length-1,j=s[o].v.substr(u+1);u>=0;--u)N>=0&&(s[o].v.charAt(u)==="0"||s[o].v.charAt(u)==="#")&&(j=_.charAt(N--)+j);s[o].v=j,s[o].t="t",k=o}for(N>=0&&k<s.length&&(s[k].v=_.substr(0,N+1)+s[k].v),N=_.indexOf(".")+1,o=S;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==S)){for(u=s[o].v.indexOf(".")>-1&&o===S?s[o].v.indexOf(".")+1:0,j=s[o].v.substr(0,u);u<s[o].v.length;++u)N<_.length&&(j+=_.charAt(N++));s[o].v=j,s[o].t="t",k=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(w=a>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=Jn(s[o].t,s[o].v,w),s[o].t="t");var E="";for(o=0;o!==s.length;++o)s[o]!=null&&(E+=s[o].v);return E}var sj=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ij(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function SD(e,t){var r=ND(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(sj),l=r[1].match(sj);return ij(t,o)?[a,r[0]]:ij(t,l)?[a,r[1]]:[a,r[o!=null&&l!=null?2:1]]}return[a,i]}function en(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Be)[e],a==null&&(a=r.table&&r.table[rj[e]]||Be[rj[e]]),a==null&&(a=oD[e]||"General");break}if(Su(a,0))return ji(t,r);t instanceof Date&&(t=nT(t,r.date1904));var s=SD(a,t);if(Su(s[1]))return ji(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return _D(s[1],t,r,s[0])}function Qn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Be[r]==null){t<0&&(t=r);continue}if(Be[r]==e){t=r;break}}t<0&&(t=391)}return Be[t]=e,t}function zf(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Qn(e[t],t)}function cl(){Be=iD()}var kD={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},hT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ED(e){var t=typeof e=="number"?Be[e]:e;return t=t.replace(hT,"(\\d+)"),new RegExp("^"+t+"$")}function TD(e,t,r){var a=-1,s=-1,i=-1,o=-1,l=-1,c=-1;(t.match(hT)||[]).forEach(function(f,x){var p=parseInt(r[x+1],10);switch(f.toLowerCase().charAt(0)){case"y":a=p;break;case"d":i=p;break;case"h":o=p;break;case"s":c=p;break;case"m":o>=0?l=p:s=p;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?d:a==-1&&s==-1&&i==-1?u:d+"T"+u}var AD=(function(){var e={};e.version="1.2.0";function t(){for(var _=0,S=new Array(256),k=0;k!=256;++k)_=k,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,S[k]=_;return typeof Int32Array<"u"?new Int32Array(S):S}var r=t();function a(_){var S=0,k=0,E=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(E=0;E!=256;++E)A[E]=_[E];for(E=0;E!=256;++E)for(k=_[E],S=256+E;S<4096;S+=256)k=A[S]=k>>>8^_[k&255];var P=[];for(E=1;E!=16;++E)P[E-1]=typeof Int32Array<"u"?A.subarray(E*256,E*256+256):A.slice(E*256,E*256+256);return P}var s=a(r),i=s[0],o=s[1],l=s[2],c=s[3],d=s[4],u=s[5],f=s[6],x=s[7],p=s[8],h=s[9],m=s[10],g=s[11],v=s[12],b=s[13],y=s[14];function N(_,S){for(var k=S^-1,E=0,A=_.length;E<A;)k=k>>>8^r[(k^_.charCodeAt(E++))&255];return~k}function j(_,S){for(var k=S^-1,E=_.length-15,A=0;A<E;)k=y[_[A++]^k&255]^b[_[A++]^k>>8&255]^v[_[A++]^k>>16&255]^g[_[A++]^k>>>24]^m[_[A++]]^h[_[A++]]^p[_[A++]]^x[_[A++]]^f[_[A++]]^u[_[A++]]^d[_[A++]]^c[_[A++]]^l[_[A++]]^o[_[A++]]^i[_[A++]]^r[_[A++]];for(E+=15;A<E;)k=k>>>8^r[(k^_[A++])&255];return~k}function w(_,S){for(var k=S^-1,E=0,A=_.length,P=0,L=0;E<A;)P=_.charCodeAt(E++),P<128?k=k>>>8^r[(k^P)&255]:P<2048?(k=k>>>8^r[(k^(192|P>>6&31))&255],k=k>>>8^r[(k^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,L=_.charCodeAt(E++)&1023,k=k>>>8^r[(k^(240|P>>8&7))&255],k=k>>>8^r[(k^(128|P>>2&63))&255],k=k>>>8^r[(k^(128|L>>6&15|(P&3)<<4))&255],k=k>>>8^r[(k^(128|L&63))&255]):(k=k>>>8^r[(k^(224|P>>12&15))&255],k=k>>>8^r[(k^(128|P>>6&63))&255],k=k>>>8^r[(k^(128|P&63))&255]);return~k}return e.table=r,e.bstr=N,e.buf=j,e.str=w,e})(),Fe=(function(){var t={};t.version="1.2.1";function r(H,J){for(var X=H.split("/"),Y=J.split("/"),Q=0,Z=0,oe=Math.min(X.length,Y.length);Q<oe;++Q){if(Z=X[Q].length-Y[Q].length)return Z;if(X[Q]!=Y[Q])return X[Q]<Y[Q]?-1:1}return X.length-Y.length}function a(H){if(H.charAt(H.length-1)=="/")return H.slice(0,-1).indexOf("/")===-1?H:a(H.slice(0,-1));var J=H.lastIndexOf("/");return J===-1?H:H.slice(0,J+1)}function s(H){if(H.charAt(H.length-1)=="/")return s(H.slice(0,-1));var J=H.lastIndexOf("/");return J===-1?H:H.slice(J+1)}function i(H,J){typeof J=="string"&&(J=new Date(J));var X=J.getHours();X=X<<6|J.getMinutes(),X=X<<5|J.getSeconds()>>>1,H.write_shift(2,X);var Y=J.getFullYear()-1980;Y=Y<<4|J.getMonth()+1,Y=Y<<5|J.getDate(),H.write_shift(2,Y)}function o(H){var J=H.read_shift(2)&65535,X=H.read_shift(2)&65535,Y=new Date,Q=X&31;X>>>=5;var Z=X&15;X>>>=4,Y.setMilliseconds(0),Y.setFullYear(X+1980),Y.setMonth(Z-1),Y.setDate(Q);var oe=J&31;J>>>=5;var me=J&63;return J>>>=6,Y.setHours(J),Y.setMinutes(me),Y.setSeconds(oe<<1),Y}function l(H){qr(H,0);for(var J={},X=0;H.l<=H.length-4;){var Y=H.read_shift(2),Q=H.read_shift(2),Z=H.l+Q,oe={};switch(Y){case 21589:X=H.read_shift(1),X&1&&(oe.mtime=H.read_shift(4)),Q>5&&(X&2&&(oe.atime=H.read_shift(4)),X&4&&(oe.ctime=H.read_shift(4))),oe.mtime&&(oe.mt=new Date(oe.mtime*1e3));break}H.l=Z,J[Y]=oe}return J}var c;function d(){return c||(c={})}function u(H,J){if(H[0]==80&&H[1]==75)return Pd(H,J);if((H[0]|32)==109&&(H[1]|32)==105)return BC(H,J);if(H.length<512)throw new Error("CFB file size "+H.length+" < 512");var X=3,Y=512,Q=0,Z=0,oe=0,me=0,ie=0,le=[],ce=H.slice(0,512);qr(ce,0);var ve=f(ce);switch(X=ve[0],X){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(ve[1]==0)return Pd(H,J);default:throw new Error("Major Version: Expected 3 or 4 saw "+X)}Y!==512&&(ce=H.slice(0,Y),qr(ce,28));var Ee=H.slice(0,Y);x(ce,X);var Ce=ce.read_shift(4,"i");if(X===3&&Ce!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ce);ce.l+=4,oe=ce.read_shift(4,"i"),ce.l+=4,ce.chk("00100000","Mini Stream Cutoff Size: "),me=ce.read_shift(4,"i"),Q=ce.read_shift(4,"i"),ie=ce.read_shift(4,"i"),Z=ce.read_shift(4,"i");for(var we=-1,Ae=0;Ae<109&&(we=ce.read_shift(4,"i"),!(we<0));++Ae)le[Ae]=we;var Xe=p(H,Y);g(ie,Z,Xe,Y,le);var Jt=b(Xe,oe,le,Y);Jt[oe].name="!Directory",Q>0&&me!==L&&(Jt[me].name="!MiniFAT"),Jt[le[0]].name="!FAT",Jt.fat_addrs=le,Jt.ssz=Y;var Qt={},Vr=[],jl=[],wl=[];y(oe,Jt,Xe,Vr,Q,Qt,jl,me),h(jl,wl,Vr),Vr.shift();var Nl={FileIndex:jl,FullPaths:wl};return J&&J.raw&&(Nl.raw={header:Ee,sectors:Xe}),Nl}function f(H){if(H[H.l]==80&&H[H.l+1]==75)return[0,0];H.chk(R,"Header Signature: "),H.l+=16;var J=H.read_shift(2,"u");return[H.read_shift(2,"u"),J]}function x(H,J){var X=9;switch(H.l+=2,X=H.read_shift(2)){case 9:if(J!=3)throw new Error("Sector Shift: Expected 9 saw "+X);break;case 12:if(J!=4)throw new Error("Sector Shift: Expected 12 saw "+X);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+X)}H.chk("0600","Mini Sector Shift: "),H.chk("000000000000","Reserved: ")}function p(H,J){for(var X=Math.ceil(H.length/J)-1,Y=[],Q=1;Q<X;++Q)Y[Q-1]=H.slice(Q*J,(Q+1)*J);return Y[X-1]=H.slice(X*J),Y}function h(H,J,X){for(var Y=0,Q=0,Z=0,oe=0,me=0,ie=X.length,le=[],ce=[];Y<ie;++Y)le[Y]=ce[Y]=Y,J[Y]=X[Y];for(;me<ce.length;++me)Y=ce[me],Q=H[Y].L,Z=H[Y].R,oe=H[Y].C,le[Y]===Y&&(Q!==-1&&le[Q]!==Q&&(le[Y]=le[Q]),Z!==-1&&le[Z]!==Z&&(le[Y]=le[Z])),oe!==-1&&(le[oe]=Y),Q!==-1&&Y!=le[Y]&&(le[Q]=le[Y],ce.lastIndexOf(Q)<me&&ce.push(Q)),Z!==-1&&Y!=le[Y]&&(le[Z]=le[Y],ce.lastIndexOf(Z)<me&&ce.push(Z));for(Y=1;Y<ie;++Y)le[Y]===Y&&(Z!==-1&&le[Z]!==Z?le[Y]=le[Z]:Q!==-1&&le[Q]!==Q&&(le[Y]=le[Q]));for(Y=1;Y<ie;++Y)if(H[Y].type!==0){if(me=Y,me!=le[me])do me=le[me],J[Y]=J[me]+"/"+J[Y];while(me!==0&&le[me]!==-1&&me!=le[me]);le[Y]=-1}for(J[0]+="/",Y=1;Y<ie;++Y)H[Y].type!==2&&(J[Y]+="/")}function m(H,J,X){for(var Y=H.start,Q=H.size,Z=[],oe=Y;X&&Q>0&&oe>=0;)Z.push(J.slice(oe*P,oe*P+P)),Q-=P,oe=Zs(X,oe*4);return Z.length===0?ue(0):Rr(Z).slice(0,H.size)}function g(H,J,X,Y,Q){var Z=L;if(H===L){if(J!==0)throw new Error("DIFAT chain shorter than expected")}else if(H!==-1){var oe=X[H],me=(Y>>>2)-1;if(!oe)return;for(var ie=0;ie<me&&(Z=Zs(oe,ie*4))!==L;++ie)Q.push(Z);g(Zs(oe,Y-4),J-1,X,Y,Q)}}function v(H,J,X,Y,Q){var Z=[],oe=[];Q||(Q=[]);var me=Y-1,ie=0,le=0;for(ie=J;ie>=0;){Q[ie]=!0,Z[Z.length]=ie,oe.push(H[ie]);var ce=X[Math.floor(ie*4/Y)];if(le=ie*4&me,Y<4+le)throw new Error("FAT boundary crossed: "+ie+" 4 "+Y);if(!H[ce])break;ie=Zs(H[ce],le)}return{nodes:Z,data:yj([oe])}}function b(H,J,X,Y){var Q=H.length,Z=[],oe=[],me=[],ie=[],le=Y-1,ce=0,ve=0,Ee=0,Ce=0;for(ce=0;ce<Q;++ce)if(me=[],Ee=ce+J,Ee>=Q&&(Ee-=Q),!oe[Ee]){ie=[];var we=[];for(ve=Ee;ve>=0;){we[ve]=!0,oe[ve]=!0,me[me.length]=ve,ie.push(H[ve]);var Ae=X[Math.floor(ve*4/Y)];if(Ce=ve*4&le,Y<4+Ce)throw new Error("FAT boundary crossed: "+ve+" 4 "+Y);if(!H[Ae]||(ve=Zs(H[Ae],Ce),we[ve]))break}Z[Ee]={nodes:me,data:yj([ie])}}return Z}function y(H,J,X,Y,Q,Z,oe,me){for(var ie=0,le=Y.length?2:0,ce=J[H].data,ve=0,Ee=0,Ce;ve<ce.length;ve+=128){var we=ce.slice(ve,ve+128);qr(we,64),Ee=we.read_shift(2),Ce=Sv(we,0,Ee-le),Y.push(Ce);var Ae={name:Ce,type:we.read_shift(1),color:we.read_shift(1),L:we.read_shift(4,"i"),R:we.read_shift(4,"i"),C:we.read_shift(4,"i"),clsid:we.read_shift(16),state:we.read_shift(4,"i"),start:0,size:0},Xe=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);Xe!==0&&(Ae.ct=N(we,we.l-8));var Jt=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);Jt!==0&&(Ae.mt=N(we,we.l-8)),Ae.start=we.read_shift(4,"i"),Ae.size=we.read_shift(4,"i"),Ae.size<0&&Ae.start<0&&(Ae.size=Ae.type=0,Ae.start=L,Ae.name=""),Ae.type===5?(ie=Ae.start,Q>0&&ie!==L&&(J[ie].name="!StreamData")):Ae.size>=4096?(Ae.storage="fat",J[Ae.start]===void 0&&(J[Ae.start]=v(X,Ae.start,J.fat_addrs,J.ssz)),J[Ae.start].name=Ae.name,Ae.content=J[Ae.start].data.slice(0,Ae.size)):(Ae.storage="minifat",Ae.size<0?Ae.size=0:ie!==L&&Ae.start!==L&&J[ie]&&(Ae.content=m(Ae,J[ie].data,(J[me]||{}).data))),Ae.content&&qr(Ae.content,0),Z[Ce]=Ae,oe.push(Ae)}}function N(H,J){return new Date((Ta(H,J+4)/1e7*Math.pow(2,32)+Ta(H,J)/1e7-11644473600)*1e3)}function j(H,J){return d(),u(c.readFileSync(H),J)}function w(H,J){var X=J&&J.type;switch(X||nt&&Buffer.isBuffer(H)&&(X="buffer"),X||"base64"){case"file":return j(H,J);case"base64":return u(Aa(Ra(H)),J);case"binary":return u(Aa(H),J)}return u(H,J)}function _(H,J){var X=J||{},Y=X.root||"Root Entry";if(H.FullPaths||(H.FullPaths=[]),H.FileIndex||(H.FileIndex=[]),H.FullPaths.length!==H.FileIndex.length)throw new Error("inconsistent CFB structure");H.FullPaths.length===0&&(H.FullPaths[0]=Y+"/",H.FileIndex[0]={name:Y,type:5}),X.CLSID&&(H.FileIndex[0].clsid=X.CLSID),S(H)}function S(H){var J="Sh33tJ5";if(!Fe.find(H,"/"+J)){var X=ue(4);X[0]=55,X[1]=X[3]=50,X[2]=54,H.FileIndex.push({name:J,type:2,content:X,size:4,L:69,R:69,C:69}),H.FullPaths.push(H.FullPaths[0]+J),k(H)}}function k(H,J){_(H);for(var X=!1,Y=!1,Q=H.FullPaths.length-1;Q>=0;--Q){var Z=H.FileIndex[Q];switch(Z.type){case 0:Y?X=!0:(H.FileIndex.pop(),H.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(Z.R*Z.L*Z.C)&&(X=!0),Z.R>-1&&Z.L>-1&&Z.R==Z.L&&(X=!0);break;default:X=!0;break}}if(!(!X&&!J)){var oe=new Date(1987,1,19),me=0,ie=Object.create?Object.create(null):{},le=[];for(Q=0;Q<H.FullPaths.length;++Q)ie[H.FullPaths[Q]]=!0,H.FileIndex[Q].type!==0&&le.push([H.FullPaths[Q],H.FileIndex[Q]]);for(Q=0;Q<le.length;++Q){var ce=a(le[Q][0]);Y=ie[ce],Y||(le.push([ce,{name:s(ce).replace("/",""),type:1,clsid:D,ct:oe,mt:oe,content:null}]),ie[ce]=!0)}for(le.sort(function(Ce,we){return r(Ce[0],we[0])}),H.FullPaths=[],H.FileIndex=[],Q=0;Q<le.length;++Q)H.FullPaths[Q]=le[Q][0],H.FileIndex[Q]=le[Q][1];for(Q=0;Q<le.length;++Q){var ve=H.FileIndex[Q],Ee=H.FullPaths[Q];if(ve.name=s(Ee).replace("/",""),ve.L=ve.R=ve.C=-(ve.color=1),ve.size=ve.content?ve.content.length:0,ve.start=0,ve.clsid=ve.clsid||D,Q===0)ve.C=le.length>1?1:-1,ve.size=0,ve.type=5;else if(Ee.slice(-1)=="/"){for(me=Q+1;me<le.length&&a(H.FullPaths[me])!=Ee;++me);for(ve.C=me>=le.length?-1:me,me=Q+1;me<le.length&&a(H.FullPaths[me])!=a(Ee);++me);ve.R=me>=le.length?-1:me,ve.type=1}else a(H.FullPaths[Q+1]||"")==a(Ee)&&(ve.R=Q+1),ve.type=2}}}function E(H,J){var X=J||{};if(X.fileType=="mad")return UC(H,X);switch(k(H),X.fileType){case"zip":return FC(H,X)}var Y=(function(Ce){for(var we=0,Ae=0,Xe=0;Xe<Ce.FileIndex.length;++Xe){var Jt=Ce.FileIndex[Xe];if(Jt.content){var Qt=Jt.content.length;Qt>0&&(Qt<4096?we+=Qt+63>>6:Ae+=Qt+511>>9)}}for(var Vr=Ce.FullPaths.length+3>>2,jl=we+7>>3,wl=we+127>>7,Nl=jl+Ae+Vr+wl,zs=Nl+127>>7,M0=zs<=109?0:Math.ceil((zs-109)/127);Nl+zs+M0+127>>7>zs;)M0=++zs<=109?0:Math.ceil((zs-109)/127);var $n=[1,M0,zs,wl,Vr,Ae,we,0];return Ce.FileIndex[0].size=we<<6,$n[7]=(Ce.FileIndex[0].start=$n[0]+$n[1]+$n[2]+$n[3]+$n[4]+$n[5])+($n[6]+7>>3),$n})(H),Q=ue(Y[7]<<9),Z=0,oe=0;{for(Z=0;Z<8;++Z)Q.write_shift(1,I[Z]);for(Z=0;Z<8;++Z)Q.write_shift(2,0);for(Q.write_shift(2,62),Q.write_shift(2,3),Q.write_shift(2,65534),Q.write_shift(2,9),Q.write_shift(2,6),Z=0;Z<3;++Z)Q.write_shift(2,0);for(Q.write_shift(4,0),Q.write_shift(4,Y[2]),Q.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),Q.write_shift(4,0),Q.write_shift(4,4096),Q.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:L),Q.write_shift(4,Y[3]),Q.write_shift(-4,Y[1]?Y[0]-1:L),Q.write_shift(4,Y[1]),Z=0;Z<109;++Z)Q.write_shift(-4,Z<Y[2]?Y[1]+Z:-1)}if(Y[1])for(oe=0;oe<Y[1];++oe){for(;Z<236+oe*127;++Z)Q.write_shift(-4,Z<Y[2]?Y[1]+Z:-1);Q.write_shift(-4,oe===Y[1]-1?L:oe+1)}var me=function(Ce){for(oe+=Ce;Z<oe-1;++Z)Q.write_shift(-4,Z+1);Ce&&(++Z,Q.write_shift(-4,L))};for(oe=Z=0,oe+=Y[1];Z<oe;++Z)Q.write_shift(-4,V.DIFSECT);for(oe+=Y[2];Z<oe;++Z)Q.write_shift(-4,V.FATSECT);me(Y[3]),me(Y[4]);for(var ie=0,le=0,ce=H.FileIndex[0];ie<H.FileIndex.length;++ie)ce=H.FileIndex[ie],ce.content&&(le=ce.content.length,!(le<4096)&&(ce.start=oe,me(le+511>>9)));for(me(Y[6]+7>>3);Q.l&511;)Q.write_shift(-4,V.ENDOFCHAIN);for(oe=Z=0,ie=0;ie<H.FileIndex.length;++ie)ce=H.FileIndex[ie],ce.content&&(le=ce.content.length,!(!le||le>=4096)&&(ce.start=oe,me(le+63>>6)));for(;Q.l&511;)Q.write_shift(-4,V.ENDOFCHAIN);for(Z=0;Z<Y[4]<<2;++Z){var ve=H.FullPaths[Z];if(!ve||ve.length===0){for(ie=0;ie<17;++ie)Q.write_shift(4,0);for(ie=0;ie<3;++ie)Q.write_shift(4,-1);for(ie=0;ie<12;++ie)Q.write_shift(4,0);continue}ce=H.FileIndex[Z],Z===0&&(ce.start=ce.size?ce.start-1:L);var Ee=Z===0&&X.root||ce.name;if(le=2*(Ee.length+1),Q.write_shift(64,Ee,"utf16le"),Q.write_shift(2,le),Q.write_shift(1,ce.type),Q.write_shift(1,ce.color),Q.write_shift(-4,ce.L),Q.write_shift(-4,ce.R),Q.write_shift(-4,ce.C),ce.clsid)Q.write_shift(16,ce.clsid,"hex");else for(ie=0;ie<4;++ie)Q.write_shift(4,0);Q.write_shift(4,ce.state||0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,ce.start),Q.write_shift(4,ce.size),Q.write_shift(4,0)}for(Z=1;Z<H.FileIndex.length;++Z)if(ce=H.FileIndex[Z],ce.size>=4096)if(Q.l=ce.start+1<<9,nt&&Buffer.isBuffer(ce.content))ce.content.copy(Q,Q.l,0,ce.size),Q.l+=ce.size+511&-512;else{for(ie=0;ie<ce.size;++ie)Q.write_shift(1,ce.content[ie]);for(;ie&511;++ie)Q.write_shift(1,0)}for(Z=1;Z<H.FileIndex.length;++Z)if(ce=H.FileIndex[Z],ce.size>0&&ce.size<4096)if(nt&&Buffer.isBuffer(ce.content))ce.content.copy(Q,Q.l,0,ce.size),Q.l+=ce.size+63&-64;else{for(ie=0;ie<ce.size;++ie)Q.write_shift(1,ce.content[ie]);for(;ie&63;++ie)Q.write_shift(1,0)}if(nt)Q.l=Q.length;else for(;Q.l<Q.length;)Q.write_shift(1,0);return Q}function A(H,J){var X=H.FullPaths.map(function(ie){return ie.toUpperCase()}),Y=X.map(function(ie){var le=ie.split("/");return le[le.length-(ie.slice(-1)=="/"?2:1)]}),Q=!1;J.charCodeAt(0)===47?(Q=!0,J=X[0].slice(0,-1)+J):Q=J.indexOf("/")!==-1;var Z=J.toUpperCase(),oe=Q===!0?X.indexOf(Z):Y.indexOf(Z);if(oe!==-1)return H.FileIndex[oe];var me=!Z.match(ql);for(Z=Z.replace(ha,""),me&&(Z=Z.replace(ql,"!")),oe=0;oe<X.length;++oe)if((me?X[oe].replace(ql,"!"):X[oe]).replace(ha,"")==Z||(me?Y[oe].replace(ql,"!"):Y[oe]).replace(ha,"")==Z)return H.FileIndex[oe];return null}var P=64,L=-2,R="d0cf11e0a1b11ae1",I=[208,207,17,224,161,177,26,225],D="00000000000000000000000000000000",V={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:R,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:D,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function F(H,J,X){d();var Y=E(H,X);c.writeFileSync(J,Y)}function U(H){for(var J=new Array(H.length),X=0;X<H.length;++X)J[X]=String.fromCharCode(H[X]);return J.join("")}function q(H,J){var X=E(H,J);switch(J&&J.type||"buffer"){case"file":return d(),c.writeFileSync(J.filename,X),X;case"binary":return typeof X=="string"?X:U(X);case"base64":return yc(typeof X=="string"?X:U(X));case"buffer":if(nt)return Buffer.isBuffer(X)?X:ls(X);case"array":return typeof X=="string"?Aa(X):X}return X}var K;function T(H){try{var J=H.InflateRaw,X=new J;if(X._processChunk(new Uint8Array([3,0]),X._finishFlushFlag),X.bytesRead)K=H;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function O(H,J){if(!K)return xs(H,J);var X=K.InflateRaw,Y=new X,Q=Y._processChunk(H.slice(H.l),Y._finishFlushFlag);return H.l+=Y.bytesRead,Q}function W(H){return K?K.deflateRawSync(H):rt(H)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function se(H){var J=(H<<1|H<<11)&139536|(H<<5|H<<15)&558144;return(J>>16|J>>8|J)&255}for(var M=typeof Uint8Array<"u",G=M?new Uint8Array(256):[],ne=0;ne<256;++ne)G[ne]=se(ne);function B(H,J){var X=G[H&255];return J<=8?X>>>8-J:(X=X<<8|G[H>>8&255],J<=16?X>>>16-J:(X=X<<8|G[H>>16&255],X>>>24-J))}function pe(H,J){var X=J&7,Y=J>>>3;return(H[Y]|(X<=6?0:H[Y+1]<<8))>>>X&3}function ye(H,J){var X=J&7,Y=J>>>3;return(H[Y]|(X<=5?0:H[Y+1]<<8))>>>X&7}function Te(H,J){var X=J&7,Y=J>>>3;return(H[Y]|(X<=4?0:H[Y+1]<<8))>>>X&15}function de(H,J){var X=J&7,Y=J>>>3;return(H[Y]|(X<=3?0:H[Y+1]<<8))>>>X&31}function xe(H,J){var X=J&7,Y=J>>>3;return(H[Y]|(X<=1?0:H[Y+1]<<8))>>>X&127}function We(H,J,X){var Y=J&7,Q=J>>>3,Z=(1<<X)-1,oe=H[Q]>>>Y;return X<8-Y||(oe|=H[Q+1]<<8-Y,X<16-Y)||(oe|=H[Q+2]<<16-Y,X<24-Y)||(oe|=H[Q+3]<<24-Y),oe&Z}function Nt(H,J,X){var Y=J&7,Q=J>>>3;return Y<=5?H[Q]|=(X&7)<<Y:(H[Q]|=X<<Y&255,H[Q+1]=(X&7)>>8-Y),J+3}function _e(H,J,X){var Y=J&7,Q=J>>>3;return X=(X&1)<<Y,H[Q]|=X,J+1}function He(H,J,X){var Y=J&7,Q=J>>>3;return X<<=Y,H[Q]|=X&255,X>>>=8,H[Q+1]=X,J+8}function Ft(H,J,X){var Y=J&7,Q=J>>>3;return X<<=Y,H[Q]|=X&255,X>>>=8,H[Q+1]=X&255,H[Q+2]=X>>>8,J+16}function _r(H,J){var X=H.length,Y=2*X>J?2*X:J+5,Q=0;if(X>=J)return H;if(nt){var Z=Z1(Y);if(H.copy)H.copy(Z);else for(;Q<H.length;++Q)Z[Q]=H[Q];return Z}else if(M){var oe=new Uint8Array(Y);if(oe.set)oe.set(H);else for(;Q<X;++Q)oe[Q]=H[Q];return oe}return H.length=Y,H}function Ut(H){for(var J=new Array(H),X=0;X<H;++X)J[X]=0;return J}function aa(H,J,X){var Y=1,Q=0,Z=0,oe=0,me=0,ie=H.length,le=M?new Uint16Array(32):Ut(32);for(Z=0;Z<32;++Z)le[Z]=0;for(Z=ie;Z<X;++Z)H[Z]=0;ie=H.length;var ce=M?new Uint16Array(ie):Ut(ie);for(Z=0;Z<ie;++Z)le[Q=H[Z]]++,Y<Q&&(Y=Q),ce[Z]=0;for(le[0]=0,Z=1;Z<=Y;++Z)le[Z+16]=me=me+le[Z-1]<<1;for(Z=0;Z<ie;++Z)me=H[Z],me!=0&&(ce[Z]=le[me+16]++);var ve=0;for(Z=0;Z<ie;++Z)if(ve=H[Z],ve!=0)for(me=B(ce[Z],Y)>>Y-ve,oe=(1<<Y+4-ve)-1;oe>=0;--oe)J[me|oe<<ve]=ve&15|Z<<4;return Y}var na=M?new Uint16Array(512):Ut(512),sn=M?new Uint16Array(32):Ut(32);if(!M){for(var Mt=0;Mt<512;++Mt)na[Mt]=0;for(Mt=0;Mt<32;++Mt)sn[Mt]=0}(function(){for(var H=[],J=0;J<32;J++)H.push(5);aa(H,sn,32);var X=[];for(J=0;J<=143;J++)X.push(8);for(;J<=255;J++)X.push(9);for(;J<=279;J++)X.push(7);for(;J<=287;J++)X.push(8);aa(X,na,288)})();var Ma=(function(){for(var J=M?new Uint8Array(32768):[],X=0,Y=0;X<ae.length-1;++X)for(;Y<ae[X+1];++Y)J[Y]=X;for(;Y<32768;++Y)J[Y]=29;var Q=M?new Uint8Array(259):[];for(X=0,Y=0;X<te.length-1;++X)for(;Y<te[X+1];++Y)Q[Y]=X;function Z(me,ie){for(var le=0;le<me.length;){var ce=Math.min(65535,me.length-le),ve=le+ce==me.length;for(ie.write_shift(1,+ve),ie.write_shift(2,ce),ie.write_shift(2,~ce&65535);ce-- >0;)ie[ie.l++]=me[le++]}return ie.l}function oe(me,ie){for(var le=0,ce=0,ve=M?new Uint16Array(32768):[];ce<me.length;){var Ee=Math.min(65535,me.length-ce);if(Ee<10){for(le=Nt(ie,le,+(ce+Ee==me.length)),le&7&&(le+=8-(le&7)),ie.l=le/8|0,ie.write_shift(2,Ee),ie.write_shift(2,~Ee&65535);Ee-- >0;)ie[ie.l++]=me[ce++];le=ie.l*8;continue}le=Nt(ie,le,+(ce+Ee==me.length)+2);for(var Ce=0;Ee-- >0;){var we=me[ce];Ce=(Ce<<5^we)&32767;var Ae=-1,Xe=0;if((Ae=ve[Ce])&&(Ae|=ce&-32768,Ae>ce&&(Ae-=32768),Ae<ce))for(;me[Ae+Xe]==me[ce+Xe]&&Xe<250;)++Xe;if(Xe>2){we=Q[Xe],we<=22?le=He(ie,le,G[we+1]>>1)-1:(He(ie,le,3),le+=5,He(ie,le,G[we-23]>>5),le+=3);var Jt=we<8?0:we-4>>2;Jt>0&&(Ft(ie,le,Xe-te[we]),le+=Jt),we=J[ce-Ae],le=He(ie,le,G[we]>>3),le-=3;var Qt=we<4?0:we-2>>1;Qt>0&&(Ft(ie,le,ce-Ae-ae[we]),le+=Qt);for(var Vr=0;Vr<Xe;++Vr)ve[Ce]=ce&32767,Ce=(Ce<<5^me[ce])&32767,++ce;Ee-=Xe-1}else we<=143?we=we+48:le=_e(ie,le,1),le=He(ie,le,G[we]),ve[Ce]=ce&32767,++ce}le=He(ie,le,0)-1}return ie.l=(le+7)/8|0,ie.l}return function(ie,le){return ie.length<8?Z(ie,le):oe(ie,le)}})();function rt(H){var J=ue(50+Math.floor(H.length*1.1)),X=Ma(H,J);return J.slice(0,X)}var Yt=M?new Uint16Array(32768):Ut(32768),xa=M?new Uint16Array(32768):Ut(32768),fr=M?new Uint16Array(128):Ut(128),Ln=1,Ad=1;function je(H,J){var X=de(H,J)+257;J+=5;var Y=de(H,J)+1;J+=5;var Q=Te(H,J)+4;J+=4;for(var Z=0,oe=M?new Uint8Array(19):Ut(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,le=M?new Uint8Array(8):Ut(8),ce=M?new Uint8Array(8):Ut(8),ve=oe.length,Ee=0;Ee<Q;++Ee)oe[z[Ee]]=Z=ye(H,J),ie<Z&&(ie=Z),le[Z]++,J+=3;var Ce=0;for(le[0]=0,Ee=1;Ee<=ie;++Ee)ce[Ee]=Ce=Ce+le[Ee-1]<<1;for(Ee=0;Ee<ve;++Ee)(Ce=oe[Ee])!=0&&(me[Ee]=ce[Ce]++);var we=0;for(Ee=0;Ee<ve;++Ee)if(we=oe[Ee],we!=0){Ce=G[me[Ee]]>>8-we;for(var Ae=(1<<7-we)-1;Ae>=0;--Ae)fr[Ce|Ae<<we]=we&7|Ee<<3}var Xe=[];for(ie=1;Xe.length<X+Y;)switch(Ce=fr[xe(H,J)],J+=Ce&7,Ce>>>=3){case 16:for(Z=3+pe(H,J),J+=2,Ce=Xe[Xe.length-1];Z-- >0;)Xe.push(Ce);break;case 17:for(Z=3+ye(H,J),J+=3;Z-- >0;)Xe.push(0);break;case 18:for(Z=11+xe(H,J),J+=7;Z-- >0;)Xe.push(0);break;default:Xe.push(Ce),ie<Ce&&(ie=Ce);break}var Jt=Xe.slice(0,X),Qt=Xe.slice(X);for(Ee=X;Ee<286;++Ee)Jt[Ee]=0;for(Ee=Y;Ee<30;++Ee)Qt[Ee]=0;return Ln=aa(Jt,Yt,286),Ad=aa(Qt,xa,30),J}function yn(H,J){if(H[0]==3&&!(H[1]&3))return[Os(J),2];for(var X=0,Y=0,Q=Z1(J||1<<18),Z=0,oe=Q.length>>>0,me=0,ie=0;(Y&1)==0;){if(Y=ye(H,X),X+=3,Y>>>1)Y>>1==1?(me=9,ie=5):(X=je(H,X),me=Ln,ie=Ad);else{X&7&&(X+=8-(X&7));var le=H[X>>>3]|H[(X>>>3)+1]<<8;if(X+=32,le>0)for(!J&&oe<Z+le&&(Q=_r(Q,Z+le),oe=Q.length);le-- >0;)Q[Z++]=H[X>>>3],X+=8;continue}for(;;){!J&&oe<Z+32767&&(Q=_r(Q,Z+32767),oe=Q.length);var ce=We(H,X,me),ve=Y>>>1==1?na[ce]:Yt[ce];if(X+=ve&15,ve>>>=4,(ve>>>8&255)===0)Q[Z++]=ve;else{if(ve==256)break;ve-=257;var Ee=ve<8?0:ve-4>>2;Ee>5&&(Ee=0);var Ce=Z+te[ve];Ee>0&&(Ce+=We(H,X,Ee),X+=Ee),ce=We(H,X,ie),ve=Y>>>1==1?sn[ce]:xa[ce],X+=ve&15,ve>>>=4;var we=ve<4?0:ve-2>>1,Ae=ae[ve];for(we>0&&(Ae+=We(H,X,we),X+=we),!J&&oe<Ce&&(Q=_r(Q,Ce+100),oe=Q.length);Z<Ce;)Q[Z]=Q[Z-Ae],++Z}}}return J?[Q,X+7>>>3]:[Q.slice(0,Z),X+7>>>3]}function xs(H,J){var X=H.slice(H.l||0),Y=yn(X,J);return H.l+=Y[1],Y[0]}function Cd(H,J){if(H)typeof console<"u"&&console.error(J);else throw new Error(J)}function Pd(H,J){var X=H;qr(X,0);var Y=[],Q=[],Z={FileIndex:Y,FullPaths:Q};_(Z,{root:J.root});for(var oe=X.length-4;(X[oe]!=80||X[oe+1]!=75||X[oe+2]!=5||X[oe+3]!=6)&&oe>=0;)--oe;X.l=oe+4,X.l+=4;var me=X.read_shift(2);X.l+=6;var ie=X.read_shift(4);for(X.l=ie,oe=0;oe<me;++oe){X.l+=20;var le=X.read_shift(4),ce=X.read_shift(4),ve=X.read_shift(2),Ee=X.read_shift(2),Ce=X.read_shift(2);X.l+=8;var we=X.read_shift(4),Ae=l(X.slice(X.l+ve,X.l+ve+Ee));X.l+=ve+Ee+Ce;var Xe=X.l;X.l=we+4,IC(X,le,ce,Z,Ae),X.l=Xe}return Z}function IC(H,J,X,Y,Q){H.l+=2;var Z=H.read_shift(2),oe=H.read_shift(2),me=o(H);if(Z&8257)throw new Error("Unsupported ZIP encryption");for(var ie=H.read_shift(4),le=H.read_shift(4),ce=H.read_shift(4),ve=H.read_shift(2),Ee=H.read_shift(2),Ce="",we=0;we<ve;++we)Ce+=String.fromCharCode(H[H.l++]);if(Ee){var Ae=l(H.slice(H.l,H.l+Ee));(Ae[21589]||{}).mt&&(me=Ae[21589].mt),((Q||{})[21589]||{}).mt&&(me=Q[21589].mt)}H.l+=Ee;var Xe=H.slice(H.l,H.l+le);switch(oe){case 8:Xe=O(H,ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+oe)}var Jt=!1;Z&8&&(ie=H.read_shift(4),ie==134695760&&(ie=H.read_shift(4),Jt=!0),le=H.read_shift(4),ce=H.read_shift(4)),le!=J&&Cd(Jt,"Bad compressed size: "+J+" != "+le),ce!=X&&Cd(Jt,"Bad uncompressed size: "+X+" != "+ce),R0(Y,Ce,Xe,{unsafe:!0,mt:me})}function FC(H,J){var X=J||{},Y=[],Q=[],Z=ue(1),oe=X.compression?8:0,me=0,ie=0,le=0,ce=0,ve=0,Ee=H.FullPaths[0],Ce=Ee,we=H.FileIndex[0],Ae=[],Xe=0;for(ie=1;ie<H.FullPaths.length;++ie)if(Ce=H.FullPaths[ie].slice(Ee.length),we=H.FileIndex[ie],!(!we.size||!we.content||Ce=="Sh33tJ5")){var Jt=ce,Qt=ue(Ce.length);for(le=0;le<Ce.length;++le)Qt.write_shift(1,Ce.charCodeAt(le)&127);Qt=Qt.slice(0,Qt.l),Ae[ve]=AD.buf(we.content,0);var Vr=we.content;oe==8&&(Vr=W(Vr)),Z=ue(30),Z.write_shift(4,67324752),Z.write_shift(2,20),Z.write_shift(2,me),Z.write_shift(2,oe),we.mt?i(Z,we.mt):Z.write_shift(4,0),Z.write_shift(-4,Ae[ve]),Z.write_shift(4,Vr.length),Z.write_shift(4,we.content.length),Z.write_shift(2,Qt.length),Z.write_shift(2,0),ce+=Z.length,Y.push(Z),ce+=Qt.length,Y.push(Qt),ce+=Vr.length,Y.push(Vr),Z=ue(46),Z.write_shift(4,33639248),Z.write_shift(2,0),Z.write_shift(2,20),Z.write_shift(2,me),Z.write_shift(2,oe),Z.write_shift(4,0),Z.write_shift(-4,Ae[ve]),Z.write_shift(4,Vr.length),Z.write_shift(4,we.content.length),Z.write_shift(2,Qt.length),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(4,0),Z.write_shift(4,Jt),Xe+=Z.l,Q.push(Z),Xe+=Qt.length,Q.push(Qt),++ve}return Z=ue(22),Z.write_shift(4,101010256),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,ve),Z.write_shift(2,ve),Z.write_shift(4,Xe),Z.write_shift(4,ce),Z.write_shift(2,0),Rr([Rr(Y),Rr(Q),Z])}var Od={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function DC(H,J){if(H.ctype)return H.ctype;var X=H.name||"",Y=X.match(/\.([^\.]+)$/);return Y&&Od[Y[1]]||J&&(Y=(X=J).match(/[\.\\]([^\.\\])+$/),Y&&Od[Y[1]])?Od[Y[1]]:"application/octet-stream"}function RC(H){for(var J=yc(H),X=[],Y=0;Y<J.length;Y+=76)X.push(J.slice(Y,Y+76));return X.join(`\r
`)+`\r
`}function MC(H){var J=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var ce=le.charCodeAt(0).toString(16).toUpperCase();return"="+(ce.length==1?"0"+ce:ce)});J=J.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),J.charAt(0)==`
`&&(J="=0D"+J.slice(1)),J=J.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var X=[],Y=J.split(`\r
`),Q=0;Q<Y.length;++Q){var Z=Y[Q];if(Z.length==0){X.push("");continue}for(var oe=0;oe<Z.length;){var me=76,ie=Z.slice(oe,oe+me);ie.charAt(me-1)=="="?me--:ie.charAt(me-2)=="="?me-=2:ie.charAt(me-3)=="="&&(me-=3),ie=Z.slice(oe,oe+me),oe+=me,oe<Z.length&&(ie+="="),X.push(ie)}}return X.join(`\r
`)}function LC(H){for(var J=[],X=0;X<H.length;++X){for(var Y=H[X];X<=H.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+H[++X];J.push(Y)}for(var Q=0;Q<J.length;++Q)J[Q]=J[Q].replace(/[=][0-9A-Fa-f]{2}/g,function(Z){return String.fromCharCode(parseInt(Z.slice(1),16))});return Aa(J.join(`\r
`))}function $C(H,J,X){for(var Y="",Q="",Z="",oe,me=0;me<10;++me){var ie=J[me];if(!ie||ie.match(/^\s*$/))break;var le=ie.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":Y=le[2].trim();break;case"content-type":Z=le[2].trim();break;case"content-transfer-encoding":Q=le[2].trim();break}}switch(++me,Q.toLowerCase()){case"base64":oe=Aa(Ra(J.slice(me).join("")));break;case"quoted-printable":oe=LC(J.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Q)}var ce=R0(H,Y.slice(X.length),oe,{unsafe:!0});Z&&(ce.ctype=Z)}function BC(H,J){if(U(H.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var X=J&&J.root||"",Y=(nt&&Buffer.isBuffer(H)?H.toString("binary"):U(H)).split(`\r
`),Q=0,Z="";for(Q=0;Q<Y.length;++Q)if(Z=Y[Q],!!/^Content-Location:/i.test(Z)&&(Z=Z.slice(Z.indexOf("file")),X||(X=Z.slice(0,Z.lastIndexOf("/")+1)),Z.slice(0,X.length)!=X))for(;X.length>0&&(X=X.slice(0,X.length-1),X=X.slice(0,X.lastIndexOf("/")+1),Z.slice(0,X.length)!=X););var oe=(Y[1]||"").match(/boundary="(.*?)"/);if(!oe)throw new Error("MAD cannot find boundary");var me="--"+(oe[1]||""),ie=[],le=[],ce={FileIndex:ie,FullPaths:le};_(ce);var ve,Ee=0;for(Q=0;Q<Y.length;++Q){var Ce=Y[Q];Ce!==me&&Ce!==me+"--"||(Ee++&&$C(ce,Y.slice(ve,Q),X),ve=Q)}return ce}function UC(H,J){var X=J||{},Y=X.boundary||"SheetJS";Y="------="+Y;for(var Q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],Z=H.FullPaths[0],oe=Z,me=H.FileIndex[0],ie=1;ie<H.FullPaths.length;++ie)if(oe=H.FullPaths[ie].slice(Z.length),me=H.FileIndex[ie],!(!me.size||!me.content||oe=="Sh33tJ5")){oe=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Xe){return"_x"+Xe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Xe){return"_u"+Xe.charCodeAt(0).toString(16)+"_"});for(var le=me.content,ce=nt&&Buffer.isBuffer(le)?le.toString("binary"):U(le),ve=0,Ee=Math.min(1024,ce.length),Ce=0,we=0;we<=Ee;++we)(Ce=ce.charCodeAt(we))>=32&&Ce<128&&++ve;var Ae=ve>=Ee*4/5;Q.push(Y),Q.push("Content-Location: "+(X.root||"file:///C:/SheetJS/")+oe),Q.push("Content-Transfer-Encoding: "+(Ae?"quoted-printable":"base64")),Q.push("Content-Type: "+DC(me,oe)),Q.push(""),Q.push(Ae?MC(ce):RC(ce))}return Q.push(Y+`--\r
`),Q.join(`\r
`)}function qC(H){var J={};return _(J,H),J}function R0(H,J,X,Y){var Q=Y&&Y.unsafe;Q||_(H);var Z=!Q&&Fe.find(H,J);if(!Z){var oe=H.FullPaths[0];J.slice(0,oe.length)==oe?oe=J:(oe.slice(-1)!="/"&&(oe+="/"),oe=(oe+J).replace("//","/")),Z={name:s(J),type:2},H.FileIndex.push(Z),H.FullPaths.push(oe),Q||Fe.utils.cfb_gc(H)}return Z.content=X,Z.size=X?X.length:0,Y&&(Y.CLSID&&(Z.clsid=Y.CLSID),Y.mt&&(Z.mt=Y.mt),Y.ct&&(Z.ct=Y.ct)),Z}function WC(H,J){_(H);var X=Fe.find(H,J);if(X){for(var Y=0;Y<H.FileIndex.length;++Y)if(H.FileIndex[Y]==X)return H.FileIndex.splice(Y,1),H.FullPaths.splice(Y,1),!0}return!1}function HC(H,J,X){_(H);var Y=Fe.find(H,J);if(Y){for(var Q=0;Q<H.FileIndex.length;++Q)if(H.FileIndex[Q]==Y)return H.FileIndex[Q].name=s(X),H.FullPaths[Q]=X,!0}return!1}function zC(H){k(H,!0)}return t.find=A,t.read=w,t.parse=u,t.write=q,t.writeFile=F,t.utils={cfb_new:qC,cfb_add:R0,cfb_del:WC,cfb_mov:HC,cfb_gc:zC,ReadShift:Ql,CheckField:DT,prep_blob:qr,bconcat:Rr,use_zlib:T,_deflateRaw:rt,_inflateRaw:xs,consts:V},t})();function CD(e){return typeof e=="string"?Hf(e):Array.isArray(e)?rD(e):e}function md(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Hf(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?_n(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([CD(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Ls(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function PD(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function ur(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function oj(e,t){for(var r=[],a=ur(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function Vf(e){for(var t=[],r=ur(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Gf(e){for(var t=[],r=ur(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function OD(e){for(var t=[],r=ur(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var Eu=new Date(1899,11,30,0,0,0);function Pr(e,t){var r=e.getTime(),a=Eu.getTime()+(e.getTimezoneOffset()-Eu.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var mT=new Date,ID=Eu.getTime()+(mT.getTimezoneOffset()-Eu.getTimezoneOffset())*6e4,lj=mT.getTimezoneOffset();function Kf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+ID),t.getTimezoneOffset()!==lj&&t.setTime(t.getTime()+(t.getTimezoneOffset()-lj)*6e4),t}function FD(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(a=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[i],10)}return t}var cj=new Date("2017-02-19T19:06:09.000Z"),xT=isNaN(cj.getFullYear())?new Date("2/19/17"):cj,DD=xT.getFullYear()==2017;function Ht(e,t){var r=new Date(e);if(DD)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(xT.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function wi(e,t){if(nt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return _n(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return _n(rT(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return _n(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return _n(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function zt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=zt(e[r]));return t}function ir(e,t){for(var r="";r.length<t;)r+=e;return r}function mn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var RD=["january","february","march","april","may","june","july","august","september","october","november","december"];function Eo(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&RD.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var MD=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),o=[i[0]],l=1;l<i.length;++l)o.push(s),o.push(i[l]);return o}})();function pT(e){return e?e.content&&e.type?wi(e.content,!0):e.data?Ul(e.data):e.asNodeBuffer&&nt?Ul(e.asNodeBuffer().toString("binary")):e.asBinary?Ul(e.asBinary()):e._data&&e._data.getContent?Ul(wi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function gT(e){if(!e)return null;if(e.data)return J1(e.data);if(e.asNodeBuffer&&nt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?J1(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function LD(e){return e&&e.name.slice(-4)===".bin"?gT(e):pT(e)}function za(e,t){for(var r=e.FullPaths||ur(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||s==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function vv(e,t){var r=za(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function yr(e,t,r){if(!r)return LD(vv(e,t));if(!t)return null;try{return yr(e,t)}catch{return null}}function Ca(e,t,r){if(!r)return pT(vv(e,t));if(!t)return null;try{return Ca(e,t)}catch{return null}}function $D(e,t,r){return gT(vv(e,t))}function dj(e){for(var t=e.FullPaths||ur(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function et(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return nt?a=ls(r):a=aD(r),Fe.utils.cfb_add(e,t,a)}Fe.utils.cfb_add(e,t,r)}else e.file(t,r)}function bv(){return Fe.utils.cfb_new()}function yT(e,t){switch(t.type){case"base64":return Fe.read(e,{type:"base64"});case"binary":return Fe.read(e,{type:"binary"});case"buffer":case"array":return Fe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Wl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var pr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,BD=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,uj=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,UD=/<[^>]*>/g,ra=pr.match(uj)?uj:UD,qD=/<\w*:/,WD=/<(\/?)\w+:/;function ze(e,t,r){for(var a={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var o=e.match(BD),l=0,c="",d=0,u="",f="",x=1;if(o)for(d=0;d!=o.length;++d){for(f=o[d],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(x=(s=f.charCodeAt(i+1))==34||s==39?1:0,c=f.slice(i+1+x,f.length-x),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),a[u]=c,a[u.toLowerCase()]=c;else{var p=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(a[p]&&u.slice(l-3,l)=="ext")continue;a[p]=c,a[p.toLowerCase()]=c}}return a}function Fn(e){return e.replace(WD,"<$1")}var vT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},jv=Vf(vT),mt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(l,c){return vT[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,o)+r(s.slice(o+3))}})(),wv=/[&<>'"]/g,HD=/[\u0000-\u0008\u000b-\u001f]/g;function At(e){var t=e+"";return t.replace(wv,function(r){return jv[r]}).replace(HD,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function fj(e){return At(e).replace(/ /g,"_x0020_")}var bT=/[\u0000-\u001f]/g;function Nv(e){var t=e+"";return t.replace(wv,function(r){return jv[r]}).replace(/\n/g,"<br/>").replace(bT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function zD(e){var t=e+"";return t.replace(wv,function(r){return jv[r]}).replace(bT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var hj=(function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function VD(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Wt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function X0(e){for(var t="",r=0,a=0,s=0,i=0,o=0,l=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((a&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function mj(e){var t=Os(2*e.length),r,a,s=1,i=0,o=0,l;for(a=0;a<e.length;a+=s)s=1,(l=e.charCodeAt(a))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(a+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function xj(e){return ls(e,"binary").toString("utf8")}var $d="foo bar bazâð£",It=nt&&(xj($d)==X0($d)&&xj||mj($d)==X0($d)&&mj)||X0,_n=nt?function(e){return ls(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},bc=(function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),jT=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}})(),GD=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),KD=/<\/?(?:vt:)?variant>/g,XD=/<(?:vt:)([^>]*)>([\s\S]*)</;function pj(e,t){var r=ze(e),a=e.match(GD(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(i){var o=i.replace(KD,"").match(XD);o&&s.push({v:It(o[2]),t:o[1]})}),s}var wT=/(^\s|\s$|\n)/;function Wr(e,t){return"<"+e+(t.match(wT)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function jc(e){return ur(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ne(e,t,r){return"<"+e+(r!=null?jc(r):"")+(t!=null?(t.match(wT)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Sg(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function YD(e,t){switch(typeof e){case"string":var r=Ne("vt:lpwstr",At(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ne((e|0)==e?"vt:i4":"vt:r8",At(String(e)));case"boolean":return Ne("vt:bool",e?"true":"false")}if(e instanceof Date)return Ne("vt:filetime",Sg(e));throw new Error("Unable to serialize "+e)}function _v(e){if(nt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return It(Ls(pv(e)));throw new Error("Bad input format: expected Buffer or string")}var wc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Er={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Fi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ea={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function JD(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function QD(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,o=a?-t:t;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|a}var gj=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,i=e[0][a].length;s<i;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},yj=nt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ls(t)})):gj(e)}:gj,vj=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(Vn(e,s)));return a.join("").replace(ha,"")},Sv=nt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ha,""):vj(e,t,r)}:vj,bj=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},NT=nt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):bj(e,t,r)}:bj,jj=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(ao(e,s)));return a.join("")},xd=nt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):jj(t,r,a)}:jj,_T=function(e,t){var r=Ta(e,t);return r>0?xd(e,t+4,t+4+r-1):""},ST=_T,kT=function(e,t){var r=Ta(e,t);return r>0?xd(e,t+4,t+4+r-1):""},ET=kT,TT=function(e,t){var r=2*Ta(e,t);return r>0?xd(e,t+4,t+4+r-1):""},AT=TT,CT=function(t,r){var a=Ta(t,r);return a>0?Sv(t,r+4,r+4+a):""},PT=CT,OT=function(e,t){var r=Ta(e,t);return r>0?xd(e,t+4,t+4+r):""},IT=OT,FT=function(e,t){return JD(e,t)},Tu=FT,kv=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};nt&&(ST=function(t,r){if(!Buffer.isBuffer(t))return _T(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},ET=function(t,r){if(!Buffer.isBuffer(t))return kT(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},AT=function(t,r){if(!Buffer.isBuffer(t))return TT(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},PT=function(t,r){if(!Buffer.isBuffer(t))return CT(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},IT=function(t,r){if(!Buffer.isBuffer(t))return OT(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Tu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):FT(t,r)},kv=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ao=function(e,t){return e[t]},Vn=function(e,t){return e[t+1]*256+e[t]},ZD=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ta=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Zs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},eR=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ql(e,t){var r="",a,s,i=[],o,l,c,d;switch(t){case"dbcs":if(d=this.l,nt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Vn(this,d)),d+=2;e*=2;break;case"utf8":r=xd(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Sv(this,this.l,this.l+e);break;case"wstr":return Ql.call(this,e,"dbcs");case"lpstr-ansi":r=ST(this,this.l),e=4+Ta(this,this.l);break;case"lpstr-cp":r=ET(this,this.l),e=4+Ta(this,this.l);break;case"lpwstr":r=AT(this,this.l),e=4+2*Ta(this,this.l);break;case"lpp4":e=4+Ta(this,this.l),r=PT(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ta(this,this.l),r=IT(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=ao(this,this.l+e++))!==0;)i.push(Ld(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Vn(this,this.l+e))!==0;)i.push(Ld(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=ao(this,d),this.l=d+1,l=Ql.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Ld(Vn(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=ao(this,d),this.l=d+1,l=Ql.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Ld(ao(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return a=ao(this,this.l),this.l++,a;case 2:return a=(t==="i"?ZD:Vn)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?Zs:eR)(this,this.l),this.l+=4,a):(s=Ta(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Tu(this,this.l):s=Tu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=NT(this,this.l,e);break}}return this.l+=e,r}var tR=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},rR=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},aR=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function nR(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)aR(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,tR(this,t,this.l);break;case 8:if(a=8,r==="f"){QD(this,t,this.l);break}case 16:break;case-4:a=4,rR(this,t,this.l);break}return this.l+=a,this}function DT(e,t){var r=NT(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function qr(e,t){e.l=t,e.read_shift=Ql,e.chk=DT,e.write_shift=nR}function ta(e,t){e.l+=t}function ue(e){var t=Os(e);return qr(t,0),t}function cs(e,t,r){if(e){var a,s,i;qr(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var d=Tc[l]||Tc[65535];for(a=e.read_shift(1),i=a&127,s=1;s<4&&a&128;++s)i+=((a=e.read_shift(1))&127)<<7*s;c=e.l+i;var u=d.f&&d.f(e,i,r);if(e.l=c,t(u,d,l))return}}}function va(){var e=[],t=nt?256:2048,r=function(d){var u=ue(d);return qr(u,0),u},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(d){return a&&d<a.length-a.l?a:(s(),a=r(Math.max(d+1,t)))},o=function(){return s(),Rr(e)},l=function(d){s(),a=d,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function ge(e,t,r,a){var s=+t,i;if(!isNaN(s)){a||(a=Tc[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var o=e.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&kv(r)&&e.push(r)}}function Zl(e,t,r){var a=zt(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function wj(e,t,r){var a=zt(e);return a.s=Zl(a.s,t.s,r),a.e=Zl(a.e,t.s,r),a}function ec(e,t){if(e.cRel&&e.c<0)for(e=zt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=zt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ue(e);return!e.cRel&&e.cRel!=null&&(r=oR(r)),!e.rRel&&e.rRel!=null&&(r=sR(r)),r}function Y0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+er(e.s.c)+":"+(e.e.cRel?"":"$")+er(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+xr(e.s.r)+":"+(e.e.rRel?"":"$")+xr(e.e.r):ec(e.s,t.biff)+":"+ec(e.e,t.biff)}function Ev(e){return parseInt(iR(e),10)-1}function xr(e){return""+(e+1)}function sR(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function iR(e){return e.replace(/\$(\d+)$/,"$1")}function Tv(e){for(var t=lR(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function er(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function oR(e){return e.replace(/^([A-Z])/,"$$$1")}function lR(e){return e.replace(/^\$([A-Z])/,"$1")}function cR(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function tr(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Ue(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function wa(e){var t=e.indexOf(":");return t==-1?{s:tr(e),e:tr(e)}:{s:tr(e.slice(0,t)),e:tr(e.slice(t+1))}}function Ze(e,t){return typeof t>"u"||typeof t=="number"?Ze(e.s,e.e):(typeof e!="string"&&(e=Ue(e)),typeof t!="string"&&(t=Ue(t)),e==t?e:e+":"+t)}function gt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,i=e.length;for(r=0;a<i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function Nj(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=en(e.z,r?Pr(t):t)}catch{}try{return e.w=en((e.XF||{}).numFmtId||(r?14:0),r?Pr(t):t)}catch{return""+t}}function as(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ds[e.v]||e.v:t==null?Nj(e,e.v):Nj(e,t))}function $s(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function RT(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,i=e||(s?[]:{}),o=0,l=0;if(i&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?tr(a.origin):a.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=gt(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(d.e.r=o=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[f].length;++x)if(!(typeof t[f][x]>"u")){var p={v:t[f][x]},h=o+f,m=l+x;if(d.s.r>h&&(d.s.r=h),d.s.c>m&&(d.s.c=m),d.e.r<h&&(d.e.r=h),d.e.c<m&&(d.e.c=m),t[f][x]&&typeof t[f][x]=="object"&&!Array.isArray(t[f][x])&&!(t[f][x]instanceof Date))p=t[f][x];else if(Array.isArray(p.v)&&(p.f=t[f][x][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(a.nullError)p.t="e",p.v=0;else if(a.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=a.dateNF||Be[14],a.cellDates?(p.t="d",p.w=en(p.z,Pr(p.v))):(p.t="n",p.v=Pr(p.v),p.w=en(p.z,p.v))):p.t="s";if(s)i[h]||(i[h]=[]),i[h][m]&&i[h][m].z&&(p.z=i[h][m].z),i[h][m]=p;else{var g=Ue({c:m,r:h});i[g]&&i[g].z&&(p.z=i[g].z),i[g]=p}}}return d.s.c<1e7&&(i["!ref"]=Ze(d)),i}function dl(e,t){return RT(null,e,t)}function dR(e){return e.read_shift(4,"i")}function xn(e,t){return t||(t=ue(4)),t.write_shift(4,e),t}function ea(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Lr(e,t){var r=!1;return t==null&&(r=!0,t=ue(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function uR(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function fR(e,t){return t||(t=ue(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Av(e,t){var r=e.l,a=e.read_shift(1),s=ea(e),i=[],o={t:s,h:s};if((a&1)!==0){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(uR(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function hR(e,t){var r=!1;return t==null&&(r=!0,t=ue(15+4*e.t.length)),t.write_shift(1,0),Lr(e.t,t),r?t.slice(0,t.l):t}var mR=Av;function xR(e,t){var r=!1;return t==null&&(r=!0,t=ue(23+4*e.t.length)),t.write_shift(1,1),Lr(e.t,t),t.write_shift(4,1),fR({},t),r?t.slice(0,t.l):t}function an(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Di(e,t){return t==null&&(t=ue(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ri(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Mi(e,t){return t==null&&(t=ue(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var pR=ea,MT=Lr;function Cv(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Au(e,t){var r=!1;return t==null&&(r=!0,t=ue(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var gR=ea,kg=Cv,Pv=Au;function Ov(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?Tu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Zs(t,0)>>2;return r?s/100:s}function LT(e,t){t==null&&(t=ue(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function $T(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function yR(e,t){return t||(t=ue(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Li=$T,ul=yR;function Zr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ni(e,t){return(t||ue(8)).write_shift(8,e,"f")}function vR(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var d=fi[s];d&&(t.rgb=_c(d));break;case 2:t.rgb=_c([o,l,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Cu(e,t){if(t||(t=ue(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function bR(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function jR(e,t){t||(t=ue(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function BT(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function wR(e){return BT(e,1)}function NR(e){return BT(e,2)}var Iv=2,pa=3,Bd=11,_j=12,Pu=19,Ud=64,_R=65,SR=71,kR=4108,ER=4126,Ir=80,UT=81,TR=[Ir,UT],Eg={1:{n:"CodePage",t:Iv},2:{n:"Category",t:Ir},3:{n:"PresentationFormat",t:Ir},4:{n:"ByteCount",t:pa},5:{n:"LineCount",t:pa},6:{n:"ParagraphCount",t:pa},7:{n:"SlideCount",t:pa},8:{n:"NoteCount",t:pa},9:{n:"HiddenCount",t:pa},10:{n:"MultimediaClipCount",t:pa},11:{n:"ScaleCrop",t:Bd},12:{n:"HeadingPairs",t:kR},13:{n:"TitlesOfParts",t:ER},14:{n:"Manager",t:Ir},15:{n:"Company",t:Ir},16:{n:"LinksUpToDate",t:Bd},17:{n:"CharacterCount",t:pa},19:{n:"SharedDoc",t:Bd},22:{n:"HyperlinksChanged",t:Bd},23:{n:"AppVersion",t:pa,p:"version"},24:{n:"DigSig",t:_R},26:{n:"ContentType",t:Ir},27:{n:"ContentStatus",t:Ir},28:{n:"Language",t:Ir},29:{n:"Version",t:Ir},255:{},2147483648:{n:"Locale",t:Pu},2147483651:{n:"Behavior",t:Pu},1919054434:{}},Tg={1:{n:"CodePage",t:Iv},2:{n:"Title",t:Ir},3:{n:"Subject",t:Ir},4:{n:"Author",t:Ir},5:{n:"Keywords",t:Ir},6:{n:"Comments",t:Ir},7:{n:"Template",t:Ir},8:{n:"LastAuthor",t:Ir},9:{n:"RevNumber",t:Ir},10:{n:"EditTime",t:Ud},11:{n:"LastPrinted",t:Ud},12:{n:"CreatedDate",t:Ud},13:{n:"ModifiedDate",t:Ud},14:{n:"PageCount",t:pa},15:{n:"WordCount",t:pa},16:{n:"CharCount",t:pa},17:{n:"Thumbnail",t:SR},18:{n:"Application",t:Ir},19:{n:"DocSecurity",t:pa},255:{},2147483648:{n:"Locale",t:Pu},2147483651:{n:"Behavior",t:Pu},1919054434:{}},Sj={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},AR=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function CR(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var PR=CR([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),fi=zt(PR),ds={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},qT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ag={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},qd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Fv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function OR(e){var t=Fv();if(!e||!e.match)return t;var r={};if((e.match(ra)||[]).forEach(function(a){var s=ze(a);switch(s[0].replace(qD,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Ag[s.ContentType]]!==void 0&&t[Ag[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Er.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function WT(e,t){var r=OD(Ag),a=[],s;a[a.length]=pr,a[a.length]=Ne("Types",null,{xmlns:Er.CT,"xmlns:xsd":Er.xsd,"xmlns:xsi":Er.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Ne("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(s=e[c][0],a[a.length]=Ne("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:qd[c][t.bookType]||qd[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(d){a[a.length]=Ne("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:qd[c][t.bookType]||qd[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(d){a[a.length]=Ne("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var it={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Nc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function tc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(ra)||[]).forEach(function(s){var i=ze(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:Wl(i.Target,t);r[l]=o,a[i.Id]=o}}),r["!id"]=a,r}function ho(e){var t=[pr,Ne("Relationships",null,{xmlns:Er.RELS})];return ur(e["!id"]).forEach(function(r){t[t.length]=Ne("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Tt(e,t,r,a,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,[it.HLINK,it.XPATH,it.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var IR="application/vnd.oasis.opendocument.spreadsheet";function FR(e,t){for(var r=_v(e),a,s;a=wc.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=ze(a[0],!1),s.path=="/"&&s.type!==IR)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function DR(e){var t=[pr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function kj(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function RR(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function MR(e){var t=[pr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(kj(e[r][0],e[r][1])),t.push(RR("",e[r][0]));return t.push(kj("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function HT(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Nu.version+"</meta:generator></office:meta></office:document-meta>"}var Ja=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],LR=(function(){for(var e=new Array(Ja.length),t=0;t<Ja.length;++t){var r=Ja[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function zT(e){var t={};e=It(e);for(var r=0;r<Ja.length;++r){var a=Ja[r],s=e.match(LR[r]);s!=null&&s.length>0&&(t[a[1]]=mt(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Ht(t[a[1]]))}return t}function J0(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=At(t),a[a.length]=r?Ne(e,t,r):Wr(e,t))}function VT(e,t){var r=t||{},a=[pr,Ne("cp:coreProperties",null,{"xmlns:cp":Er.CORE_PROPS,"xmlns:dc":Er.dc,"xmlns:dcterms":Er.dcterms,"xmlns:dcmitype":Er.dcmitype,"xmlns:xsi":Er.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&J0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Sg(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&J0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Sg(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var i=0;i!=Ja.length;++i){var o=Ja[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&J0(o[0],l,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var hi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],GT=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function KT(e,t,r,a){var s=[];if(typeof e=="string")s=pj(e,a);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(u){return{v:u}}));var o=typeof t=="string"?pj(t,a).map(function(u){return u.v}):t,l=0,c=0;if(o.length>0)for(var d=0;d!==s.length;d+=2){switch(c=+s[d+1].v,s[d].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function $R(e,t,r){var a={};return t||(t={}),e=It(e),hi.forEach(function(s){var i=(e.match(bc(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=mt(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(a[s[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&KT(a.HeadingPairs,a.TitlesOfParts,t,r),t}function XT(e){var t=[],r=Ne;return e||(e={}),e.Application="SheetJS",t[t.length]=pr,t[t.length]=Ne("Properties",null,{xmlns:Er.EXT_PROPS,"xmlns:vt":Er.vt}),hi.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=At(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+At(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var BR=/<[^>]+>[^<]*/g;function UR(e,t){var r={},a="",s=e.match(BR);if(s)for(var i=0;i!=s.length;++i){var o=s[i],l=ze(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":a=mt(l.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),d=c[0].slice(4),u=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=mt(u);break;case"bool":r[a]=Wt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(u);break;case"filetime":case"date":r[a]=Ht(u);break;case"cy":case"error":r[a]=mt(u);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function YT(e){var t=[pr,Ne("Properties",null,{xmlns:Er.CUST_PROPS,"xmlns:vt":Er.vt})];if(!e)return t.join("");var r=1;return ur(e).forEach(function(s){++r,t[t.length]=Ne("property",YD(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:At(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Cg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Q0;function qR(e,t,r){Q0||(Q0=Vf(Cg)),t=Q0[t]||t,e[t]=r}function WR(e,t){var r=[];return ur(Cg).map(function(a){for(var s=0;s<Ja.length;++s)if(Ja[s][1]==a)return Ja[s];for(s=0;s<hi.length;++s)if(hi[s][1]==a)return hi[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Wr(Cg[a[1]]||a[1],s))}}),Ne("DocumentProperties",r.join(""),{xmlns:Ea.o})}function HR(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&ur(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Ja.length;++o)if(i==Ja[o][1])return;for(o=0;o<hi.length;++o)if(i==hi[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(Ne(fj(i),l,{"dt:dt":c}))}}),t&&ur(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Ne(fj(i),o,{"dt:dt":l}))}}),"<"+a+' xmlns="'+Ea.o+'">'+s.join("")+"</"+a+">"}function Dv(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function zR(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),s+=i);var o=ue(8);return o.write_shift(4,a),o.write_shift(4,s),o}function JT(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function QT(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function ZT(e,t,r){return t===31?QT(e):JT(e,t,r)}function Pg(e,t,r){return ZT(e,t,r===!1?0:4)}function VR(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return ZT(e,t,0)}function GR(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(ha,""),e.l-s&2&&(e.l+=2)}return r}function KR(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(ha,"");return r}function XR(e){var t=e.l,r=Ou(e,UT);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Ou(e,pa);return[r,a]}function YR(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(XR(e));return r}function Ej(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var i=e.read_shift(4),o=e.read_shift(4);a[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(ha,"").replace(ql,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function e5(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function JR(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Ou(e,t,r){var a=e.read_shift(2),s,i=r||{};if(e.l+=2,t!==_j&&a!==t&&TR.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===_j?a:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return JT(e,a,4).replace(ha,"");case 31:return QT(e);case 64:return Dv(e);case 65:return e5(e);case 71:return JR(e);case 80:return Pg(e,a,!i.raw).replace(ha,"");case 81:return VR(e,a).replace(ha,"");case 4108:return YR(e);case 4126:case 4127:return a==4127?GR(e):KR(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Tj(e,t){var r=ue(4),a=ue(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=ue(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=zR(t);break;case 31:case 80:for(a=ue(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Rr([r,a])}function Aj(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),i=[],o=0,l=0,c=-1,d={};for(o=0;o!=s;++o){var u=e.read_shift(4),f=e.read_shift(4);i[o]=[u,f+r]}i.sort(function(b,y){return b[1]-y[1]});var x={};for(o=0;o!=s;++o){if(e.l!==i[o][1]){var p=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,p=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],p=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],p=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(p=!1,e.l=i[o][1]),p)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var h=t[i[o][0]];if(x[h.n]=Ou(e,h.t,{raw:!0}),h.p==="version"&&(x[h.n]=String(x[h.n]>>16)+"."+("0000"+String(x[h.n]&65535)).slice(-4)),h.n=="CodePage")switch(x[h.n]){case 0:x[h.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:fn(l=x[h.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[h.n])}}else if(i[o][0]===1){if(l=x.CodePage=Ou(e,Iv),fn(l),c!==-1){var m=e.l;e.l=i[c][1],d=Ej(e,l),e.l=m}}else if(i[o][0]===0){if(l===0){c=o,e.l=i[o+1][1];continue}d=Ej(e,l)}else{var g=d[i[o][0]],v;switch(e[e.l]){case 65:e.l+=4,v=e5(e);break;case 30:e.l+=4,v=Pg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Pg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=hr(e,4);break;case 64:e.l+=4,v=Ht(Dv(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[g]=v}}return e.l=r+a,x}var t5=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function QR(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Cj(e,t,r){var a=ue(8),s=[],i=[],o=8,l=0,c=ue(8),d=ue(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),s.push(d),o+=8+c.length,!t){d=ue(8),d.write_shift(4,0),s.unshift(d);var u=[ue(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=ue(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Rr(u),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(t5.indexOf(e[l][0])>-1||GT.indexOf(e[l][0])>-1)&&e[l][1]!=null){var x=e[l][1],p=0;if(t){p=+t[e[l][0]];var h=r[p];if(h.p=="version"&&typeof x=="string"){var m=x.split(".");x=(+m[0]<<16)+(+m[1]||0)}c=Tj(h.t,x)}else{var g=QR(x);g==-1&&(g=31,x=String(x)),c=Tj(g,x)}i.push(c),d=ue(8),d.write_shift(4,t?p:2+l),s.push(d),o+=8+c.length}var v=8*(i.length+1);for(l=0;l<i.length;++l)s[l].write_shift(4,v),v+=i[l].length;return a.write_shift(4,o),a.write_shift(4,i.length),Rr([a].concat(s).concat(i))}function Pj(e,t,r){var a=e.content;if(!a)return{};qr(a,0);var s,i,o,l,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),u=a.read_shift(16);if(u!==Fe.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=a.read_shift(16),l=a.read_shift(4),s===1&&l!==a.l)throw new Error("Length mismatch: "+l+" !== "+a.l);s===2&&(o=a.read_shift(16),c=a.read_shift(4));var f=Aj(a,t),x={SystemIdentifier:d};for(var p in f)x[p]=f[p];if(x.FMTID=i,s===1)return x;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var h;try{h=Aj(a,null)}catch{}for(p in h)x[p]=h[p];return x.FMTID=[i,o],x}function Oj(e,t,r,a,s,i){var o=ue(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Fe.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var c=Cj(e,r,a);if(l.push(c),s){var d=Cj(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(d)}return Rr(l)}function gs(e,t){return e.read_shift(t),null}function ZR(e,t){t||(t=ue(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function eM(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function hr(e,t){return e.read_shift(t)===1}function oa(e,t){return t||(t=ue(2)),t.write_shift(2,+!!e),t}function vr(e){return e.read_shift(2,"u")}function Va(e,t){return t||(t=ue(2)),t.write_shift(2,e),t}function r5(e,t){return eM(e,t,vr)}function tM(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function a5(e,t,r){return r||(r=ue(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function pd(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=a?e.read_shift(a,s):"";return o}function rM(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,i=1+(r&1),o=0,l,c={};s&&(o=e.read_shift(2)),a&&(l=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,d);return s&&(e.l+=4*o),a&&(e.l+=l),c.t=u,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function aM(e){var t=e.t||"",r=ue(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=ue(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return Rr(s)}function _i(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function gd(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):_i(e,a,r)}function $i(e,t,r){if(r.biff>5)return gd(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function n5(e,t,r){return r||(r=ue(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function nM(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function sM(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(ha,"");return a&&(e.l+=24),s}function iM(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(ha,"");return r+o}function oM(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return sM(e);case"0303000000000000c000000000000046":return iM(e);default:throw new Error("Unsupported Moniker "+r)}}function Wd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ha,""):"";return r}function Ij(e,t){t||(t=ue(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function lM(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var i,o,l,c,d="",u,f;s&16&&(i=Wd(e,r-e.l)),s&128&&(o=Wd(e,r-e.l)),(s&257)===257&&(l=Wd(e,r-e.l)),(s&257)===1&&(c=oM(e,r-e.l)),s&8&&(d=Wd(e,r-e.l)),s&32&&(u=e.read_shift(16)),s&64&&(f=Dv(e)),e.l=r;var x=o||l||c||"";x&&d&&(x+="#"+d),x||(x="#"+d),s&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var p={Target:x};return u&&(p.guid=u),f&&(p.time=f),i&&(p.Tooltip=i),p}function cM(e){var t=ue(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),i=s>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)a=a.slice(1),Ij(a,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&Ij(s>-1?a.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,a.length-3*c+1),r=0;r<a.length-3*c;++r)t.write_shift(1,a.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function s5(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function i5(e,t){var r=s5(e);return r[3]=0,r}function Dn(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Si(e,t,r,a){return a||(a=ue(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function dM(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function uM(e,t,r){return t===0?"":$i(e,t,r)}function fM(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),i=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[s,i,o]}function o5(e){var t=e.read_shift(2),r=Ov(e);return[t,r]}function hM(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=pd(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,s}function Xf(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function l5(e,t){return t||(t=ue(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function c5(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var mM=c5;function d5(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function xM(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function pM(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Gr(e){e.l+=2,e.l+=e.read_shift(2)}var gM={0:Gr,4:Gr,5:Gr,6:Gr,7:pM,8:Gr,9:Gr,10:Gr,11:Gr,12:Gr,13:xM,14:Gr,15:Gr,16:Gr,17:Gr,18:Gr,19:Gr,20:Gr,21:d5};function yM(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(gM[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function Hd(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Rv(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ue(s);return i.write_shift(2,a),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function vM(e,t){return t===0||e.read_shift(2),1200}function bM(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=$i(e,0,r);return e.read_shift(t+a-e.l),s}function jM(e,t){var r=!t||t.biff==8,a=ue(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function wM(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function NM(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=pd(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:s,dt:i,name:o}}function _M(e,t){var r=!t||t.biff>=8?2:1,a=ue(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function SM(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),i=[],o=0;o!=s&&e.l<r;++o)i.push(rM(e));return i.Count=a,i.Unique=s,i}function kM(e,t){var r=ue(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=aM(e[s]);var i=Rr([r].concat(a));return i.parts=[r.length].concat(a.map(function(o){return o.length})),i}function EM(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function TM(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function AM(e){var t=dM(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function CM(e){return e.read_shift(2),e.read_shift(4)}function Fj(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,s]}function PM(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:d}}function OM(){var e=ue(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function IM(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function FM(e){var t=ue(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function DM(){}function RM(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=pd(e,0,r),a}function MM(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,i=ue(s);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function LM(e){var t=Dn(e);return t.isst=e.read_shift(4),t}function $M(e,t,r,a){var s=ue(10);return Si(e,t,a,s),s.write_shift(4,r),s}function BM(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=Dn(e);r.biff==2&&e.l++;var i=gd(e,a-e.l,r);return s.val=i,s}function UM(e,t,r,a,s){var i=!s||s.biff==8,o=ue(8+ +i+(1+i)*r.length);return Si(e,t,a,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function qM(e,t,r){var a=e.read_shift(2),s=$i(e,0,r);return[a,s]}function WM(e,t,r,a){var s=r&&r.biff==5;a||(a=ue(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var HM=$i;function Dj(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,i=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:l},e:{r:o,c}}}function zM(e,t){var r=t.biff==8||!t.biff?4:2,a=ue(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function VM(e){var t=e.read_shift(2),r=e.read_shift(2),a=o5(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function GM(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(o5(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:o,rkrec:i}}function KM(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:o,ixfe:i}}function XM(e,t,r,a){var s={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return s.patternType=AR[l>>26],a.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function YM(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=XM(e,t,a.fStyle,r),a}function Rj(e,t,r,a){var s=r&&r.biff==5;a||(a=ue(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function JM(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function QM(e){var t=ue(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Mj(e,t,r){var a=Dn(e);(r.biff==2||t==9)&&++e.l;var s=tM(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function ZM(e,t,r,a,s,i){var o=ue(8);return Si(e,t,a,o),a5(r,i,o),o}function eL(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Dn(e),s=Zr(e);return a.val=s,a}function tL(e,t,r,a){var s=ue(14);return Si(e,t,a,s),Ni(r,s),s}var Lj=uM;function rL(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=_i(e,i),l=[];a>e.l;)l.push(gd(e));return[i,s,o,l]}function $j(e,t,r){var a=e.read_shift(2),s,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=hM(e,t-2,r)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var aL=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Bj(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=_i(e,o,r);s&32&&(d=aL[d.charCodeAt(0)]);var u=a-e.l;r&&r.biff==2&&--u;var f=a==e.l||l===0||!(u>0)?[]:y9(e,u,r,l);return{chKey:i,Name:d,itab:c,rgce:f}}function u5(e,t,r){if(r.biff<8)return nL(e,t,r);for(var a=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(fM(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function nL(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=pd(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function sL(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),i=_i(e,a,r),o=_i(e,s,r);return[i,o]}function iL(e,t,r){var a=c5(e);e.l++;var s=e.read_shift(1);return t-=8,[v9(e,t,r),s,a]}function Uj(e,t,r){var a=mM(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,p9(e,t,r)]}function oL(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function lL(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=$i(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},l,o,i]}}function cL(e,t,r){return lL(e,t,r)}function dL(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Xf(e));return r}function uL(e){var t=ue(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)l5(e[r],t);return t}function fL(e,t,r){if(r&&r.biff<8)return mL(e,t,r);var a=d5(e),s=yM(e,t-22,a[1]);return{cmo:a,ft:s}}var hL={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function mL(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((hL[a]||ta)(e,t,r)),{cmo:[s,a,i],ft:o}}function xL(e,t,r){var a=e.l,s="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=nM(e,6,r);var l=e.read_shift(2);e.read_shift(2),vr(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-a!=e.lens[d])throw new Error("TxO: bad continue record");var u=e[e.l],f=_i(e,e.lens[d+1]-e.lens[d]-1);if(s+=f,s.length>=(u?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function pL(e,t){var r=Xf(e);e.l+=16;var a=lM(e,t-24);return[r,a]}function gL(e){var t=ue(24),r=tr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return Rr([t,cM(e[1])])}function yL(e,t){e.read_shift(2);var r=Xf(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(ha,""),[r,a]}function vL(e){var t=e[1].Tooltip,r=ue(10+2*(t.length+1));r.write_shift(2,2048);var a=tr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function bL(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Sj[r]||r,r=e.read_shift(2),t[1]=Sj[r]||r,t}function jL(e){return e||(e=ue(4)),e.write_shift(2,1),e.write_shift(2,1),e}function wL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(i5(e));return r}function NL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(i5(e));return r}function _L(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function f5(e,t,r){if(!r.cellStyles)return ta(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var d={s,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function SL(e,t){var r=ue(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function kL(e,t){var r={};return t<32||(e.l+=16,r.header=Zr(e),r.footer=Zr(e),e.l+=2),r}function EL(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function TL(e){for(var t=ue(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var AL=Dn,CL=r5,PL=gd;function OL(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function IL(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Dn(e);++e.l;var s=$i(e,t-7,r);return a.t="str",a.val=s,a}function FL(e){var t=Dn(e);++e.l;var r=Zr(e);return t.t="n",t.val=r,t}function DL(e,t,r){var a=ue(15);return jd(a,e,t),a.write_shift(8,r,"f"),a}function RL(e){var t=Dn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function ML(e,t,r){var a=ue(9);return jd(a,e,t),a.write_shift(2,r),a}function LL(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function $L(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function BL(e,t,r){var a=e.l+t,s=Dn(e),i=e.read_shift(2),o=_i(e,i,r);return e.l=a,s.t="str",s.val=o,s}var UL=[2,3,48,49,131,139,140,245],Og=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Vf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],u=Os(1);switch(c.type){case"base64":u=Aa(Ra(l));break;case"binary":u=Aa(l);break;case"buffer":case"array":u=l;break}qr(u,0);var f=u.read_shift(1),x=!!(f&136),p=!1,h=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,x=!0;break;case 49:p=!0,x=!0;break;case 131:break;case 139:break;case 140:h=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,g=521;f==2&&(m=u.read_shift(2)),u.l+=3,f!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(g=u.read_shift(2));var v=u.read_shift(2),b=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=e[u[u.l]]),u.l+=1,u.l+=2),h&&(u.l+=36);for(var y=[],N={},j=Math.min(u.length,f==2?521:g-10-(p?264:0)),w=h?32:11;u.l<j&&u[u.l]!=13;)switch(N={},N.name=gc.utils.decode(b,u.slice(u.l,u.l+w)).replace(/[\u0000\r\n].*$/g,""),u.l+=w,N.type=String.fromCharCode(u.read_shift(1)),f!=2&&!h&&(N.offset=u.read_shift(4)),N.len=u.read_shift(1),f==2&&(N.offset=u.read_shift(2)),N.dec=u.read_shift(1),N.name.length&&y.push(N),f!=2&&(u.l+=h?13:14),N.type){case"B":(!p||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var _=0,S=0;for(d[0]=[],S=0;S!=y.length;++S)d[0][S]=y[S].name;for(;m-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,d[++_]=[],S=0,S=0;S!=y.length;++S){var k=u.slice(u.l,u.l+y[S].len);u.l+=y[S].len,qr(k,0);var E=gc.utils.decode(b,k);switch(y[S].type){case"C":E.trim().length&&(d[_][S]=E.replace(/\s+$/,""));break;case"D":E.length===8?d[_][S]=new Date(+E.slice(0,4),+E.slice(4,6)-1,+E.slice(6,8)):d[_][S]=E;break;case"F":d[_][S]=parseFloat(E.trim());break;case"+":case"I":d[_][S]=h?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(E.trim().toUpperCase()){case"Y":case"T":d[_][S]=!0;break;case"N":case"F":d[_][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+E+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[_][S]="##MEMO##"+(h?parseInt(E.trim(),10):k.read_shift(4));break;case"N":E=E.replace(/\u0000/g,"").trim(),E&&E!="."&&(d[_][S]=+E||0);break;case"@":d[_][S]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":d[_][S]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":d[_][S]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[_][S]=-k.read_shift(-8,"f");break;case"B":if(p&&y[S].len==8){d[_][S]=k.read_shift(8,"f");break}case"G":case"P":k.l+=y[S].len;break;case"0":if(y[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[S].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=y,d}function a(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=dl(r(l,d),d);return u["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,u}function s(l,c){try{return $s(a(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var d=c||{};if(+d.codepage>=0&&fn(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=va(),f=Du(l,{header:1,raw:!0,cellDates:!0}),x=f[0],p=f.slice(1),h=l["!cols"]||[],m=0,g=0,v=0,b=1;for(m=0;m<x.length;++m){if(((h[m]||{}).DBF||{}).name){x[m]=h[m].DBF.name,++v;continue}if(x[m]!=null){if(++v,typeof x[m]=="number"&&(x[m]=x[m].toString(10)),typeof x[m]!="string")throw new Error("DBF Invalid column name "+x[m]+" |"+typeof x[m]+"|");if(x.indexOf(x[m])!==m){for(g=0;g<1024;++g)if(x.indexOf(x[m]+"_"+g)==-1){x[m]+="_"+g;break}}}}var y=gt(l["!ref"]),N=[],j=[],w=[];for(m=0;m<=y.e.c-y.s.c;++m){var _="",S="",k=0,E=[];for(g=0;g<p.length;++g)p[g][m]!=null&&E.push(p[g][m]);if(E.length==0||x[m]==null){N[m]="?";continue}for(g=0;g<E.length;++g){switch(typeof E[g]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=E[g]instanceof Date?"D":"C";break;default:S="C"}k=Math.max(k,String(E[g]).length),_=_&&_!=S?"C":S}k>250&&(k=250),S=((h[m]||{}).DBF||{}).type,S=="C"&&h[m].DBF.len>k&&(k=h[m].DBF.len),_=="B"&&S=="N"&&(_="N",w[m]=h[m].DBF.dec,k=h[m].DBF.len),j[m]=_=="C"||S=="N"?k:i[_]||0,b+=j[m],N[m]=_}var A=u.next(32);for(A.write_shift(4,318902576),A.write_shift(4,p.length),A.write_shift(2,296+32*v),A.write_shift(2,b),m=0;m<4;++m)A.write_shift(4,0);for(A.write_shift(4,0|(+t[tT]||3)<<8),m=0,g=0;m<x.length;++m)if(x[m]!=null){var P=u.next(32),L=(x[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,L,"sbcs"),P.write_shift(1,N[m]=="?"?"C":N[m],"sbcs"),P.write_shift(4,g),P.write_shift(1,j[m]||i[N[m]]||0),P.write_shift(1,w[m]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),g+=j[m]||i[N[m]]||0}var R=u.next(264);for(R.write_shift(4,13),m=0;m<65;++m)R.write_shift(4,0);for(m=0;m<p.length;++m){var I=u.next(b);for(I.write_shift(1,0),g=0;g<x.length;++g)if(x[g]!=null)switch(N[g]){case"L":I.write_shift(1,p[m][g]==null?63:p[m][g]?84:70);break;case"B":I.write_shift(8,p[m][g]||0,"f");break;case"N":var D="0";for(typeof p[m][g]=="number"&&(D=p[m][g].toFixed(w[g]||0)),v=0;v<j[g]-D.length;++v)I.write_shift(1,32);I.write_shift(1,D,"sbcs");break;case"D":p[m][g]?(I.write_shift(4,("0000"+p[m][g].getFullYear()).slice(-4),"sbcs"),I.write_shift(2,("00"+(p[m][g].getMonth()+1)).slice(-2),"sbcs"),I.write_shift(2,("00"+p[m][g].getDate()).slice(-2),"sbcs")):I.write_shift(8,"00000000","sbcs");break;case"C":var V=String(p[m][g]!=null?p[m][g]:"").slice(0,j[g]);for(I.write_shift(1,V,"sbcs"),v=0;v<j[g]-V.length;++v)I.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:a,from_sheet:o}})(),h5=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ur(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,p){var h=e[p];return typeof h=="number"?Q1(h):h},a=function(x,p,h){var m=p.charCodeAt(0)-32<<4|h.charCodeAt(0)-48;return m==59?x:Q1(m)};e["|"]=254;function s(x,p){switch(p.type){case"base64":return i(Ra(x),p);case"binary":return i(x,p);case"buffer":return i(nt&&Buffer.isBuffer(x)?x.toString("binary"):Ls(x),p);case"array":return i(wi(x),p)}throw new Error("Unrecognized type "+p.type)}function i(x,p){var h=x.split(/[\n\r]+/),m=-1,g=-1,v=0,b=0,y=[],N=[],j=null,w={},_=[],S=[],k=[],E=0,A;for(+p.codepage>=0&&fn(+p.codepage);v!==h.length;++v){E=0;var P=h[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),L=P.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),R=L[0],I;if(P.length>0)switch(R){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&N.push(P.slice(3).replace(/;;/g,";"));break;case"C":var D=!1,V=!1,F=!1,U=!1,q=-1,K=-1;for(b=1;b<L.length;++b)switch(L[b].charAt(0)){case"A":break;case"X":g=parseInt(L[b].slice(1))-1,V=!0;break;case"Y":for(m=parseInt(L[b].slice(1))-1,V||(g=0),A=y.length;A<=m;++A)y[A]=[];break;case"K":I=L[b].slice(1),I.charAt(0)==='"'?I=I.slice(1,I.length-1):I==="TRUE"?I=!0:I==="FALSE"?I=!1:isNaN(mn(I))?isNaN(Eo(I).getDate())||(I=Ht(I)):(I=mn(I),j!==null&&ll(j)&&(I=Kf(I))),D=!0;break;case"E":U=!0;var T=mo(L[b].slice(1),{r:m,c:g});y[m][g]=[y[m][g],T];break;case"S":F=!0,y[m][g]=[y[m][g],"S5S"];break;case"G":break;case"R":q=parseInt(L[b].slice(1))-1;break;case"C":K=parseInt(L[b].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}if(D&&(y[m][g]&&y[m][g].length==2?y[m][g][0]=I:y[m][g]=I,j=null),F){if(U)throw new Error("SYLK shared formula cannot have own formula");var O=q>-1&&y[q][K];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");y[m][g][1]=P5(O[1],{r:m-q,c:g-K})}break;case"F":var W=0;for(b=1;b<L.length;++b)switch(L[b].charAt(0)){case"X":g=parseInt(L[b].slice(1))-1,++W;break;case"Y":for(m=parseInt(L[b].slice(1))-1,A=y.length;A<=m;++A)y[A]=[];break;case"M":E=parseInt(L[b].slice(1))/20;break;case"F":break;case"G":break;case"P":j=N[parseInt(L[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=L[b].slice(1).split(" "),A=parseInt(k[0],10);A<=parseInt(k[1],10);++A)E=parseInt(k[2],10),S[A-1]=E===0?{hidden:!0}:{wch:E},Is(S[A-1]);break;case"C":g=parseInt(L[b].slice(1))-1,S[g]||(S[g]={});break;case"R":m=parseInt(L[b].slice(1))-1,_[m]||(_[m]={}),E>0?(_[m].hpt=E,_[m].hpx=Ao(E)):E===0&&(_[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}W<1&&(j=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}}return _.length>0&&(w["!rows"]=_),S.length>0&&(w["!cols"]=S),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,w]}function o(x,p){var h=s(x,p),m=h[0],g=h[1],v=dl(m,p);return ur(g).forEach(function(b){v[b]=g[b]}),v}function l(x,p){return $s(o(x,p),p)}function c(x,p,h,m){var g="C;Y"+(h+1)+";X"+(m+1)+";K";switch(x.t){case"n":g+=x.v||0,x.f&&!x.F&&(g+=";E"+qv(x.f,{r:h,c:m}));break;case"b":g+=x.v?"TRUE":"FALSE";break;case"e":g+=x.w||x.v;break;case"d":g+='"'+(x.w||x.v)+'"';break;case"s":g+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function d(x,p){p.forEach(function(h,m){var g="F;W"+(m+1)+" "+(m+1)+" ";h.hidden?g+="0":(typeof h.width=="number"&&!h.wpx&&(h.wpx=Sc(h.width)),typeof h.wpx=="number"&&!h.wch&&(h.wch=kc(h.wpx)),typeof h.wch=="number"&&(g+=Math.round(h.wch))),g.charAt(g.length-1)!=" "&&x.push(g)})}function u(x,p){p.forEach(function(h,m){var g="F;";h.hidden?g+="M0;":h.hpt?g+="M"+20*h.hpt+";":h.hpx&&(g+="M"+20*Ec(h.hpx)+";"),g.length>2&&x.push(g+"R"+(m+1))})}function f(x,p){var h=["ID;PWXL;N;E"],m=[],g=gt(x["!ref"]),v,b=Array.isArray(x),y=`\r
`;h.push("P;PGeneral"),h.push("F;P0;DG0G8;M255"),x["!cols"]&&d(h,x["!cols"]),x["!rows"]&&u(h,x["!rows"]),h.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var N=g.s.r;N<=g.e.r;++N)for(var j=g.s.c;j<=g.e.c;++j){var w=Ue({r:N,c:j});v=b?(x[N]||[])[j]:x[w],!(!v||v.v==null&&(!v.f||v.F))&&m.push(c(v,x,N,j))}return h.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:l,to_sheet:o,from_sheet:f}})(),m5=(function(){function e(i,o){switch(o.type){case"base64":return t(Ra(i),o);case"binary":return t(i,o);case"buffer":return t(nt&&Buffer.isBuffer(i)?i.toString("binary"):Ls(i),o);case"array":return t(wi(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),c=-1,d=-1,u=0,f=[];u!==l.length;++u){if(l[u].trim()==="BOT"){f[++c]=[],d=0;continue}if(!(c<0)){var x=l[u].trim().split(","),p=x[0],h=x[1];++u;for(var m=l[u]||"";(m.match(/["]/g)||[]).length&1&&u<l.length-1;)m+=`
`+l[++u];switch(m=m.trim(),+p){case-1:if(m==="BOT"){f[++c]=[],d=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[c][d]=!0:m==="FALSE"?f[c][d]=!1:isNaN(mn(h))?isNaN(Eo(h).getDate())?f[c][d]=h:f[c][d]=Ht(h):f[c][d]=mn(h),++d;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[c][d++]=m!==""?m:null;break}if(m==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(i,o){return dl(e(i,o),o)}function a(i,o){return $s(r(i,o),o)}var s=(function(){var i=function(c,d,u,f,x){c.push(d),c.push(u+","+f),c.push('"'+x.replace(/"/g,'""')+'"')},o=function(c,d,u,f){c.push(d+","+u),c.push(d==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var d=[],u=gt(c["!ref"]),f,x=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,u.e.r-u.s.r+1,""),i(d,"TUPLES",0,u.e.c-u.s.c+1,""),i(d,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){o(d,-1,0,"BOT");for(var h=u.s.c;h<=u.e.c;++h){var m=Ue({r:p,c:h});if(f=x?(c[p]||[])[h]:c[m],!f){o(d,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?o(d,1,0,"="+f.f):o(d,1,0,""):o(d,0,g,"V");break;case"b":o(d,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=en(f.z||Be[14],Pr(Ht(f.v)))),o(d,0,f.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var v=`\r
`,b=d.join(v);return b}})();return{to_workbook:a,to_sheet:r,from_sheet:s}})(),x5=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,x){for(var p=f.split(`
`),h=-1,m=-1,g=0,v=[];g!==p.length;++g){var b=p[g].trim().split(":");if(b[0]==="cell"){var y=tr(b[1]);if(v.length<=y.r)for(h=v.length;h<=y.r;++h)v[h]||(v[h]=[]);switch(h=y.r,m=y.c,b[2]){case"t":v[h][m]=e(b[3]);break;case"v":v[h][m]=+b[3];break;case"vtf":var N=b[b.length-1];case"vtc":switch(b[3]){case"nl":v[h][m]=!!+b[4];break;default:v[h][m]=+b[4];break}b[2]=="vtf"&&(v[h][m]=[v[h][m],N])}}}return x&&x.sheetRows&&(v=v.slice(0,x.sheetRows)),v}function a(f,x){return dl(r(f,x),x)}function s(f,x){return $s(a(f,x),x)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var x=[],p=[],h,m="",g=wa(f["!ref"]),v=Array.isArray(f),b=g.s.r;b<=g.e.r;++b)for(var y=g.s.c;y<=g.e.c;++y)if(m=Ue({r:b,c:y}),h=v?(f[b]||[])[y]:f[m],!(!h||h.v==null||h.t==="z")){switch(p=["cell",m,"t"],h.t){case"s":case"str":p.push(t(h.v));break;case"n":h.f?(p[2]="vtf",p[3]="n",p[4]=h.v,p[5]=t(h.f)):(p[2]="v",p[3]=h.v);break;case"b":p[2]="vt"+(h.f?"f":"c"),p[3]="nl",p[4]=h.v?"1":"0",p[5]=t(h.f||(h.v?"TRUE":"FALSE"));break;case"d":var N=Pr(Ht(h.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=h.w||en(h.z||Be[14],N);break;case"e":continue}x.push(p.join(":"))}return x.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function u(f){return[i,o,l,o,d(f),c].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:u}})(),To=(function(){function e(u,f,x,p,h){h.raw?f[x][p]=u:u===""||(u==="TRUE"?f[x][p]=!0:u==="FALSE"?f[x][p]=!1:isNaN(mn(u))?isNaN(Eo(u).getDate())?f[x][p]=u:f[x][p]=Ht(u):f[x][p]=mn(u))}function t(u,f){var x=f||{},p=[];if(!u||u.length===0)return p;for(var h=u.split(/[\r\n]/),m=h.length-1;m>=0&&h[m].length===0;)--m;for(var g=10,v=0,b=0;b<=m;++b)v=h[b].indexOf(" "),v==-1?v=h[b].length:v++,g=Math.max(g,v);for(b=0;b<=m;++b){p[b]=[];var y=0;for(e(h[b].slice(0,g).trim(),p,b,y,x),y=1;y<=(h[b].length-g)/10+1;++y)e(h[b].slice(g+(y-1)*10,g+y*10).trim(),p,b,y,x)}return x.sheetRows&&(p=p.slice(0,x.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(u){for(var f={},x=!1,p=0,h=0;p<u.length;++p)(h=u.charCodeAt(p))==34?x=!x:!x&&h in r&&(f[h]=(f[h]||0)+1);h=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&h.push([f[p],p]);if(!h.length){f=a;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&h.push([f[p],p])}return h.sort(function(m,g){return m[0]-g[0]||a[m[1]]-a[g[1]]}),r[h.pop()[1]]||44}function i(u,f){var x=f||{},p="",h=x.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=s(u.slice(0,1024)):x&&x.FS?p=x.FS:p=s(u.slice(0,1024));var g=0,v=0,b=0,y=0,N=0,j=p.charCodeAt(0),w=!1,_=0,S=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var k=x.dateNF!=null?ED(x.dateNF):null;function E(){var A=u.slice(y,N),P={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)P.t="z";else if(x.raw)P.t="s",P.v=A;else if(A.trim().length===0)P.t="s",P.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(P.t="s",P.v=A.slice(2,-1).replace(/""/g,'"')):rB(A)?(P.t="n",P.f=A.slice(1)):(P.t="s",P.v=A);else if(A=="TRUE")P.t="b",P.v=!0;else if(A=="FALSE")P.t="b",P.v=!1;else if(!isNaN(b=mn(A)))P.t="n",x.cellText!==!1&&(P.w=A),P.v=b;else if(!isNaN(Eo(A).getDate())||k&&A.match(k)){P.z=x.dateNF||Be[14];var L=0;k&&A.match(k)&&(A=TD(A,x.dateNF,A.match(k)||[]),L=1),x.cellDates?(P.t="d",P.v=Ht(A,L)):(P.t="n",P.v=Pr(Ht(A,L))),x.cellText!==!1&&(P.w=en(P.z,P.v instanceof Date?Pr(P.v):P.v)),x.cellNF||delete P.z}else P.t="s",P.v=A;if(P.t=="z"||(x.dense?(h[g]||(h[g]=[]),h[g][v]=P):h[Ue({c:v,r:g})]=P),y=N+1,S=u.charCodeAt(y),m.e.c<v&&(m.e.c=v),m.e.r<g&&(m.e.r=g),_==j)++v;else if(v=0,++g,x.sheetRows&&x.sheetRows<=g)return!0}e:for(;N<u.length;++N)switch(_=u.charCodeAt(N)){case 34:S===34&&(w=!w);break;case j:case 10:case 13:if(!w&&E())break e;break}return N-y>0&&E(),h["!ref"]=Ze(m),h}function o(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):dl(t(u,f),f)}function l(u,f){var x="",p=f.type=="string"?[0,0,0,0]:Yv(u,f);switch(f.type){case"base64":x=Ra(u);break;case"binary":x=u;break;case"buffer":f.codepage==65001?x=u.toString("utf8"):f.codepage&&typeof gc<"u"||(x=nt&&Buffer.isBuffer(u)?u.toString("binary"):Ls(u));break;case"array":x=wi(u);break;case"string":x=u;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?x=It(x.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?x=It(x):f.type=="binary"&&typeof gc<"u",x.slice(0,19)=="socialcalc:version:"?x5.to_sheet(f.type=="string"?x:It(x),f):o(x,f)}function c(u,f){return $s(l(u,f),f)}function d(u){for(var f=[],x=gt(u["!ref"]),p,h=Array.isArray(u),m=x.s.r;m<=x.e.r;++m){for(var g=[],v=x.s.c;v<=x.e.c;++v){var b=Ue({r:m,c:v});if(p=h?(u[m]||[])[v]:u[b],!p||p.v==null){g.push("          ");continue}for(var y=(p.w||(as(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(v===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}})();function qL(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=h5.to_workbook(e,r);return r.WTF=a,s}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return To.to_workbook(e,t)}}var mi=(function(){function e(T,O,W){if(T){qr(T,T.l||0);for(var z=W.Enum||q;T.l<T.length;){var te=T.read_shift(2),ae=z[te]||z[65535],se=T.read_shift(2),M=T.l+se,G=ae.f&&ae.f(T,se,W);if(T.l=M,O(G,ae,te))return}}}function t(T,O){switch(O.type){case"base64":return r(Aa(Ra(T)),O);case"binary":return r(Aa(T),O);case"buffer":case"array":return r(T,O)}throw"Unsupported type "+O.type}function r(T,O){if(!T)return T;var W=O||{},z=W.dense?[]:{},te="Sheet1",ae="",se=0,M={},G=[],ne=[],B={s:{r:0,c:0},e:{r:0,c:0}},pe=W.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)W.Enum=q,e(T,function(xe,We,Nt){switch(Nt){case 0:W.vers=xe,xe>=4096&&(W.qpro=!0);break;case 6:B=xe;break;case 204:xe&&(ae=xe);break;case 222:ae=xe;break;case 15:case 51:W.qpro||(xe[1].v=xe[1].v.slice(1));case 13:case 14:case 16:Nt==14&&(xe[2]&112)==112&&(xe[2]&15)>1&&(xe[2]&15)<15&&(xe[1].z=W.dateNF||Be[14],W.cellDates&&(xe[1].t="d",xe[1].v=Kf(xe[1].v))),W.qpro&&xe[3]>se&&(z["!ref"]=Ze(B),M[te]=z,G.push(te),z=W.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},se=xe[3],te=ae||"Sheet"+(se+1),ae="");var _e=W.dense?(z[xe[0].r]||[])[xe[0].c]:z[Ue(xe[0])];if(_e){_e.t=xe[1].t,_e.v=xe[1].v,xe[1].z!=null&&(_e.z=xe[1].z),xe[1].f!=null&&(_e.f=xe[1].f);break}W.dense?(z[xe[0].r]||(z[xe[0].r]=[]),z[xe[0].r][xe[0].c]=xe[1]):z[Ue(xe[0])]=xe[1];break}},W);else if(T[2]==26||T[2]==14)W.Enum=K,T[2]==14&&(W.qpro=!0,T.l=0),e(T,function(xe,We,Nt){switch(Nt){case 204:te=xe;break;case 22:xe[1].v=xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(xe[3]>se&&(z["!ref"]=Ze(B),M[te]=z,G.push(te),z=W.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},se=xe[3],te="Sheet"+(se+1)),pe>0&&xe[0].r>=pe)break;W.dense?(z[xe[0].r]||(z[xe[0].r]=[]),z[xe[0].r][xe[0].c]=xe[1]):z[Ue(xe[0])]=xe[1],B.e.c<xe[0].c&&(B.e.c=xe[0].c),B.e.r<xe[0].r&&(B.e.r=xe[0].r);break;case 27:xe[14e3]&&(ne[xe[14e3][0]]=xe[14e3][1]);break;case 1537:ne[xe[0]]=xe[1],xe[0]==se&&(te=xe[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(z["!ref"]=Ze(B),M[ae||te]=z,G.push(ae||te),!ne.length)return{SheetNames:G,Sheets:M};for(var ye={},Te=[],de=0;de<ne.length;++de)M[G[de]]?(Te.push(ne[de]||G[de]),ye[ne[de]]=M[ne[de]]||M[G[de]]):(Te.push(ne[de]),ye[ne[de]]={"!ref":"A1"});return{SheetNames:Te,Sheets:ye}}function a(T,O){var W=O||{};if(+W.codepage>=0&&fn(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var z=va(),te=gt(T["!ref"]),ae=Array.isArray(T),se=[];Se(z,0,i(1030)),Se(z,6,c(te));for(var M=Math.min(te.e.r,8191),G=te.s.r;G<=M;++G)for(var ne=xr(G),B=te.s.c;B<=te.e.c;++B){G===te.s.r&&(se[B]=er(B));var pe=se[B]+ne,ye=ae?(T[G]||[])[B]:T[pe];if(!(!ye||ye.t=="z"))if(ye.t=="n")(ye.v|0)==ye.v&&ye.v>=-32768&&ye.v<=32767?Se(z,13,p(G,B,ye.v)):Se(z,14,m(G,B,ye.v));else{var Te=as(ye);Se(z,15,f(G,B,Te.slice(0,239)))}}return Se(z,1),z.end()}function s(T,O){var W=O||{};if(+W.codepage>=0&&fn(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var z=va();Se(z,0,o(T));for(var te=0,ae=0;te<T.SheetNames.length;++te)(T.Sheets[T.SheetNames[te]]||{})["!ref"]&&Se(z,27,U(T.SheetNames[te],ae++));var se=0;for(te=0;te<T.SheetNames.length;++te){var M=T.Sheets[T.SheetNames[te]];if(!(!M||!M["!ref"])){for(var G=gt(M["!ref"]),ne=Array.isArray(M),B=[],pe=Math.min(G.e.r,8191),ye=G.s.r;ye<=pe;++ye)for(var Te=xr(ye),de=G.s.c;de<=G.e.c;++de){ye===G.s.r&&(B[de]=er(de));var xe=B[de]+Te,We=ne?(M[ye]||[])[de]:M[xe];if(!(!We||We.t=="z"))if(We.t=="n")Se(z,23,E(ye,de,se,We.v));else{var Nt=as(We);Se(z,22,_(ye,de,se,Nt.slice(0,239)))}}++se}}return Se(z,1),z.end()}function i(T){var O=ue(2);return O.write_shift(2,T),O}function o(T){var O=ue(26);O.write_shift(2,4096),O.write_shift(2,4),O.write_shift(4,0);for(var W=0,z=0,te=0,ae=0;ae<T.SheetNames.length;++ae){var se=T.SheetNames[ae],M=T.Sheets[se];if(!(!M||!M["!ref"])){++te;var G=wa(M["!ref"]);W<G.e.r&&(W=G.e.r),z<G.e.c&&(z=G.e.c)}}return W>8191&&(W=8191),O.write_shift(2,W),O.write_shift(1,te),O.write_shift(1,z),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(1,1),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(4,0),O}function l(T,O,W){var z={s:{c:0,r:0},e:{c:0,r:0}};return O==8&&W.qpro?(z.s.c=T.read_shift(1),T.l++,z.s.r=T.read_shift(2),z.e.c=T.read_shift(1),T.l++,z.e.r=T.read_shift(2),z):(z.s.c=T.read_shift(2),z.s.r=T.read_shift(2),O==12&&W.qpro&&(T.l+=2),z.e.c=T.read_shift(2),z.e.r=T.read_shift(2),O==12&&W.qpro&&(T.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function c(T){var O=ue(8);return O.write_shift(2,T.s.c),O.write_shift(2,T.s.r),O.write_shift(2,T.e.c),O.write_shift(2,T.e.r),O}function d(T,O,W){var z=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(z[0].c=T.read_shift(1),z[3]=T.read_shift(1),z[0].r=T.read_shift(2),T.l+=2):(z[2]=T.read_shift(1),z[0].c=T.read_shift(2),z[0].r=T.read_shift(2)),z}function u(T,O,W){var z=T.l+O,te=d(T,O,W);if(te[1].t="s",W.vers==20768){T.l++;var ae=T.read_shift(1);return te[1].v=T.read_shift(ae,"utf8"),te}return W.qpro&&T.l++,te[1].v=T.read_shift(z-T.l,"cstr"),te}function f(T,O,W){var z=ue(7+W.length);z.write_shift(1,255),z.write_shift(2,O),z.write_shift(2,T),z.write_shift(1,39);for(var te=0;te<z.length;++te){var ae=W.charCodeAt(te);z.write_shift(1,ae>=128?95:ae)}return z.write_shift(1,0),z}function x(T,O,W){var z=d(T,O,W);return z[1].v=T.read_shift(2,"i"),z}function p(T,O,W){var z=ue(7);return z.write_shift(1,255),z.write_shift(2,O),z.write_shift(2,T),z.write_shift(2,W,"i"),z}function h(T,O,W){var z=d(T,O,W);return z[1].v=T.read_shift(8,"f"),z}function m(T,O,W){var z=ue(13);return z.write_shift(1,255),z.write_shift(2,O),z.write_shift(2,T),z.write_shift(8,W,"f"),z}function g(T,O,W){var z=T.l+O,te=d(T,O,W);if(te[1].v=T.read_shift(8,"f"),W.qpro)T.l=z;else{var ae=T.read_shift(2);N(T.slice(T.l,T.l+ae),te),T.l+=ae}return te}function v(T,O,W){var z=O&32768;return O&=-32769,O=(z?T:0)+(O>=8192?O-16384:O),(z?"":"$")+(W?er(O):xr(O))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(T,O){qr(T,0);for(var W=[],z=0,te="",ae="",se="",M="";T.l<T.length;){var G=T[T.l++];switch(G){case 0:W.push(T.read_shift(8,"f"));break;case 1:ae=v(O[0].c,T.read_shift(2),!0),te=v(O[0].r,T.read_shift(2),!1),W.push(ae+te);break;case 2:{var ne=v(O[0].c,T.read_shift(2),!0),B=v(O[0].r,T.read_shift(2),!1);ae=v(O[0].c,T.read_shift(2),!0),te=v(O[0].r,T.read_shift(2),!1),W.push(ne+B+":"+ae+te)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(T.read_shift(2));break;case 6:{for(var pe="";G=T[T.l++];)pe+=String.fromCharCode(G);W.push('"'+pe.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:M=W.pop(),se=W.pop(),W.push(["AND","OR"][G-20]+"("+se+","+M+")");break;default:if(G<32&&y[G])M=W.pop(),se=W.pop(),W.push(se+y[G]+M);else if(b[G]){if(z=b[G][1],z==69&&(z=T[T.l++]),z>W.length){console.error("WK1 bad formula parse 0x"+G.toString(16)+":|"+W.join("|")+"|");return}var ye=W.slice(-z);W.length-=z,W.push(b[G][0]+"("+ye.join(",")+")")}else return G<=7?console.error("WK1 invalid opcode "+G.toString(16)):G<=24?console.error("WK1 unsupported op "+G.toString(16)):G<=30?console.error("WK1 invalid opcode "+G.toString(16)):G<=115?console.error("WK1 unsupported function opcode "+G.toString(16)):console.error("WK1 unrecognized opcode "+G.toString(16))}}W.length==1?O[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function j(T){var O=[{c:0,r:0},{t:"n",v:0},0];return O[0].r=T.read_shift(2),O[3]=T[T.l++],O[0].c=T[T.l++],O}function w(T,O){var W=j(T);return W[1].t="s",W[1].v=T.read_shift(O-4,"cstr"),W}function _(T,O,W,z){var te=ue(6+z.length);te.write_shift(2,T),te.write_shift(1,W),te.write_shift(1,O),te.write_shift(1,39);for(var ae=0;ae<z.length;++ae){var se=z.charCodeAt(ae);te.write_shift(1,se>=128?95:se)}return te.write_shift(1,0),te}function S(T,O){var W=j(T);W[1].v=T.read_shift(2);var z=W[1].v>>1;if(W[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return W[1].v=z,W}function k(T,O){var W=j(T),z=T.read_shift(4),te=T.read_shift(4),ae=T.read_shift(2);if(ae==65535)return z===0&&te===3221225472?(W[1].t="e",W[1].v=15):z===0&&te===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var se=ae&32768;return ae=(ae&32767)-16446,W[1].v=(1-se*2)*(te*Math.pow(2,ae+32)+z*Math.pow(2,ae)),W}function E(T,O,W,z){var te=ue(14);if(te.write_shift(2,T),te.write_shift(1,W),te.write_shift(1,O),z==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var ae=0,se=0,M=0,G=0;return z<0&&(ae=1,z=-z),se=Math.log2(z)|0,z/=Math.pow(2,se-31),G=z>>>0,(G&2147483648)==0&&(z/=2,++se,G=z>>>0),z-=G,G|=2147483648,G>>>=0,z*=Math.pow(2,32),M=z>>>0,te.write_shift(4,M),te.write_shift(4,G),se+=16383+(ae?32768:0),te.write_shift(2,se),te}function A(T,O){var W=k(T);return T.l+=O-14,W}function P(T,O){var W=j(T),z=T.read_shift(4);return W[1].v=z>>6,W}function L(T,O){var W=j(T),z=T.read_shift(8,"f");return W[1].v=z,W}function R(T,O){var W=L(T);return T.l+=O-10,W}function I(T,O){return T[T.l+O-1]==0?T.read_shift(O,"cstr"):""}function D(T,O){var W=T[T.l++];W>O-1&&(W=O-1);for(var z="";z.length<W;)z+=String.fromCharCode(T[T.l++]);return z}function V(T,O,W){if(!(!W.qpro||O<21)){var z=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var te=T.read_shift(O-21,"cstr");return[z,te]}}function F(T,O){for(var W={},z=T.l+O;T.l<z;){var te=T.read_shift(2);if(te==14e3){for(W[te]=[0,""],W[te][0]=T.read_shift(2);T[T.l];)W[te][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return W}function U(T,O){var W=ue(5+T.length);W.write_shift(2,14e3),W.write_shift(2,O);for(var z=0;z<T.length;++z){var te=T.charCodeAt(z);W[W.l++]=te>127?95:te}return W[W.l++]=0,W}var q={0:{n:"BOF",f:vr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:h},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:I},222:{n:"SHEETNAMELP",f:D},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:w},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:F},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:R},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:I},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:V},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}})();function WL(e){var t={},r=e.match(ra),a=0,s=!1;if(r)for(;a!=r.length;++a){var i=ze(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=hv[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var HL=(function(){var e=bc("t"),t=bc("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:mt(o[1])},c=i.match(t);return c&&(l.s=WL(c[1])),l}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(s).map(r).filter(function(l){return l.v})}})(),zL=(function(){var t=/(\r\n|\n)/g;function r(s,i,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function a(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}})(),VL=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,GL=/<(?:\w+:)?r>/,KL=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Mv(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=mt(It(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=It(e),r&&(a.h=Nv(a.t))):e.match(GL)&&(a.r=It(e),a.t=mt(It((e.replace(KL,"").match(VL)||[]).join("").replace(ra,""))),r&&(a.h=zL(HL(a.r)))),a):{t:""}}var XL=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,YL=/<(?:\w+:)?(?:si|sstItem)>/g,JL=/<\/(?:\w+:)?(?:si|sstItem)>/;function QL(e,t){var r=[],a="";if(!e)return r;var s=e.match(XL);if(s){a=s[2].replace(YL,"").split(JL);for(var i=0;i!=a.length;++i){var o=Mv(a[i].trim(),t);o!=null&&(r[r.length]=o)}s=ze(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var ZL=/^\s|\s$|[\t\n\r]/;function p5(e,t){if(!t.bookSST)return"";var r=[pr];r[r.length]=Ne("sst",null,{xmlns:Fi[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(ZL)&&(i+=' xml:space="preserve"'),i+=">"+At(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function e$(e){return[e.read_shift(4),e.read_shift(4)]}function t$(e,t){var r=[],a=!1;return cs(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function r$(e,t){return t||(t=ue(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var a$=hR;function n$(e){var t=va();ge(t,159,r$(e));for(var r=0;r<e.length;++r)ge(t,19,a$(e[r]));return ge(t,160),t.end()}function g5(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Zn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function s$(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Zn(e,4),t.U=Zn(e,4),t.W=Zn(e,4),t}function i$(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function o$(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(i$(e));return t}function l$(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function c$(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Zn(e,4),t.U=Zn(e,4),t.W=Zn(e,4),t}function d$(e){var t=c$(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function y5(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function v5(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function u$(e){var t=Zn(e);switch(t.Minor){case 2:return[t.Minor,f$(e)];case 3:return[t.Minor,h$()];case 4:return[t.Minor,m$(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function f$(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=y5(e,r),s=v5(e,e.length-e.l);return{t:"Std",h:a,v:s}}function h$(){throw new Error("File is password-protected: ECMA-376 Extensible")}function m$(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(ra,function(i){var o=ze(i);switch(Fn(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){a[l]=o[l]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function x$(e,t){var r={},a=r.EncryptionVersionInfo=Zn(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=y5(e,s),t-=s,r.EncryptionVerifier=v5(e,t),r}function p$(e){var t={},r=t.EncryptionVersionInfo=Zn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Lv(e){var t=0,r,a=g5(e),s=a.length+1,i,o,l,c,d;for(r=Os(s),r[0]=a.length,i=1;i!=s;++i)r[i]=a[i-1];for(i=s-1;i>=0;--i)o=r[i],l=(t&16384)===0?0:1,c=t<<1&32767,d=l|c,t=d^o;return t^52811}var b5=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},s=function(o,l){return a(o^l)},i=function(o){for(var l=t[o.length-1],c=104,d=o.length-1;d>=0;--d)for(var u=o[d],f=0;f!=7;++f)u&64&&(l^=r[c]),u*=2,--c;return l};return function(o){for(var l=g5(o),c=i(l),d=l.length,u=Os(16),f=0;f!=16;++f)u[f]=0;var x,p,h;for((d&1)===1&&(x=c>>8,u[d]=s(e[0],x),--d,x=c&255,p=l[l.length-1],u[d]=s(p,x));d>0;)--d,x=c>>8,u[d]=s(l[d],x),--d,x=c&255,u[d]=s(l[d],x);for(d=15,h=15-l.length;h>0;)x=c>>8,u[d]=s(e[h],x),--d,--h,x=c&255,u[d]=s(l[d],x),--d,--h;return u}})(),g$=function(e,t,r,a,s){s||(s=t),a||(a=b5(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=a[r],o=(o>>5|o<<3)&255,s[i]=o,++r;return[s,r,a]},y$=function(e){var t=0,r=b5(e);return function(a){var s=g$("",a,t,r);return t=s[1],s[0]}};function v$(e,t,r,a){var s={key:vr(e),verificationBytes:vr(e)};return r.password&&(s.verifier=Lv(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=y$(r.password)),s}function b$(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=p$(e):a.Data=x$(e,t),a}function j$(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?b$(e,t-2,a):v$(e,r.biff>=8?t:t-2,r,a),a}var j5=(function(){function e(s,i){switch(i.type){case"base64":return t(Ra(s),i);case"binary":return t(s,i);case"buffer":return t(nt&&Buffer.isBuffer(s)?s.toString("binary"):Ls(s),i);case"array":return t(wi(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var o=i||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(l)&&(l[f]=[]);for(var x=/\\\w+\b/g,p=0,h,m=-1;h=x.exec(u);){switch(h[0]){case"\\cell":var g=u.slice(p,x.lastIndex-h[0].length);if(g[0]==" "&&(g=g.slice(1)),++m,g.length){var v={v:g,t:"s"};Array.isArray(l)?l[f][m]=v:l[Ue({r:f,c:m})]=v}break}p=x.lastIndex}m>d.e.c&&(d.e.c=m)}),l["!ref"]=Ze(d),l}function r(s,i){return $s(e(s,i),i)}function a(s){for(var i=["{\\rtf1\\ansi"],o=gt(s["!ref"]),l,c=Array.isArray(s),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var f=Ue({r:d,c:u});l=c?(s[d]||[])[u]:s[f],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(as(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function w$(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function _c(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function N$(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),i=Math.min(t,r,a),o=s-i;if(o===0)return[0,0,t];var l=0,c=0,d=s+i;switch(c=o/(d>1?2-d:d),s){case t:l=((r-a)/o+6)%6;break;case r:l=(a-t)/o+2;break;case a:l=(t-r)/o+4;break}return[l/6,c,d/2]}function _$(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),i=a-s/2,o=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function Iu(e,t){if(t===0)return e;var r=N$(w$(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),_c(_$(r))}var w5=6,S$=15,k$=1,Jr=w5;function Sc(e){return Math.floor((e+Math.round(128/Jr)/256)*Jr)}function kc(e){return Math.floor((e-5)/Jr*100+.5)/100}function Fu(e){return Math.round((e*Jr+5)/Jr*256)/256}function Z0(e){return Fu(kc(Sc(e)))}function $v(e){var t=Math.abs(e-Z0(e)),r=Jr;if(t>.005)for(Jr=k$;Jr<S$;++Jr)Math.abs(e-Z0(e))<=t&&(t=Math.abs(e-Z0(e)),r=Jr);Jr=r}function Is(e){e.width?(e.wpx=Sc(e.width),e.wch=kc(e.wpx),e.MDW=Jr):e.wpx?(e.wch=kc(e.wpx),e.width=Fu(e.wch),e.MDW=Jr):typeof e.wch=="number"&&(e.width=Fu(e.wch),e.wpx=Sc(e.width),e.MDW=Jr),e.customWidth&&delete e.customWidth}var E$=96,N5=E$;function Ec(e){return e*96/N5}function Ao(e){return e*N5/96}var T$={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function A$(e,t,r,a){t.Borders=[];var s={},i=!1;(e[0].match(ra)||[]).forEach(function(o){var l=ze(o);switch(Fn(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=Wt(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=Wt(l.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function C$(e,t,r,a){t.Fills=[];var s={},i=!1;(e[0].match(ra)||[]).forEach(function(o){var l=ze(o);switch(Fn(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function P$(e,t,r,a){t.Fonts=[];var s={},i=!1;(e[0].match(ra)||[]).forEach(function(o){var l=ze(o);switch(Fn(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=It(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?Wt(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?Wt(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?Wt(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?Wt(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?Wt(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?Wt(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?Wt(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=hv[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=Wt(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=fi[s.color.index];s.color.index==81&&(c=fi[1]),c||(c=fi[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Iu(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function O$(e,t,r){t.NumberFmt=[];for(var a=ur(Be),s=0;s<a.length;++s)t.NumberFmt[a[s]]=Be[a[s]];var i=e[0].match(ra);if(i)for(s=0;s<i.length;++s){var o=ze(i[s]);switch(Fn(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=mt(It(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}Qn(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function I$(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Ne("numFmt",null,{numFmtId:a,formatCode:At(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ne("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var zd=["numFmtId","fillId","fontId","borderId","xfId"],Vd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function F$(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(ra)||[]).forEach(function(i){var o=ze(i),l=0;switch(Fn(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],l=0;l<zd.length;++l)a[zd[l]]&&(a[zd[l]]=parseInt(a[zd[l]],10));for(l=0;l<Vd.length;++l)a[Vd[l]]&&(a[Vd[l]]=Wt(a[Vd[l]]));if(t.NumberFmt&&a.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[l]){a.numFmtId=l;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Wt(o.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function D$(e){var t=[];return t[t.length]=Ne("cellXfs",null),e.forEach(function(r){t[t.length]=Ne("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ne("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var R$=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&O$(f,u,d),(f=l.match(s))&&P$(f,u,c,d),(f=l.match(a))&&C$(f,u,c,d),(f=l.match(i))&&A$(f,u,c,d),(f=l.match(r))&&F$(f,u,d),u}})();function _5(e,t){var r=[pr,Ne("styleSheet",null,{xmlns:Fi[0],"xmlns:vt":Er.vt})],a;return e.SSF&&(a=I$(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=D$(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function M$(e,t){var r=e.read_shift(2),a=ea(e);return[r,a]}function L$(e,t,r){r||(r=ue(6+4*t.length)),r.write_shift(2,e),Lr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function $$(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=bR(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var l=e.read_shift(1);l>0&&(a.family=l);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=vR(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=ea(e),a}function B$(e,t){t||(t=ue(153)),t.write_shift(2,e.sz*20),jR(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Cu(e.color,t);var a=0;return a=2,t.write_shift(1,a),Lr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var U$=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],eh,q$=ta;function qj(e,t){t||(t=ue(84)),eh||(eh=Vf(U$));var r=eh[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(Cu({auto:1},t),Cu({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function W$(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function S5(e,t,r){r||(r=ue(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Cl(e,t){return t||(t=ue(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var H$=ta;function z$(e,t){return t||(t=ue(51)),t.write_shift(1,0),Cl(null,t),Cl(null,t),Cl(null,t),Cl(null,t),Cl(null,t),t.length>t.l?t.slice(0,t.l):t}function V$(e,t){return t||(t=ue(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Au(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function G$(e,t,r){var a=ue(2052);return a.write_shift(4,e),Au(t,a),Au(r,a),a.length>a.l?a.slice(0,a.l):a}function K$(e,t,r){var a={};a.NumberFmt=[];for(var s in Be)a.NumberFmt[s]=Be[s];a.CellXf=[],a.Fonts=[];var i=[],o=!1;return cs(e,function(c,d,u){switch(u){case 44:a.NumberFmt[c[0]]=c[1],Qn(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Iu(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(u),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(u);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function X$(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(ge(e,615,xn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&ge(e,44,L$(s,t[s]))}),ge(e,616))}}function Y$(e){var t=1;ge(e,611,xn(t)),ge(e,43,B$({sz:12,color:{theme:1},name:"Calibri",family:2})),ge(e,612)}function J$(e){var t=2;ge(e,603,xn(t)),ge(e,45,qj({patternType:"none"})),ge(e,45,qj({patternType:"gray125"})),ge(e,604)}function Q$(e){var t=1;ge(e,613,xn(t)),ge(e,46,z$()),ge(e,614)}function Z$(e){var t=1;ge(e,626,xn(t)),ge(e,47,S5({numFmtId:0},65535)),ge(e,627)}function e7(e,t){ge(e,617,xn(t.length)),t.forEach(function(r){ge(e,47,S5(r,0))}),ge(e,618)}function t7(e){var t=1;ge(e,619,xn(t)),ge(e,48,V$({xfId:0,name:"Normal"})),ge(e,620)}function r7(e){var t=0;ge(e,505,xn(t)),ge(e,506)}function a7(e){var t=0;ge(e,508,G$(t,"TableStyleMedium9","PivotStyleMedium4")),ge(e,509)}function n7(e,t){var r=va();return ge(r,278),X$(r,e.SSF),Y$(r),J$(r),Q$(r),Z$(r),e7(r,t.cellXfs),t7(r),r7(r),a7(r),ge(r,279),r.end()}var s7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function i7(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(ra)||[]).forEach(function(s){var i=ze(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[s7.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function o7(){}function l7(){}var c7=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,d7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,u7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function f7(e,t,r){t.themeElements={};var a;[["clrScheme",c7,i7],["fontScheme",d7,o7],["fmtScheme",u7,l7]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var h7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function k5(e,t){(!e||e.length===0)&&(e=Bv());var r,a={};if(!(r=e.match(h7)))throw new Error("themeElements not found in theme");return f7(r[0],a,t),a.raw=e,a}function Bv(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[pr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function m7(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var o;try{o=yT(i,{type:"array"})}catch{return}var l=Ca(o,"theme/theme/theme1.xml",!0);if(l)return k5(l,r)}}function x7(e){return e.read_shift(4)}function p7(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=g7(e,4);break;case 2:t.xclrValue=s5(e);break;case 3:t.xclrValue=x7(e);break;case 4:e.l+=4;break}return e.l+=8,t}function g7(e,t){return ta(e,t)}function y7(e,t){return ta(e,t)}function v7(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=p7(e);break;case 6:a[1]=y7(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function b7(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(v7(e,r-e.l));return{ixfe:a,ext:i}}function j7(e,t){t.forEach(function(r){r[0]})}function w7(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ea(e)}}function N7(e){var t=ue(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Lr(e.name,t),t.slice(0,t.l)}function _7(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function S7(e){var t=ue(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function k7(e,t){var r=ue(8+2*t.length);return r.write_shift(4,e),Lr(t,r),r.slice(0,r.l)}function E7(e){return e.l+=4,e.read_shift(4)!=0}function T7(e,t){var r=ue(8);return r.write_shift(4,e),r.write_shift(4,1),r}function A7(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},i=[],o=!1,l=2;return cs(e,function(c,d,u){switch(u){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?a.Cell.push({type:a.Types[f[0]-1].name,index:f[1]}):l==0&&a.Value.push({type:a.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(u),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),a}function C7(){var e=va();return ge(e,332),ge(e,334,xn(1)),ge(e,335,N7({name:"XLDAPR",version:12e4,flags:3496657072})),ge(e,336),ge(e,339,k7(1,"XLDAPR")),ge(e,52),ge(e,35,xn(514)),ge(e,4096,xn(0)),ge(e,4097,Va(1)),ge(e,36),ge(e,53),ge(e,340),ge(e,337,T7(1)),ge(e,51,S7([[1,0]])),ge(e,338),ge(e,333),e.end()}function P7(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,i=2,o;return e.replace(ra,function(l){var c=ze(l);switch(Fn(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==c.name&&(o=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),a}function E5(){var e=[pr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function O7(e){var t=[];if(!e)return t;var r=1;return(e.match(ra)||[]).forEach(function(a){var s=ze(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function I7(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ue(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function F7(e,t,r){var a=[];return cs(e,function(i,o,l){switch(l){case 63:a.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),a}function D7(e,t,r,a){if(!e)return e;var s=a||{},i=!1;cs(e,function(l,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function R7(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var so=1024;function T5(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Ne("xml",null,{"xmlns:v":Ea.v,"xmlns:o":Ea.o,"xmlns:x":Ea.x,"xmlns:mv":Ea.mv}).replace(/\/>/,">"),Ne("o:shapelayout",Ne("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ne("v:shapetype",[Ne("v:stroke",null,{joinstyle:"miter"}),Ne("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];so<e*1e3;)so+=1e3;return t.forEach(function(i){var o=tr(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Ne("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Ne("v:fill",c,l),u={on:"t",obscured:"t"};++so,s=s.concat(["<v:shape"+jc({id:"_x0000_s"+so,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Ne("v:shadow",null,u),Ne("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Wr("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Wr("x:AutoFill","False"),Wr("x:Row",String(o.r)),Wr("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Wj(e,t,r,a){var s=Array.isArray(e),i;t.forEach(function(o){var l=tr(o.ref);if(s?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},s?e[l.r][l.c]=i:e[o.ref]=i;var c=gt(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=Ze(c);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&a){for(f=0;f<a.length;++f)if(u.a==a[f].id){u.a=a[f].name||u.a;break}}i.c.push(u)})}function M7(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=ze(l[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=tr(c.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!f&&!!f[1]&&Mv(f[1])||{r:"",t:"",h:""};d.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),d.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=x.h),a.push(d)}}}}),a}function A5(e){var t=[pr,Ne("comments",null,{xmlns:Fi[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var i=At(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(s=r.indexOf(At(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(Wr("t",At(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(Wr("t",At(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function L7(e,t){var r=[],a=!1,s={},i=0;return e.replace(ra,function(l,c){var d=ze(l);switch(Fn(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":s.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function $7(e,t,r){var a=[pr,Ne("ThreadedComments",null,{xmlns:Er.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(Ne("threadedComment",Wr("text",o.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function B7(e,t){var r=[],a=!1;return e.replace(ra,function(i){var o=ze(i);switch(Fn(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function U7(e){var t=[pr,Ne("personList",null,{xmlns:Er.TCMNT,"xmlns:x":Fi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Ne("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function q7(e){var t={};t.iauthor=e.read_shift(4);var r=Li(e);return t.rfx=r.s,t.ref=Ue(r.s),e.l+=16,t}function W7(e,t){return t==null&&(t=ue(36)),t.write_shift(4,e[1].iauthor),ul(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var H7=ea;function z7(e){return Lr(e.slice(0,54))}function V7(e,t){var r=[],a=[],s={},i=!1;return cs(e,function(l,c,d){switch(d){case 632:a.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function G7(e){var t=va(),r=[];return ge(t,628),ge(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ge(t,632,z7(s.a)))})}),ge(t,631),ge(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:tr(a[0]),e:tr(a[0])};ge(t,635,W7([i,s])),s.t&&s.t.length>0&&ge(t,637,xR(s)),ge(t,636),delete s.iauthor})}),ge(t,634),ge(t,629),t.end()}var K7="application/vnd.ms-office.vbaProject";function X7(e){var t=Fe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Fe.utils.cfb_add(t,s,e.FileIndex[a].content)}}),Fe.write(t)}function Y7(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Fe.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var C5=["xlsb","xlsm","xlam","biff8","xla"];function J7(){return{"!type":"dialog"}}function Q7(){return{"!type":"dialog"}}function Z7(){return{"!type":"macro"}}function eB(){return{"!type":"macro"}}var mo=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=t.c:--u,c?d+=t.r:--d,s+(l?"":"$")+er(u)+(c?"":"$")+xr(d)}return function(s,i){return t=i,s.replace(e,r)}})(),Uv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,qv=(function(){return function(t,r){return t.replace(Uv,function(a,s,i,o,l,c){var d=Tv(o)-(i?0:r.c),u=Ev(c)-(l?0:r.r),f=u==0?"":l?u+1:"["+u+"]",x=d==0?"":i?d+1:"["+d+"]";return s+"R"+f+"C"+x})}})();function P5(e,t){return e.replace(Uv,function(r,a,s,i,o,l){return a+(s=="$"?s+i:er(Tv(i)+t.c))+(o=="$"?o+l:xr(Ev(l)+t.r))})}function tB(e,t,r){var a=wa(t),s=a.s,i=tr(r),o={r:i.r-s.r,c:i.c-s.c};return P5(e,o)}function rB(e){return e.length!=1}function Hj(e){return e.replace(/_xlfn\./g,"")}function gr(e){e.l+=1}function Fs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function O5(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return I5(e);r.biff==12&&(a=4)}var s=e.read_shift(a),i=e.read_shift(a),o=Fs(e),l=Fs(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function I5(e){var t=Fs(e),r=Fs(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function aB(e,t,r){if(r.biff<8)return I5(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=Fs(e),o=Fs(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function F5(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return nB(e);var a=e.read_shift(r&&r.biff==12?4:2),s=Fs(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function nB(e){var t=Fs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function sB(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function iB(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return oB(e);var s=e.read_shift(a>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:l}}function oB(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function lB(e,t,r){var a=(e[e.l++]&96)>>5,s=O5(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function cB(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=O5(e,i,r);return[a,s,o]}function dB(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function uB(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,s]}function fB(e,t,r){var a=(e[e.l++]&96)>>5,s=aB(e,t-1,r);return[a,s]}function hB(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function zj(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function mB(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=a;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function xB(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function pB(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function gB(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function yB(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function D5(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function vB(e){return e.read_shift(2),D5(e)}function bB(e){return e.read_shift(2),D5(e)}function jB(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=F5(e,0,r);return[a,s]}function wB(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=iB(e,0,r);return[a,s]}function NB(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=F5(e,0,r);return[a,s,i]}function _B(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[E9[s],L5[s],a]}function SB(e,t,r){var a=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:kB(e);return[s,(i[0]===0?L5:k9)[i[1]]]}function kB(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function EB(e,t,r){e.l+=r&&r.biff==2?3:4}function TB(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function AB(e){return e.l++,ds[e.read_shift(1)]}function CB(e){return e.l++,e.read_shift(2)}function PB(e){return e.l++,e.read_shift(1)!==0}function OB(e){return e.l++,Zr(e)}function IB(e,t,r){return e.l++,pd(e,t-1,r)}function FB(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=hr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ds[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Zr(e);break;case 2:r[1]=$i(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function DB(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=a;++i)s.push((r.biff==12?Li:Xf)(e));return s}function RB(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var i=0,o=[];i!=a&&(o[i]=[]);++i)for(var l=0;l!=s;++l)o[i][l]=FB(e,r.biff);return o}function MB(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function LB(e,t,r){if(r.biff==5)return $B(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[a,s,i]}function $B(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function BB(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function UB(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function qB(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function WB(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,s]}var HB=ta,zB=ta,VB=ta;function yd(e,t,r){return e.l+=2,[sB(e)]}function Wv(e){return e.l+=6,[]}var GB=yd,KB=Wv,XB=Wv,YB=yd;function R5(e){return e.l+=2,[vr(e),e.read_shift(2)&1]}var JB=yd,QB=R5,ZB=Wv,e9=yd,t9=yd,r9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function a9(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),o=r9[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:s,C:i}}function n9(e){return e.l+=2,[e.read_shift(4)]}function s9(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function i9(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function o9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function l9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function c9(e){return e.l+=4,[0,0]}var Vj={1:{n:"PtgExp",f:TB},2:{n:"PtgTbl",f:VB},3:{n:"PtgAdd",f:gr},4:{n:"PtgSub",f:gr},5:{n:"PtgMul",f:gr},6:{n:"PtgDiv",f:gr},7:{n:"PtgPower",f:gr},8:{n:"PtgConcat",f:gr},9:{n:"PtgLt",f:gr},10:{n:"PtgLe",f:gr},11:{n:"PtgEq",f:gr},12:{n:"PtgGe",f:gr},13:{n:"PtgGt",f:gr},14:{n:"PtgNe",f:gr},15:{n:"PtgIsect",f:gr},16:{n:"PtgUnion",f:gr},17:{n:"PtgRange",f:gr},18:{n:"PtgUplus",f:gr},19:{n:"PtgUminus",f:gr},20:{n:"PtgPercent",f:gr},21:{n:"PtgParen",f:gr},22:{n:"PtgMissArg",f:gr},23:{n:"PtgStr",f:IB},26:{n:"PtgSheet",f:s9},27:{n:"PtgEndSheet",f:i9},28:{n:"PtgErr",f:AB},29:{n:"PtgBool",f:PB},30:{n:"PtgInt",f:CB},31:{n:"PtgNum",f:OB},32:{n:"PtgArray",f:hB},33:{n:"PtgFunc",f:_B},34:{n:"PtgFuncVar",f:SB},35:{n:"PtgName",f:MB},36:{n:"PtgRef",f:jB},37:{n:"PtgArea",f:lB},38:{n:"PtgMemArea",f:BB},39:{n:"PtgMemErr",f:HB},40:{n:"PtgMemNoMem",f:zB},41:{n:"PtgMemFunc",f:UB},42:{n:"PtgRefErr",f:qB},43:{n:"PtgAreaErr",f:dB},44:{n:"PtgRefN",f:wB},45:{n:"PtgAreaN",f:fB},46:{n:"PtgMemAreaN",f:o9},47:{n:"PtgMemNoMemN",f:l9},57:{n:"PtgNameX",f:LB},58:{n:"PtgRef3d",f:NB},59:{n:"PtgArea3d",f:cB},60:{n:"PtgRefErr3d",f:WB},61:{n:"PtgAreaErr3d",f:uB},255:{}},d9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},u9={1:{n:"PtgElfLel",f:R5},2:{n:"PtgElfRw",f:e9},3:{n:"PtgElfCol",f:GB},6:{n:"PtgElfRwV",f:t9},7:{n:"PtgElfColV",f:YB},10:{n:"PtgElfRadical",f:JB},11:{n:"PtgElfRadicalS",f:ZB},13:{n:"PtgElfColS",f:KB},15:{n:"PtgElfColSV",f:XB},16:{n:"PtgElfRadicalLel",f:QB},25:{n:"PtgList",f:a9},29:{n:"PtgSxName",f:n9},255:{}},f9={0:{n:"PtgAttrNoop",f:c9},1:{n:"PtgAttrSemi",f:yB},2:{n:"PtgAttrIf",f:pB},4:{n:"PtgAttrChoose",f:mB},8:{n:"PtgAttrGoto",f:xB},16:{n:"PtgAttrSum",f:EB},32:{n:"PtgAttrBaxcel",f:zj},33:{n:"PtgAttrBaxcel",f:zj},64:{n:"PtgAttrSpace",f:vB},65:{n:"PtgAttrSpaceSemi",f:bB},128:{n:"PtgAttrIfError",f:gB},255:{}};function vd(e,t,r,a){if(a.biff<8)return ta(e,t);for(var s=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=RB(e,0,a),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=DB(e,r[o][1],a),i.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&i.push(ta(e,t)),i}function bd(e,t,r){for(var a=e.l+t,s,i,o=[];a!=e.l;)t=a-e.l,i=e[e.l],s=Vj[i]||Vj[d9[i]],(i===24||i===25)&&(s=(i===24?u9:f9)[e[e.l+1]]),!s||!s.f?ta(e,t):o.push([s.n,s.f(e,t,r)]);return o}function h9(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],i=0;i<a.length;++i){var o=a[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var m9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function x9(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function M5(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Gj(e,t,r){var a=M5(e,t,r);return a=="#REF"?a:x9(a,r)}function Yr(e,t,r,a,s){var i=s&&s.biff||8,o={s:{c:0,r:0}},l=[],c,d,u,f=0,x=0,p,h="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",v=0,b=e[0].length;v<b;++v){var y=e[0][v];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=ir(" ",e[0][m][1][1]);break;case 1:g=ir("\r",e[0][m][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}d=d+g,m=-1}l.push(d+m9[y[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Zl(y[1][1],o,s),l.push(ec(u,i));break;case"PtgRefN":u=r?Zl(y[1][1],r,s):y[1][1],l.push(ec(u,i));break;case"PtgRef3d":f=y[1][1],u=Zl(y[1][2],o,s),h=Gj(a,f,s),l.push(h+"!"+ec(u,i));break;case"PtgFunc":case"PtgFuncVar":var N=y[1][0],j=y[1][1];N||(N=0),N&=127;var w=N==0?[]:l.slice(-N);l.length-=N,j==="User"&&(j=w.shift()),l.push(j+"("+w.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":p=wj(y[1][1],r?{s:r}:o,s),l.push(Y0(p,s));break;case"PtgArea":p=wj(y[1][1],o,s),l.push(Y0(p,s));break;case"PtgArea3d":f=y[1][1],p=y[1][2],h=Gj(a,f,s),l.push(h+"!"+Y0(p,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=y[1][2];var _=(a.names||[])[x-1]||(a[0]||[])[x],S=_?_.Name:"SH33TJSNAME"+String(x);S&&S.slice(0,6)=="_xlfn."&&!s.xlfn&&(S=S.slice(6)),l.push(S);break;case"PtgNameX":var k=y[1][1];x=y[1][2];var E;if(s.biff<=5)k<0&&(k=-k),a[k]&&(E=a[k][x]);else{var A="";if(((a[k]||[])[0]||[])[0]==14849||(((a[k]||[])[0]||[])[0]==1025?a[k][x]&&a[k][x].itab>0&&(A=a.SheetNames[a[k][x].itab-1]+"!"):A=a.SheetNames[x-1]+"!"),a[k]&&a[k][x])A+=a[k][x].Name;else if(a[0]&&a[0][x])A+=a[0][x].Name;else{var P=(M5(a,k,s)||"").split(";;");P[x-1]?A=P[x-1]:A+="SH33TJSERRX"}l.push(A);break}E||(E={Name:"SH33TJSERRY"}),l.push(E.Name);break;case"PtgParen":var L="(",R=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:L=ir(" ",e[0][m][1][1])+L;break;case 3:L=ir("\r",e[0][m][1][1])+L;break;case 4:R=ir(" ",e[0][m][1][1])+R;break;case 5:R=ir("\r",e[0][m][1][1])+R;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}l.push(L+l.pop()+R);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var I={c:r.c,r:r.r};if(a.sharedf[Ue(u)]){var D=a.sharedf[Ue(u)];l.push(Yr(D,o,I,a,s))}else{var V=!1;for(c=0;c!=a.arrayf.length;++c)if(d=a.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){l.push(Yr(d[1],o,I,a,s)),V=!0;break}V||l.push(y[1])}break;case"PtgArray":l.push("{"+h9(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var F=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&m>=0&&F.indexOf(e[0][v][0])==-1){y=e[0][m];var U=!0;switch(y[1][0]){case 4:U=!1;case 0:g=ir(" ",y[1][1]);break;case 5:U=!1;case 1:g=ir("\r",y[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((U?g:"")+l.pop()+(U?"":g)),m=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function p9(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],ta(e,t-2)];var l=bd(e,o,r);return t!==o+s&&(i=vd(e,t-o-s,l,r)),e.l=a,[l,i]}function g9(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],ta(e,t-2)];var l=bd(e,o,r);return t!==o+s&&(i=vd(e,t-o-s,l,r)),e.l=a,[l,i]}function y9(e,t,r,a){var s=e.l+t,i=bd(e,a,r),o;return s!==e.l&&(o=vd(e,s-e.l,i,r)),[i,o]}function v9(e,t,r){var a=e.l+t,s,i=e.read_shift(2),o=bd(e,i,r);return i==65535?[[],ta(e,t-2)]:(t!==i+2&&(s=vd(e,a-i-2,o,r)),[o,s])}function b9(e){var t;if(Vn(e,e.l+6)!==65535)return[Zr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function j9(e){if(e==null){var t=ue(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ni(e);return Ni(0)}function th(e,t,r){var a=e.l+t,s=Dn(e);r.biff==2&&++e.l;var i=b9(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=g9(e,a-e.l,r);return{cell:s,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function w9(e,t,r,a,s){var i=Si(t,r,s),o=j9(e.v),l=ue(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=ue(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var f=Rr([i,o,l,d]);return f}function Yf(e,t,r){var a=e.read_shift(4),s=bd(e,a,r),i=e.read_shift(4),o=i>0?vd(e,i,s,r):null;return[s,o]}var N9=Yf,Jf=Yf,_9=Yf,S9=Yf,k9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},L5={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},E9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Kj(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function T9(e){var t="of:="+e.replace(Uv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function rh(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function A9(e){return e.replace(/\./,"!")}var rc={},xo={},ac=typeof Map<"u";function Hv(e,t,r){var a=0,s=e.length;if(r){if(ac?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=ac?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(ac?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function Qf(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Jr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=kc(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=Fu(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function xi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Bs(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Qn(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===a)return s;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function $5(e,t,r,a,s,i){try{a.cellNF&&(e.z=Be[t])}catch(l){if(a.WTF)throw l}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ht(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Be[t]==null&&Qn(kD[t]||"General",t),e.t==="e")e.w=e.w||ds[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=vc(e.v);else if(e.t==="d"){var o=Pr(e.v);(o|0)===o?e.w=o.toString(10):e.w=vc(o)}else{if(e.v===void 0)return"";e.w=ji(e.v,xo)}else e.t==="d"?e.w=en(t,Pr(e.v),xo):e.w=en(t,e.v,xo)}catch(l){if(a.WTF)throw l}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Iu(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Iu(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(a.WTF&&i.Fills)throw l}}}function C9(e,t,r){if(e&&e["!ref"]){var a=gt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function P9(e,t){var r=gt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ze(r))}var O9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,I9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,F9=/<(?:\w:)?hyperlink [^>]*>/mg,D9=/"(\w*:\w*)"/,R9=/<(?:\w:)?col\b[^>]*[\/]?>/g,M9=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,L9=/<(?:\w:)?pageMargins[^>]*\/>/g,B5=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,$9=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,B9=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function U9(e,t,r,a,s,i,o){if(!e)return e;a||(a={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",u="",f=e.match(I9);f?(d=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):d=u=e;var x=d.match(B5);x?zv(x[0],l,s,r):(x=d.match($9))&&W9(x[0],x[1]||"",l,s,r);var p=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var h=d.slice(p,p+50).match(D9);h&&P9(l,h[1])}var m=d.match(B9);m&&m[1]&&rU(m[1],s);var g=[];if(t.cellStyles){var v=d.match(R9);v&&J9(g,v)}f&&sU(f[1],l,t,c,i,o);var b=u.match(M9);b&&(l["!autofilter"]=Z9(b[0]));var y=[],N=u.match(O9);if(N)for(p=0;p!=N.length;++p)y[p]=gt(N[p].slice(N[p].indexOf('"')+1));var j=u.match(F9);j&&K9(l,j,a);var w=u.match(L9);if(w&&(l["!margins"]=X9(ze(w[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Ze(c)),t.sheetRows>0&&l["!ref"]){var _=gt(l["!ref"]);t.sheetRows<=+_.e.r&&(_.e.r=t.sheetRows-1,_.e.r>c.e.r&&(_.e.r=c.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>c.e.c&&(_.e.c=c.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ze(_))}return g.length>0&&(l["!cols"]=g),y.length>0&&(l["!merges"]=y),l}function q9(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ze(e[r])+'"/>';return t+"</mergeCells>"}function zv(e,t,r,a){var s=ze(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=mt(It(s.codeName)))}function W9(e,t,r,a,s){zv(e.slice(0,e.indexOf(">")),r,a,s)}function H9(e,t,r,a,s){var i=!1,o={},l=null;if(a.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=_n(At(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),l=(l||"")+Ne("outlinePr",null,d)}!i&&!l||(s[s.length]=Ne("sheetPr",l,o))}var z9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],V9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function G9(e){var t={sheet:1};return z9.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),V9.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Lv(e.password).toString(16).toUpperCase()),Ne("sheetProtection",null,t)}function K9(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var i=ze(It(t[s]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+mt(i.location))):(i.Target="#"+mt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=gt(i.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var u=Ue({c:d,r:c});a?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function X9(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Y9(e){return xi(e),Ne("pageMargins",null,e)}function J9(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=ze(t[a],!0);s.hidden&&(s.hidden=Wt(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,$v(s.width)),Is(s);i<=o;)e[i++]=zt(s)}}function Q9(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=Ne("col",null,Qf(s,a)));return r[r.length]="</cols>",r.join("")}function Z9(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function eU(e,t,r,a){var s=typeof e.ref=="string"?e.ref:Ze(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=wa(s);o.s.r==o.e.r&&(o.e.r=wa(t["!ref"]).e.r,s=Ze(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),Ne("autoFilter",null,{ref:s})}var tU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function rU(e,t){t.Views||(t.Views=[{}]),(e.match(tU)||[]).forEach(function(r,a){var s=ze(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),Wt(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function aU(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Ne("sheetViews",Ne("sheetView",null,s),{})}function nU(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=ds[e.v];break;case"d":a&&a.cellDates?s=Ht(e.v,-1).toISOString():(e=zt(e),e.t="n",s=""+(e.v=Pr(Ht(e.v)))),typeof e.z>"u"&&(e.z=Be[14]);break;default:s=e.v;break}var l=Wr("v",At(s)),c={r:t},d=Bs(a.cellXfs,e,a);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){l=Wr("v",""+Hv(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Ne("f",At(e.f),u)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Ne("c",l,c)}var sU=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=bc("v"),o=bc("f");return function(c,d,u,f,x,p){for(var h=0,m="",g=[],v=[],b=0,y=0,N=0,j="",w,_,S=0,k=0,E,A,P=0,L=0,R=Array.isArray(p.CellXf),I,D=[],V=[],F=Array.isArray(d),U=[],q={},K=!1,T=!!u.sheetStubs,O=c.split(t),W=0,z=O.length;W!=z;++W){m=O[W].trim();var te=m.length;if(te!==0){var ae=0;e:for(h=0;h<te;++h)switch(m[h]){case">":if(m[h-1]!="/"){++h;break e}if(u&&u.cellStyles){if(_=ze(m.slice(ae,h),!0),S=_.r!=null?parseInt(_.r,10):S+1,k=-1,u.sheetRows&&u.sheetRows<S)continue;q={},K=!1,_.ht&&(K=!0,q.hpt=parseFloat(_.ht),q.hpx=Ao(q.hpt)),_.hidden=="1"&&(K=!0,q.hidden=!0),_.outlineLevel!=null&&(K=!0,q.level=+_.outlineLevel),K&&(U[S-1]=q)}break;case"<":ae=h;break}if(ae>=h)break;if(_=ze(m.slice(ae,h),!0),S=_.r!=null?parseInt(_.r,10):S+1,k=-1,!(u.sheetRows&&u.sheetRows<S)){f.s.r>S-1&&(f.s.r=S-1),f.e.r<S-1&&(f.e.r=S-1),u&&u.cellStyles&&(q={},K=!1,_.ht&&(K=!0,q.hpt=parseFloat(_.ht),q.hpx=Ao(q.hpt)),_.hidden=="1"&&(K=!0,q.hidden=!0),_.outlineLevel!=null&&(K=!0,q.level=+_.outlineLevel),K&&(U[S-1]=q)),g=m.slice(h).split(e);for(var se=0;se!=g.length&&g[se].trim().charAt(0)=="<";++se);for(g=g.slice(se),h=0;h!=g.length;++h)if(m=g[h].trim(),m.length!==0){if(v=m.match(r),b=h,y=0,N=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,v!=null&&v.length===2){for(b=0,j=v[1],y=0;y!=j.length&&!((N=j.charCodeAt(y)-64)<1||N>26);++y)b=26*b+N;--b,k=b}else++k;for(y=0;y!=m.length&&m.charCodeAt(y)!==62;++y);if(++y,_=ze(m.slice(0,y),!0),_.r||(_.r=Ue({r:S-1,c:k})),j=m.slice(y),w={t:""},(v=j.match(i))!=null&&v[1]!==""&&(w.v=mt(v[1])),u.cellFormula){if((v=j.match(o))!=null&&v[1]!==""){if(w.f=mt(It(v[1])).replace(/\r\n/g,`
`),u.xlfn||(w.f=Hj(w.f)),v[0].indexOf('t="array"')>-1)w.F=(j.match(s)||[])[1],w.F.indexOf(":")>-1&&D.push([gt(w.F),w.F]);else if(v[0].indexOf('t="shared"')>-1){A=ze(v[0]);var M=mt(It(v[1]));u.xlfn||(M=Hj(M)),V[parseInt(A.si,10)]=[A,M,_.r]}}else(v=j.match(/<f[^>]*\/>/))&&(A=ze(v[0]),V[A.si]&&(w.f=tB(V[A.si][1],V[A.si][2],_.r)));var G=tr(_.r);for(y=0;y<D.length;++y)G.r>=D[y][0].s.r&&G.r<=D[y][0].e.r&&G.c>=D[y][0].s.c&&G.c<=D[y][0].e.c&&(w.F=D[y][1])}if(_.t==null&&w.v===void 0)if(w.f||w.F)w.v=0,w.t="n";else if(T)w.t="z";else continue;else w.t=_.t||"n";switch(f.s.c>k&&(f.s.c=k),f.e.c<k&&(f.e.c=k),w.t){case"n":if(w.v==""||w.v==null){if(!T)continue;w.t="z"}else w.v=parseFloat(w.v);break;case"s":if(typeof w.v>"u"){if(!T)continue;w.t="z"}else E=rc[parseInt(w.v,10)],w.v=E.t,w.r=E.r,u.cellHTML&&(w.h=E.h);break;case"str":w.t="s",w.v=w.v!=null?It(w.v):"",u.cellHTML&&(w.h=Nv(w.v));break;case"inlineStr":v=j.match(a),w.t="s",v!=null&&(E=Mv(v[1]))?(w.v=E.t,u.cellHTML&&(w.h=E.h)):w.v="";break;case"b":w.v=Wt(w.v);break;case"d":u.cellDates?w.v=Ht(w.v,1):(w.v=Pr(Ht(w.v,1)),w.t="n");break;case"e":(!u||u.cellText!==!1)&&(w.w=w.v),w.v=qT[w.v];break}if(P=L=0,I=null,R&&_.s!==void 0&&(I=p.CellXf[_.s],I!=null&&(I.numFmtId!=null&&(P=I.numFmtId),u.cellStyles&&I.fillId!=null&&(L=I.fillId))),$5(w,P,L,u,x,p),u.cellDates&&R&&w.t=="n"&&ll(Be[P])&&(w.t="d",w.v=Kf(w.v)),_.cm&&u.xlmeta){var ne=(u.xlmeta.Cell||[])[+_.cm-1];ne&&ne.type=="XLDAPR"&&(w.D=!0)}if(F){var B=tr(_.r);d[B.r]||(d[B.r]=[]),d[B.r][B.c]=w}else d[_.r]=w}}}}U.length>0&&(d["!rows"]=U)}})();function iU(e,t,r,a){var s=[],i=[],o=gt(e["!ref"]),l="",c,d="",u=[],f=0,x=0,p=e["!rows"],h=Array.isArray(e),m={r:d},g,v=-1;for(x=o.s.c;x<=o.e.c;++x)u[x]=er(x);for(f=o.s.r;f<=o.e.r;++f){for(i=[],d=xr(f),x=o.s.c;x<=o.e.c;++x){c=u[x]+d;var b=h?(e[f]||[])[x]:e[c];b!==void 0&&(l=nU(b,c,e,t))!=null&&i.push(l)}(i.length>0||p&&p[f])&&(m={r:d},p&&p[f]&&(g=p[f],g.hidden&&(m.hidden=1),v=-1,g.hpx?v=Ec(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(m.ht=v,m.customHeight=1),g.level&&(m.outlineLevel=g.level)),s[s.length]=Ne("row",i.join(""),m))}if(p)for(;f<p.length;++f)p&&p[f]&&(m={r:f+1},g=p[f],g.hidden&&(m.hidden=1),v=-1,g.hpx?v=Ec(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(m.ht=v,m.customHeight=1),g.level&&(m.outlineLevel=g.level),s[s.length]=Ne("row","",m));return s.join("")}function U5(e,t,r,a){var s=[pr,Ne("worksheet",null,{xmlns:Fi[0],"xmlns:r":Er.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",u=gt(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=Ze(u)}a||(a={}),c["!comments"]=[];var f=[];H9(c,r,e,t,s),s[s.length]=Ne("dimension",null,{ref:d}),s[s.length]=aU(c,t,e,r),t.sheetFormat&&(s[s.length]=Ne("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=Q9(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=iU(c,t),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=G9(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=eU(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=q9(c["!merges"]));var x=-1,p,h=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(h=Tt(a,-1,At(m[1].Target).replace(/#.*$/,""),it.HLINK),p["r:id"]="rId"+h),(x=m[1].Target.indexOf("#"))>-1&&(p.location=At(m[1].Target.slice(x+1))),m[1].Tooltip&&(p.tooltip=At(m[1].Tooltip)),s[s.length]=Ne("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=Y9(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Wr("ignoredErrors",Ne("ignoredError",null,{numberStoredAsText:1,sqref:d}))),f.length>0&&(h=Tt(a,-1,"../drawings/drawing"+(e+1)+".xml",it.DRAW),s[s.length]=Ne("drawing",null,{"r:id":"rId"+h}),c["!drawing"]=f),c["!comments"].length>0&&(h=Tt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",it.VML),s[s.length]=Ne("legacyDrawing",null,{"r:id":"rId"+h}),c["!legacy"]=h),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function oU(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function lU(e,t,r){var a=ue(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;s.hpx?i=Ec(s.hpx)*20:s.hpt&&(i=s.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var l=0,c=a.l;a.l+=4;for(var d={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,x=-1,p=u<<10;p<u+1<<10;++p){d.c=p;var h=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Ue(d)];h&&(f<0&&(f=p),x=p)}f<0||(++l,a.write_shift(4,f),a.write_shift(4,x))}var m=a.l;return a.l=c,a.write_shift(4,l),a.l=m,a.length>a.l?a.slice(0,a.l):a}function cU(e,t,r,a){var s=lU(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&ge(e,0,s)}var dU=Li,uU=ul;function fU(){}function hU(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=pR(e),r}function mU(e,t,r){r==null&&(r=ue(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return Cu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),MT(e,r),r.slice(0,r.l)}function xU(e){var t=an(e);return[t]}function pU(e,t,r){return r==null&&(r=ue(8)),Di(t,r)}function gU(e){var t=Ri(e);return[t]}function yU(e,t,r){return r==null&&(r=ue(4)),Mi(t,r)}function vU(e){var t=an(e),r=e.read_shift(1);return[t,r,"b"]}function bU(e,t,r){return r==null&&(r=ue(9)),Di(t,r),r.write_shift(1,e.v?1:0),r}function jU(e){var t=Ri(e),r=e.read_shift(1);return[t,r,"b"]}function wU(e,t,r){return r==null&&(r=ue(5)),Mi(t,r),r.write_shift(1,e.v?1:0),r}function NU(e){var t=an(e),r=e.read_shift(1);return[t,r,"e"]}function _U(e,t,r){return r==null&&(r=ue(9)),Di(t,r),r.write_shift(1,e.v),r}function SU(e){var t=Ri(e),r=e.read_shift(1);return[t,r,"e"]}function kU(e,t,r){return r==null&&(r=ue(8)),Mi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function EU(e){var t=an(e),r=e.read_shift(4);return[t,r,"s"]}function TU(e,t,r){return r==null&&(r=ue(12)),Di(t,r),r.write_shift(4,t.v),r}function AU(e){var t=Ri(e),r=e.read_shift(4);return[t,r,"s"]}function CU(e,t,r){return r==null&&(r=ue(8)),Mi(t,r),r.write_shift(4,t.v),r}function PU(e){var t=an(e),r=Zr(e);return[t,r,"n"]}function OU(e,t,r){return r==null&&(r=ue(16)),Di(t,r),Ni(e.v,r),r}function q5(e){var t=Ri(e),r=Zr(e);return[t,r,"n"]}function IU(e,t,r){return r==null&&(r=ue(12)),Mi(t,r),Ni(e.v,r),r}function FU(e){var t=an(e),r=Ov(e);return[t,r,"n"]}function DU(e,t,r){return r==null&&(r=ue(12)),Di(t,r),LT(e.v,r),r}function RU(e){var t=Ri(e),r=Ov(e);return[t,r,"n"]}function MU(e,t,r){return r==null&&(r=ue(8)),Mi(t,r),LT(e.v,r),r}function LU(e){var t=an(e),r=Av(e);return[t,r,"is"]}function $U(e){var t=an(e),r=ea(e);return[t,r,"str"]}function BU(e,t,r){return r==null&&(r=ue(12+4*e.v.length)),Di(t,r),Lr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function UU(e){var t=Ri(e),r=ea(e);return[t,r,"str"]}function qU(e,t,r){return r==null&&(r=ue(8+4*e.v.length)),Mi(t,r),Lr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function WU(e,t,r){var a=e.l+t,s=an(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"b"];if(r.cellFormula){e.l+=2;var l=Jf(e,a-e.l,r);o[3]=Yr(l,null,s,r.supbooks,r)}else e.l=a;return o}function HU(e,t,r){var a=e.l+t,s=an(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"e"];if(r.cellFormula){e.l+=2;var l=Jf(e,a-e.l,r);o[3]=Yr(l,null,s,r.supbooks,r)}else e.l=a;return o}function zU(e,t,r){var a=e.l+t,s=an(e);s.r=r["!row"];var i=Zr(e),o=[s,i,"n"];if(r.cellFormula){e.l+=2;var l=Jf(e,a-e.l,r);o[3]=Yr(l,null,s,r.supbooks,r)}else e.l=a;return o}function VU(e,t,r){var a=e.l+t,s=an(e);s.r=r["!row"];var i=ea(e),o=[s,i,"str"];if(r.cellFormula){e.l+=2;var l=Jf(e,a-e.l,r);o[3]=Yr(l,null,s,r.supbooks,r)}else e.l=a;return o}var GU=Li,KU=ul;function XU(e,t){return t==null&&(t=ue(4)),t.write_shift(4,e),t}function YU(e,t){var r=e.l+t,a=Li(e),s=Cv(e),i=ea(e),o=ea(e),l=ea(e);e.l=r;var c={rfx:a,relId:s,loc:i,display:l};return o&&(c.Tooltip=o),c}function JU(e,t){var r=ue(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ul({s:tr(e[0]),e:tr(e[0])},r),Pv("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return Lr(s||"",r),Lr(e[1].Tooltip||"",r),Lr("",r),r.slice(0,r.l)}function QU(){}function ZU(e,t,r){var a=e.l+t,s=$T(e),i=e.read_shift(1),o=[s];if(o[2]=i,r.cellFormula){var l=N9(e,a-e.l,r);o[1]=l}else e.l=a;return o}function eq(e,t,r){var a=e.l+t,s=Li(e),i=[s];if(r.cellFormula){var o=S9(e,a-e.l,r);i[1]=o,e.l=a}else e.l=a;return i}function tq(e,t,r){r==null&&(r=ue(18));var a=Qf(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var W5=["left","right","top","bottom","header","footer"];function rq(e){var t={};return W5.forEach(function(r){t[r]=Zr(e)}),t}function aq(e,t){return t==null&&(t=ue(48)),xi(e),W5.forEach(function(r){Ni(e[r],t)}),t}function nq(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function sq(e,t,r){r==null&&(r=ue(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function iq(e){var t=ue(24);return t.write_shift(4,4),t.write_shift(4,1),ul(e,t),t}function oq(e,t){return t==null&&(t=ue(66)),t.write_shift(2,e.password?Lv(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function lq(){}function cq(){}function dq(e,t,r,a,s,i,o){if(!e)return e;var l=t||{};a||(a={"!id":{}});var c=l.dense?[]:{},d,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,x=!1,p,h,m,g,v,b,y,N,j,w=[];l.biff=12,l["!row"]=0;var _=0,S=!1,k=[],E={},A=l.supbooks||s.supbooks||[[]];if(A.sharedf=E,A.arrayf=k,A.SheetNames=s.SheetNames||s.Sheets.map(function(F){return F.name}),!l.supbooks&&(l.supbooks=A,s.Names))for(var P=0;P<s.Names.length;++P)A[0][P+1]=s.Names[P];var L=[],R=[],I=!1;Tc[16]={n:"BrtShortReal",f:q5};var D;if(cs(e,function(U,q,K){if(!x)switch(K){case 148:d=U;break;case 0:p=U,l.sheetRows&&l.sheetRows<=p.r&&(x=!0),N=xr(g=p.r),l["!row"]=p.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=Ao(U.hpt)),R[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(h={t:U[2]},U[2]){case"n":h.v=U[1];break;case"s":y=rc[U[1]],h.v=y.t,h.r=y.r;break;case"b":h.v=!!U[1];break;case"e":h.v=U[1],l.cellText!==!1&&(h.w=ds[h.v]);break;case"str":h.t="s",h.v=U[1];break;case"is":h.t="s",h.v=U[1].t;break}if((m=o.CellXf[U[0].iStyleRef])&&$5(h,m.numFmtId,null,l,i,o),v=U[0].c==-1?v+1:U[0].c,l.dense?(c[g]||(c[g]=[]),c[g][v]=h):c[er(v)+N]=h,l.cellFormula){for(S=!1,_=0;_<k.length;++_){var T=k[_];p.r>=T[0].s.r&&p.r<=T[0].e.r&&v>=T[0].s.c&&v<=T[0].e.c&&(h.F=Ze(T[0]),S=!0)}!S&&U.length>3&&(h.f=U[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>v&&(u.s.c=v),u.e.r<p.r&&(u.e.r=p.r),u.e.c<v&&(u.e.c=v),l.cellDates&&m&&h.t=="n"&&ll(Be[m.numFmtId])){var O=ai(h.v);O&&(h.t="d",h.v=new Date(O.y,O.m-1,O.d,O.H,O.M,O.S,O.u))}D&&(D.type=="XLDAPR"&&(h.D=!0),D=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;h={t:"z",v:void 0},v=U[0].c==-1?v+1:U[0].c,l.dense?(c[g]||(c[g]=[]),c[g][v]=h):c[er(v)+N]=h,u.s.r>p.r&&(u.s.r=p.r),u.s.c>v&&(u.s.c=v),u.e.r<p.r&&(u.e.r=p.r),u.e.c<v&&(u.e.c=v),D&&(D.type=="XLDAPR"&&(h.D=!0),D=void 0);break;case 176:w.push(U);break;case 49:D=((l.xlmeta||{}).Cell||[])[U-1];break;case 494:var W=a["!id"][U.relId];for(W?(U.Target=W.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=W):U.relId==""&&(U.Target="#"+U.loc),g=U.rfx.s.r;g<=U.rfx.e.r;++g)for(v=U.rfx.s.c;v<=U.rfx.e.c;++v)l.dense?(c[g]||(c[g]=[]),c[g][v]||(c[g][v]={t:"z",v:void 0}),c[g][v].l=U):(b=Ue({c:v,r:g}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=U);break;case 426:if(!l.cellFormula)break;k.push(U),j=l.dense?c[g][v]:c[er(v)+N],j.f=Yr(U[1],u,{r:p.r,c:v},A,l),j.F=Ze(U[0]);break;case 427:if(!l.cellFormula)break;E[Ue(U[0].s)]=U[1],j=l.dense?c[g][v]:c[er(v)+N],j.f=Yr(U[1],u,{r:p.r,c:v},A,l);break;case 60:if(!l.cellStyles)break;for(;U.e>=U.s;)L[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},I||(I=!0,$v(U.w/256)),Is(L[U.e+1]);break;case 161:c["!autofilter"]={ref:Ze(U)};break;case 476:c["!margins"]=U;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),U.name&&(s.Sheets[r].CodeName=U.name),(U.above||U.left)&&(c["!outline"]={above:U.above,left:U.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),U.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!q.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+K.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=Ze(d||u)),l.sheetRows&&c["!ref"]){var V=gt(c["!ref"]);l.sheetRows<=+V.e.r&&(V.e.r=l.sheetRows-1,V.e.r>u.e.r&&(V.e.r=u.e.r),V.e.r<V.s.r&&(V.s.r=V.e.r),V.e.c>u.e.c&&(V.e.c=u.e.c),V.e.c<V.s.c&&(V.s.c=V.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ze(V))}return w.length>0&&(c["!merges"]=w),L.length>0&&(c["!cols"]=L),R.length>0&&(c["!rows"]=R),c}function uq(e,t,r,a,s,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=zt(t),t.z=t.z||Be[14],t.v=Pr(Ht(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:a};switch(c.s=Bs(s.cellXfs,t,s),t.l&&i["!links"].push([Ue(c),t.l]),t.c&&i["!comments"].push([Ue(c),t.c]),t.t){case"s":case"str":return s.bookSST?(l=Hv(s.Strings,t.v,s.revStrings),c.t="s",c.v=l,o?ge(e,18,CU(t,c)):ge(e,7,TU(t,c))):(c.t="str",o?ge(e,17,qU(t,c)):ge(e,6,BU(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?ge(e,13,MU(t,c)):ge(e,2,DU(t,c)):o?ge(e,16,IU(t,c)):ge(e,5,OU(t,c)),!0;case"b":return c.t="b",o?ge(e,15,wU(t,c)):ge(e,4,bU(t,c)),!0;case"e":return c.t="e",o?ge(e,14,kU(t,c)):ge(e,3,_U(t,c)),!0}return o?ge(e,12,yU(t,c)):ge(e,1,pU(t,c)),!0}function fq(e,t,r,a){var s=gt(t["!ref"]||"A1"),i,o="",l=[];ge(e,145);var c=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=d;++u){o=xr(u),cU(e,t,s,u);var f=!1;if(u<=s.e.r)for(var x=s.s.c;x<=s.e.c;++x){u===s.s.r&&(l[x]=er(x)),i=l[x]+o;var p=c?(t[u]||[])[x]:t[i];if(!p){f=!1;continue}f=uq(e,p,u,x,a,t,f)}}ge(e,146)}function hq(e,t){!t||!t["!merges"]||(ge(e,177,XU(t["!merges"].length)),t["!merges"].forEach(function(r){ge(e,176,KU(r))}),ge(e,178))}function mq(e,t){!t||!t["!cols"]||(ge(e,390),t["!cols"].forEach(function(r,a){r&&ge(e,60,tq(a,r))}),ge(e,391))}function xq(e,t){!t||!t["!ref"]||(ge(e,648),ge(e,649,iq(gt(t["!ref"]))),ge(e,650))}function pq(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=Tt(r,-1,a[1].Target.replace(/#.*$/,""),it.HLINK);ge(e,494,JU(a,s))}}),delete t["!links"]}function gq(e,t,r,a){if(t["!comments"].length>0){var s=Tt(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",it.VML);ge(e,551,Pv("rId"+s)),t["!legacy"]=s}}function yq(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:Ze(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=wa(i);l.s.r==l.e.r&&(l.e.r=wa(t["!ref"]).e.r,i=Ze(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),ge(e,161,ul(gt(i))),ge(e,162)}}function vq(e,t,r){ge(e,133),ge(e,137,sq(t,r)),ge(e,138),ge(e,134)}function bq(e,t){t["!protect"]&&ge(e,535,oq(t["!protect"]))}function jq(e,t,r,a){var s=va(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=gt(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ge(s,129),(r.vbaraw||o["!outline"])&&ge(s,147,mU(l,o["!outline"])),ge(s,148,uU(c)),vq(s,o,r.Workbook),mq(s,o),fq(s,o,e,t),bq(s,o),yq(s,o,r,e),hq(s,o),pq(s,o,a),o["!margins"]&&ge(s,476,aq(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&xq(s,o),gq(s,o,e,a),ge(s,130),s.end()}function wq(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=mt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,s,a]}function Nq(e,t,r,a,s,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,d="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var x=wq(f);u.s.r=u.s.c=0,u.e.c=l,d=er(l),x[0].forEach(function(p,h){o[d+xr(h)]={t:"n",v:p,z:x[1]},c=h}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(o["!ref"]=Ze(u)),o}function _q(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(B5);return l&&zv(l[0],i,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function Sq(e,t){e.l+=10;var r=ea(e);return{name:r}}function kq(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return cs(e,function(c,d,u){switch(u){case 550:i["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var Vv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Eq=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Tq=[],Aq=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Xj(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var i=t[s];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=Wt(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function Yj(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=Wt(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function H5(e){Yj(e.WBProps,Vv),Yj(e.CalcPr,Aq),Xj(e.WBView,Eq),Xj(e.Sheets,Tq),xo.date1904=Wt(e.WBProps.date1904)}function Cq(e){return!e.Workbook||!e.Workbook.WBProps?"false":Wt(e.Workbook.WBProps.date1904)?"true":"false"}var Pq="][*?/\\".split("");function z5(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Pq.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Oq(e,t,r){e.forEach(function(a,s){z5(a);for(var i=0;i<s;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[s]&&t[s].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Iq(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Oq(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)C9(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Fq=/<\w+:workbook/;function Dq(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",i={},o=0;if(e.replace(ra,function(c,d){var u=ze(c);switch(Fn(u[0])){case"<?xml":break;case"<workbook":c.match(Fq)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Vv.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Wt(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=It(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=mt(It(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=It(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),Wt(u.hidden||"0")&&(i.Hidden=!0),o=d+c.length;break;case"</definedName>":i.Ref=mt(It(e.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),Fi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return H5(r),r}function V5(e){var t=[pr];t[t.length]=Ne("workbook",null,{xmlns:Fi[0],"xmlns:r":Er.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Vv.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(a[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Ne("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:At(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Ne("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Ne("definedName",At(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Rq(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=kg(e),r.name=ea(e),r}function Mq(e,t){return t||(t=ue(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Pv(e.strRelID,t),Lr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Lq(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?ea(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function $q(e,t){t||(t=ue(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),MT(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Bq(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Uq(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=gR(e),o=_9(e,0,r),l=Cv(e);e.l=a;var c={Name:i,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function qq(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],Tc[16]={n:"BrtFRTArchID$",f:Bq},cs(e,function(c,d,u){switch(u){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Yr(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(u),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(u),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),H5(r),r.Names=i,r.supbooks=o,r}function Wq(e,t){ge(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ge(e,156,Mq(s))}ge(e,144)}function Hq(e,t){t||(t=ue(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Lr("SheetJS",t),Lr(Nu.version,t),Lr(Nu.version,t),Lr("7262",t),t.length>t.l?t.slice(0,t.l):t}function zq(e,t){t||(t=ue(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Vq(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&i==-1&&(i=a);i>s||(ge(e,135),ge(e,158,zq(s)),ge(e,136))}}function Gq(e,t){var r=va();return ge(r,131),ge(r,128,Hq()),ge(r,153,$q(e.Workbook&&e.Workbook.WBProps||null)),Vq(r,e),Wq(r,e),ge(r,132),r.end()}function Kq(e,t,r){return t.slice(-4)===".bin"?qq(e,r):Dq(e,r)}function Xq(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?dq(e,a,r,s,i,o,l):U9(e,a,r,s,i,o,l)}function Yq(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?kq(e,a,r,s,i):_q(e,a,r,s,i)}function Jq(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?Z7():eB()}function Qq(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?J7():Q7()}function Zq(e,t,r,a){return t.slice(-4)===".bin"?K$(e,r,a):R$(e,r,a)}function eW(e,t,r){return k5(e,r)}function tW(e,t,r){return t.slice(-4)===".bin"?t$(e,r):QL(e,r)}function rW(e,t,r){return t.slice(-4)===".bin"?V7(e,r):M7(e,r)}function aW(e,t,r){return t.slice(-4)===".bin"?F7(e):O7(e)}function nW(e,t,r,a){return r.slice(-4)===".bin"?D7(e,t,r,a):void 0}function sW(e,t,r){return t.slice(-4)===".bin"?A7(e,t,r):P7(e,t,r)}function iW(e,t,r){return(t.slice(-4)===".bin"?Gq:V5)(e)}function oW(e,t,r,a,s){return(t.slice(-4)===".bin"?jq:U5)(e,r,a,s)}function lW(e,t,r){return(t.slice(-4)===".bin"?n7:_5)(e,r)}function cW(e,t,r){return(t.slice(-4)===".bin"?n$:p5)(e,r)}function dW(e,t,r){return(t.slice(-4)===".bin"?G7:A5)(e)}function uW(e){return(e.slice(-4)===".bin"?C7:E5)()}var G5=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,K5=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function on(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match(G5),i,o,l,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match(K5),(o=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),a[l]=i[2].slice(1,i[2].length-1));return a}function fW(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(G5),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(K5),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),r[o]=s[2].slice(1,s[2].length-1));return r}var nc;function hW(e,t){var r=nc[e]||mt(e);return r==="General"?ji(t):en(r,t)}function mW(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Wt(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=Ht(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[mt(t)]=s}function xW(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ds[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=vc(e.v):e.w=ji(e.v):e.w=hW(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=nc[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&ll(a)){var s=ai(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function pW(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=T$[a.Pattern]||a.Pattern)}e[t.ID]=t}function gW(e,t,r,a,s,i,o,l,c,d){var u="General",f=a.StyleID,x={};d=d||{};var p=[],h=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&p.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=Wt(e);break;case"String":a.t="s",a.r=hj(mt(e)),a.v=e.indexOf("<")>-1?mt(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Ht(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=mt(e):a.v<60&&(a.v=a.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=qT[e],d.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=hj(t||e));break}if(xW(a,u,d),d.cellFormula!==!1)if(a.Formula){var m=mt(a.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),a.f=mo(m,s),delete a.Formula,a.ArrayRange=="RC"?a.F=mo("RC:RC",s):a.ArrayRange&&(a.F=mo(a.ArrayRange,s),c.push([gt(a.F),a.F]))}else for(h=0;h<c.length;++h)s.r>=c[h][0].s.r&&s.r<=c[h][0].e.r&&s.c>=c[h][0].s.c&&s.c<=c[h][0].e.c&&(a.F=c[h][1]);d.cellStyles&&(p.forEach(function(g){!x.patternType&&g.patternType&&(x.patternType=g.patternType)}),a.s=x),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function yW(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ah(e,t){var r=t||{};cl();var a=Ul(_v(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=It(a));var s=a.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=zt(r);return o.type="string",To.to_workbook(a,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(We){s.indexOf("<"+We)>=0&&(i=!0)}),i)return aH(a,r);nc={"General Number":"General","General Date":Be[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Be[15],"Short Date":Be[14],"Long Time":Be[19],"Medium Time":Be[18],"Short Time":Be[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Be[2],Standard:Be[4],Percent:Be[10],Scientific:Be[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],d,u={},f=[],x=r.dense?[]:{},p="",h={},m={},g=on('<Data ss:Type="String">'),v=0,b=0,y=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},w={},_="",S=0,k=[],E={},A={},P=0,L=[],R=[],I={},D=[],V,F=!1,U=[],q=[],K={},T=0,O=0,W={Sheets:[],WBProps:{date1904:!1}},z={};wc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";l=wc.exec(a);)switch(l[3]=(te=l[3]).toLowerCase()){case"data":if(te=="data"){if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?gW(a.slice(v,l.index),_,g,c[c.length-1][0]=="comment"?I:h,{c:b,r:y},j,D[b],m,U,r):(_="",g=on(l[0]),v=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(R.length>0&&(h.c=R),(!r.sheetRows||r.sheetRows>y)&&h.v!==void 0&&(r.dense?(x[y]||(x[y]=[]),x[y][b]=h):x[er(b)+xr(y)]=h),h.HRef&&(h.l={Target:mt(h.HRef)},h.HRefScreenTip&&(h.l.Tooltip=h.HRefScreenTip),delete h.HRef,delete h.HRefScreenTip),(h.MergeAcross||h.MergeDown)&&(T=b+(parseInt(h.MergeAcross,10)|0),O=y+(parseInt(h.MergeDown,10)|0),k.push({s:{c:b,r:y},e:{c:T,r:O}})),!r.sheetStubs)h.MergeAcross?b=T+1:++b;else if(h.MergeAcross||h.MergeDown){for(var ae=b;ae<=T;++ae)for(var se=y;se<=O;++se)(ae>b||se>y)&&(r.dense?(x[se]||(x[se]=[]),x[se][ae]={t:"z"}):x[er(ae)+xr(se)]={t:"z"});b=T+1}else++b;else h=fW(l[0]),h.Index&&(b=+h.Index-1),b<N.s.c&&(N.s.c=b),b>N.e.c&&(N.e.c=b),l[0].slice(-2)==="/>"&&++b,R=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(y<N.s.r&&(N.s.r=y),y>N.e.r&&(N.e.r=y),l[0].slice(-2)==="/>"&&(m=on(l[0]),m.Index&&(y=+m.Index-1)),b=0,++y):(m=on(l[0]),m.Index&&(y=+m.Index-1),K={},(m.AutoFitHeight=="0"||m.Height)&&(K.hpx=parseInt(m.Height,10),K.hpt=Ec(K.hpx),q[y]=K),m.Hidden=="1"&&(K.hidden=!0,q[y]=K));break;case"worksheet":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));f.push(p),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(x["!ref"]=Ze(N),r.sheetRows&&r.sheetRows<=N.e.r&&(x["!fullref"]=x["!ref"],N.e.r=r.sheetRows-1,x["!ref"]=Ze(N))),k.length&&(x["!merges"]=k),D.length>0&&(x["!cols"]=D),q.length>0&&(x["!rows"]=q),u[p]=x}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=b=0,c.push([l[3],!1]),d=on(l[0]),p=mt(d.Name),x=r.dense?[]:{},k=[],U=[],q=[],z={name:p,Hidden:0},W.Sheets.push(z);break;case"table":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),D=[],F=!1}break;case"style":l[1]==="/"?pW(j,w,r):w=on(l[0]);break;case"numberformat":w.nf=mt(on(l[0]).Format||"General"),nc[w.nf]&&(w.nf=nc[w.nf]);for(var M=0;M!=392&&Be[M]!=w.nf;++M);if(M==392){for(M=57;M!=392;++M)if(Be[M]==null){Qn(w.nf,M);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(V=on(l[0]),V.Hidden&&(V.hidden=!0,delete V.Hidden),V.Width&&(V.wpx=parseInt(V.Width,10)),!F&&V.wpx>10){F=!0,Jr=w5;for(var G=0;G<D.length;++G)D[G]&&Is(D[G])}F&&Is(V),D[V.Index-1||D.length]=V;for(var ne=0;ne<+V.Span;++ne)D[D.length]=zt(V);break;case"namedrange":if(l[1]==="/")break;W.Names||(W.Names=[]);var B=ze(l[0]),pe={Name:B.Name,Ref:mo(B.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&(pe.Sheet=W.Sheets.length-1),W.Names.push(pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?_+=a.slice(S,l.index):S=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;w.Interior=on(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?qR(E,te,a.slice(P,l.index)):P=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));yW(I),R.push(I)}else c.push([l[3],!1]),d=on(l[0]),I={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ye=on(l[0]);x["!autofilter"]={ref:mo(ye.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return tw(a,r);var Te=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Te=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Te=!1}break;case"excelworkbook":switch(l[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Te=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Te=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(a.slice(P,l.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else P=l.index+l[0].length;break;case"header":x["!margins"]||xi(x["!margins"]={},"xlml"),isNaN(+ze(l[0]).Margin)||(x["!margins"].header=+ze(l[0]).Margin);break;case"footer":x["!margins"]||xi(x["!margins"]={},"xlml"),isNaN(+ze(l[0]).Margin)||(x["!margins"].footer=+ze(l[0]).Margin);break;case"pagemargins":var de=ze(l[0]);x["!margins"]||xi(x["!margins"]={},"xlml"),isNaN(+de.Top)||(x["!margins"].top=+de.Top),isNaN(+de.Left)||(x["!margins"].left=+de.Left),isNaN(+de.Right)||(x["!margins"].right=+de.Right),isNaN(+de.Bottom)||(x["!margins"].bottom=+de.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Te=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Te=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Te=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Te=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Te=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Te=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Te=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Te=!1}break;case"smarttags":break;default:Te=!1;break}if(Te||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?mW(A,te,L,a.slice(P,l.index)):(L=l,P=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var xe={};return!r.bookSheets&&!r.bookProps&&(xe.Sheets=u),xe.SheetNames=f,xe.Workbook=W,xe.SSF=zt(Be),xe.Props=E,xe.Custprops=A,xe}function Ig(e,t){switch(Kv(t=t||{}),t.type||"base64"){case"base64":return ah(Ra(e),t);case"binary":case"buffer":case"file":return ah(e,t);case"array":return ah(Ls(e),t)}}function vW(e,t){var r=[];return e.Props&&r.push(WR(e.Props,t)),e.Custprops&&r.push(HR(e.Props,e.Custprops)),r.join("")}function bW(){return""}function jW(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var i=[];i.push(Ne("NumberFormat",null,{"ss:Format":At(Be[a.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(Ne("Style",i.join(""),o))}),Ne("Styles",r.join(""))}function X5(e){return Ne("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+qv(e.Ref,{r:0,c:0})})}function wW(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(X5(s)))}return Ne("Names",r.join(""))}function NW(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,i=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(X5(l)))}return i.join("")}function _W(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ne("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ne("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ne("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(Ne("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Wr("ProtectContents","True")),e["!protect"].objects&&s.push(Wr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Wr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Wr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Wr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Ne("WorksheetOptions",s.join(""),{xmlns:Ea.x})}function SW(e){return e.map(function(t){var r=VD(t.t||""),a=Ne("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ne("Comment",a,{"ss:Author":t.a})}).join("")}function kW(e,t,r,a,s,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+At(qv(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=tr(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=At(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=At(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=o.c||d[u].s.r!=o.r||(d[u].e.c>d[u].s.c&&(l["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(l["ss:MergeDown"]=d[u].e.r-d[u].s.r));var f="",x="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":f="Number",x=String(e.v);break;case"b":f="Boolean",x=e.v?"1":"0";break;case"e":f="Error",x=ds[e.v];break;case"d":f="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Be[14]);break;case"s":f="String",x=zD(e.v||"");break}var p=Bs(a.cellXfs,e,a);l["ss:StyleID"]="s"+(21+p),l["ss:Index"]=o.c+1;var h=e.v!=null?x:"",m=e.t=="z"?"":'<Data ss:Type="'+f+'">'+h+"</Data>";return(e.c||[]).length>0&&(m+=SW(e.c)),Ne("Cell",m,l)}function EW(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ao(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function TW(e,t,r,a){if(!e["!ref"])return"";var s=gt(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,v){Is(g);var b=!!g.width,y=Qf(v,g),N={"ss:Index":v+1};b&&(N["ss:Width"]=Sc(y.width)),g.hidden&&(N["ss:Hidden"]="1"),l.push(Ne("Column",null,N))});for(var c=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var u=[EW(d,(e["!rows"]||[])[d])],f=s.s.c;f<=s.e.c;++f){var x=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>f)&&!(i[o].s.r>d)&&!(i[o].e.c<f)&&!(i[o].e.r<d)){(i[o].s.c!=f||i[o].s.r!=d)&&(x=!0);break}if(!x){var p={r:d,c:f},h=Ue(p),m=c?(e[d]||[])[f]:e[h];u.push(kW(m,h,e,t,r,a,p))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function AW(e,t,r){var a=[],s=r.SheetNames[e],i=r.Sheets[s],o=i?NW(i,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=i?TW(i,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(_W(i,t,e,r)),a.join("")}function CW(e,t){t||(t={}),e.SSF||(e.SSF=zt(Be)),e.SSF&&(cl(),zf(e.SSF),t.revssf=Gf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Bs(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(vW(e,t)),r.push(bW()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Ne("Worksheet",AW(a,t,e),{"ss:Name":At(e.SheetNames[a])}));return r[2]=jW(e,t),r[3]=wW(e),pr+Ne("Workbook",r.join(""),{xmlns:Ea.ss,"xmlns:o":Ea.o,"xmlns:x":Ea.x,"xmlns:ss":Ea.ss,"xmlns:dt":Ea.dt,"xmlns:html":Ea.html})}function PW(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=wR(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=NR(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var OW=[60,1084,2066,2165,2175];function IW(e,t,r,a,s){var i=a,o=[],l=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),r.l+=i;for(var c=Vn(r,r.l),d=Fg[c],u=0;d!=null&&OW.indexOf(c)>-1;)i=Vn(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=r.slice(u,r.l+4+i),o.push(l),r.l+=4+i,d=Fg[c=Vn(r,r.l)];var f=Rr(o);qr(f,0);var x=0;f.lens=[];for(var p=0;p<o.length;++p)f.lens.push(x),x+=o[p].length;if(f.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+a;return t.f(f,f.length,s)}function vn(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Be[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ds[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=vc(e.v):e.w=ji(e.v):e.w=en(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&ll(Be[a]||String(a))){var s=ai(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Gd(e,t,r){return{v:e,ixfe:t,t:r}}function FW(e,t){var r={opts:{}},a={},s=t.dense?[]:{},i={},o={},l=null,c=[],d="",u={},f,x="",p,h,m,g,v={},b=[],y,N,j=[],w=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},k=function(rt){return rt<8?fi[rt]:rt<64&&w[rt-8]||fi[rt]},E=function(rt,Yt,xa){var fr=Yt.XF.data;if(!(!fr||!fr.patternType||!xa||!xa.cellStyles)){Yt.s={},Yt.s.patternType=fr.patternType;var Ln;(Ln=_c(k(fr.icvFore)))&&(Yt.s.fgColor={rgb:Ln}),(Ln=_c(k(fr.icvBack)))&&(Yt.s.bgColor={rgb:Ln})}},A=function(rt,Yt,xa){if(!(K>1)&&!(xa.sheetRows&&rt.r>=xa.sheetRows)){if(xa.cellStyles&&Yt.XF&&Yt.XF.data&&E(rt,Yt,xa),delete Yt.ixfe,delete Yt.XF,f=rt,x=Ue(rt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),rt.r<o.s.r&&(o.s.r=rt.r),rt.c<o.s.c&&(o.s.c=rt.c),rt.r+1>o.e.r&&(o.e.r=rt.r+1),rt.c+1>o.e.c&&(o.e.c=rt.c+1),xa.cellFormula&&Yt.f){for(var fr=0;fr<b.length;++fr)if(!(b[fr][0].s.c>rt.c||b[fr][0].s.r>rt.r)&&!(b[fr][0].e.c<rt.c||b[fr][0].e.r<rt.r)){Yt.F=Ze(b[fr][0]),(b[fr][0].s.c!=rt.c||b[fr][0].s.r!=rt.r)&&delete Yt.f,Yt.f&&(Yt.f=""+Yr(b[fr][1],o,rt,U,P));break}}xa.dense?(s[rt.r]||(s[rt.r]=[]),s[rt.r][rt.c]=Yt):s[x]=Yt}},P={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var L,R=[],I=[],D=[],V=[],F=!1,U=[];U.SheetNames=P.snames,U.sharedf=P.sharedf,U.arrayf=P.arrayf,U.names=[],U.XTI=[];var q=0,K=0,T=0,O=[],W=[],z;P.codepage=1200,fn(1200);for(var te=!1;e.l<e.length-1;){var ae=e.l,se=e.read_shift(2);if(se===0&&q===10)break;var M=e.l===e.length?0:e.read_shift(2),G=Fg[se];if(G&&G.f){if(t.bookSheets&&q===133&&se!==133)break;if(q=se,G.r===2||G.r==12){var ne=e.read_shift(2);if(M-=2,!P.enc&&ne!==se&&((ne&255)<<8|ne>>8)!==se)throw new Error("rt mismatch: "+ne+"!="+se);G.r==12&&(e.l+=10,M-=10)}var B={};if(se===10?B=G.f(e,M,P):B=IW(se,G,e,M,P),K==0&&[9,521,1033,2057].indexOf(q)===-1)continue;switch(se){case 34:r.opts.Date1904=_.WBProps.date1904=B;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=B,!t.password)throw new Error("File is password-protected");if(B.valid==null)throw new Error("Encryption scheme unsupported");if(!B.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=B;break;case 66:var pe=Number(B);switch(pe){case 21010:pe=1200;break;case 32768:pe=1e4;break;case 32769:pe=1252;break}fn(P.codepage=pe),te=!0;break;case 317:P.rrtabid=B;break;case 25:P.winlocked=B;break;case 439:r.opts.RefreshAll=B;break;case 12:r.opts.CalcCount=B;break;case 16:r.opts.CalcDelta=B;break;case 17:r.opts.CalcIter=B;break;case 13:r.opts.CalcMode=B;break;case 14:r.opts.CalcPrecision=B;break;case 95:r.opts.CalcSaveRecalc=B;break;case 15:P.CalcRefMode=B;break;case 2211:r.opts.FullCalc=B;break;case 129:B.fDialog&&(s["!type"]="dialog"),B.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),B.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:j.push(B);break;case 430:U.push([B]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(B);break;case 24:case 536:z={Name:B.Name,Ref:Yr(B.rgce,o,null,U,P)},B.itab>0&&(z.Sheet=B.itab-1),U.names.push(z),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(B),B.Name=="_xlnm._FilterDatabase"&&B.itab>0&&B.rgce&&B.rgce[0]&&B.rgce[0][0]&&B.rgce[0][0][0]=="PtgArea3d"&&(W[B.itab-1]={ref:Ze(B.rgce[0][0][1][2])});break;case 22:P.ExternCount=B;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(B),U.XTI=U.XTI.concat(B);break;case 2196:if(P.biff<8)break;z!=null&&(z.Comment=B[1]);break;case 18:s["!protect"]=B;break;case 19:B!==0&&P.WTF&&console.error("Password verifier: "+B);break;case 133:i[B.pos]=B,P.snames.push(B.name);break;case 10:{if(--K)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=Ze(o),t.sheetRows&&t.sheetRows<=o.e.r){var ye=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Ze(o),o.e.r=ye}o.e.r++,o.e.c++}R.length>0&&(s["!merges"]=R),I.length>0&&(s["!objects"]=I),D.length>0&&(s["!cols"]=D),V.length>0&&(s["!rows"]=V),_.Sheets.push(S)}d===""?u=s:a[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[se]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[B.BIFFVer]||8),P.biffguess=B.BIFFVer==0,B.BIFFVer==0&&B.dt==4096&&(P.biff=5,te=!0,fn(P.codepage=28591)),P.biff==8&&B.BIFFVer==0&&B.dt==16&&(P.biff=2),K++)break;if(s=t.dense?[]:{},P.biff<8&&!te&&(te=!0,fn(P.codepage=t.codepage||1252)),P.biff<5||B.BIFFVer==0&&B.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Te={pos:e.l-M,name:d};i[Te.pos]=Te,P.snames.push(d)}else d=(i[ae]||{name:""}).name;B.dt==32&&(s["!type"]="chart"),B.dt==64&&(s["!type"]="macro"),R=[],I=[],P.arrayf=b=[],D=[],V=[],F=!1,S={Hidden:(i[ae]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[B.r]||[])[B.c]:s[Ue({c:B.c,r:B.r})])&&++B.c,y={ixfe:B.ixfe,XF:j[B.ixfe]||{},v:B.val,t:"n"},T>0&&(y.z=O[y.ixfe>>8&63]),vn(y,t,r.opts.Date1904),A({c:B.c,r:B.r},y,t);break;case 5:case 517:y={ixfe:B.ixfe,XF:j[B.ixfe],v:B.val,t:B.t},T>0&&(y.z=O[y.ixfe>>8&63]),vn(y,t,r.opts.Date1904),A({c:B.c,r:B.r},y,t);break;case 638:y={ixfe:B.ixfe,XF:j[B.ixfe],v:B.rknum,t:"n"},T>0&&(y.z=O[y.ixfe>>8&63]),vn(y,t,r.opts.Date1904),A({c:B.c,r:B.r},y,t);break;case 189:for(var de=B.c;de<=B.C;++de){var xe=B.rkrec[de-B.c][0];y={ixfe:xe,XF:j[xe],v:B.rkrec[de-B.c][1],t:"n"},T>0&&(y.z=O[y.ixfe>>8&63]),vn(y,t,r.opts.Date1904),A({c:de,r:B.r},y,t)}break;case 6:case 518:case 1030:{if(B.val=="String"){l=B;break}if(y=Gd(B.val,B.cell.ixfe,B.tt),y.XF=j[y.ixfe],t.cellFormula){var We=B.formula;if(We&&We[0]&&We[0][0]&&We[0][0][0]=="PtgExp"){var Nt=We[0][0][1][0],_e=We[0][0][1][1],He=Ue({r:Nt,c:_e});v[He]?y.f=""+Yr(B.formula,o,B.cell,U,P):y.F=((t.dense?(s[Nt]||[])[_e]:s[He])||{}).F}else y.f=""+Yr(B.formula,o,B.cell,U,P)}T>0&&(y.z=O[y.ixfe>>8&63]),vn(y,t,r.opts.Date1904),A(B.cell,y,t),l=B}break;case 7:case 519:if(l)l.val=B,y=Gd(B,l.cell.ixfe,"s"),y.XF=j[y.ixfe],t.cellFormula&&(y.f=""+Yr(l.formula,o,l.cell,U,P)),T>0&&(y.z=O[y.ixfe>>8&63]),vn(y,t,r.opts.Date1904),A(l.cell,y,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(B);var Ft=Ue(B[0].s);if(p=t.dense?(s[B[0].s.r]||[])[B[0].s.c]:s[Ft],t.cellFormula&&p){if(!l||!Ft||!p)break;p.f=""+Yr(B[1],o,B[0],U,P),p.F=Ze(B[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!l)break;v[Ue(l.cell)]=B[0],p=t.dense?(s[l.cell.r]||[])[l.cell.c]:s[Ue(l.cell)],(p||{}).f=""+Yr(B[0],o,f,U,P)}}break;case 253:y=Gd(c[B.isst].t,B.ixfe,"s"),c[B.isst].h&&(y.h=c[B.isst].h),y.XF=j[y.ixfe],T>0&&(y.z=O[y.ixfe>>8&63]),vn(y,t,r.opts.Date1904),A({c:B.c,r:B.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:B.ixfe,XF:j[B.ixfe],t:"z"},T>0&&(y.z=O[y.ixfe>>8&63]),vn(y,t,r.opts.Date1904),A({c:B.c,r:B.r},y,t));break;case 190:if(t.sheetStubs)for(var _r=B.c;_r<=B.C;++_r){var Ut=B.ixfe[_r-B.c];y={ixfe:Ut,XF:j[Ut],t:"z"},T>0&&(y.z=O[y.ixfe>>8&63]),vn(y,t,r.opts.Date1904),A({c:_r,r:B.r},y,t)}break;case 214:case 516:case 4:y=Gd(B.val,B.ixfe,"s"),y.XF=j[y.ixfe],T>0&&(y.z=O[y.ixfe>>8&63]),vn(y,t,r.opts.Date1904),A({c:B.c,r:B.r},y,t);break;case 0:case 512:K===1&&(o=B);break;case 252:c=B;break;case 1054:if(P.biff==4){O[T++]=B[1];for(var aa=0;aa<T+163&&Be[aa]!=B[1];++aa);aa>=163&&Qn(B[1],T+163)}else Qn(B[1],B[0]);break;case 30:{O[T++]=B;for(var na=0;na<T+163&&Be[na]!=B;++na);na>=163&&Qn(B,T+163)}break;case 229:R=R.concat(B);break;case 93:I[B.cmo[0]]=P.lastobj=B;break;case 438:P.lastobj.TxO=B;break;case 127:P.lastobj.ImData=B;break;case 440:for(g=B[0].s.r;g<=B[0].e.r;++g)for(m=B[0].s.c;m<=B[0].e.c;++m)p=t.dense?(s[g]||[])[m]:s[Ue({c:m,r:g})],p&&(p.l=B[1]);break;case 2048:for(g=B[0].s.r;g<=B[0].e.r;++g)for(m=B[0].s.c;m<=B[0].e.c;++m)p=t.dense?(s[g]||[])[m]:s[Ue({c:m,r:g})],p&&p.l&&(p.l.Tooltip=B[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;p=t.dense?(s[B[0].r]||[])[B[0].c]:s[Ue(B[0])];var sn=I[B[2]];p||(t.dense?(s[B[0].r]||(s[B[0].r]=[]),p=s[B[0].r][B[0].c]={t:"z"}):p=s[Ue(B[0])]={t:"z"},o.e.r=Math.max(o.e.r,B[0].r),o.s.r=Math.min(o.s.r,B[0].r),o.e.c=Math.max(o.e.c,B[0].c),o.s.c=Math.min(o.s.c,B[0].c)),p.c||(p.c=[]),h={a:B[1],t:sn.TxO.t},p.c.push(h)}break;case 2173:j7(j[B.ixfe],B.ext);break;case 125:{if(!P.cellStyles)break;for(;B.e>=B.s;)D[B.e--]={width:B.w/256,level:B.level||0,hidden:!!(B.flags&1)},F||(F=!0,$v(B.w/256)),Is(D[B.e+1])}break;case 520:{var Mt={};B.level!=null&&(V[B.r]=Mt,Mt.level=B.level),B.hidden&&(V[B.r]=Mt,Mt.hidden=!0),B.hpt&&(V[B.r]=Mt,Mt.hpt=B.hpt,Mt.hpx=Ao(B.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||xi(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[se]]=B;break;case 161:s["!margins"]||xi(s["!margins"]={}),s["!margins"].header=B.header,s["!margins"].footer=B.footer;break;case 574:B.RTL&&(_.Views[0].RTL=!0);break;case 146:w=B;break;case 2198:L=B;break;case 140:N=B;break;case 442:d?S.CodeName=B||S.name:_.WBProps.CodeName=B||"ThisWorkbook";break}}else G||console.error("Missing Info for XLS Record 0x"+se.toString(16)),e.l+=M}return r.SheetNames=ur(i).sort(function(Ma,rt){return Number(Ma)-Number(rt)}).map(function(Ma){return i[Ma].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&W.forEach(function(Ma,rt){r.Sheets[r.SheetNames[rt]]["!autofilter"]=Ma}),r.Strings=c,r.SSF=zt(Be),P.enc&&(r.Encryption=P.enc),L&&(r.Themes=L),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),U.names.length>0&&(_.Names=U.names),r.Workbook=_,r}var sc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function DW(e,t,r){var a=Fe.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=Pj(a,Eg,sc.DSI);for(var i in s)t[i]=s[i]}catch(d){if(r.WTF)throw d}var o=Fe.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=Pj(o,Tg,sc.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(KT(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function RW(e,t){var r=[],a=[],s=[],i=0,o,l=oj(Eg,"n"),c=oj(Tg,"n");if(e.Props)for(o=ur(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?a:s).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=ur(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?a:s).push([o[i],e.Custprops[o[i]]]);var d=[];for(i=0;i<s.length;++i)t5.indexOf(s[i][0])>-1||GT.indexOf(s[i][0])>-1||s[i][1]!=null&&d.push(s[i]);a.length&&Fe.utils.cfb_add(t,"/SummaryInformation",Oj(a,sc.SI,c,Tg)),(r.length||d.length)&&Fe.utils.cfb_add(t,"/DocumentSummaryInformation",Oj(r,sc.DSI,l,Eg,d.length?d:null,sc.UDI))}function Y5(e,t){t||(t={}),Kv(t),xv(),t.codepage&&mv(t.codepage);var r,a;if(e.FullPaths){if(Fe.find(e,"/encryption"))throw new Error("File is password-protected");r=Fe.find(e,"!CompObj"),a=Fe.find(e,"/Workbook")||Fe.find(e,"/Book")}else{switch(t.type){case"base64":e=Aa(Ra(e));break;case"binary":e=Aa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}qr(e,0),a={content:e}}var s,i;if(r&&PW(r),t.bookProps&&!t.bookSheets)s={};else{var o=nt?"buffer":"array";if(a&&a.content)s=FW(a.content,t);else if((i=Fe.find(e,"PerfectOffice_MAIN"))&&i.content)s=mi.to_workbook(i.content,(t.type=o,t));else if((i=Fe.find(e,"NativeContent_MAIN"))&&i.content)s=mi.to_workbook(i.content,(t.type=o,t));else throw(i=Fe.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Fe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=X7(e))}var l={};return e.FullPaths&&DW(e,l,t),s.Props=s.Custprops=l,t.bookFiles&&(s.cfb=e),s}function MW(e,t){var r=t||{},a=Fe.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Fe.utils.cfb_add(a,s,J5(e,r)),r.biff==8&&(e.Props||e.Custprops)&&RW(e,a),r.biff==8&&e.vbaraw&&Y7(a,Fe.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Tc={0:{f:oU},1:{f:xU},2:{f:FU},3:{f:NU},4:{f:vU},5:{f:PU},6:{f:$U},7:{f:EU},8:{f:VU},9:{f:zU},10:{f:WU},11:{f:HU},12:{f:gU},13:{f:RU},14:{f:SU},15:{f:jU},16:{f:q5},17:{f:UU},18:{f:AU},19:{f:Av},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Uq},40:{},42:{},43:{f:$$},44:{f:M$},45:{f:q$},46:{f:H$},47:{f:W$},48:{},49:{f:dR},50:{},51:{f:_7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:f5},62:{f:LU},63:{f:I7},64:{f:lq},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ta,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:nq},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:hU},148:{f:dU,p:16},151:{f:QU},152:{},153:{f:Lq},154:{},155:{},156:{f:Rq},157:{},158:{},159:{T:1,f:e$},160:{T:-1},161:{T:1,f:Li},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:GU},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:w7},336:{T:-1},337:{f:E7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:kg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:u5},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ZU},427:{f:eq},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:rq},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:fU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:YU},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:kg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:H7},633:{T:1},634:{T:-1},635:{T:1,f:q7},636:{T:-1},637:{f:mR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Sq},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:cq},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Fg={6:{f:th},10:{f:gs},12:{f:vr},13:{f:vr},14:{f:hr},15:{f:hr},16:{f:Zr},17:{f:hr},18:{f:hr},19:{f:vr},20:{f:Lj},21:{f:Lj},23:{f:u5},24:{f:Bj},25:{f:hr},26:{},27:{},28:{f:cL},29:{},34:{f:hr},35:{f:$j},38:{f:Zr},39:{f:Zr},40:{f:Zr},41:{f:Zr},42:{f:hr},43:{f:hr},47:{f:j$},49:{f:RM},51:{f:vr},60:{},61:{f:PM},64:{f:hr},65:{f:DM},66:{f:vr},77:{},80:{},81:{},82:{},85:{f:vr},89:{},90:{},91:{},92:{f:bM},93:{f:fL},94:{},95:{f:hr},96:{},97:{},99:{f:hr},125:{f:f5},128:{f:JM},129:{f:wM},130:{f:vr},131:{f:hr},132:{f:hr},133:{f:NM},134:{},140:{f:bL},141:{f:vr},144:{},146:{f:NL},151:{},152:{},153:{},154:{},155:{},156:{f:vr},157:{},158:{},160:{f:CL},161:{f:kL},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:GM},190:{f:KM},193:{f:gs},197:{},198:{},199:{},200:{},201:{},202:{f:hr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:vr},220:{},221:{f:hr},222:{},224:{f:YM},225:{f:vM},226:{f:gs},227:{},229:{f:dL},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:SM},253:{f:LM},255:{f:EM},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:r5},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:hr},353:{f:gs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:rL},431:{f:hr},432:{},433:{},434:{},437:{},438:{f:xL},439:{f:hr},440:{f:pL},441:{},442:{f:gd},443:{},444:{f:vr},445:{},446:{},448:{f:gs},449:{f:CM,r:2},450:{f:gs},512:{f:Dj},513:{f:AL},515:{f:eL},516:{f:BM},517:{f:Mj},519:{f:PL},520:{f:TM},523:{},545:{f:Uj},549:{f:Fj},566:{},574:{f:IM},638:{f:VM},659:{},1048:{},1054:{f:qM},1084:{},1212:{f:iL},2048:{f:yL},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Hd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:gs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:_L,r:12},2173:{f:b7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:hr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:sL,r:12},2197:{},2198:{f:m7,r:12},2199:{},2200:{},2201:{},2202:{f:oL,r:12},2203:{f:gs},2204:{},2205:{},2206:{},2207:{},2211:{f:AM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:vr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:EL},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:wL},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Dj},1:{},2:{f:RL},3:{f:FL},4:{f:IL},5:{f:Mj},7:{f:LL},8:{},9:{f:Hd},11:{},22:{f:vr},30:{f:HM},31:{},32:{},33:{f:Uj},36:{},37:{f:Fj},50:{f:$L},62:{},52:{},67:{},68:{f:vr},69:{},86:{},126:{},127:{f:OL},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:BL},223:{},234:{},354:{},421:{},518:{f:th},521:{f:Hd},536:{f:Bj},547:{f:$j},561:{},579:{},1030:{f:th},1033:{f:Hd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Se(e,t,r,a){var s=t;if(!isNaN(s)){var i=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&kv(r)&&e.push(r)}}function LW(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return Se(e,t,r,s);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<s;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function jd(e,t,r){return e||(e=ue(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function $W(e,t,r,a){var s=ue(9);return jd(s,e,t),a5(r,a||"b",s),s}function BW(e,t,r){var a=ue(8+2*r.length);return jd(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function UW(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Pr(Ht(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Se(e,2,ML(r,a,s)):Se(e,3,DL(r,a,s));return;case"b":case"e":Se(e,5,$W(r,a,t.v,t.t));return;case"s":case"str":Se(e,4,BW(r,a,(t.v||"").slice(0,255)));return}Se(e,1,jd(null,r,a))}function qW(e,t,r,a){var s=Array.isArray(t),i=gt(t["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Ze(i)}for(var d=i.s.r;d<=i.e.r;++d){l=xr(d);for(var u=i.s.c;u<=i.e.c;++u){d===i.s.r&&(c[u]=er(u)),o=c[u]+l;var f=s?(t[d]||[])[u]:t[o];f&&UW(e,f,d,u)}}}function WW(e,t){for(var r=t||{},a=va(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Se(a,r.biff==4?1033:r.biff==3?521:9,Rv(e,16,r)),qW(a,e.Sheets[e.SheetNames[s]],s,r),Se(a,10),a.end()}function HW(e,t,r){Se(e,49,MM({sz:12,name:"Arial"},r))}function zW(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&Se(e,1054,WM(s,t[s],r))})}function VW(e,t){var r=ue(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Se(e,2151,r),r=ue(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),l5(gt(t["!ref"]||"A1"),r),r.write_shift(4,4),Se(e,2152,r)}function GW(e,t){for(var r=0;r<16;++r)Se(e,224,Rj({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Se(e,224,Rj(a,0,t))})}function KW(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Se(e,440,gL(a)),a[1].Tooltip&&Se(e,2048,vL(a))}delete t["!links"]}function XW(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&Se(e,125,SL(Qf(s,a),s))})}}function YW(e,t,r,a,s){var i=16+Bs(s.cellXfs,t,s);if(t.v==null&&!t.bf){Se(e,513,Si(r,a,i));return}if(t.bf)Se(e,6,w9(t,r,a,s,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?Pr(Ht(t.v)):t.v;Se(e,515,tL(r,a,o,i));break;case"b":case"e":Se(e,517,ZM(r,a,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var l=Hv(s.Strings,t.v,s.revStrings);Se(e,253,$M(r,a,l,i))}else Se(e,516,UM(r,a,(t.v||"").slice(0,255),i,s));break;default:Se(e,513,Si(r,a,i))}}function JW(e,t,r){var a=va(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),d=t.biff==8,u,f="",x=[],p=gt(i["!ref"]||"A1"),h=d?65536:16384;if(p.e.c>255||p.e.r>=h){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,h-1)}Se(a,2057,Rv(r,16,t)),Se(a,13,Va(1)),Se(a,12,Va(100)),Se(a,15,oa(!0)),Se(a,17,oa(!1)),Se(a,16,Ni(.001)),Se(a,95,oa(!0)),Se(a,42,oa(!1)),Se(a,43,oa(!1)),Se(a,130,Va(1)),Se(a,128,QM()),Se(a,131,oa(!1)),Se(a,132,oa(!1)),d&&XW(a,i["!cols"]),Se(a,512,zM(p,t)),d&&(i["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){f=xr(m);for(var g=p.s.c;g<=p.e.c;++g){m===p.s.r&&(x[g]=er(g)),u=x[g]+f;var v=c?(i[m]||[])[g]:i[u];v&&(YW(a,v,m,g,t),d&&v.l&&i["!links"].push([u,v.l]))}}var b=l.CodeName||l.name||s;return d&&Se(a,574,FM((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&Se(a,229,uL(i["!merges"])),d&&KW(a,i),Se(a,442,n5(b)),d&&VW(a,i),Se(a,10),a.end()}function QW(e,t,r){var a=va(),s=(e||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(Se(a,2057,Rv(e,5,r)),r.bookType=="xla"&&Se(a,135),Se(a,225,l?Va(1200):null),Se(a,193,ZR(2)),c&&Se(a,191),c&&Se(a,192),Se(a,226),Se(a,92,jM("SheetJS",r)),Se(a,66,Va(l?1200:1252)),l&&Se(a,353,Va(0)),l&&Se(a,448),Se(a,317,TL(e.SheetNames.length)),l&&e.vbaraw&&Se(a,211),l&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";Se(a,442,n5(d))}Se(a,156,Va(17)),Se(a,25,oa(!1)),Se(a,18,oa(!1)),Se(a,19,Va(0)),l&&Se(a,431,oa(!1)),l&&Se(a,444,Va(0)),Se(a,61,OM()),Se(a,64,oa(!1)),Se(a,141,Va(0)),Se(a,34,oa(Cq(e)=="true")),Se(a,14,oa(!0)),l&&Se(a,439,oa(!1)),Se(a,218,Va(0)),HW(a,e,r),zW(a,e.SSF,r),GW(a,r),l&&Se(a,352,oa(!1));var u=a.end(),f=va();l&&Se(f,140,jL()),l&&r.Strings&&LW(f,252,kM(r.Strings)),Se(f,10);var x=f.end(),p=va(),h=0,m=0;for(m=0;m<e.SheetNames.length;++m)h+=(l?12:11)+(l?2:1)*e.SheetNames[m].length;var g=u.length+h+x.length;for(m=0;m<e.SheetNames.length;++m){var v=i[m]||{};Se(p,133,_M({pos:g,hs:v.Hidden||0,dt:0,name:e.SheetNames[m]},r)),g+=t[m].length}var b=p.end();if(h!=b.length)throw new Error("BS8 "+h+" != "+b.length);var y=[];return u.length&&y.push(u),b.length&&y.push(b),x.length&&y.push(x),Rr(y)}function ZW(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=zt(Be)),e&&e.SSF&&(cl(),zf(e.SSF),r.revssf=Gf(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Xv(r),r.cellXfs=[],Bs(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=JW(s,r,e);return a.unshift(QW(e,a,r)),Rr(a)}function J5(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=wa(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return ZW(e,t);case 4:case 3:case 2:return WW(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Jj(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=s.index,l=i&&i.index||e.length,c=MD(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,u=0,f=0,x=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},h=[];for(o=0;o<c.length;++o){var m=c[o].trim(),g=m.slice(0,3).toLowerCase();if(g=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var v=m.split(/<\/t[dh]>/i);for(l=0;l<v.length;++l){var b=v[l].trim();if(b.match(/<t[dh]/i)){for(var y=b,N=0;y.charAt(0)=="<"&&(N=y.indexOf(">"))>-1;)y=y.slice(N+1);for(var j=0;j<h.length;++j){var w=h[j];w.s.c==u&&w.s.r<d&&d<=w.e.r&&(u=w.e.c+1,j=-1)}var _=ze(b.slice(0,b.indexOf(">")));x=_.colspan?+_.colspan:1,((f=+_.rowspan)>1||x>1)&&h.push({s:{r:d,c:u},e:{r:d+(f||1)-1,c:u+x-1}});var S=_.t||_["data-t"]||"";if(!y.length){u+=x;continue}if(y=jT(y),p.s.r>d&&(p.s.r=d),p.e.r<d&&(p.e.r=d),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!y.length){u+=x;continue}var k={t:"s",v:y};r.raw||!y.trim().length||S=="s"||(y==="TRUE"?k={t:"b",v:!0}:y==="FALSE"?k={t:"b",v:!1}:isNaN(mn(y))?isNaN(Eo(y).getDate())||(k={t:"d",v:Ht(y)},r.cellDates||(k={t:"n",v:Pr(k.v)}),k.z=r.dateNF||Be[14]):k={t:"n",v:mn(y)}),r.dense?(a[d]||(a[d]=[]),a[d][u]=k):a[Ue({r:d,c:u})]=k,u+=x}}}}return a["!ref"]=Ze(p),h.length&&(a["!merges"]=h),a}function eH(e,t,r,a){for(var s=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>o)&&!(s[d].e.r<r||s[d].e.c<o)){if(s[d].s.r<r||s[d].s.c<o){l=-1;break}l=s[d].e.r-s[d].s.r+1,c=s[d].e.c-s[d].s.c+1;break}if(!(l<0)){var u=Ue({r,c:o}),f=a.dense?(e[r]||[])[o]:e[u],x=f&&f.v!=null&&(f.h||Nv(f.w||(as(f),f.w)||""))||"",p={};l>1&&(p.rowspan=l),c>1&&(p.colspan=c),a.editable?x='<span contenteditable="true">'+x+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+f.l.Target+'">'+x+"</a>")),p.id=(a.id||"sjs")+"-"+u,i.push(Ne("td",x,p))}}var h="<tr>";return h+i.join("")+"</tr>"}var tH='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',rH="</body></html>";function aH(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return $s(Jj(r[0],t),t);var a=Qv();return r.forEach(function(s,i){Zv(a,Jj(s,t),"Sheet"+(i+1))}),a}function nH(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Q5(e,t){var r=t||{},a=r.header!=null?r.header:tH,s=r.footer!=null?r.footer:rH,i=[a],o=wa(e["!ref"]);r.dense=Array.isArray(e),i.push(nH(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(eH(e,o,l,r));return i.push("</table>"+s),i.join("")}function Z5(e,t,r){var a=r||{},s=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var o=typeof a.origin=="string"?tr(a.origin):a.origin;s=o.r,i=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var u=wa(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),s==-1&&(d.e.r=s=u.e.r+1)}var f=[],x=0,p=e["!rows"]||(e["!rows"]=[]),h=0,m=0,g=0,v=0,b=0,y=0;for(e["!cols"]||(e["!cols"]=[]);h<l.length&&m<c;++h){var N=l[h];if(Qj(N)){if(a.display)continue;p[m]={hidden:!0}}var j=N.children;for(g=v=0;g<j.length;++g){var w=j[g];if(!(a.display&&Qj(w))){var _=w.hasAttribute("data-v")?w.getAttribute("data-v"):w.hasAttribute("v")?w.getAttribute("v"):jT(w.innerHTML),S=w.getAttribute("data-z")||w.getAttribute("z");for(x=0;x<f.length;++x){var k=f[x];k.s.c==v+i&&k.s.r<m+s&&m+s<=k.e.r&&(v=k.e.c+1-i,x=-1)}y=+w.getAttribute("colspan")||1,((b=+w.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:m+s,c:v+i},e:{r:m+s+(b||1)-1,c:v+i+(y||1)-1}});var E={t:"s",v:_},A=w.getAttribute("data-t")||w.getAttribute("t")||"";_!=null&&(_.length==0?E.t=A||"z":a.raw||_.trim().length==0||A=="s"||(_==="TRUE"?E={t:"b",v:!0}:_==="FALSE"?E={t:"b",v:!1}:isNaN(mn(_))?isNaN(Eo(_).getDate())||(E={t:"d",v:Ht(_)},a.cellDates||(E={t:"n",v:Pr(E.v)}),E.z=a.dateNF||Be[14]):E={t:"n",v:mn(_)})),E.z===void 0&&S!=null&&(E.z=S);var P="",L=w.getElementsByTagName("A");if(L&&L.length)for(var R=0;R<L.length&&!(L[R].hasAttribute("href")&&(P=L[R].getAttribute("href"),P.charAt(0)!="#"));++R);P&&P.charAt(0)!="#"&&(E.l={Target:P}),a.dense?(e[m+s]||(e[m+s]=[]),e[m+s][v+i]=E):e[Ue({c:v+i,r:m+s})]=E,d.e.c<v+i&&(d.e.c=v+i),v+=y}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),d.e.r=Math.max(d.e.r,m-1+s),e["!ref"]=Ze(d),m>=c&&(e["!fullref"]=Ze((d.e.r=l.length-h+m-1+s,d))),e}function e6(e,t){var r=t||{},a=r.dense?[]:{};return Z5(a,e,t)}function sH(e,t){return $s(e6(e,t),t)}function Qj(e){var t="",r=iH(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function iH(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function oH(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=mt(t.replace(/<[^>]*>/g,""));return[r]}var Zj={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function t6(e,t){var r=t||{},a=_v(e),s=[],i,o,l={name:""},c="",d=0,u,f,x={},p=[],h=r.dense?[]:{},m,g,v={value:""},b="",y=0,N=[],j=-1,w=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,k={},E=[],A={},P=0,L=0,R=[],I=1,D=1,V=[],F={Names:[]},U={},q=["",""],K=[],T={},O="",W=0,z=!1,te=!1,ae=0;for(wc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=wc.exec(a);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"工作表":m[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?h["!ref"]=Ze(_):h["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(h["!fullref"]=h["!ref"],_.e.r=r.sheetRows-1,h["!ref"]=Ze(_)),E.length&&(h["!merges"]=E),R.length&&(h["!rows"]=R),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),x[u.name]=h,te=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=ze(m[0],!1),j=w=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,h=r.dense?[]:{},E=[],R=[],te=!0);break;case"table-row-group":m[1]==="/"?--S:++S;break;case"table-row":case"行":if(m[1]==="/"){j+=I,I=1;break}if(f=ze(m[0],!1),f.行号?j=f.行号-1:j==-1&&(j=0),I=+f["number-rows-repeated"]||1,I<10)for(ae=0;ae<I;++ae)S>0&&(R[j+ae]={level:S});w=-1;break;case"covered-table-cell":m[1]!=="/"&&++w,r.sheetStubs&&(r.dense?(h[j]||(h[j]=[]),h[j][w]={t:"z"}):h[Ue({r:j,c:w})]={t:"z"}),b="",N=[];break;case"table-cell":case"数据":if(m[0].charAt(m[0].length-2)==="/")++w,v=ze(m[0],!1),D=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(g.f=Kj(mt(v.formula))),(v.数据类型||v["value-type"])=="string"&&(g.t="s",g.v=mt(v["string-value"]||""),r.dense?(h[j]||(h[j]=[]),h[j][w]=g):h[Ue({r:j,c:w})]=g),w+=D-1;else if(m[1]!=="/"){++w,b="",y=0,N=[],D=1;var se=I?j+I-1:j;if(w>_.e.c&&(_.e.c=w),w<_.s.c&&(_.s.c=w),j<_.s.r&&(_.s.r=j),se>_.e.r&&(_.e.r=se),v=ze(m[0],!1),K=[],T={},g={t:v.数据类型||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=mt(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(P=parseInt(v["number-matrix-rows-spanned"],10)||0,L=parseInt(v["number-matrix-columns-spanned"],10)||0,A={s:{r:j,c:w},e:{r:j+P-1,c:w+L-1}},g.F=Ze(A),V.push([A,g.F])),v.formula)g.f=Kj(v.formula);else for(ae=0;ae<V.length;++ae)j>=V[ae][0].s.r&&j<=V[ae][0].e.r&&w>=V[ae][0].s.c&&w<=V[ae][0].e.c&&(g.F=V[ae][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(P=parseInt(v["number-rows-spanned"],10)||0,L=parseInt(v["number-columns-spanned"],10)||0,A={s:{r:j,c:w},e:{r:j+P-1,c:w+L-1}},E.push(A)),v["number-columns-repeated"]&&(D=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Wt(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=Ht(v["date-value"]),r.cellDates||(g.t="n",g.v=Pr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=FD(v["time-value"])/86400,r.cellDates&&(g.t="d",g.v=Kf(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.数据数值);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(b=mt(v["string-value"]),N=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(z=!1,g.t==="s"&&(g.v=b||"",N.length&&(g.R=N),z=y==0),U.Target&&(g.l=U),K.length>0&&(g.c=K,K=[]),b&&r.cellText!==!1&&(g.w=b),z&&(g.t="z",delete g.v),(!z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var M=0;M<I;++M){if(D=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(h[j+M]||(h[j+M]=[]),h[j+M][w]=M==0?g:zt(g);--D>0;)h[j+M][w+D]=zt(g);else for(h[Ue({r:j+M,c:w})]=g;--D>0;)h[Ue({r:j+M,c:w+D})]=zt(g);_.e.c<=w&&(_.e.c=w)}D=parseInt(v["number-columns-repeated"]||"1",10),w+=D-1,D=0,g={},b="",N=[]}U={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i;T.t=b,N.length&&(T.R=N),T.a=O,K.push(T)}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);O="",W=0,b="",y=0,N=[];break;case"creator":m[1]==="/"?O=a.slice(W,m.index):W=m.index+m[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);b="",y=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(k[l.name]=c,(i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&(c="",l=ze(m[0],!1),s.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=ze(m[0],!1),c+=Zj[m[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=ze(m[0],!1),c+=Zj[m[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(d,m.index);break}else d=m.index+m[0].length;break;case"named-range":o=ze(m[0],!1),q=rh(o["cell-range-address"]);var G={Name:o.name,Ref:q[0]+"!"+q[1]};te&&(G.Sheet=p.length),F.Names.push(G);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(m[1]==="/"&&(!v||!v["string-value"])){var ne=oH(a.slice(y,m.index));b=(b.length>0?b+`
`:"")+ne[0]}else ze(m[0],!1),y=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{q=rh(ze(m[0])["target-range-address"]),x[q[0]]["!autofilter"]={ref:q[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(U=ze(m[0],!1),!U.href)break;U.Target=mt(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(q=rh(U.Target.slice(1)),U.Target="#"+q[0]+"!"+q[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(m)}}var B={Sheets:x,SheetNames:p,Workbook:F};return r.bookSheets&&delete B.Sheets,B}function ew(e,t){t=t||{},za(e,"META-INF/manifest.xml")&&FR(yr(e,"META-INF/manifest.xml"),t);var r=Ca(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=t6(It(r),t);return za(e,"meta.xml")&&(a.Props=zT(yr(e,"meta.xml"))),a}function tw(e,t){return t6(e,t)}var lH=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+jc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return pr+t}})(),rw=(function(){var e=function(i){return At(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,o,l){var c=[];c.push('      <table:table table:name="'+At(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,u=0,f=wa(i["!ref"]||"A1"),x=i["!merges"]||[],p=0,h=Array.isArray(i);if(i["!cols"])for(u=0;u<=f.e.c;++u)c.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var m="",g=i["!rows"]||[];for(d=0;d<f.s.r;++d)m=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;d<=f.e.r;++d){for(m=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+m+`>
`),u=0;u<f.s.c;++u)c.push(t);for(;u<=f.e.c;++u){var v=!1,b={},y="";for(p=0;p!=x.length;++p)if(!(x[p].s.c>u)&&!(x[p].s.r>d)&&!(x[p].e.c<u)&&!(x[p].e.r<d)){(x[p].s.c!=u||x[p].s.r!=d)&&(v=!0),b["table:number-columns-spanned"]=x[p].e.c-x[p].s.c+1,b["table:number-rows-spanned"]=x[p].e.r-x[p].s.r+1;break}if(v){c.push(r);continue}var N=Ue({r:d,c:u}),j=h?(i[d]||[])[u]:i[N];if(j&&j.f&&(b["table:formula"]=At(T9(j.f)),j.F&&j.F.slice(0,N.length)==N)){var w=wa(j.F);b["table:number-matrix-columns-spanned"]=w.e.c-w.s.c+1,b["table:number-matrix-rows-spanned"]=w.e.r-w.s.r+1}if(!j){c.push(t);continue}switch(j.t){case"b":y=j.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=j.v?"true":"false";break;case"n":y=j.w||String(j.v||0),b["office:value-type"]="float",b["office:value"]=j.v||0;break;case"s":case"str":y=j.v==null?"":j.v,b["office:value-type"]="string";break;case"d":y=j.w||Ht(j.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Ht(j.v).toISOString(),b["table:style-name"]="ce1";break;default:c.push(t);continue}var _=e(y);if(j.l&&j.l.Target){var S=j.l.Target;S=S.charAt(0)=="#"?"#"+A9(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),_=Ne("text:a",_,{"xlink:href":S.replace(/&/g,"&amp;")})}c.push("          "+Ne("table:table-cell",Ne("text:p",_,{}),b)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var f=d["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Is(f),f.ods=l;var x=d["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var f=d["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[pr],d=jc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=jc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push(HT().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(a(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function r6(e,t){if(t.bookType=="fods")return rw(e,t);var r=bv(),a="",s=[],i=[];return a="mimetype",et(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",et(r,a,rw(e,t)),s.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",et(r,a,lH(e,t)),s.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",et(r,a,pr+HT()),s.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",et(r,a,MR(i)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",et(r,a,DR(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ki(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Dg(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):It(Ls(e))}function cH(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Aa(_n(e))}function dH(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Ds(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function aw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function uH(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function fH(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function Ac(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function kt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function dr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function vt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=Ac(e,r),i=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Ac(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var d={data:l,type:i};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function Br(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(kt(a*8+s.type)),s.type==2&&t.push(kt(s.data.length)),t.push(s.data))})}),Ds(t)}function Gv(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Wa(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=Ac(e,a),i=vt(e.slice(a[0],a[0]+s));a[0]+=s;var o={id:dr(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=vt(l.data),d=dr(c[3][0].data);o.messages.push({meta:c,data:e.slice(a[0],a[0]+d)}),a[0]+=d}),(t=i[3])!=null&&t[0]&&(o.merge=dr(i[3][0].data)>>>0>0),r.push(o)}return r}function Qi(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:kt(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:kt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:kt(o.data.length)}],a[2].push({data:Br(o.meta),type:2})});var i=Br(a);t.push(kt(i.length)),t.push(i),s.forEach(function(o){return t.push(o)})}),Ds(t)}function hH(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Ac(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Ds(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(s.push(s[0].slice(-c)),d-=c;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-c,-c+d))}}var u=Ds(s);if(u.length!=a)throw new Error("Unexpected length: ".concat(u.length," != ").concat(a));return u}function Ha(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(hH(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ds(t)}function Zi(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=kt(a),o=i.length;t.push(i),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=a}return Ds(t)}function mH(e,t,r,a){var s=ki(e),i=s.getUint32(4,!0),o=(a>1?12:8)+aw(i&(a>1?3470:398))*4,l=-1,c=-1,d=NaN,u=new Date(2001,0,1);i&512&&(l=s.getUint32(o,!0),o+=4),o+=aw(i&(a>1?12288:4096))*4,i&16&&(c=s.getUint32(o,!0),o+=4),i&32&&(d=s.getFloat64(o,!0),o+=8),i&64&&(u.setTime(u.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:d};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(d))f={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function xH(e,t,r){var a=ki(e),s=a.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,d=NaN,u=new Date(2001,0,1);s&1&&(c=uH(e,i),i+=16),s&2&&(d=a.getFloat64(i,!0),i+=8),s&4&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8),s&8&&(l=a.getUint32(i,!0),i+=4),s&16&&(o=a.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function nh(e,t){var r=new Uint8Array(32),a=ki(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,fH(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,s)}function sh(e,t){var r=new Uint8Array(32),a=ki(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,s)}function pH(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return mH(e,t,r,e[0]);case 5:return xH(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Xr(e){var t=vt(e);return Ac(t[1][0].data)}function nw(e,t){var r=vt(t.data),a=dr(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(o){var l=vt(o.data),c=dr(l[1][0].data)>>>0;switch(a){case 1:i[c]=Dg(l[3][0].data);break;case 8:{var d=e[Xr(l[9][0].data)][0],u=vt(d.data),f=e[Xr(u[1][0].data)][0],x=dr(f.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var p=vt(f.data);i[c]=p[3].map(function(h){return Dg(h.data)}).join("")}break}}),i}function gH(e,t){var r,a,s,i,o,l,c,d,u,f,x,p,h,m,g=vt(e),v=dr(g[1][0].data)>>>0,b=dr(g[2][0].data)>>>0,y=((a=(r=g[8])==null?void 0:r[0])==null?void 0:a.data)&&dr(g[8][0].data)>0||!1,N,j;if((i=(s=g[7])==null?void 0:s[0])!=null&&i.data&&t!=0)N=(l=(o=g[7])==null?void 0:o[0])==null?void 0:l.data,j=(d=(c=g[6])==null?void 0:c[0])==null?void 0:d.data;else if((f=(u=g[4])==null?void 0:u[0])!=null&&f.data&&t!=1)N=(p=(x=g[4])==null?void 0:x[0])==null?void 0:p.data,j=(m=(h=g[3])==null?void 0:h[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var w=y?4:1,_=ki(N),S=[],k=0;k<N.length/2;++k){var E=_.getUint16(k*2,!0);E<65535&&S.push([k,E])}if(S.length!=b)throw"Expected ".concat(b," cells, found ").concat(S.length);var A=[];for(k=0;k<S.length-1;++k)A[S[k][0]]=j.subarray(S[k][1]*w,S[k+1][1]*w);return S.length>=1&&(A[S[S.length-1][0]]=j.subarray(S[S.length-1][1]*w)),{R:v,cells:A}}function yH(e,t){var r,a=vt(t.data),s=(r=a==null?void 0:a[7])!=null&&r[0]?dr(a[7][0].data)>>>0>0?1:0:-1,i=Gv(a[5],function(o){return gH(o,s)});return{nrows:dr(a[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,d){if(o[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));o[l.R][d]=c}),o},[])}}function vH(e,t,r){var a,s=vt(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(dr(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(dr(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Ze(i);var o=vt(s[4][0].data),l=nw(e,e[Xr(o[4][0].data)][0]),c=(a=o[17])!=null&&a[0]?nw(e,e[Xr(o[17][0].data)][0]):[],d=vt(o[3][0].data),u=0;d[1].forEach(function(f){var x=vt(f.data),p=e[Xr(x[2][0].data)][0],h=dr(p.meta[1][0].data);if(h!=6002)throw new Error("6001 unexpected reference to ".concat(h));var m=yH(e,p);m.data.forEach(function(g,v){g.forEach(function(b,y){var N=Ue({r:u+v,c:y}),j=pH(b,l,c);j&&(r[N]=j)})}),u+=m.nrows})}function bH(e,t){var r=vt(t.data),a={"!ref":"A1"},s=e[Xr(r[2][0].data)],i=dr(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return vH(e,s[0],a),a}function jH(e,t){var r,a=vt(t.data),s={name:(r=a[1])!=null&&r[0]?Dg(a[1][0].data):"",sheets:[]},i=Gv(a[2],Xr);return i.forEach(function(o){e[o].forEach(function(l){var c=dr(l.meta[1][0].data);c==6e3&&s.sheets.push(bH(e,l))})}),s}function wH(e,t){var r=Qv(),a=vt(t.data),s=Gv(a[1],Xr);if(s.forEach(function(i){e[i].forEach(function(o){var l=dr(o.meta[1][0].data);if(l==2){var c=jH(e,o);c.sheets.forEach(function(d,u){Zv(r,d,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ih(e){var t,r,a,s,i={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=Ha(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var u;try{u=Wa(d)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(a=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&dr(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(d){var u=dr(d.meta[1][0].data)>>>0;if(u==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return wH(i,l)}function NH(e,t,r){var a,s,i,o;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&dr(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=ki(e[7][0].data),u=0,f=[],x=ki(e[4][0].data),p=0,h=[],m=0;m<t.length;++m){if(t[m]==null){d.setUint16(m*2,65535,!0),x.setUint16(m*2,65535);continue}d.setUint16(m*2,u,!0),x.setUint16(m*2,p,!0);var g,v;switch(typeof t[m]){case"string":g=nh({t:"s",v:t[m]},r),v=sh({t:"s",v:t[m]},r);break;case"number":g=nh({t:"n",v:t[m]},r),v=sh({t:"n",v:t[m]},r);break;case"boolean":g=nh({t:"b",v:t[m]},r),v=sh({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}f.push(g),u+=g.length,h.push(v),p+=v.length,++c}for(e[2][0].data=kt(c);m<e[7][0].data.length/2;++m)d.setUint16(m*2,65535,!0),x.setUint16(m*2,65535,!0);return e[6][0].data=Ds(f),e[3][0].data=Ds(h),c}function _H(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=wa(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Ze(a)));var i=Du(r,{range:a,header:1}),o=["~Sh33tJ5~"];i.forEach(function(O){return O.forEach(function(W){typeof W=="string"&&o.push(W)})});var l={},c=[],d=Fe.read(t.numbers,{type:"base64"});d.FileIndex.map(function(O,W){return[O,d.FullPaths[W]]}).forEach(function(O){var W=O[0],z=O[1];if(W.type==2&&W.name.match(/\.iwa/)){var te=W.content,ae=Ha(te),se=Wa(ae);se.forEach(function(M){c.push(M.id),l[M.id]={deps:[],location:z,type:dr(M.messages[0].meta[1][0].data)}})}}),c.sort(function(O,W){return O-W});var u=c.filter(function(O){return O>1}).map(function(O){return[O,kt(O)]});d.FileIndex.map(function(O,W){return[O,d.FullPaths[W]]}).forEach(function(O){var W=O[0];if(O[1],!!W.name.match(/\.iwa/)){var z=Wa(Ha(W.content));z.forEach(function(te){te.messages.forEach(function(ae){u.forEach(function(se){te.messages.some(function(M){return dr(M.meta[1][0].data)!=11006&&dH(M.data,se[1])})&&l[se[0]].deps.push(te.id)})})})}});for(var f=Fe.find(d,l[1].location),x=Wa(Ha(f.content)),p,h=0;h<x.length;++h){var m=x[h];m.id==1&&(p=m)}var g=Xr(vt(p.messages[0].data)[1][0].data);for(f=Fe.find(d,l[g].location),x=Wa(Ha(f.content)),h=0;h<x.length;++h)m=x[h],m.id==g&&(p=m);for(g=Xr(vt(p.messages[0].data)[2][0].data),f=Fe.find(d,l[g].location),x=Wa(Ha(f.content)),h=0;h<x.length;++h)m=x[h],m.id==g&&(p=m);for(g=Xr(vt(p.messages[0].data)[2][0].data),f=Fe.find(d,l[g].location),x=Wa(Ha(f.content)),h=0;h<x.length;++h)m=x[h],m.id==g&&(p=m);var v=vt(p.messages[0].data);{v[6][0].data=kt(a.e.r+1),v[7][0].data=kt(a.e.c+1);var b=Xr(v[46][0].data),y=Fe.find(d,l[b].location),N=Wa(Ha(y.content));{for(var j=0;j<N.length&&N[j].id!=b;++j);if(N[j].id!=b)throw"Bad ColumnRowUIDMapArchive";var w=vt(N[j].messages[0].data);w[1]=[],w[2]=[],w[3]=[];for(var _=0;_<=a.e.c;++_){var S=[];S[1]=S[2]=[{type:0,data:kt(_+420690)}],w[1].push({type:2,data:Br(S)}),w[2].push({type:0,data:kt(_)}),w[3].push({type:0,data:kt(_)})}w[4]=[],w[5]=[],w[6]=[];for(var k=0;k<=a.e.r;++k)S=[],S[1]=S[2]=[{type:0,data:kt(k+726270)}],w[4].push({type:2,data:Br(S)}),w[5].push({type:0,data:kt(k)}),w[6].push({type:0,data:kt(k)});N[j].messages[0].data=Br(w)}y.content=Zi(Qi(N)),y.size=y.content.length,delete v[46];var E=vt(v[4][0].data);{E[7][0].data=kt(a.e.r+1);var A=vt(E[1][0].data),P=Xr(A[2][0].data);y=Fe.find(d,l[P].location),N=Wa(Ha(y.content));{if(N[0].id!=P)throw"Bad HeaderStorageBucket";var L=vt(N[0].messages[0].data);for(k=0;k<i.length;++k){var R=vt(L[2][0].data);R[1][0].data=kt(k),R[4][0].data=kt(i[k].length),L[2][k]={type:L[2][0].type,data:Br(R)}}N[0].messages[0].data=Br(L)}y.content=Zi(Qi(N)),y.size=y.content.length;var I=Xr(E[2][0].data);y=Fe.find(d,l[I].location),N=Wa(Ha(y.content));{if(N[0].id!=I)throw"Bad HeaderStorageBucket";for(L=vt(N[0].messages[0].data),_=0;_<=a.e.c;++_)R=vt(L[2][0].data),R[1][0].data=kt(_),R[4][0].data=kt(a.e.r+1),L[2][_]={type:L[2][0].type,data:Br(R)};N[0].messages[0].data=Br(L)}y.content=Zi(Qi(N)),y.size=y.content.length;var D=Xr(E[4][0].data);(function(){for(var O=Fe.find(d,l[D].location),W=Wa(Ha(O.content)),z,te=0;te<W.length;++te){var ae=W[te];ae.id==D&&(z=ae)}var se=vt(z.messages[0].data);{se[3]=[];var M=[];o.forEach(function(B,pe){M[1]=[{type:0,data:kt(pe)}],M[2]=[{type:0,data:kt(1)}],M[3]=[{type:2,data:cH(B)}],se[3].push({type:2,data:Br(M)})})}z.messages[0].data=Br(se);var G=Qi(W),ne=Zi(G);O.content=ne,O.size=O.content.length})();var V=vt(E[3][0].data);{var F=V[1][0];delete V[2];var U=vt(F.data);{var q=Xr(U[2][0].data);(function(){for(var O=Fe.find(d,l[q].location),W=Wa(Ha(O.content)),z,te=0;te<W.length;++te){var ae=W[te];ae.id==q&&(z=ae)}var se=vt(z.messages[0].data);{delete se[6],delete V[7];var M=new Uint8Array(se[5][0].data);se[5]=[];for(var G=0,ne=0;ne<=a.e.r;++ne){var B=vt(M);G+=NH(B,i[ne],o),B[1][0].data=kt(ne),se[5].push({data:Br(B),type:2})}se[1]=[{type:0,data:kt(a.e.c+1)}],se[2]=[{type:0,data:kt(a.e.r+1)}],se[3]=[{type:0,data:kt(G)}],se[4]=[{type:0,data:kt(a.e.r+1)}]}z.messages[0].data=Br(se);var pe=Qi(W),ye=Zi(pe);O.content=ye,O.size=O.content.length})()}F.data=Br(U)}E[3][0].data=Br(V)}v[4][0].data=Br(E)}p.messages[0].data=Br(v);var K=Qi(x),T=Zi(K);return f.content=T,f.size=f.content.length,d}function a6(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Kv(e){a6([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Xv(e){a6([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function SH(e){return it.WS.indexOf(e)>-1?"sheet":e==it.CS?"chart":e==it.DS?"dialog":e==it.MS?"macro":e&&e.length?e:"sheet"}function kH(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,SH(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function EH(e,t,r,a,s,i,o,l,c,d,u,f){try{i[a]=tc(Ca(e,r,!0),t);var x=yr(e,t),p;switch(l){case"sheet":p=Xq(x,t,s,c,i[a],d,u,f);break;case"chart":if(p=Yq(x,t,s,c,i[a],d,u,f),!p||!p["!drawel"])break;var h=Wl(p["!drawel"].Target,t),m=Nc(h),g=R7(Ca(e,h,!0),tc(Ca(e,m,!0),h)),v=Wl(g,h),b=Nc(v);p=Nq(Ca(e,v,!0),v,c,tc(Ca(e,b,!0),v),d,p);break;case"macro":p=Jq(x,t,s,c,i[a],d,u,f);break;case"dialog":p=Qq(x,t,s,c,i[a],d,u,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[a]=p;var y=[];i&&i[a]&&ur(i[a]).forEach(function(N){var j="";if(i[a][N].Type==it.CMNT){j=Wl(i[a][N].Target,t);var w=rW(yr(e,j,!0),j,c);if(!w||!w.length)return;Wj(p,w,!1)}i[a][N].Type==it.TCMNT&&(j=Wl(i[a][N].Target,t),y=y.concat(L7(yr(e,j,!0),c)))}),y&&y.length&&Wj(p,y,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function La(e){return e.charAt(0)=="/"?e.slice(1):e}function TH(e,t){if(cl(),t=t||{},Kv(t),za(e,"META-INF/manifest.xml")||za(e,"objectdata.xml"))return ew(e,t);if(za(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ih<"u"){if(e.FileIndex)return ih(e);var r=Fe.utils.cfb_new();return dj(e).forEach(function(R){et(r,R,$D(e,R))}),ih(r)}throw new Error("Unsupported NUMBERS file")}if(!za(e,"[Content_Types].xml"))throw za(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):za(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=dj(e),s=OR(Ca(e,"[Content_Types].xml")),i=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",yr(e,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!yr(e,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(rc=[],s.sst)try{rc=tW(yr(e,La(s.sst)),s.sst,t)}catch(R){if(t.WTF)throw R}t.cellStyles&&s.themes.length&&(c=eW(Ca(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=Zq(yr(e,La(s.style)),s.style,c,t))}s.links.map(function(R){try{var I=tc(Ca(e,Nc(La(R))),R);return nW(yr(e,La(R)),I,R,t)}catch{}});var u=Kq(yr(e,La(s.workbooks[0])),s.workbooks[0],t),f={},x="";s.coreprops.length&&(x=yr(e,La(s.coreprops[0]),!0),x&&(f=zT(x)),s.extprops.length!==0&&(x=yr(e,La(s.extprops[0]),!0),x&&$R(x,f,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(x=Ca(e,La(s.custprops[0]),!0),x&&(p=UR(x,t)));var h={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(I){return I.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(h.Props=f,h.Custprops=p),t.bookSheets&&typeof o<"u"&&(h.SheetNames=o),t.bookSheets?h.SheetNames:t.bookProps))return h;o={};var m={};t.bookDeps&&s.calcchain&&(m=aW(yr(e,La(s.calcchain)),s.calcchain));var g=0,v={},b,y;{var N=u.Sheets;f.Worksheets=N.length,f.SheetNames=[];for(var j=0;j!=N.length;++j)f.SheetNames[j]=N[j].name}var w=i?"bin":"xml",_=s.workbooks[0].lastIndexOf("/"),S=(s.workbooks[0].slice(0,_+1)+"_rels/"+s.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");za(e,S)||(S="xl/_rels/workbook."+w+".rels");var k=tc(Ca(e,S,!0),S.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=sW(yr(e,La(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=B7(yr(e,La(s.people[0])),t)),k&&(k=kH(k,u.Sheets));var E=yr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var A="sheet";if(k&&k[g]?(b="xl/"+k[g][1].replace(/[\/]?xl\//,""),za(e,b)||(b=k[g][1]),za(e,b)||(b=S.replace(/_rels\/.*$/,"")+k[g][1]),A=k[g][2]):(b="xl/worksheets/sheet"+(g+1-E)+"."+w,b=b.replace(/sheet0\./,"sheet.")),y=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,L=0;L!=t.sheets.length;++L)typeof t.sheets[L]=="number"&&t.sheets[L]==g&&(P=1),typeof t.sheets[L]=="string"&&t.sheets[L].toLowerCase()==f.SheetNames[g].toLowerCase()&&(P=1);if(!P)continue e}}EH(e,b,y,f.SheetNames[g],g,v,o,A,t,u,c,d)}return h={Directory:s,Workbook:u,Props:f,Custprops:p,Deps:m,Sheets:o,SheetNames:f.SheetNames,Strings:rc,Styles:d,Themes:c,SSF:zt(Be)},t&&t.bookFiles&&(e.files?(h.keys=a,h.files=e.files):(h.keys=[],h.files={},e.FullPaths.forEach(function(R,I){R=R.replace(/^Root Entry[\/]/,""),h.keys.push(R),h.files[R]=e.FileIndex[I]}))),t&&t.bookVBA&&(s.vba.length>0?h.vbaraw=yr(e,La(s.vba[0]),!0):s.defaults&&s.defaults.bin===K7&&(h.vbaraw=yr(e,"xl/vbaProject.bin",!0))),h}function AH(e,t){var r=t||{},a="Workbook",s=Fe.find(e,a);try{if(a="/!DataSpaces/Version",s=Fe.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(s$(s.content),a="/!DataSpaces/DataSpaceMap",s=Fe.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=o$(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Fe.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=l$(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Fe.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);d$(s.content)}catch{}if(a="/EncryptionInfo",s=Fe.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=u$(s.content);if(a="/EncryptedPackage",s=Fe.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function CH(e,t){return t.bookType=="ods"?r6(e,t):t.bookType=="numbers"?_H(e,t):t.bookType=="xlsb"?PH(e,t):OH(e,t)}function PH(e,t){so=1024,e&&!e.SSF&&(e.SSF=zt(Be)),e&&e.SSF&&(cl(),zf(e.SSF),t.revssf=Gf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ac?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=C5.indexOf(t.bookType)>-1,s=Fv();Xv(t=t||{});var i=bv(),o="",l=0;if(t.cellXfs=[],Bs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",et(i,o,VT(e.Props,t)),s.coreprops.push(o),Tt(t.rels,2,o,it.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,et(i,o,XT(e.Props)),s.extprops.push(o),Tt(t.rels,3,o,it.EXT_PROPS),e.Custprops!==e.Props&&ur(e.Custprops||{}).length>0&&(o="docProps/custom.xml",et(i,o,YT(e.Custprops)),s.custprops.push(o),Tt(t.rels,4,o,it.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],x=(f||{})["!type"]||"sheet";switch(x){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,et(i,o,oW(l-1,o,t,e,u)),s.sheets.push(o),Tt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,it.WS[0])}if(f){var p=f["!comments"],h=!1,m="";p&&p.length>0&&(m="xl/comments"+l+"."+r,et(i,m,dW(p,m)),s.comments.push(m),Tt(u,-1,"../comments"+l+"."+r,it.CMNT),h=!0),f["!legacy"]&&h&&et(i,"xl/drawings/vmlDrawing"+l+".vml",T5(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&et(i,Nc(o),ho(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,et(i,o,cW(t.Strings,o,t)),s.strs.push(o),Tt(t.wbrels,-1,"sharedStrings."+r,it.SST)),o="xl/workbook."+r,et(i,o,iW(e,o)),s.workbooks.push(o),Tt(t.rels,1,o,it.WB),o="xl/theme/theme1.xml",et(i,o,Bv(e.Themes,t)),s.themes.push(o),Tt(t.wbrels,-1,"theme/theme1.xml",it.THEME),o="xl/styles."+r,et(i,o,lW(e,o,t)),s.styles.push(o),Tt(t.wbrels,-1,"styles."+r,it.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",et(i,o,e.vbaraw),s.vba.push(o),Tt(t.wbrels,-1,"vbaProject.bin",it.VBA)),o="xl/metadata."+r,et(i,o,uW(o)),s.metadata.push(o),Tt(t.wbrels,-1,"metadata."+r,it.XLMETA),et(i,"[Content_Types].xml",WT(s,t)),et(i,"_rels/.rels",ho(t.rels)),et(i,"xl/_rels/workbook."+r+".rels",ho(t.wbrels)),delete t.revssf,delete t.ssf,i}function OH(e,t){so=1024,e&&!e.SSF&&(e.SSF=zt(Be)),e&&e.SSF&&(cl(),zf(e.SSF),t.revssf=Gf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ac?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=C5.indexOf(t.bookType)>-1,s=Fv();Xv(t=t||{});var i=bv(),o="",l=0;if(t.cellXfs=[],Bs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",et(i,o,VT(e.Props,t)),s.coreprops.push(o),Tt(t.rels,2,o,it.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,et(i,o,XT(e.Props)),s.extprops.push(o),Tt(t.rels,3,o,it.EXT_PROPS),e.Custprops!==e.Props&&ur(e.Custprops||{}).length>0&&(o="docProps/custom.xml",et(i,o,YT(e.Custprops)),s.custprops.push(o),Tt(t.rels,4,o,it.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},x=e.Sheets[e.SheetNames[l-1]],p=(x||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,et(i,o,U5(l-1,t,e,f)),s.sheets.push(o),Tt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,it.WS[0])}if(x){var h=x["!comments"],m=!1,g="";if(h&&h.length>0){var v=!1;h.forEach(function(b){b[1].forEach(function(y){y.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+l+"."+r,et(i,g,$7(h,u,t)),s.threadedcomments.push(g),Tt(f,-1,"../threadedComments/threadedComment"+l+"."+r,it.TCMNT)),g="xl/comments"+l+"."+r,et(i,g,A5(h)),s.comments.push(g),Tt(f,-1,"../comments"+l+"."+r,it.CMNT),m=!0}x["!legacy"]&&m&&et(i,"xl/drawings/vmlDrawing"+l+".vml",T5(l,x["!comments"])),delete x["!comments"],delete x["!legacy"]}f["!id"].rId1&&et(i,Nc(o),ho(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,et(i,o,p5(t.Strings,t)),s.strs.push(o),Tt(t.wbrels,-1,"sharedStrings."+r,it.SST)),o="xl/workbook."+r,et(i,o,V5(e)),s.workbooks.push(o),Tt(t.rels,1,o,it.WB),o="xl/theme/theme1.xml",et(i,o,Bv(e.Themes,t)),s.themes.push(o),Tt(t.wbrels,-1,"theme/theme1.xml",it.THEME),o="xl/styles."+r,et(i,o,_5(e,t)),s.styles.push(o),Tt(t.wbrels,-1,"styles."+r,it.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",et(i,o,e.vbaraw),s.vba.push(o),Tt(t.wbrels,-1,"vbaProject.bin",it.VBA)),o="xl/metadata."+r,et(i,o,E5()),s.metadata.push(o),Tt(t.wbrels,-1,"metadata."+r,it.XLMETA),u.length>1&&(o="xl/persons/person.xml",et(i,o,U7(u)),s.people.push(o),Tt(t.wbrels,-1,"persons/person.xml",it.PEOPLE)),et(i,"[Content_Types].xml",WT(s,t)),et(i,"_rels/.rels",ho(t.rels)),et(i,"xl/_rels/workbook."+r+".rels",ho(t.wbrels)),delete t.revssf,delete t.ssf,i}function Yv(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ra(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function IH(e,t){return Fe.find(e,"EncryptedPackage")?AH(e,t):Y5(e,t)}function FH(e,t){var r,a=e,s=t||{};return s.type||(s.type=nt&&Buffer.isBuffer(e)?"buffer":"base64"),r=yT(a,s),TH(r,s)}function n6(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ig(e.slice(r),t);default:break e}return To.to_workbook(e,t)}function DH(e,t){var r="",a=Yv(e,t);switch(t.type){case"base64":r=Ra(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=wi(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=It(r)),t.type="binary",n6(r,t)}function RH(e,t){var r=e;return t.type=="base64"&&(r=Ra(r)),r=gc.utils.decode(1200,r.slice(2),"str"),t.type="binary",n6(r,t)}function MH(e){return e.match(/[^\x00-\x7F]/)?_n(e):e}function oh(e,t,r,a){return a?(r.type="string",To.to_workbook(e,r)):To.to_workbook(t,r)}function Rg(e,t){xv();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Rg(new Uint8Array(e),(r=zt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),xo={},r.dateNF&&(xo.dateNF=r.dateNF),r.type||(r.type=nt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=nt?"buffer":"binary",a=PD(e),typeof Uint8Array<"u"&&!nt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=MH(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=zt(r),r.type="array",Rg(pv(a),r)}switch((s=Yv(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return IH(Fe.read(a,r),r);break;case 9:if(s[1]<=8)return Y5(a,r);break;case 60:return Ig(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return qL(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return m5.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?FH(a,r):oh(e,a,r,i);case 239:return s[3]===60?Ig(a,r):oh(e,a,r,i);case 255:if(s[1]===254)return RH(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return mi.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return mi.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Og.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return j5.to_workbook(a,r);break;case 10:case 13:case 32:return DH(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return UL.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Og.to_workbook(a,r):oh(e,a,r,i)}function s6(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return md(t.file,Fe.write(e,{type:nt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Fe.write(e,t)}function LH(e,t){var r=zt(t||{}),a=CH(e,r);return $H(a,r)}function $H(e,t){var r={},a=nt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Fe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Hf(s))}return t.password&&typeof encrypt_agile<"u"?s6(encrypt_agile(s,t.password),t):t.type==="file"?md(t.file,s):t.type=="string"?It(s):s}function BH(e,t){var r=t||{},a=MW(e,r);return s6(a,r)}function jn(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return yc(_n(a));case"binary":return _n(a);case"string":return e;case"file":return md(t.file,a,"utf8");case"buffer":return nt?ls(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):jn(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function UH(e,t){switch(t.type){case"base64":return yc(e);case"binary":return e;case"string":return e;case"file":return md(t.file,e,"binary");case"buffer":return nt?ls(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Kd(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?yc(r):t.type=="string"?It(r):r;case"file":return md(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function i6(e,t){xv(),Iq(e);var r=zt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=i6(e,r);return r.type="array",Hf(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return jn(CW(e,r),r);case"slk":case"sylk":return jn(h5.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return jn(Q5(e.Sheets[e.SheetNames[s]],r),r);case"txt":return UH(o6(e.Sheets[e.SheetNames[s]],r),r);case"csv":return jn(Jv(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return jn(m5.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Kd(Og.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return jn(To.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return jn(j5.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return jn(x5.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return jn(r6(e,r),r);case"wk1":return Kd(mi.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Kd(mi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Kd(J5(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),BH(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return LH(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function qH(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function wd(e,t,r){var a={};return a.type="file",a.file=t,qH(a),i6(e,a)}function WH(e,t,r,a,s,i,o,l){var c=xr(r),d=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,x=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!o||e[r])for(var p=t.s.c;p<=t.e.c;++p){var h=o?e[r][p]:e[a[p]+c];if(h===void 0||h.t===void 0){if(d===void 0)continue;i[p]!=null&&(x[i[p]]=d);continue}var m=h.v;switch(h.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+h.t)}if(i[p]!=null){if(m==null)if(h.t=="e"&&m===null)x[i[p]]=null;else if(d!==void 0)x[i[p]]=d;else if(u&&m===null)x[i[p]]=null;else continue;else x[i[p]]=u&&(h.t!=="n"||h.t==="n"&&l.rawNumbers!==!1)?m:as(h,m,l);m!=null&&(f=!1)}}return{row:x,isempty:f}}function Du(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof u){case"string":c=gt(u);break;case"number":c=gt(e["!ref"]),c.s.r=u;break;default:c=u}a>0&&(s=0);var f=xr(c.s.r),x=[],p=[],h=0,m=0,g=Array.isArray(e),v=c.s.r,b=0,y={};g&&!e[v]&&(e[v]=[]);var N=d.skipHidden&&e["!cols"]||[],j=d.skipHidden&&e["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(N[b]||{}).hidden)switch(x[b]=er(b),r=g?e[v][b]:e[x[b]+f],a){case 1:i[b]=b-c.s.c;break;case 2:i[b]=x[b];break;case 3:i[b]=d.header[b-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=as(r,null,d),m=y[o]||0,!m)y[o]=1;else{do l=o+"_"+m++;while(y[l]);y[o]=m,y[l]=1}i[b]=l}for(v=c.s.r+s;v<=c.e.r;++v)if(!(j[v]||{}).hidden){var w=WH(e,c,v,x,a,i,g,d);(w.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(p[h++]=w.row)}return p.length=h,p}var sw=/"/g;function HH(e,t,r,a,s,i,o,l){for(var c=!0,d=[],u="",f=xr(r),x=t.s.c;x<=t.e.c;++x)if(a[x]){var p=l.dense?(e[r]||[])[x]:e[a[x]+f];if(p==null)u="";else if(p.v!=null){c=!1,u=""+(l.rawNumbers&&p.t=="n"?p.v:as(p,null,l));for(var h=0,m=0;h!==u.length;++h)if((m=u.charCodeAt(h))===s||m===i||m===34||l.forceQuotes){u='"'+u.replace(sw,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(c=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(sw,'""')+'"')):u="";d.push(u)}return l.blankrows===!1&&c?null:d.join(o)}function Jv(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=gt(e["!ref"]),i=a.FS!==void 0?a.FS:",",o=i.charCodeAt(0),l=a.RS!==void 0?a.RS:`
`,c=l.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];a.dense=Array.isArray(e);for(var x=a.skipHidden&&e["!cols"]||[],p=a.skipHidden&&e["!rows"]||[],h=s.s.c;h<=s.e.c;++h)(x[h]||{}).hidden||(f[h]=er(h));for(var m=0,g=s.s.r;g<=s.e.r;++g)(p[g]||{}).hidden||(u=HH(e,s,g,f,o,c,i,a),u!=null&&(a.strip&&(u=u.replace(d,"")),(u||a.blankrows!==!1)&&r.push((m++?l:"")+u)));return delete a.dense,r.join("")}function o6(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Jv(e,t);return r}function zH(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=gt(e["!ref"]),i="",o=[],l,c=[],d=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)o[l]=er(l);for(var u=s.s.r;u<=s.e.r;++u)for(i=xr(u),l=s.s.c;l<=s.e.c;++l)if(t=o[l]+i,r=d?(e[u]||[])[l]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function l6(e,t,r){var a=r||{},s=+!a.skipHeader,i=e||{},o=0,l=0;if(i&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?tr(a.origin):a.origin;o=c.r,l=c.c}var d,u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var f=gt(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(o=f.e.r+1,u.e.r=o+t.length-1+s)}else o==-1&&(o=0,u.e.r=t.length-1+s);var x=a.header||[],p=0;t.forEach(function(m,g){ur(m).forEach(function(v){(p=x.indexOf(v))==-1&&(x[p=x.length]=v);var b=m[v],y="z",N="",j=Ue({c:l+p,r:o+g+s});d=Cc(i,j),b&&typeof b=="object"&&!(b instanceof Date)?i[j]=b:(typeof b=="number"?y="n":typeof b=="boolean"?y="b":typeof b=="string"?y="s":b instanceof Date?(y="d",a.cellDates||(y="n",b=Pr(b)),N=a.dateNF||Be[14]):b===null&&a.nullError&&(y="e",b=0),d?(d.t=y,d.v=b,delete d.w,delete d.R,N&&(d.z=N)):i[j]=d={t:y,v:b},N&&(d.z=N))})}),u.e.c=Math.max(u.e.c,l+x.length-1);var h=xr(o);if(s)for(p=0;p<x.length;++p)i[er(p+l)+h]={t:"s",v:x[p]};return i["!ref"]=Ze(u),i}function VH(e,t){return l6(null,e,t)}function Cc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=tr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Cc(e,Ue(t)):Cc(e,Ue({r:t,c:r||0}))}function GH(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Qv(){return{SheetNames:[],Sheets:{}}}function Zv(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(z5(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function KH(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=GH(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function XH(e,t){return e.z=t,e}function c6(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function YH(e,t,r){return c6(e,"#"+t,r)}function JH(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function QH(e,t,r,a){for(var s=typeof t!="string"?t:gt(t),i=typeof t=="string"?t:Ze(t),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=Cc(e,o,l);c.t="n",c.F=i,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,a&&(c.D=!0))}return e}var Vt={encode_col:er,encode_row:xr,encode_cell:Ue,encode_range:Ze,decode_col:Tv,decode_row:Ev,split_cell:cR,decode_cell:tr,decode_range:wa,format_cell:as,sheet_add_aoa:RT,sheet_add_json:l6,sheet_add_dom:Z5,aoa_to_sheet:dl,json_to_sheet:VH,table_to_sheet:e6,table_to_book:sH,sheet_to_csv:Jv,sheet_to_txt:o6,sheet_to_json:Du,sheet_to_html:Q5,sheet_to_formulae:zH,sheet_to_row_object_array:Du,sheet_get_cell:Cc,book_new:Qv,book_append_sheet:Zv,book_set_sheet_visibility:KH,cell_set_number_format:XH,cell_set_hyperlink:c6,cell_set_internal_link:YH,cell_add_comment:JH,sheet_set_array_formula:QH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const iw=[{id:"all",name:"جميع المستخدمين"},{id:"student",name:"طلاب",icon:vi,color:"bg-blue-500"},{id:"teacher",name:"مشرفين",icon:bt,color:"bg-green-500"},{id:"school",name:"مدارس",icon:ks,color:"bg-purple-500"},{id:"consultant",name:"مستشارين",icon:As,color:"bg-orange-500"},{id:"admin",name:"مديرين",icon:ba,color:"bg-red-500"}],ZH=[{id:"all",name:"جميع الحالات"},{id:"active",name:"نشط",color:"bg-green-100 text-green-800"},{id:"pending",name:"قيد المراجعة",color:"bg-yellow-100 text-yellow-800"},{id:"inactive",name:"غير نشط",color:"bg-gray-100 text-gray-800"},{id:"suspended",name:"موقوف",color:"bg-red-100 text-red-800"}],ow=()=>{const{users:e,loading:t,error:r,addUser:a,editUser:s,removeUser:i,activateUser:o,deactivateUser:l}=JF(),[c,d]=C.useState("all"),[u,f]=C.useState(""),[x,p]=C.useState("all"),[h,m]=C.useState("all"),[g,v]=C.useState("all"),[b,y]=C.useState(!1),[N,j]=C.useState(null),[w,_]=C.useState(!1),[S,k]=C.useState(null),[E,A]=C.useState(null),[P,L]=C.useState(null),R=["all",...new Set(e.filter(M=>M.school).map(M=>M.school))],I=["all",...new Set(e.filter(M=>M.schoolCity&&M.schoolCity!=="غير محدد").map(M=>M.schoolCity))],D=e.filter(M=>{const G=c==="all"||M.role===c,ne=M.name.toLowerCase().includes(u.toLowerCase())||M.email.toLowerCase().includes(u.toLowerCase())||M.school&&M.school.toLowerCase().includes(u.toLowerCase()),B=x==="all"||M.status===x,pe=h==="all"||M.school===h,ye=g==="all"||M.schoolCity===g;return G&&ne&&B&&pe&&ye}),V=M=>{switch(M){case"student":return"طالب";case"teacher":return"مشرف";case"school":return"مدرسة";case"admin":return"مدير";case"consultant":return"مستشار";default:return M}},F=M=>{switch(M){case"active":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"inactive":return"bg-gray-100 text-gray-800";case"suspended":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},U=M=>{switch(M){case"active":return"نشط";case"pending":return"قيد المراجعة";case"inactive":return"غير نشط";case"suspended":return"موقوف";default:return M}},q=M=>{const G=iw.find(ne=>ne.id===M);return G?G.icon:dt},K=()=>{j(null),_(!1),y(!0)},T=M=>{j(M),_(!0),y(!0)},O=M=>{k(M)},W=async()=>{if(S)try{A(`delete-${S.id}`),await i(S.id),k(null),L("تم حذف المستخدم بنجاح"),setTimeout(()=>L(null),3e3)}catch(M){console.error("Error deleting user:",M),alert("حدث خطأ في حذف المستخدم")}finally{A(null)}},z=async M=>{try{A(`activate-${M}`),await o(M),L("تم تفعيل المستخدم بنجاح"),setTimeout(()=>L(null),3e3)}catch(G){console.error("Error activating user:",G),alert("حدث خطأ في تفعيل المستخدم")}finally{A(null)}},te=async M=>{try{A(`deactivate-${M}`),await l(M),L("تم تعطيل المستخدم بنجاح"),setTimeout(()=>L(null),3e3)}catch(G){console.error("Error deactivating user:",G),alert("حدث خطأ في تعطيل المستخدم")}finally{A(null)}},ae=async M=>{try{w&&N?await s(N.id,M):await a(M)}catch(G){throw console.error("Error submitting user form:",G),G}},se=()=>{try{const M=D.map(B=>({الاسم:B.name,"البريد الإلكتروني":B.email,الدور:V(B.role),المدرسة:B.school||"غير محدد",المدينة:B.schoolCity||"غير محدد",الحالة:U(B.status),"رقم الهاتف":B.phone||"غير محدد","الصف الدراسي":B.grade||"غير محدد","المادة التدريسية":B.subject||"غير محدد","تاريخ الانضمام":Ye(B.joinedAt),"آخر نشاط":Ye(B.lastActive)})),G=Vt.json_to_sheet(M),ne=Vt.book_new();Vt.book_append_sheet(ne,G,"المستخدمين"),wd(ne,`المستخدمين_${new Date().toISOString().split("T")[0]}.xlsx`),L("تم تصدير البيانات بنجاح"),setTimeout(()=>L(null),3e3)}catch(M){console.error("Error exporting data:",M),alert("حدث خطأ أثناء تصدير البيانات")}};return t?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ja,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:r})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(dt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"إدارة المستخدمين"}),n.jsx("p",{className:"opacity-90",children:"إدارة ومتابعة جميع مستخدمي المنصة"})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:se,className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 flex items-center gap-2",children:[n.jsx(Mr,{className:"w-5 h-5"}),"تصدير Excel"]}),n.jsxs("button",{onClick:K,className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5"}),"إضافة مستخدم"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي المستخدمين"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(M=>M.role==="student").length}),n.jsx("div",{className:"text-sm opacity-80",children:"طلاب"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(M=>M.role==="teacher").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مشرفين"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(M=>M.role==="school").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مدارس"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(M=>M.status==="pending").length}),n.jsx("div",{className:"text-sm opacity-80",children:"قيد المراجعة"})]})]})]}),P&&n.jsxs(re.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(Le,{className:"w-6 h-6 text-green-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-green-800 mb-1",children:"تمت العملية بنجاح"}),n.jsx("p",{className:"text-green-700",children:P})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"grid lg:grid-cols-6 gap-4 mb-6",children:[n.jsxs("div",{className:"lg:col-span-2 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث بالاسم أو البريد الإلكتروني...",value:u,onChange:M=>f(M.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsx("div",{children:n.jsx("select",{value:c,onChange:M=>d(M.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:iw.map(M=>n.jsx("option",{value:M.id,children:M.name},M.id))})}),n.jsx("div",{children:n.jsx("select",{value:x,onChange:M=>p(M.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:ZH.map(M=>n.jsx("option",{value:M.id,children:M.name},M.id))})}),n.jsx("div",{children:n.jsxs("select",{value:h,onChange:M=>m(M.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:"جميع المدارس"}),R.filter(M=>M!=="all").map(M=>n.jsx("option",{value:M,children:M},M))]})}),n.jsx("div",{children:n.jsxs("select",{value:g,onChange:M=>v(M.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:"جميع المدن"}),I.filter(M=>M!=="all").map(M=>n.jsx("option",{value:M,children:M},M))]})})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs("button",{onClick:()=>p("pending"),className:`px-4 py-2 rounded-xl transition-all ${x==="pending"?"bg-yellow-500 text-white shadow-lg":"bg-yellow-100 text-yellow-800 hover:bg-yellow-200"}`,children:["الحسابات المعلقة (",e.filter(M=>M.status==="pending").length,")"]}),n.jsxs("button",{onClick:()=>d("school"),className:`px-4 py-2 rounded-xl transition-all ${c==="school"?"bg-purple-500 text-white shadow-lg":"bg-purple-100 text-purple-800 hover:bg-purple-200"}`,children:["المدارس (",e.filter(M=>M.role==="school").length,")"]}),n.jsxs("button",{onClick:()=>d("consultant"),className:`px-4 py-2 rounded-xl transition-all ${c==="consultant"?"bg-orange-500 text-white shadow-lg":"bg-orange-100 text-orange-800 hover:bg-orange-200"}`,children:["المستشارين (",e.filter(M=>M.role==="consultant").length,")"]})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("p",{className:"text-gray-600",children:["عرض ",D.length," من أصل ",e.length," مستخدم"]}),n.jsx("button",{onClick:()=>{d("all"),p("all"),m("all"),v("all"),f("")},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:"إعادة تعيين الفلاتر"})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المستخدم"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الدور"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المدرسة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المدينة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ الانضمام"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:D.map(M=>{const G=q(M.role);return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:n.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:M.avatar,alt:M.name})}),n.jsxs("div",{className:"mr-4",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:M.name}),n.jsx("div",{className:"text-sm text-gray-500",children:M.email}),M.phone&&n.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-1",children:[n.jsx(Cr,{className:"w-3 h-3"}),M.phone]})]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:n.jsx(G,{className:"w-4 h-4 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:V(M.role)}),M.subject&&n.jsx("div",{className:"text-xs text-gray-500",children:M.subject}),M.grade&&n.jsx("div",{className:"text-xs text-gray-500",children:M.grade})]})]})}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[n.jsx("div",{className:"text-sm text-gray-900",children:M.school||"غير محدد"}),M.role==="school"&&M.studentsCount!==void 0&&n.jsxs("div",{className:"text-xs text-gray-500",children:[M.studentsCount," طالب، ",M.teachersCount||0," مشرف"]})]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"text-sm text-gray-900 flex items-center gap-1",children:[n.jsx(fd,{className:"w-4 h-4 text-gray-400"}),M.schoolCity||M.location||"غير محدد"]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${F(M.status)}`,children:U(M.status)})}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[n.jsx("div",{children:Ye(M.joinedAt)}),n.jsxs("div",{className:"text-xs text-gray-400",children:["آخر نشاط: ",Bl(M.lastActive)]})]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"relative group",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Rf,{className:"w-5 h-5 text-gray-400"})}),n.jsx("div",{className:"absolute left-0 top-10 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-10",children:n.jsxs("div",{className:"p-2",children:[n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(mr,{className:"w-4 h-4"}),"عرض الملف الشخصي"]}),n.jsxs("button",{onClick:()=>T(M),className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(Ia,{className:"w-4 h-4"}),"تعديل"]}),M.status==="pending"&&n.jsxs("button",{onClick:()=>z(M.id),disabled:E===`activate-${M.id}`,className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-green-700 hover:bg-green-50 rounded-md disabled:opacity-50",children:[E===`activate-${M.id}`?n.jsx("div",{className:"w-4 h-4 border-2 border-green-600 border-t-transparent rounded-full animate-spin"}):n.jsx(o1,{className:"w-4 h-4"}),"تفعيل"]}),M.status==="active"&&n.jsxs("button",{onClick:()=>te(M.id),disabled:E===`deactivate-${M.id}`,className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-orange-700 hover:bg-orange-50 rounded-md disabled:opacity-50",children:[E===`deactivate-${M.id}`?n.jsx("div",{className:"w-4 h-4 border-2 border-orange-600 border-t-transparent rounded-full animate-spin"}):n.jsx(sP,{className:"w-4 h-4"}),"تعطيل"]}),M.status==="inactive"&&n.jsxs("button",{onClick:()=>z(M.id),disabled:E===`activate-${M.id}`,className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-green-700 hover:bg-green-50 rounded-md disabled:opacity-50",children:[E===`activate-${M.id}`?n.jsx("div",{className:"w-4 h-4 border-2 border-green-600 border-t-transparent rounded-full animate-spin"}):n.jsx(o1,{className:"w-4 h-4"}),"تفعيل"]}),n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(ma,{className:"w-4 h-4"}),"إرسال رسالة"]}),n.jsx("hr",{className:"my-1"}),n.jsxs("button",{onClick:()=>O(M),className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",children:[n.jsx(nr,{className:"w-4 h-4"}),"حذف"]})]})})]})})]},M.id)})})]})}),D.length===0&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(dt,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لا يوجد مستخدمين"}),n.jsx("p",{className:"text-gray-600 mb-4",children:e.length===0?"لم يتم إضافة أي مستخدمين بعد":"لم يتم العثور على مستخدمين يطابقون معايير البحث"}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs("button",{onClick:K,className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(uu,{className:"w-4 h-4"}),"إضافة مستخدم جديد"]}),e.length>0&&n.jsx("button",{onClick:()=>{d("all"),p("all"),m("all"),v("all"),f("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إعادة تعيين الفلاتر"})]})]})]}),n.jsx(QF,{isOpen:b,onClose:()=>y(!1),onSubmit:ae,editingUser:N,isEditing:w}),S&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:n.jsx(ja,{className:"w-6 h-6 text-red-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"تأكيد الحذف"}),n.jsx("p",{className:"text-sm text-gray-600",children:"هذا الإجراء لا يمكن التراجع عنه"})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700 mb-2",children:"هل أنت متأكد من حذف المستخدم التالي؟"}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("img",{src:S.avatar,alt:S.name,className:"w-10 h-10 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:S.name}),n.jsx("p",{className:"text-sm text-gray-600",children:S.email}),n.jsx("p",{className:"text-xs text-gray-500",children:V(S.role)})]})]})})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>k(null),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:E===`delete-${S.id}`,children:"إلغاء"}),n.jsx("button",{onClick:W,disabled:E===`delete-${S.id}`,className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:E===`delete-${S.id}`?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"جاري الحذف..."]}):n.jsxs(n.Fragment,{children:[n.jsx(nr,{className:"w-4 h-4"}),"حذف"]})})]})]})})]})};function d6(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=d6(e[t]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function tt(){for(var e,t,r=0,a="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=d6(e))&&(a&&(a+=" "),a+=t);return a}var lh,lw;function Na(){if(lw)return lh;lw=1;var e=Array.isArray;return lh=e,lh}var ch,cw;function u6(){if(cw)return ch;cw=1;var e=typeof Hn=="object"&&Hn&&Hn.Object===Object&&Hn;return ch=e,ch}var dh,dw;function Rn(){if(dw)return dh;dw=1;var e=u6(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return dh=r,dh}var uh,uw;function Nd(){if(uw)return uh;uw=1;var e=Rn(),t=e.Symbol;return uh=t,uh}var fh,fw;function ez(){if(fw)return fh;fw=1;var e=Nd(),t=Object.prototype,r=t.hasOwnProperty,a=t.toString,s=e?e.toStringTag:void 0;function i(o){var l=r.call(o,s),c=o[s];try{o[s]=void 0;var d=!0}catch{}var u=a.call(o);return d&&(l?o[s]=c:delete o[s]),u}return fh=i,fh}var hh,hw;function tz(){if(hw)return hh;hw=1;var e=Object.prototype,t=e.toString;function r(a){return t.call(a)}return hh=r,hh}var mh,mw;function us(){if(mw)return mh;mw=1;var e=Nd(),t=ez(),r=tz(),a="[object Null]",s="[object Undefined]",i=e?e.toStringTag:void 0;function o(l){return l==null?l===void 0?s:a:i&&i in Object(l)?t(l):r(l)}return mh=o,mh}var xh,xw;function fs(){if(xw)return xh;xw=1;function e(t){return t!=null&&typeof t=="object"}return xh=e,xh}var ph,pw;function fl(){if(pw)return ph;pw=1;var e=us(),t=fs(),r="[object Symbol]";function a(s){return typeof s=="symbol"||t(s)&&e(s)==r}return ph=a,ph}var gh,gw;function eb(){if(gw)return gh;gw=1;var e=Na(),t=fl(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function s(i,o){if(e(i))return!1;var l=typeof i;return l=="number"||l=="symbol"||l=="boolean"||i==null||t(i)?!0:a.test(i)||!r.test(i)||o!=null&&i in Object(o)}return gh=s,gh}var yh,yw;function Us(){if(yw)return yh;yw=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return yh=e,yh}var vh,vw;function tb(){if(vw)return vh;vw=1;var e=us(),t=Us(),r="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",i="[object Proxy]";function o(l){if(!t(l))return!1;var c=e(l);return c==a||c==s||c==r||c==i}return vh=o,vh}var bh,bw;function rz(){if(bw)return bh;bw=1;var e=Rn(),t=e["__core-js_shared__"];return bh=t,bh}var jh,jw;function az(){if(jw)return jh;jw=1;var e=rz(),t=(function(){var a=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""})();function r(a){return!!t&&t in a}return jh=r,jh}var wh,ww;function f6(){if(ww)return wh;ww=1;var e=Function.prototype,t=e.toString;function r(a){if(a!=null){try{return t.call(a)}catch{}try{return a+""}catch{}}return""}return wh=r,wh}var Nh,Nw;function nz(){if(Nw)return Nh;Nw=1;var e=tb(),t=az(),r=Us(),a=f6(),s=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,c=o.toString,d=l.hasOwnProperty,u=RegExp("^"+c.call(d).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(x){if(!r(x)||t(x))return!1;var p=e(x)?u:i;return p.test(a(x))}return Nh=f,Nh}var _h,_w;function sz(){if(_w)return _h;_w=1;function e(t,r){return t==null?void 0:t[r]}return _h=e,_h}var Sh,Sw;function Bi(){if(Sw)return Sh;Sw=1;var e=nz(),t=sz();function r(a,s){var i=t(a,s);return e(i)?i:void 0}return Sh=r,Sh}var kh,kw;function Zf(){if(kw)return kh;kw=1;var e=Bi(),t=e(Object,"create");return kh=t,kh}var Eh,Ew;function iz(){if(Ew)return Eh;Ew=1;var e=Zf();function t(){this.__data__=e?e(null):{},this.size=0}return Eh=t,Eh}var Th,Tw;function oz(){if(Tw)return Th;Tw=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return Th=e,Th}var Ah,Aw;function lz(){if(Aw)return Ah;Aw=1;var e=Zf(),t="__lodash_hash_undefined__",r=Object.prototype,a=r.hasOwnProperty;function s(i){var o=this.__data__;if(e){var l=o[i];return l===t?void 0:l}return a.call(o,i)?o[i]:void 0}return Ah=s,Ah}var Ch,Cw;function cz(){if(Cw)return Ch;Cw=1;var e=Zf(),t=Object.prototype,r=t.hasOwnProperty;function a(s){var i=this.__data__;return e?i[s]!==void 0:r.call(i,s)}return Ch=a,Ch}var Ph,Pw;function dz(){if(Pw)return Ph;Pw=1;var e=Zf(),t="__lodash_hash_undefined__";function r(a,s){var i=this.__data__;return this.size+=this.has(a)?0:1,i[a]=e&&s===void 0?t:s,this}return Ph=r,Ph}var Oh,Ow;function uz(){if(Ow)return Oh;Ow=1;var e=iz(),t=oz(),r=lz(),a=cz(),s=dz();function i(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=a,i.prototype.set=s,Oh=i,Oh}var Ih,Iw;function fz(){if(Iw)return Ih;Iw=1;function e(){this.__data__=[],this.size=0}return Ih=e,Ih}var Fh,Fw;function rb(){if(Fw)return Fh;Fw=1;function e(t,r){return t===r||t!==t&&r!==r}return Fh=e,Fh}var Dh,Dw;function e0(){if(Dw)return Dh;Dw=1;var e=rb();function t(r,a){for(var s=r.length;s--;)if(e(r[s][0],a))return s;return-1}return Dh=t,Dh}var Rh,Rw;function hz(){if(Rw)return Rh;Rw=1;var e=e0(),t=Array.prototype,r=t.splice;function a(s){var i=this.__data__,o=e(i,s);if(o<0)return!1;var l=i.length-1;return o==l?i.pop():r.call(i,o,1),--this.size,!0}return Rh=a,Rh}var Mh,Mw;function mz(){if(Mw)return Mh;Mw=1;var e=e0();function t(r){var a=this.__data__,s=e(a,r);return s<0?void 0:a[s][1]}return Mh=t,Mh}var Lh,Lw;function xz(){if(Lw)return Lh;Lw=1;var e=e0();function t(r){return e(this.__data__,r)>-1}return Lh=t,Lh}var $h,$w;function pz(){if($w)return $h;$w=1;var e=e0();function t(r,a){var s=this.__data__,i=e(s,r);return i<0?(++this.size,s.push([r,a])):s[i][1]=a,this}return $h=t,$h}var Bh,Bw;function t0(){if(Bw)return Bh;Bw=1;var e=fz(),t=hz(),r=mz(),a=xz(),s=pz();function i(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=a,i.prototype.set=s,Bh=i,Bh}var Uh,Uw;function ab(){if(Uw)return Uh;Uw=1;var e=Bi(),t=Rn(),r=e(t,"Map");return Uh=r,Uh}var qh,qw;function gz(){if(qw)return qh;qw=1;var e=uz(),t=t0(),r=ab();function a(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return qh=a,qh}var Wh,Ww;function yz(){if(Ww)return Wh;Ww=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return Wh=e,Wh}var Hh,Hw;function r0(){if(Hw)return Hh;Hw=1;var e=yz();function t(r,a){var s=r.__data__;return e(a)?s[typeof a=="string"?"string":"hash"]:s.map}return Hh=t,Hh}var zh,zw;function vz(){if(zw)return zh;zw=1;var e=r0();function t(r){var a=e(this,r).delete(r);return this.size-=a?1:0,a}return zh=t,zh}var Vh,Vw;function bz(){if(Vw)return Vh;Vw=1;var e=r0();function t(r){return e(this,r).get(r)}return Vh=t,Vh}var Gh,Gw;function jz(){if(Gw)return Gh;Gw=1;var e=r0();function t(r){return e(this,r).has(r)}return Gh=t,Gh}var Kh,Kw;function wz(){if(Kw)return Kh;Kw=1;var e=r0();function t(r,a){var s=e(this,r),i=s.size;return s.set(r,a),this.size+=s.size==i?0:1,this}return Kh=t,Kh}var Xh,Xw;function nb(){if(Xw)return Xh;Xw=1;var e=gz(),t=vz(),r=bz(),a=jz(),s=wz();function i(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=a,i.prototype.set=s,Xh=i,Xh}var Yh,Yw;function h6(){if(Yw)return Yh;Yw=1;var e=nb(),t="Expected a function";function r(a,s){if(typeof a!="function"||s!=null&&typeof s!="function")throw new TypeError(t);var i=function(){var o=arguments,l=s?s.apply(this,o):o[0],c=i.cache;if(c.has(l))return c.get(l);var d=a.apply(this,o);return i.cache=c.set(l,d)||c,d};return i.cache=new(r.Cache||e),i}return r.Cache=e,Yh=r,Yh}var Jh,Jw;function Nz(){if(Jw)return Jh;Jw=1;var e=h6(),t=500;function r(a){var s=e(a,function(o){return i.size===t&&i.clear(),o}),i=s.cache;return s}return Jh=r,Jh}var Qh,Qw;function _z(){if(Qw)return Qh;Qw=1;var e=Nz(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,a=e(function(s){var i=[];return s.charCodeAt(0)===46&&i.push(""),s.replace(t,function(o,l,c,d){i.push(c?d.replace(r,"$1"):l||o)}),i});return Qh=a,Qh}var Zh,Zw;function sb(){if(Zw)return Zh;Zw=1;function e(t,r){for(var a=-1,s=t==null?0:t.length,i=Array(s);++a<s;)i[a]=r(t[a],a,t);return i}return Zh=e,Zh}var em,eN;function Sz(){if(eN)return em;eN=1;var e=Nd(),t=sb(),r=Na(),a=fl(),s=e?e.prototype:void 0,i=s?s.toString:void 0;function o(l){if(typeof l=="string")return l;if(r(l))return t(l,o)+"";if(a(l))return i?i.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return em=o,em}var tm,tN;function m6(){if(tN)return tm;tN=1;var e=Sz();function t(r){return r==null?"":e(r)}return tm=t,tm}var rm,rN;function x6(){if(rN)return rm;rN=1;var e=Na(),t=eb(),r=_z(),a=m6();function s(i,o){return e(i)?i:t(i,o)?[i]:r(a(i))}return rm=s,rm}var am,aN;function a0(){if(aN)return am;aN=1;var e=fl();function t(r){if(typeof r=="string"||e(r))return r;var a=r+"";return a=="0"&&1/r==-1/0?"-0":a}return am=t,am}var nm,nN;function ib(){if(nN)return nm;nN=1;var e=x6(),t=a0();function r(a,s){s=e(s,a);for(var i=0,o=s.length;a!=null&&i<o;)a=a[t(s[i++])];return i&&i==o?a:void 0}return nm=r,nm}var sm,sN;function p6(){if(sN)return sm;sN=1;var e=ib();function t(r,a,s){var i=r==null?void 0:e(r,a);return i===void 0?s:i}return sm=t,sm}var kz=p6();const Oa=Ct(kz);var im,iN;function Ez(){if(iN)return im;iN=1;function e(t){return t==null}return im=e,im}var Tz=Ez();const Je=Ct(Tz);var om,oN;function Az(){if(oN)return om;oN=1;var e=us(),t=Na(),r=fs(),a="[object String]";function s(i){return typeof i=="string"||!t(i)&&r(i)&&e(i)==a}return om=s,om}var Cz=Az();const Ei=Ct(Cz);var Pz=tb();const qe=Ct(Pz);var Oz=Us();const hl=Ct(Oz);var lm={exports:{}},_t={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lN;function Iz(){if(lN)return _t;lN=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.server_context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen"),h;h=Symbol.for("react.module.reference");function m(g){if(typeof g=="object"&&g!==null){var v=g.$$typeof;switch(v){case e:switch(g=g.type,g){case r:case s:case a:case d:case u:return g;default:switch(g=g&&g.$$typeof,g){case l:case o:case c:case x:case f:case i:return g;default:return v}}case t:return v}}}return _t.ContextConsumer=o,_t.ContextProvider=i,_t.Element=e,_t.ForwardRef=c,_t.Fragment=r,_t.Lazy=x,_t.Memo=f,_t.Portal=t,_t.Profiler=s,_t.StrictMode=a,_t.Suspense=d,_t.SuspenseList=u,_t.isAsyncMode=function(){return!1},_t.isConcurrentMode=function(){return!1},_t.isContextConsumer=function(g){return m(g)===o},_t.isContextProvider=function(g){return m(g)===i},_t.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===e},_t.isForwardRef=function(g){return m(g)===c},_t.isFragment=function(g){return m(g)===r},_t.isLazy=function(g){return m(g)===x},_t.isMemo=function(g){return m(g)===f},_t.isPortal=function(g){return m(g)===t},_t.isProfiler=function(g){return m(g)===s},_t.isStrictMode=function(g){return m(g)===a},_t.isSuspense=function(g){return m(g)===d},_t.isSuspenseList=function(g){return m(g)===u},_t.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===r||g===s||g===a||g===d||g===u||g===p||typeof g=="object"&&g!==null&&(g.$$typeof===x||g.$$typeof===f||g.$$typeof===i||g.$$typeof===o||g.$$typeof===c||g.$$typeof===h||g.getModuleId!==void 0)},_t.typeOf=m,_t}var cN;function Fz(){return cN||(cN=1,lm.exports=Iz()),lm.exports}var Dz=Fz(),cm,dN;function g6(){if(dN)return cm;dN=1;var e=us(),t=fs(),r="[object Number]";function a(s){return typeof s=="number"||t(s)&&e(s)==r}return cm=a,cm}var dm,uN;function Rz(){if(uN)return dm;uN=1;var e=g6();function t(r){return e(r)&&r!=+r}return dm=t,dm}var Mz=Rz();const ml=Ct(Mz);var Lz=g6();const $z=Ct(Lz);var ca=function(t){return t===0?0:t>0?1:-1},ni=function(t){return Ei(t)&&t.indexOf("%")===t.length-1},be=function(t){return $z(t)&&!ml(t)},Bz=function(t){return Je(t)},Ar=function(t){return be(t)||Ei(t)},Uz=0,xl=function(t){var r=++Uz;return"".concat(t||"").concat(r)},da=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!be(t)&&!Ei(t))return a;var i;if(ni(t)){var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return ml(i)&&(i=a),s&&i>r&&(i=r),i},bs=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},qz=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,a={},s=0;s<r;s++)if(!a[t[s]])a[t[s]]=!0;else return!0;return!1},ga=function(t,r){return be(t)&&be(r)?function(a){return t+a*(r-t)}:function(){return r}};function Ru(e,t,r){return!e||!e.length?null:e.find(function(a){return a&&(typeof t=="function"?t(a):Oa(a,t))===r})}var Wz=function(t,r){return be(t)&&be(r)?t-r:Ei(t)&&Ei(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function po(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var a in t)if({}.hasOwnProperty.call(t,a)&&!{}.hasOwnProperty.call(e,a))return!1;return!0}function Mg(e){"@babel/helpers - typeof";return Mg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mg(e)}var Hz=["viewBox","children"],zz=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],fN=["points","pathLength"],um={svg:Hz,polygon:fN,polyline:fN},ob=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Mu=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(C.isValidElement(t)&&(a=t.props),!hl(a))return null;var s={};return Object.keys(a).forEach(function(i){ob.includes(i)&&(s[i]=r||function(o){return a[i](a,o)})}),s},Vz=function(t,r,a){return function(s){return t(r,a,s),null}},Ti=function(t,r,a){if(!hl(t)||Mg(t)!=="object")return null;var s=null;return Object.keys(t).forEach(function(i){var o=t[i];ob.includes(i)&&typeof o=="function"&&(s||(s={}),s[i]=Vz(o,r,a))}),s},Gz=["children"],Kz=["children"];function hN(e,t){if(e==null)return{};var r=Xz(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function Xz(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function Lg(e){"@babel/helpers - typeof";return Lg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lg(e)}var mN={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},es=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},xN=null,fm=null,lb=function e(t){if(t===xN&&Array.isArray(fm))return fm;var r=[];return C.Children.forEach(t,function(a){Je(a)||(Dz.isFragment(a)?r=r.concat(e(a.props.children)):r.push(a))}),fm=r,xN=t,r};function Qa(e,t){var r=[],a=[];return Array.isArray(t)?a=t.map(function(s){return es(s)}):a=[es(t)],lb(e).forEach(function(s){var i=Oa(s,"type.displayName")||Oa(s,"type.name");a.indexOf(i)!==-1&&r.push(s)}),r}function ka(e,t){var r=Qa(e,t);return r&&r[0]}var pN=function(t){if(!t||!t.props)return!1;var r=t.props,a=r.width,s=r.height;return!(!be(a)||a<=0||!be(s)||s<=0)},Yz=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Jz=function(t){return t&&t.type&&Ei(t.type)&&Yz.indexOf(t.type)>=0},Qz=function(t){return t&&Lg(t)==="object"&&"clipDot"in t},Zz=function(t,r,a,s){var i,o=(i=um==null?void 0:um[s])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!qe(t)&&(s&&o.includes(r)||zz.includes(r))||a&&ob.includes(r)},Re=function(t,r,a){if(!t||typeof t=="function"||typeof t=="boolean")return null;var s=t;if(C.isValidElement(t)&&(s=t.props),!hl(s))return null;var i={};return Object.keys(s).forEach(function(o){var l;Zz((l=s)===null||l===void 0?void 0:l[o],o,r,a)&&(i[o]=s[o])}),i},$g=function e(t,r){if(t===r)return!0;var a=C.Children.count(t);if(a!==C.Children.count(r))return!1;if(a===0)return!0;if(a===1)return gN(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var s=0;s<a;s++){var i=t[s],o=r[s];if(Array.isArray(i)||Array.isArray(o)){if(!e(i,o))return!1}else if(!gN(i,o))return!1}return!0},gN=function(t,r){if(Je(t)&&Je(r))return!0;if(!Je(t)&&!Je(r)){var a=t.props||{},s=a.children,i=hN(a,Gz),o=r.props||{},l=o.children,c=hN(o,Kz);return s&&l?po(i,c)&&$g(s,l):!s&&!l?po(i,c):!1}return!1},yN=function(t,r){var a=[],s={};return lb(t).forEach(function(i,o){if(Jz(i))a.push(i);else if(i){var l=es(i.type),c=r[l]||{},d=c.handler,u=c.once;if(d&&(!u||!s[l])){var f=d(i,l,o);a.push(f),s[l]=!0}}}),a},eV=function(t){var r=t&&t.type;return r&&mN[r]?mN[r]:null},tV=function(t,r){return lb(r).indexOf(t)},rV=["children","width","height","viewBox","className","style","title","desc"];function Bg(){return Bg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Bg.apply(this,arguments)}function aV(e,t){if(e==null)return{};var r=nV(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function nV(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function Ug(e){var t=e.children,r=e.width,a=e.height,s=e.viewBox,i=e.className,o=e.style,l=e.title,c=e.desc,d=aV(e,rV),u=s||{width:r,height:a,x:0,y:0},f=tt("recharts-surface",i);return ee.createElement("svg",Bg({},Re(d,!0,"svg"),{className:f,width:r,height:a,style:o,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),ee.createElement("title",null,l),ee.createElement("desc",null,c),t)}var sV=["children","className"];function qg(){return qg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},qg.apply(this,arguments)}function iV(e,t){if(e==null)return{};var r=oV(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function oV(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}var ht=ee.forwardRef(function(e,t){var r=e.children,a=e.className,s=iV(e,sV),i=tt("recharts-layer",a);return ee.createElement("g",qg({className:i},Re(s,!0),{ref:t}),r)}),pn=function(t,r){for(var a=arguments.length,s=new Array(a>2?a-2:0),i=2;i<a;i++)s[i-2]=arguments[i]},hm,vN;function lV(){if(vN)return hm;vN=1;function e(t,r,a){var s=-1,i=t.length;r<0&&(r=-r>i?0:i+r),a=a>i?i:a,a<0&&(a+=i),i=r>a?0:a-r>>>0,r>>>=0;for(var o=Array(i);++s<i;)o[s]=t[s+r];return o}return hm=e,hm}var mm,bN;function cV(){if(bN)return mm;bN=1;var e=lV();function t(r,a,s){var i=r.length;return s=s===void 0?i:s,!a&&s>=i?r:e(r,a,s)}return mm=t,mm}var xm,jN;function y6(){if(jN)return xm;jN=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",a="\\u20d0-\\u20ff",s=t+r+a,i="\\ufe0e\\ufe0f",o="\\u200d",l=RegExp("["+o+e+s+i+"]");function c(d){return l.test(d)}return xm=c,xm}var pm,wN;function dV(){if(wN)return pm;wN=1;function e(t){return t.split("")}return pm=e,pm}var gm,NN;function uV(){if(NN)return gm;NN=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",a="\\u20d0-\\u20ff",s=t+r+a,i="\\ufe0e\\ufe0f",o="["+e+"]",l="["+s+"]",c="\\ud83c[\\udffb-\\udfff]",d="(?:"+l+"|"+c+")",u="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",x="[\\ud800-\\udbff][\\udc00-\\udfff]",p="\\u200d",h=d+"?",m="["+i+"]?",g="(?:"+p+"(?:"+[u,f,x].join("|")+")"+m+h+")*",v=m+h+g,b="(?:"+[u+l+"?",l,f,x,o].join("|")+")",y=RegExp(c+"(?="+c+")|"+b+v,"g");function N(j){return j.match(y)||[]}return gm=N,gm}var ym,_N;function fV(){if(_N)return ym;_N=1;var e=dV(),t=y6(),r=uV();function a(s){return t(s)?r(s):e(s)}return ym=a,ym}var vm,SN;function hV(){if(SN)return vm;SN=1;var e=cV(),t=y6(),r=fV(),a=m6();function s(i){return function(o){o=a(o);var l=t(o)?r(o):void 0,c=l?l[0]:o.charAt(0),d=l?e(l,1).join(""):o.slice(1);return c[i]()+d}}return vm=s,vm}var bm,kN;function mV(){if(kN)return bm;kN=1;var e=hV(),t=e("toUpperCase");return bm=t,bm}var xV=mV();const n0=Ct(xV);function $t(e){return function(){return e}}const v6=Math.cos,Lu=Math.sin,gn=Math.sqrt,$u=Math.PI,s0=2*$u,Wg=Math.PI,Hg=2*Wg,Js=1e-6,pV=Hg-Js;function b6(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function gV(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return b6;const r=10**t;return function(a){this._+=a[0];for(let s=1,i=a.length;s<i;++s)this._+=Math.round(arguments[s]*r)/r+a[s]}}class yV{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?b6:gV(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,a,s){this._append`Q${+t},${+r},${this._x1=+a},${this._y1=+s}`}bezierCurveTo(t,r,a,s,i,o){this._append`C${+t},${+r},${+a},${+s},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,a,s,i){if(t=+t,r=+r,a=+a,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=a-t,d=s-r,u=o-t,f=l-r,x=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(x>Js)if(!(Math.abs(f*c-d*u)>Js)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let p=a-o,h=s-l,m=c*c+d*d,g=p*p+h*h,v=Math.sqrt(m),b=Math.sqrt(x),y=i*Math.tan((Wg-Math.acos((m+x-g)/(2*v*b)))/2),N=y/b,j=y/v;Math.abs(N-1)>Js&&this._append`L${t+N*u},${r+N*f}`,this._append`A${i},${i},0,0,${+(f*p>u*h)},${this._x1=t+j*c},${this._y1=r+j*d}`}}arc(t,r,a,s,i,o){if(t=+t,r=+r,a=+a,o=!!o,a<0)throw new Error(`negative radius: ${a}`);let l=a*Math.cos(s),c=a*Math.sin(s),d=t+l,u=r+c,f=1^o,x=o?s-i:i-s;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>Js||Math.abs(this._y1-u)>Js)&&this._append`L${d},${u}`,a&&(x<0&&(x=x%Hg+Hg),x>pV?this._append`A${a},${a},0,1,${f},${t-l},${r-c}A${a},${a},0,1,${f},${this._x1=d},${this._y1=u}`:x>Js&&this._append`A${a},${a},0,${+(x>=Wg)},${f},${this._x1=t+a*Math.cos(i)},${this._y1=r+a*Math.sin(i)}`)}rect(t,r,a,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${a=+a}v${+s}h${-a}Z`}toString(){return this._}}function cb(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const a=Math.floor(r);if(!(a>=0))throw new RangeError(`invalid digits: ${r}`);t=a}return e},()=>new yV(t)}function db(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function j6(e){this._context=e}j6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function i0(e){return new j6(e)}function w6(e){return e[0]}function N6(e){return e[1]}function _6(e,t){var r=$t(!0),a=null,s=i0,i=null,o=cb(l);e=typeof e=="function"?e:e===void 0?w6:$t(e),t=typeof t=="function"?t:t===void 0?N6:$t(t);function l(c){var d,u=(c=db(c)).length,f,x=!1,p;for(a==null&&(i=s(p=o())),d=0;d<=u;++d)!(d<u&&r(f=c[d],d,c))===x&&((x=!x)?i.lineStart():i.lineEnd()),x&&i.point(+e(f,d,c),+t(f,d,c));if(p)return i=null,p+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:$t(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:$t(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:$t(!!c),l):r},l.curve=function(c){return arguments.length?(s=c,a!=null&&(i=s(a)),l):s},l.context=function(c){return arguments.length?(c==null?a=i=null:i=s(a=c),l):a},l}function Xd(e,t,r){var a=null,s=$t(!0),i=null,o=i0,l=null,c=cb(d);e=typeof e=="function"?e:e===void 0?w6:$t(+e),t=typeof t=="function"?t:$t(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?N6:$t(+r);function d(f){var x,p,h,m=(f=db(f)).length,g,v=!1,b,y=new Array(m),N=new Array(m);for(i==null&&(l=o(b=c())),x=0;x<=m;++x){if(!(x<m&&s(g=f[x],x,f))===v)if(v=!v)p=x,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),h=x-1;h>=p;--h)l.point(y[h],N[h]);l.lineEnd(),l.areaEnd()}v&&(y[x]=+e(g,x,f),N[x]=+t(g,x,f),l.point(a?+a(g,x,f):y[x],r?+r(g,x,f):N[x]))}if(b)return l=null,b+""||null}function u(){return _6().defined(s).curve(o).context(i)}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:$t(+f),a=null,d):e},d.x0=function(f){return arguments.length?(e=typeof f=="function"?f:$t(+f),d):e},d.x1=function(f){return arguments.length?(a=f==null?null:typeof f=="function"?f:$t(+f),d):a},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:$t(+f),r=null,d):t},d.y0=function(f){return arguments.length?(t=typeof f=="function"?f:$t(+f),d):t},d.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:$t(+f),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(a).y(t)},d.defined=function(f){return arguments.length?(s=typeof f=="function"?f:$t(!!f),d):s},d.curve=function(f){return arguments.length?(o=f,i!=null&&(l=o(i)),d):o},d.context=function(f){return arguments.length?(f==null?i=l=null:l=o(i=f),d):i},d}class S6{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function vV(e){return new S6(e,!0)}function bV(e){return new S6(e,!1)}const ub={draw(e,t){const r=gn(t/$u);e.moveTo(r,0),e.arc(0,0,r,0,s0)}},jV={draw(e,t){const r=gn(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},k6=gn(1/3),wV=k6*2,NV={draw(e,t){const r=gn(t/wV),a=r*k6;e.moveTo(0,-r),e.lineTo(a,0),e.lineTo(0,r),e.lineTo(-a,0),e.closePath()}},_V={draw(e,t){const r=gn(t),a=-r/2;e.rect(a,a,r,r)}},SV=.8908130915292852,E6=Lu($u/10)/Lu(7*$u/10),kV=Lu(s0/10)*E6,EV=-v6(s0/10)*E6,TV={draw(e,t){const r=gn(t*SV),a=kV*r,s=EV*r;e.moveTo(0,-r),e.lineTo(a,s);for(let i=1;i<5;++i){const o=s0*i/5,l=v6(o),c=Lu(o);e.lineTo(c*r,-l*r),e.lineTo(l*a-c*s,c*a+l*s)}e.closePath()}},jm=gn(3),AV={draw(e,t){const r=-gn(t/(jm*3));e.moveTo(0,r*2),e.lineTo(-jm*r,-r),e.lineTo(jm*r,-r),e.closePath()}},$a=-.5,Ba=gn(3)/2,zg=1/gn(12),CV=(zg/2+1)*3,PV={draw(e,t){const r=gn(t/CV),a=r/2,s=r*zg,i=a,o=r*zg+r,l=-i,c=o;e.moveTo(a,s),e.lineTo(i,o),e.lineTo(l,c),e.lineTo($a*a-Ba*s,Ba*a+$a*s),e.lineTo($a*i-Ba*o,Ba*i+$a*o),e.lineTo($a*l-Ba*c,Ba*l+$a*c),e.lineTo($a*a+Ba*s,$a*s-Ba*a),e.lineTo($a*i+Ba*o,$a*o-Ba*i),e.lineTo($a*l+Ba*c,$a*c-Ba*l),e.closePath()}};function OV(e,t){let r=null,a=cb(s);e=typeof e=="function"?e:$t(e||ub),t=typeof t=="function"?t:$t(t===void 0?64:+t);function s(){let i;if(r||(r=i=a()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return s.type=function(i){return arguments.length?(e=typeof i=="function"?i:$t(i),s):e},s.size=function(i){return arguments.length?(t=typeof i=="function"?i:$t(+i),s):t},s.context=function(i){return arguments.length?(r=i??null,s):r},s}function Bu(){}function Uu(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function T6(e){this._context=e}T6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Uu(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Uu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function IV(e){return new T6(e)}function A6(e){this._context=e}A6.prototype={areaStart:Bu,areaEnd:Bu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Uu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function FV(e){return new A6(e)}function C6(e){this._context=e}C6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,a):this._context.moveTo(r,a);break;case 3:this._point=4;default:Uu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function DV(e){return new C6(e)}function P6(e){this._context=e}P6.prototype={areaStart:Bu,areaEnd:Bu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function RV(e){return new P6(e)}function EN(e){return e<0?-1:1}function TN(e,t,r){var a=e._x1-e._x0,s=t-e._x1,i=(e._y1-e._y0)/(a||s<0&&-0),o=(r-e._y1)/(s||a<0&&-0),l=(i*s+o*a)/(a+s);return(EN(i)+EN(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function AN(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function wm(e,t,r){var a=e._x0,s=e._y0,i=e._x1,o=e._y1,l=(i-a)/3;e._context.bezierCurveTo(a+l,s+l*t,i-l,o-l*r,i,o)}function qu(e){this._context=e}qu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:wm(this,this._t0,AN(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,wm(this,AN(this,r=TN(this,e,t)),r);break;default:wm(this,this._t0,r=TN(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function O6(e){this._context=new I6(e)}(O6.prototype=Object.create(qu.prototype)).point=function(e,t){qu.prototype.point.call(this,t,e)};function I6(e){this._context=e}I6.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,a,s,i){this._context.bezierCurveTo(t,e,a,r,i,s)}};function MV(e){return new qu(e)}function LV(e){return new O6(e)}function F6(e){this._context=e}F6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var a=CN(e),s=CN(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(a[0][i],s[0][i],a[1][i],s[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function CN(e){var t,r=e.length-1,a,s=new Array(r),i=new Array(r),o=new Array(r);for(s[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)s[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(s[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)a=s[t]/i[t-1],i[t]-=a,o[t]-=a*o[t-1];for(s[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)s[t]=(o[t]-s[t+1])/i[t];for(i[r-1]=(e[r]+s[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-s[t+1];return[s,i]}function $V(e){return new F6(e)}function o0(e,t){this._context=e,this._t=t}o0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function BV(e){return new o0(e,.5)}function UV(e){return new o0(e,0)}function qV(e){return new o0(e,1)}function Co(e,t){if((o=e.length)>1)for(var r=1,a,s,i=e[t[0]],o,l=i.length;r<o;++r)for(s=i,i=e[t[r]],a=0;a<l;++a)i[a][1]+=i[a][0]=isNaN(s[a][1])?s[a][0]:s[a][1]}function Vg(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function WV(e,t){return e[t]}function HV(e){const t=[];return t.key=e,t}function zV(){var e=$t([]),t=Vg,r=Co,a=WV;function s(i){var o=Array.from(e.apply(this,arguments),HV),l,c=o.length,d=-1,u;for(const f of i)for(l=0,++d;l<c;++l)(o[l][d]=[0,+a(f,o[l].key,d,i)]).data=f;for(l=0,u=db(t(o));l<c;++l)o[u[l]].index=l;return r(o,u),o}return s.keys=function(i){return arguments.length?(e=typeof i=="function"?i:$t(Array.from(i)),s):e},s.value=function(i){return arguments.length?(a=typeof i=="function"?i:$t(+i),s):a},s.order=function(i){return arguments.length?(t=i==null?Vg:typeof i=="function"?i:$t(Array.from(i)),s):t},s.offset=function(i){return arguments.length?(r=i??Co,s):r},s}function VV(e,t){if((a=e.length)>0){for(var r,a,s=0,i=e[0].length,o;s<i;++s){for(o=r=0;r<a;++r)o+=e[r][s][1]||0;if(o)for(r=0;r<a;++r)e[r][s][1]/=o}Co(e,t)}}function GV(e,t){if((s=e.length)>0){for(var r=0,a=e[t[0]],s,i=a.length;r<i;++r){for(var o=0,l=0;o<s;++o)l+=e[o][r][1]||0;a[r][1]+=a[r][0]=-l/2}Co(e,t)}}function KV(e,t){if(!(!((o=e.length)>0)||!((i=(s=e[t[0]]).length)>0))){for(var r=0,a=1,s,i,o;a<i;++a){for(var l=0,c=0,d=0;l<o;++l){for(var u=e[t[l]],f=u[a][1]||0,x=u[a-1][1]||0,p=(f-x)/2,h=0;h<l;++h){var m=e[t[h]],g=m[a][1]||0,v=m[a-1][1]||0;p+=g-v}c+=f,d+=p*f}s[a-1][1]+=s[a-1][0]=r,c&&(r-=d/c)}s[a-1][1]+=s[a-1][0]=r,Co(e,t)}}function Pc(e){"@babel/helpers - typeof";return Pc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pc(e)}var XV=["type","size","sizeType"];function Gg(){return Gg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Gg.apply(this,arguments)}function PN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ON(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PN(Object(r),!0).forEach(function(a){YV(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function YV(e,t,r){return t=JV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JV(e){var t=QV(e,"string");return Pc(t)=="symbol"?t:t+""}function QV(e,t){if(Pc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Pc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZV(e,t){if(e==null)return{};var r=eG(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function eG(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}var D6={symbolCircle:ub,symbolCross:jV,symbolDiamond:NV,symbolSquare:_V,symbolStar:TV,symbolTriangle:AV,symbolWye:PV},tG=Math.PI/180,rG=function(t){var r="symbol".concat(n0(t));return D6[r]||ub},aG=function(t,r,a){if(r==="area")return t;switch(a){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var s=18*tG;return 1.25*t*t*(Math.tan(s)-Math.tan(s*2)*Math.pow(Math.tan(s),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},nG=function(t,r){D6["symbol".concat(n0(t))]=r},fb=function(t){var r=t.type,a=r===void 0?"circle":r,s=t.size,i=s===void 0?64:s,o=t.sizeType,l=o===void 0?"area":o,c=ZV(t,XV),d=ON(ON({},c),{},{type:a,size:i,sizeType:l}),u=function(){var g=rG(a),v=OV().type(g).size(aG(i,l,a));return v()},f=d.className,x=d.cx,p=d.cy,h=Re(d,!0);return x===+x&&p===+p&&i===+i?ee.createElement("path",Gg({},h,{className:tt("recharts-symbols",f),transform:"translate(".concat(x,", ").concat(p,")"),d:u()})):null};fb.registerSymbol=nG;function Po(e){"@babel/helpers - typeof";return Po=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Po(e)}function Kg(){return Kg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Kg.apply(this,arguments)}function IN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function sG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IN(Object(r),!0).forEach(function(a){Oc(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function iG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oG(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,M6(a.key),a)}}function lG(e,t,r){return t&&oG(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function cG(e,t,r){return t=Wu(t),dG(e,R6()?Reflect.construct(t,r||[],Wu(e).constructor):t.apply(e,r))}function dG(e,t){if(t&&(Po(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uG(e)}function uG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R6(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(R6=function(){return!!e})()}function Wu(e){return Wu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wu(e)}function fG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xg(e,t)}function Xg(e,t){return Xg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Xg(e,t)}function Oc(e,t,r){return t=M6(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M6(e){var t=hG(e,"string");return Po(t)=="symbol"?t:t+""}function hG(e,t){if(Po(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Po(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ua=32,hb=(function(e){function t(){return iG(this,t),cG(this,t,arguments)}return fG(t,e),lG(t,[{key:"renderIcon",value:function(a){var s=this.props.inactiveColor,i=Ua/2,o=Ua/6,l=Ua/3,c=a.inactive?s:a.color;if(a.type==="plainline")return ee.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:a.payload.strokeDasharray,x1:0,y1:i,x2:Ua,y2:i,className:"recharts-legend-icon"});if(a.type==="line")return ee.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(l,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*l,",").concat(i,`
            H`).concat(Ua,"M").concat(2*l,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(l,",").concat(i),className:"recharts-legend-icon"});if(a.type==="rect")return ee.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Ua/8,"h").concat(Ua,"v").concat(Ua*3/4,"h").concat(-Ua,"z"),className:"recharts-legend-icon"});if(ee.isValidElement(a.legendIcon)){var d=sG({},a);return delete d.legendIcon,ee.cloneElement(a.legendIcon,d)}return ee.createElement(fb,{fill:c,cx:i,cy:i,size:Ua,sizeType:"diameter",type:a.type})}},{key:"renderItems",value:function(){var a=this,s=this.props,i=s.payload,o=s.iconSize,l=s.layout,c=s.formatter,d=s.inactiveColor,u={x:0,y:0,width:Ua,height:Ua},f={display:l==="horizontal"?"inline-block":"block",marginRight:10},x={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(p,h){var m=p.formatter||c,g=tt(Oc(Oc({"recharts-legend-item":!0},"legend-item-".concat(h),!0),"inactive",p.inactive));if(p.type==="none")return null;var v=qe(p.value)?null:p.value;pn(!qe(p.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=p.inactive?d:p.color;return ee.createElement("li",Kg({className:g,style:f,key:"legend-item-".concat(h)},Ti(a.props,p,h)),ee.createElement(Ug,{width:o,height:o,viewBox:u,style:x},a.renderIcon(p)),ee.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},m?m(v,p,h):v))})}},{key:"render",value:function(){var a=this.props,s=a.payload,i=a.layout,o=a.align;if(!s||!s.length)return null;var l={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return ee.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])})(C.PureComponent);Oc(hb,"displayName","Legend");Oc(hb,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var Nm,FN;function mG(){if(FN)return Nm;FN=1;var e=t0();function t(){this.__data__=new e,this.size=0}return Nm=t,Nm}var _m,DN;function xG(){if(DN)return _m;DN=1;function e(t){var r=this.__data__,a=r.delete(t);return this.size=r.size,a}return _m=e,_m}var Sm,RN;function pG(){if(RN)return Sm;RN=1;function e(t){return this.__data__.get(t)}return Sm=e,Sm}var km,MN;function gG(){if(MN)return km;MN=1;function e(t){return this.__data__.has(t)}return km=e,km}var Em,LN;function yG(){if(LN)return Em;LN=1;var e=t0(),t=ab(),r=nb(),a=200;function s(i,o){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<a-1)return c.push([i,o]),this.size=++l.size,this;l=this.__data__=new r(c)}return l.set(i,o),this.size=l.size,this}return Em=s,Em}var Tm,$N;function L6(){if($N)return Tm;$N=1;var e=t0(),t=mG(),r=xG(),a=pG(),s=gG(),i=yG();function o(l){var c=this.__data__=new e(l);this.size=c.size}return o.prototype.clear=t,o.prototype.delete=r,o.prototype.get=a,o.prototype.has=s,o.prototype.set=i,Tm=o,Tm}var Am,BN;function vG(){if(BN)return Am;BN=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return Am=t,Am}var Cm,UN;function bG(){if(UN)return Cm;UN=1;function e(t){return this.__data__.has(t)}return Cm=e,Cm}var Pm,qN;function $6(){if(qN)return Pm;qN=1;var e=nb(),t=vG(),r=bG();function a(s){var i=-1,o=s==null?0:s.length;for(this.__data__=new e;++i<o;)this.add(s[i])}return a.prototype.add=a.prototype.push=t,a.prototype.has=r,Pm=a,Pm}var Om,WN;function B6(){if(WN)return Om;WN=1;function e(t,r){for(var a=-1,s=t==null?0:t.length;++a<s;)if(r(t[a],a,t))return!0;return!1}return Om=e,Om}var Im,HN;function U6(){if(HN)return Im;HN=1;function e(t,r){return t.has(r)}return Im=e,Im}var Fm,zN;function q6(){if(zN)return Fm;zN=1;var e=$6(),t=B6(),r=U6(),a=1,s=2;function i(o,l,c,d,u,f){var x=c&a,p=o.length,h=l.length;if(p!=h&&!(x&&h>p))return!1;var m=f.get(o),g=f.get(l);if(m&&g)return m==l&&g==o;var v=-1,b=!0,y=c&s?new e:void 0;for(f.set(o,l),f.set(l,o);++v<p;){var N=o[v],j=l[v];if(d)var w=x?d(j,N,v,l,o,f):d(N,j,v,o,l,f);if(w!==void 0){if(w)continue;b=!1;break}if(y){if(!t(l,function(_,S){if(!r(y,S)&&(N===_||u(N,_,c,d,f)))return y.push(S)})){b=!1;break}}else if(!(N===j||u(N,j,c,d,f))){b=!1;break}}return f.delete(o),f.delete(l),b}return Fm=i,Fm}var Dm,VN;function jG(){if(VN)return Dm;VN=1;var e=Rn(),t=e.Uint8Array;return Dm=t,Dm}var Rm,GN;function wG(){if(GN)return Rm;GN=1;function e(t){var r=-1,a=Array(t.size);return t.forEach(function(s,i){a[++r]=[i,s]}),a}return Rm=e,Rm}var Mm,KN;function mb(){if(KN)return Mm;KN=1;function e(t){var r=-1,a=Array(t.size);return t.forEach(function(s){a[++r]=s}),a}return Mm=e,Mm}var Lm,XN;function NG(){if(XN)return Lm;XN=1;var e=Nd(),t=jG(),r=rb(),a=q6(),s=wG(),i=mb(),o=1,l=2,c="[object Boolean]",d="[object Date]",u="[object Error]",f="[object Map]",x="[object Number]",p="[object RegExp]",h="[object Set]",m="[object String]",g="[object Symbol]",v="[object ArrayBuffer]",b="[object DataView]",y=e?e.prototype:void 0,N=y?y.valueOf:void 0;function j(w,_,S,k,E,A,P){switch(S){case b:if(w.byteLength!=_.byteLength||w.byteOffset!=_.byteOffset)return!1;w=w.buffer,_=_.buffer;case v:return!(w.byteLength!=_.byteLength||!A(new t(w),new t(_)));case c:case d:case x:return r(+w,+_);case u:return w.name==_.name&&w.message==_.message;case p:case m:return w==_+"";case f:var L=s;case h:var R=k&o;if(L||(L=i),w.size!=_.size&&!R)return!1;var I=P.get(w);if(I)return I==_;k|=l,P.set(w,_);var D=a(L(w),L(_),k,E,A,P);return P.delete(w),D;case g:if(N)return N.call(w)==N.call(_)}return!1}return Lm=j,Lm}var $m,YN;function W6(){if(YN)return $m;YN=1;function e(t,r){for(var a=-1,s=r.length,i=t.length;++a<s;)t[i+a]=r[a];return t}return $m=e,$m}var Bm,JN;function _G(){if(JN)return Bm;JN=1;var e=W6(),t=Na();function r(a,s,i){var o=s(a);return t(a)?o:e(o,i(a))}return Bm=r,Bm}var Um,QN;function SG(){if(QN)return Um;QN=1;function e(t,r){for(var a=-1,s=t==null?0:t.length,i=0,o=[];++a<s;){var l=t[a];r(l,a,t)&&(o[i++]=l)}return o}return Um=e,Um}var qm,ZN;function kG(){if(ZN)return qm;ZN=1;function e(){return[]}return qm=e,qm}var Wm,e2;function EG(){if(e2)return Wm;e2=1;var e=SG(),t=kG(),r=Object.prototype,a=r.propertyIsEnumerable,s=Object.getOwnPropertySymbols,i=s?function(o){return o==null?[]:(o=Object(o),e(s(o),function(l){return a.call(o,l)}))}:t;return Wm=i,Wm}var Hm,t2;function TG(){if(t2)return Hm;t2=1;function e(t,r){for(var a=-1,s=Array(t);++a<t;)s[a]=r(a);return s}return Hm=e,Hm}var zm,r2;function AG(){if(r2)return zm;r2=1;var e=us(),t=fs(),r="[object Arguments]";function a(s){return t(s)&&e(s)==r}return zm=a,zm}var Vm,a2;function xb(){if(a2)return Vm;a2=1;var e=AG(),t=fs(),r=Object.prototype,a=r.hasOwnProperty,s=r.propertyIsEnumerable,i=e((function(){return arguments})())?e:function(o){return t(o)&&a.call(o,"callee")&&!s.call(o,"callee")};return Vm=i,Vm}var Hl={exports:{}},Gm,n2;function CG(){if(n2)return Gm;n2=1;function e(){return!1}return Gm=e,Gm}Hl.exports;var s2;function H6(){return s2||(s2=1,(function(e,t){var r=Rn(),a=CG(),s=t&&!t.nodeType&&t,i=s&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===s,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||a;e.exports=d})(Hl,Hl.exports)),Hl.exports}var Km,i2;function pb(){if(i2)return Km;i2=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(a,s){var i=typeof a;return s=s??e,!!s&&(i=="number"||i!="symbol"&&t.test(a))&&a>-1&&a%1==0&&a<s}return Km=r,Km}var Xm,o2;function gb(){if(o2)return Xm;o2=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return Xm=t,Xm}var Ym,l2;function PG(){if(l2)return Ym;l2=1;var e=us(),t=gb(),r=fs(),a="[object Arguments]",s="[object Array]",i="[object Boolean]",o="[object Date]",l="[object Error]",c="[object Function]",d="[object Map]",u="[object Number]",f="[object Object]",x="[object RegExp]",p="[object Set]",h="[object String]",m="[object WeakMap]",g="[object ArrayBuffer]",v="[object DataView]",b="[object Float32Array]",y="[object Float64Array]",N="[object Int8Array]",j="[object Int16Array]",w="[object Int32Array]",_="[object Uint8Array]",S="[object Uint8ClampedArray]",k="[object Uint16Array]",E="[object Uint32Array]",A={};A[b]=A[y]=A[N]=A[j]=A[w]=A[_]=A[S]=A[k]=A[E]=!0,A[a]=A[s]=A[g]=A[i]=A[v]=A[o]=A[l]=A[c]=A[d]=A[u]=A[f]=A[x]=A[p]=A[h]=A[m]=!1;function P(L){return r(L)&&t(L.length)&&!!A[e(L)]}return Ym=P,Ym}var Jm,c2;function z6(){if(c2)return Jm;c2=1;function e(t){return function(r){return t(r)}}return Jm=e,Jm}var zl={exports:{}};zl.exports;var d2;function OG(){return d2||(d2=1,(function(e,t){var r=u6(),a=t&&!t.nodeType&&t,s=a&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===a,o=i&&r.process,l=(function(){try{var c=s&&s.require&&s.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}})();e.exports=l})(zl,zl.exports)),zl.exports}var Qm,u2;function V6(){if(u2)return Qm;u2=1;var e=PG(),t=z6(),r=OG(),a=r&&r.isTypedArray,s=a?t(a):e;return Qm=s,Qm}var Zm,f2;function IG(){if(f2)return Zm;f2=1;var e=TG(),t=xb(),r=Na(),a=H6(),s=pb(),i=V6(),o=Object.prototype,l=o.hasOwnProperty;function c(d,u){var f=r(d),x=!f&&t(d),p=!f&&!x&&a(d),h=!f&&!x&&!p&&i(d),m=f||x||p||h,g=m?e(d.length,String):[],v=g.length;for(var b in d)(u||l.call(d,b))&&!(m&&(b=="length"||p&&(b=="offset"||b=="parent")||h&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||s(b,v)))&&g.push(b);return g}return Zm=c,Zm}var ex,h2;function FG(){if(h2)return ex;h2=1;var e=Object.prototype;function t(r){var a=r&&r.constructor,s=typeof a=="function"&&a.prototype||e;return r===s}return ex=t,ex}var tx,m2;function G6(){if(m2)return tx;m2=1;function e(t,r){return function(a){return t(r(a))}}return tx=e,tx}var rx,x2;function DG(){if(x2)return rx;x2=1;var e=G6(),t=e(Object.keys,Object);return rx=t,rx}var ax,p2;function RG(){if(p2)return ax;p2=1;var e=FG(),t=DG(),r=Object.prototype,a=r.hasOwnProperty;function s(i){if(!e(i))return t(i);var o=[];for(var l in Object(i))a.call(i,l)&&l!="constructor"&&o.push(l);return o}return ax=s,ax}var nx,g2;function _d(){if(g2)return nx;g2=1;var e=tb(),t=gb();function r(a){return a!=null&&t(a.length)&&!e(a)}return nx=r,nx}var sx,y2;function l0(){if(y2)return sx;y2=1;var e=IG(),t=RG(),r=_d();function a(s){return r(s)?e(s):t(s)}return sx=a,sx}var ix,v2;function MG(){if(v2)return ix;v2=1;var e=_G(),t=EG(),r=l0();function a(s){return e(s,r,t)}return ix=a,ix}var ox,b2;function LG(){if(b2)return ox;b2=1;var e=MG(),t=1,r=Object.prototype,a=r.hasOwnProperty;function s(i,o,l,c,d,u){var f=l&t,x=e(i),p=x.length,h=e(o),m=h.length;if(p!=m&&!f)return!1;for(var g=p;g--;){var v=x[g];if(!(f?v in o:a.call(o,v)))return!1}var b=u.get(i),y=u.get(o);if(b&&y)return b==o&&y==i;var N=!0;u.set(i,o),u.set(o,i);for(var j=f;++g<p;){v=x[g];var w=i[v],_=o[v];if(c)var S=f?c(_,w,v,o,i,u):c(w,_,v,i,o,u);if(!(S===void 0?w===_||d(w,_,l,c,u):S)){N=!1;break}j||(j=v=="constructor")}if(N&&!j){var k=i.constructor,E=o.constructor;k!=E&&"constructor"in i&&"constructor"in o&&!(typeof k=="function"&&k instanceof k&&typeof E=="function"&&E instanceof E)&&(N=!1)}return u.delete(i),u.delete(o),N}return ox=s,ox}var lx,j2;function $G(){if(j2)return lx;j2=1;var e=Bi(),t=Rn(),r=e(t,"DataView");return lx=r,lx}var cx,w2;function BG(){if(w2)return cx;w2=1;var e=Bi(),t=Rn(),r=e(t,"Promise");return cx=r,cx}var dx,N2;function K6(){if(N2)return dx;N2=1;var e=Bi(),t=Rn(),r=e(t,"Set");return dx=r,dx}var ux,_2;function UG(){if(_2)return ux;_2=1;var e=Bi(),t=Rn(),r=e(t,"WeakMap");return ux=r,ux}var fx,S2;function qG(){if(S2)return fx;S2=1;var e=$G(),t=ab(),r=BG(),a=K6(),s=UG(),i=us(),o=f6(),l="[object Map]",c="[object Object]",d="[object Promise]",u="[object Set]",f="[object WeakMap]",x="[object DataView]",p=o(e),h=o(t),m=o(r),g=o(a),v=o(s),b=i;return(e&&b(new e(new ArrayBuffer(1)))!=x||t&&b(new t)!=l||r&&b(r.resolve())!=d||a&&b(new a)!=u||s&&b(new s)!=f)&&(b=function(y){var N=i(y),j=N==c?y.constructor:void 0,w=j?o(j):"";if(w)switch(w){case p:return x;case h:return l;case m:return d;case g:return u;case v:return f}return N}),fx=b,fx}var hx,k2;function WG(){if(k2)return hx;k2=1;var e=L6(),t=q6(),r=NG(),a=LG(),s=qG(),i=Na(),o=H6(),l=V6(),c=1,d="[object Arguments]",u="[object Array]",f="[object Object]",x=Object.prototype,p=x.hasOwnProperty;function h(m,g,v,b,y,N){var j=i(m),w=i(g),_=j?u:s(m),S=w?u:s(g);_=_==d?f:_,S=S==d?f:S;var k=_==f,E=S==f,A=_==S;if(A&&o(m)){if(!o(g))return!1;j=!0,k=!1}if(A&&!k)return N||(N=new e),j||l(m)?t(m,g,v,b,y,N):r(m,g,_,v,b,y,N);if(!(v&c)){var P=k&&p.call(m,"__wrapped__"),L=E&&p.call(g,"__wrapped__");if(P||L){var R=P?m.value():m,I=L?g.value():g;return N||(N=new e),y(R,I,v,b,N)}}return A?(N||(N=new e),a(m,g,v,b,y,N)):!1}return hx=h,hx}var mx,E2;function yb(){if(E2)return mx;E2=1;var e=WG(),t=fs();function r(a,s,i,o,l){return a===s?!0:a==null||s==null||!t(a)&&!t(s)?a!==a&&s!==s:e(a,s,i,o,r,l)}return mx=r,mx}var xx,T2;function HG(){if(T2)return xx;T2=1;var e=L6(),t=yb(),r=1,a=2;function s(i,o,l,c){var d=l.length,u=d,f=!c;if(i==null)return!u;for(i=Object(i);d--;){var x=l[d];if(f&&x[2]?x[1]!==i[x[0]]:!(x[0]in i))return!1}for(;++d<u;){x=l[d];var p=x[0],h=i[p],m=x[1];if(f&&x[2]){if(h===void 0&&!(p in i))return!1}else{var g=new e;if(c)var v=c(h,m,p,i,o,g);if(!(v===void 0?t(m,h,r|a,c,g):v))return!1}}return!0}return xx=s,xx}var px,A2;function X6(){if(A2)return px;A2=1;var e=Us();function t(r){return r===r&&!e(r)}return px=t,px}var gx,C2;function zG(){if(C2)return gx;C2=1;var e=X6(),t=l0();function r(a){for(var s=t(a),i=s.length;i--;){var o=s[i],l=a[o];s[i]=[o,l,e(l)]}return s}return gx=r,gx}var yx,P2;function Y6(){if(P2)return yx;P2=1;function e(t,r){return function(a){return a==null?!1:a[t]===r&&(r!==void 0||t in Object(a))}}return yx=e,yx}var vx,O2;function VG(){if(O2)return vx;O2=1;var e=HG(),t=zG(),r=Y6();function a(s){var i=t(s);return i.length==1&&i[0][2]?r(i[0][0],i[0][1]):function(o){return o===s||e(o,s,i)}}return vx=a,vx}var bx,I2;function GG(){if(I2)return bx;I2=1;function e(t,r){return t!=null&&r in Object(t)}return bx=e,bx}var jx,F2;function KG(){if(F2)return jx;F2=1;var e=x6(),t=xb(),r=Na(),a=pb(),s=gb(),i=a0();function o(l,c,d){c=e(c,l);for(var u=-1,f=c.length,x=!1;++u<f;){var p=i(c[u]);if(!(x=l!=null&&d(l,p)))break;l=l[p]}return x||++u!=f?x:(f=l==null?0:l.length,!!f&&s(f)&&a(p,f)&&(r(l)||t(l)))}return jx=o,jx}var wx,D2;function XG(){if(D2)return wx;D2=1;var e=GG(),t=KG();function r(a,s){return a!=null&&t(a,s,e)}return wx=r,wx}var Nx,R2;function YG(){if(R2)return Nx;R2=1;var e=yb(),t=p6(),r=XG(),a=eb(),s=X6(),i=Y6(),o=a0(),l=1,c=2;function d(u,f){return a(u)&&s(f)?i(o(u),f):function(x){var p=t(x,u);return p===void 0&&p===f?r(x,u):e(f,p,l|c)}}return Nx=d,Nx}var _x,M2;function pl(){if(M2)return _x;M2=1;function e(t){return t}return _x=e,_x}var Sx,L2;function JG(){if(L2)return Sx;L2=1;function e(t){return function(r){return r==null?void 0:r[t]}}return Sx=e,Sx}var kx,$2;function QG(){if($2)return kx;$2=1;var e=ib();function t(r){return function(a){return e(a,r)}}return kx=t,kx}var Ex,B2;function ZG(){if(B2)return Ex;B2=1;var e=JG(),t=QG(),r=eb(),a=a0();function s(i){return r(i)?e(a(i)):t(i)}return Ex=s,Ex}var Tx,U2;function Mn(){if(U2)return Tx;U2=1;var e=VG(),t=YG(),r=pl(),a=Na(),s=ZG();function i(o){return typeof o=="function"?o:o==null?r:typeof o=="object"?a(o)?t(o[0],o[1]):e(o):s(o)}return Tx=i,Tx}var Ax,q2;function J6(){if(q2)return Ax;q2=1;function e(t,r,a,s){for(var i=t.length,o=a+(s?1:-1);s?o--:++o<i;)if(r(t[o],o,t))return o;return-1}return Ax=e,Ax}var Cx,W2;function eK(){if(W2)return Cx;W2=1;function e(t){return t!==t}return Cx=e,Cx}var Px,H2;function tK(){if(H2)return Px;H2=1;function e(t,r,a){for(var s=a-1,i=t.length;++s<i;)if(t[s]===r)return s;return-1}return Px=e,Px}var Ox,z2;function rK(){if(z2)return Ox;z2=1;var e=J6(),t=eK(),r=tK();function a(s,i,o){return i===i?r(s,i,o):e(s,t,o)}return Ox=a,Ox}var Ix,V2;function aK(){if(V2)return Ix;V2=1;var e=rK();function t(r,a){var s=r==null?0:r.length;return!!s&&e(r,a,0)>-1}return Ix=t,Ix}var Fx,G2;function nK(){if(G2)return Fx;G2=1;function e(t,r,a){for(var s=-1,i=t==null?0:t.length;++s<i;)if(a(r,t[s]))return!0;return!1}return Fx=e,Fx}var Dx,K2;function sK(){if(K2)return Dx;K2=1;function e(){}return Dx=e,Dx}var Rx,X2;function iK(){if(X2)return Rx;X2=1;var e=K6(),t=sK(),r=mb(),a=1/0,s=e&&1/r(new e([,-0]))[1]==a?function(i){return new e(i)}:t;return Rx=s,Rx}var Mx,Y2;function oK(){if(Y2)return Mx;Y2=1;var e=$6(),t=aK(),r=nK(),a=U6(),s=iK(),i=mb(),o=200;function l(c,d,u){var f=-1,x=t,p=c.length,h=!0,m=[],g=m;if(u)h=!1,x=r;else if(p>=o){var v=d?null:s(c);if(v)return i(v);h=!1,x=a,g=new e}else g=d?[]:m;e:for(;++f<p;){var b=c[f],y=d?d(b):b;if(b=u||b!==0?b:0,h&&y===y){for(var N=g.length;N--;)if(g[N]===y)continue e;d&&g.push(y),m.push(b)}else x(g,y,u)||(g!==m&&g.push(y),m.push(b))}return m}return Mx=l,Mx}var Lx,J2;function lK(){if(J2)return Lx;J2=1;var e=Mn(),t=oK();function r(a,s){return a&&a.length?t(a,e(s,2)):[]}return Lx=r,Lx}var cK=lK();const Q2=Ct(cK);function Q6(e,t,r){return t===!0?Q2(e,r):qe(t)?Q2(e,t):e}function Oo(e){"@babel/helpers - typeof";return Oo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oo(e)}var dK=["ref"];function Z2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Un(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z2(Object(r),!0).forEach(function(a){c0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function uK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function e_(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,e3(a.key),a)}}function fK(e,t,r){return t&&e_(e.prototype,t),r&&e_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hK(e,t,r){return t=Hu(t),mK(e,Z6()?Reflect.construct(t,r||[],Hu(e).constructor):t.apply(e,r))}function mK(e,t){if(t&&(Oo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xK(e)}function xK(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z6(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Z6=function(){return!!e})()}function Hu(e){return Hu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hu(e)}function pK(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yg(e,t)}function Yg(e,t){return Yg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Yg(e,t)}function c0(e,t,r){return t=e3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e3(e){var t=gK(e,"string");return Oo(t)=="symbol"?t:t+""}function gK(e,t){if(Oo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Oo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function yK(e,t){if(e==null)return{};var r=vK(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function vK(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function bK(e){return e.value}function jK(e,t){if(ee.isValidElement(e))return ee.cloneElement(e,t);if(typeof e=="function")return ee.createElement(e,t);t.ref;var r=yK(t,dK);return ee.createElement(hb,r)}var t_=1,go=(function(e){function t(){var r;uK(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return r=hK(this,t,[].concat(s)),c0(r,"lastBoundingBox",{width:-1,height:-1}),r}return pK(t,e),fK(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var a=this.wrapperNode.getBoundingClientRect();return a.height=this.wrapperNode.offsetHeight,a.width=this.wrapperNode.offsetWidth,a}return null}},{key:"updateBBox",value:function(){var a=this.props.onBBoxUpdate,s=this.getBBox();s?(Math.abs(s.width-this.lastBoundingBox.width)>t_||Math.abs(s.height-this.lastBoundingBox.height)>t_)&&(this.lastBoundingBox.width=s.width,this.lastBoundingBox.height=s.height,a&&a(s)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,a&&a(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Un({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(a){var s=this.props,i=s.layout,o=s.align,l=s.verticalAlign,c=s.margin,d=s.chartWidth,u=s.chartHeight,f,x;if(!a||(a.left===void 0||a.left===null)&&(a.right===void 0||a.right===null))if(o==="center"&&i==="vertical"){var p=this.getBBoxSnapshot();f={left:((d||0)-p.width)/2}}else f=o==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!a||(a.top===void 0||a.top===null)&&(a.bottom===void 0||a.bottom===null))if(l==="middle"){var h=this.getBBoxSnapshot();x={top:((u||0)-h.height)/2}}else x=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return Un(Un({},f),x)}},{key:"render",value:function(){var a=this,s=this.props,i=s.content,o=s.width,l=s.height,c=s.wrapperStyle,d=s.payloadUniqBy,u=s.payload,f=Un(Un({position:"absolute",width:o||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return ee.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(p){a.wrapperNode=p}},jK(i,Un(Un({},this.props),{},{payload:Q6(u,d,bK)})))}}],[{key:"getWithHeight",value:function(a,s){var i=Un(Un({},this.defaultProps),a.props),o=i.layout;return o==="vertical"&&be(a.props.height)?{height:a.props.height}:o==="horizontal"?{width:a.props.width||s}:null}}])})(C.PureComponent);c0(go,"displayName","Legend");c0(go,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var $x,r_;function wK(){if(r_)return $x;r_=1;var e=Nd(),t=xb(),r=Na(),a=e?e.isConcatSpreadable:void 0;function s(i){return r(i)||t(i)||!!(a&&i&&i[a])}return $x=s,$x}var Bx,a_;function t3(){if(a_)return Bx;a_=1;var e=W6(),t=wK();function r(a,s,i,o,l){var c=-1,d=a.length;for(i||(i=t),l||(l=[]);++c<d;){var u=a[c];s>0&&i(u)?s>1?r(u,s-1,i,o,l):e(l,u):o||(l[l.length]=u)}return l}return Bx=r,Bx}var Ux,n_;function NK(){if(n_)return Ux;n_=1;function e(t){return function(r,a,s){for(var i=-1,o=Object(r),l=s(r),c=l.length;c--;){var d=l[t?c:++i];if(a(o[d],d,o)===!1)break}return r}}return Ux=e,Ux}var qx,s_;function _K(){if(s_)return qx;s_=1;var e=NK(),t=e();return qx=t,qx}var Wx,i_;function r3(){if(i_)return Wx;i_=1;var e=_K(),t=l0();function r(a,s){return a&&e(a,s,t)}return Wx=r,Wx}var Hx,o_;function SK(){if(o_)return Hx;o_=1;var e=_d();function t(r,a){return function(s,i){if(s==null)return s;if(!e(s))return r(s,i);for(var o=s.length,l=a?o:-1,c=Object(s);(a?l--:++l<o)&&i(c[l],l,c)!==!1;);return s}}return Hx=t,Hx}var zx,l_;function vb(){if(l_)return zx;l_=1;var e=r3(),t=SK(),r=t(e);return zx=r,zx}var Vx,c_;function a3(){if(c_)return Vx;c_=1;var e=vb(),t=_d();function r(a,s){var i=-1,o=t(a)?Array(a.length):[];return e(a,function(l,c,d){o[++i]=s(l,c,d)}),o}return Vx=r,Vx}var Gx,d_;function kK(){if(d_)return Gx;d_=1;function e(t,r){var a=t.length;for(t.sort(r);a--;)t[a]=t[a].value;return t}return Gx=e,Gx}var Kx,u_;function EK(){if(u_)return Kx;u_=1;var e=fl();function t(r,a){if(r!==a){var s=r!==void 0,i=r===null,o=r===r,l=e(r),c=a!==void 0,d=a===null,u=a===a,f=e(a);if(!d&&!f&&!l&&r>a||l&&c&&u&&!d&&!f||i&&c&&u||!s&&u||!o)return 1;if(!i&&!l&&!f&&r<a||f&&s&&o&&!i&&!l||d&&s&&o||!c&&o||!u)return-1}return 0}return Kx=t,Kx}var Xx,f_;function TK(){if(f_)return Xx;f_=1;var e=EK();function t(r,a,s){for(var i=-1,o=r.criteria,l=a.criteria,c=o.length,d=s.length;++i<c;){var u=e(o[i],l[i]);if(u){if(i>=d)return u;var f=s[i];return u*(f=="desc"?-1:1)}}return r.index-a.index}return Xx=t,Xx}var Yx,h_;function AK(){if(h_)return Yx;h_=1;var e=sb(),t=ib(),r=Mn(),a=a3(),s=kK(),i=z6(),o=TK(),l=pl(),c=Na();function d(u,f,x){f.length?f=e(f,function(m){return c(m)?function(g){return t(g,m.length===1?m[0]:m)}:m}):f=[l];var p=-1;f=e(f,i(r));var h=a(u,function(m,g,v){var b=e(f,function(y){return y(m)});return{criteria:b,index:++p,value:m}});return s(h,function(m,g){return o(m,g,x)})}return Yx=d,Yx}var Jx,m_;function CK(){if(m_)return Jx;m_=1;function e(t,r,a){switch(a.length){case 0:return t.call(r);case 1:return t.call(r,a[0]);case 2:return t.call(r,a[0],a[1]);case 3:return t.call(r,a[0],a[1],a[2])}return t.apply(r,a)}return Jx=e,Jx}var Qx,x_;function PK(){if(x_)return Qx;x_=1;var e=CK(),t=Math.max;function r(a,s,i){return s=t(s===void 0?a.length-1:s,0),function(){for(var o=arguments,l=-1,c=t(o.length-s,0),d=Array(c);++l<c;)d[l]=o[s+l];l=-1;for(var u=Array(s+1);++l<s;)u[l]=o[l];return u[s]=i(d),e(a,this,u)}}return Qx=r,Qx}var Zx,p_;function OK(){if(p_)return Zx;p_=1;function e(t){return function(){return t}}return Zx=e,Zx}var ep,g_;function n3(){if(g_)return ep;g_=1;var e=Bi(),t=(function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}})();return ep=t,ep}var tp,y_;function IK(){if(y_)return tp;y_=1;var e=OK(),t=n3(),r=pl(),a=t?function(s,i){return t(s,"toString",{configurable:!0,enumerable:!1,value:e(i),writable:!0})}:r;return tp=a,tp}var rp,v_;function FK(){if(v_)return rp;v_=1;var e=800,t=16,r=Date.now;function a(s){var i=0,o=0;return function(){var l=r(),c=t-(l-o);if(o=l,c>0){if(++i>=e)return arguments[0]}else i=0;return s.apply(void 0,arguments)}}return rp=a,rp}var ap,b_;function DK(){if(b_)return ap;b_=1;var e=IK(),t=FK(),r=t(e);return ap=r,ap}var np,j_;function RK(){if(j_)return np;j_=1;var e=pl(),t=PK(),r=DK();function a(s,i){return r(t(s,i,e),s+"")}return np=a,np}var sp,w_;function d0(){if(w_)return sp;w_=1;var e=rb(),t=_d(),r=pb(),a=Us();function s(i,o,l){if(!a(l))return!1;var c=typeof o;return(c=="number"?t(l)&&r(o,l.length):c=="string"&&o in l)?e(l[o],i):!1}return sp=s,sp}var ip,N_;function MK(){if(N_)return ip;N_=1;var e=t3(),t=AK(),r=RK(),a=d0(),s=r(function(i,o){if(i==null)return[];var l=o.length;return l>1&&a(i,o[0],o[1])?o=[]:l>2&&a(o[0],o[1],o[2])&&(o=[o[0]]),t(i,e(o,1),[])});return ip=s,ip}var LK=MK();const bb=Ct(LK);function Ic(e){"@babel/helpers - typeof";return Ic=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ic(e)}function Jg(){return Jg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Jg.apply(this,arguments)}function $K(e,t){return WK(e)||qK(e,t)||UK(e,t)||BK()}function BK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UK(e,t){if(e){if(typeof e=="string")return __(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return __(e,t)}}function __(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function qK(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function WK(e){if(Array.isArray(e))return e}function S_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function op(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S_(Object(r),!0).forEach(function(a){HK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S_(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function HK(e,t,r){return t=zK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zK(e){var t=VK(e,"string");return Ic(t)=="symbol"?t:t+""}function VK(e,t){if(Ic(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Ic(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GK(e){return Array.isArray(e)&&Ar(e[0])&&Ar(e[1])?e.join(" ~ "):e}var KK=function(t){var r=t.separator,a=r===void 0?" : ":r,s=t.contentStyle,i=s===void 0?{}:s,o=t.itemStyle,l=o===void 0?{}:o,c=t.labelStyle,d=c===void 0?{}:c,u=t.payload,f=t.formatter,x=t.itemSorter,p=t.wrapperClassName,h=t.labelClassName,m=t.label,g=t.labelFormatter,v=t.accessibilityLayer,b=v===void 0?!1:v,y=function(){if(u&&u.length){var P={padding:0,margin:0},L=(x?bb(u,x):u).map(function(R,I){if(R.type==="none")return null;var D=op({display:"block",paddingTop:4,paddingBottom:4,color:R.color||"#000"},l),V=R.formatter||f||GK,F=R.value,U=R.name,q=F,K=U;if(V&&q!=null&&K!=null){var T=V(F,U,R,I,u);if(Array.isArray(T)){var O=$K(T,2);q=O[0],K=O[1]}else q=T}return ee.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(I),style:D},Ar(K)?ee.createElement("span",{className:"recharts-tooltip-item-name"},K):null,Ar(K)?ee.createElement("span",{className:"recharts-tooltip-item-separator"},a):null,ee.createElement("span",{className:"recharts-tooltip-item-value"},q),ee.createElement("span",{className:"recharts-tooltip-item-unit"},R.unit||""))});return ee.createElement("ul",{className:"recharts-tooltip-item-list",style:P},L)}return null},N=op({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),j=op({margin:0},d),w=!Je(m),_=w?m:"",S=tt("recharts-default-tooltip",p),k=tt("recharts-tooltip-label",h);w&&g&&u!==void 0&&u!==null&&(_=g(m,u));var E=b?{role:"status","aria-live":"assertive"}:{};return ee.createElement("div",Jg({className:S,style:N},E),ee.createElement("p",{className:k,style:j},ee.isValidElement(_)?_:"".concat(_)),y())};function Fc(e){"@babel/helpers - typeof";return Fc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fc(e)}function Yd(e,t,r){return t=XK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XK(e){var t=YK(e,"string");return Fc(t)=="symbol"?t:t+""}function YK(e,t){if(Fc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Fc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pl="recharts-tooltip-wrapper",JK={visibility:"hidden"};function QK(e){var t=e.coordinate,r=e.translateX,a=e.translateY;return tt(Pl,Yd(Yd(Yd(Yd({},"".concat(Pl,"-right"),be(r)&&t&&be(t.x)&&r>=t.x),"".concat(Pl,"-left"),be(r)&&t&&be(t.x)&&r<t.x),"".concat(Pl,"-bottom"),be(a)&&t&&be(t.y)&&a>=t.y),"".concat(Pl,"-top"),be(a)&&t&&be(t.y)&&a<t.y))}function k_(e){var t=e.allowEscapeViewBox,r=e.coordinate,a=e.key,s=e.offsetTopLeft,i=e.position,o=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,d=e.viewBoxDimension;if(i&&be(i[a]))return i[a];var u=r[a]-l-s,f=r[a]+s;if(t[a])return o[a]?u:f;if(o[a]){var x=u,p=c[a];return x<p?Math.max(f,c[a]):Math.max(u,c[a])}var h=f+l,m=c[a]+d;return h>m?Math.max(u,c[a]):Math.max(f,c[a])}function ZK(e){var t=e.translateX,r=e.translateY,a=e.useTranslate3d;return{transform:a?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function eX(e){var t=e.allowEscapeViewBox,r=e.coordinate,a=e.offsetTopLeft,s=e.position,i=e.reverseDirection,o=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,d,u,f;return o.height>0&&o.width>0&&r?(u=k_({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:a,position:s,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),f=k_({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:a,position:s,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),d=ZK({translateX:u,translateY:f,useTranslate3d:l})):d=JK,{cssProperties:d,cssClasses:QK({translateX:u,translateY:f,coordinate:r})}}function Io(e){"@babel/helpers - typeof";return Io=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Io(e)}function E_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function T_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E_(Object(r),!0).forEach(function(a){Zg(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E_(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function tX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rX(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,i3(a.key),a)}}function aX(e,t,r){return t&&rX(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function nX(e,t,r){return t=zu(t),sX(e,s3()?Reflect.construct(t,r||[],zu(e).constructor):t.apply(e,r))}function sX(e,t){if(t&&(Io(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iX(e)}function iX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(s3=function(){return!!e})()}function zu(e){return zu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zu(e)}function oX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qg(e,t)}function Qg(e,t){return Qg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Qg(e,t)}function Zg(e,t,r){return t=i3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i3(e){var t=lX(e,"string");return Io(t)=="symbol"?t:t+""}function lX(e,t){if(Io(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Io(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var A_=1,cX=(function(e){function t(){var r;tX(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return r=nX(this,t,[].concat(s)),Zg(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),Zg(r,"handleKeyDown",function(o){if(o.key==="Escape"){var l,c,d,u;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(d=(u=r.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&d!==void 0?d:0}})}}),r}return oX(t,e),aX(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var a=this.wrapperNode.getBoundingClientRect();(Math.abs(a.width-this.state.lastBoundingBox.width)>A_||Math.abs(a.height-this.state.lastBoundingBox.height)>A_)&&this.setState({lastBoundingBox:{width:a.width,height:a.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var a,s;this.props.active&&this.updateBBox(),this.state.dismissed&&(((a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==this.state.dismissedAtCoordinate.x||((s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var a=this,s=this.props,i=s.active,o=s.allowEscapeViewBox,l=s.animationDuration,c=s.animationEasing,d=s.children,u=s.coordinate,f=s.hasPayload,x=s.isAnimationActive,p=s.offset,h=s.position,m=s.reverseDirection,g=s.useTranslate3d,v=s.viewBox,b=s.wrapperStyle,y=eX({allowEscapeViewBox:o,coordinate:u,offsetTopLeft:p,position:h,reverseDirection:m,tooltipBox:this.state.lastBoundingBox,useTranslate3d:g,viewBox:v}),N=y.cssClasses,j=y.cssProperties,w=T_(T_({transition:x&&i?"transform ".concat(l,"ms ").concat(c):void 0},j),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&f?"visible":"hidden",position:"absolute",top:0,left:0},b);return ee.createElement("div",{tabIndex:-1,className:N,style:w,ref:function(S){a.wrapperNode=S}},d)}}])})(C.PureComponent),dX=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Ui={isSsr:dX()};function Fo(e){"@babel/helpers - typeof";return Fo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fo(e)}function C_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function P_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C_(Object(r),!0).forEach(function(a){jb(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C_(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function uX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fX(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,l3(a.key),a)}}function hX(e,t,r){return t&&fX(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mX(e,t,r){return t=Vu(t),xX(e,o3()?Reflect.construct(t,r||[],Vu(e).constructor):t.apply(e,r))}function xX(e,t){if(t&&(Fo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pX(e)}function pX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(o3=function(){return!!e})()}function Vu(e){return Vu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vu(e)}function gX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ey(e,t)}function ey(e,t){return ey=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},ey(e,t)}function jb(e,t,r){return t=l3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l3(e){var t=yX(e,"string");return Fo(t)=="symbol"?t:t+""}function yX(e,t){if(Fo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Fo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function vX(e){return e.dataKey}function bX(e,t){return ee.isValidElement(e)?ee.cloneElement(e,t):typeof e=="function"?ee.createElement(e,t):ee.createElement(KK,t)}var Ga=(function(e){function t(){return uX(this,t),mX(this,t,arguments)}return gX(t,e),hX(t,[{key:"render",value:function(){var a=this,s=this.props,i=s.active,o=s.allowEscapeViewBox,l=s.animationDuration,c=s.animationEasing,d=s.content,u=s.coordinate,f=s.filterNull,x=s.isAnimationActive,p=s.offset,h=s.payload,m=s.payloadUniqBy,g=s.position,v=s.reverseDirection,b=s.useTranslate3d,y=s.viewBox,N=s.wrapperStyle,j=h??[];f&&j.length&&(j=Q6(h.filter(function(_){return _.value!=null&&(_.hide!==!0||a.props.includeHidden)}),m,vX));var w=j.length>0;return ee.createElement(cX,{allowEscapeViewBox:o,animationDuration:l,animationEasing:c,isAnimationActive:x,active:i,coordinate:u,hasPayload:w,offset:p,position:g,reverseDirection:v,useTranslate3d:b,viewBox:y,wrapperStyle:N},bX(d,P_(P_({},this.props),{},{payload:j})))}}])})(C.PureComponent);jb(Ga,"displayName","Tooltip");jb(Ga,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Ui.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var lp,O_;function jX(){if(O_)return lp;O_=1;var e=Rn(),t=function(){return e.Date.now()};return lp=t,lp}var cp,I_;function wX(){if(I_)return cp;I_=1;var e=/\s/;function t(r){for(var a=r.length;a--&&e.test(r.charAt(a)););return a}return cp=t,cp}var dp,F_;function NX(){if(F_)return dp;F_=1;var e=wX(),t=/^\s+/;function r(a){return a&&a.slice(0,e(a)+1).replace(t,"")}return dp=r,dp}var up,D_;function c3(){if(D_)return up;D_=1;var e=NX(),t=Us(),r=fl(),a=NaN,s=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt;function c(d){if(typeof d=="number")return d;if(r(d))return a;if(t(d)){var u=typeof d.valueOf=="function"?d.valueOf():d;d=t(u)?u+"":u}if(typeof d!="string")return d===0?d:+d;d=e(d);var f=i.test(d);return f||o.test(d)?l(d.slice(2),f?2:8):s.test(d)?a:+d}return up=c,up}var fp,R_;function _X(){if(R_)return fp;R_=1;var e=Us(),t=jX(),r=c3(),a="Expected a function",s=Math.max,i=Math.min;function o(l,c,d){var u,f,x,p,h,m,g=0,v=!1,b=!1,y=!0;if(typeof l!="function")throw new TypeError(a);c=r(c)||0,e(d)&&(v=!!d.leading,b="maxWait"in d,x=b?s(r(d.maxWait)||0,c):x,y="trailing"in d?!!d.trailing:y);function N(L){var R=u,I=f;return u=f=void 0,g=L,p=l.apply(I,R),p}function j(L){return g=L,h=setTimeout(S,c),v?N(L):p}function w(L){var R=L-m,I=L-g,D=c-R;return b?i(D,x-I):D}function _(L){var R=L-m,I=L-g;return m===void 0||R>=c||R<0||b&&I>=x}function S(){var L=t();if(_(L))return k(L);h=setTimeout(S,w(L))}function k(L){return h=void 0,y&&u?N(L):(u=f=void 0,p)}function E(){h!==void 0&&clearTimeout(h),g=0,u=m=f=h=void 0}function A(){return h===void 0?p:k(t())}function P(){var L=t(),R=_(L);if(u=arguments,f=this,m=L,R){if(h===void 0)return j(m);if(b)return clearTimeout(h),h=setTimeout(S,c),N(m)}return h===void 0&&(h=setTimeout(S,c)),p}return P.cancel=E,P.flush=A,P}return fp=o,fp}var hp,M_;function SX(){if(M_)return hp;M_=1;var e=_X(),t=Us(),r="Expected a function";function a(s,i,o){var l=!0,c=!0;if(typeof s!="function")throw new TypeError(r);return t(o)&&(l="leading"in o?!!o.leading:l,c="trailing"in o?!!o.trailing:c),e(s,i,{leading:l,maxWait:i,trailing:c})}return hp=a,hp}var kX=SX();const d3=Ct(kX);function Dc(e){"@babel/helpers - typeof";return Dc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dc(e)}function L_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Jd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L_(Object(r),!0).forEach(function(a){EX(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L_(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function EX(e,t,r){return t=TX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TX(e){var t=AX(e,"string");return Dc(t)=="symbol"?t:t+""}function AX(e,t){if(Dc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Dc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CX(e,t){return FX(e)||IX(e,t)||OX(e,t)||PX()}function PX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OX(e,t){if(e){if(typeof e=="string")return $_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $_(e,t)}}function $_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function IX(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function FX(e){if(Array.isArray(e))return e}var mp=C.forwardRef(function(e,t){var r=e.aspect,a=e.initialDimension,s=a===void 0?{width:-1,height:-1}:a,i=e.width,o=i===void 0?"100%":i,l=e.height,c=l===void 0?"100%":l,d=e.minWidth,u=d===void 0?0:d,f=e.minHeight,x=e.maxHeight,p=e.children,h=e.debounce,m=h===void 0?0:h,g=e.id,v=e.className,b=e.onResize,y=e.style,N=y===void 0?{}:y,j=C.useRef(null),w=C.useRef();w.current=b,C.useImperativeHandle(t,function(){return Object.defineProperty(j.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),j.current},configurable:!0})});var _=C.useState({containerWidth:s.width,containerHeight:s.height}),S=CX(_,2),k=S[0],E=S[1],A=C.useCallback(function(L,R){E(function(I){var D=Math.round(L),V=Math.round(R);return I.containerWidth===D&&I.containerHeight===V?I:{containerWidth:D,containerHeight:V}})},[]);C.useEffect(function(){var L=function(U){var q,K=U[0].contentRect,T=K.width,O=K.height;A(T,O),(q=w.current)===null||q===void 0||q.call(w,T,O)};m>0&&(L=d3(L,m,{trailing:!0,leading:!1}));var R=new ResizeObserver(L),I=j.current.getBoundingClientRect(),D=I.width,V=I.height;return A(D,V),R.observe(j.current),function(){R.disconnect()}},[A,m]);var P=C.useMemo(function(){var L=k.containerWidth,R=k.containerHeight;if(L<0||R<0)return null;pn(ni(o)||ni(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,c),pn(!r||r>0,"The aspect(%s) must be greater than zero.",r);var I=ni(o)?L:o,D=ni(c)?R:c;r&&r>0&&(I?D=I/r:D&&(I=D*r),x&&D>x&&(D=x)),pn(I>0||D>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,I,D,o,c,u,f,r);var V=!Array.isArray(p)&&es(p.type).endsWith("Chart");return ee.Children.map(p,function(F){return ee.isValidElement(F)?C.cloneElement(F,Jd({width:I,height:D},V?{style:Jd({height:"100%",width:"100%",maxHeight:D,maxWidth:I},F.props.style)}:{})):F})},[r,p,c,x,f,u,k,o]);return ee.createElement("div",{id:g?"".concat(g):void 0,className:tt("recharts-responsive-container",v),style:Jd(Jd({},N),{},{width:o,height:c,minWidth:u,minHeight:f,maxHeight:x}),ref:j},P)}),u0=function(t){return null};u0.displayName="Cell";function Rc(e){"@babel/helpers - typeof";return Rc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rc(e)}function B_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ty(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B_(Object(r),!0).forEach(function(a){DX(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B_(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function DX(e,t,r){return t=RX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RX(e){var t=MX(e,"string");return Rc(t)=="symbol"?t:t+""}function MX(e,t){if(Rc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Rc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eo={widthCache:{},cacheCount:0},LX=2e3,$X={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},U_="recharts_measurement_span";function BX(e){var t=ty({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var ic=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Ui.isSsr)return{width:0,height:0};var a=BX(r),s=JSON.stringify({text:t,copyStyle:a});if(eo.widthCache[s])return eo.widthCache[s];try{var i=document.getElementById(U_);i||(i=document.createElement("span"),i.setAttribute("id",U_),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=ty(ty({},$X),a);Object.assign(i.style,o),i.textContent="".concat(t);var l=i.getBoundingClientRect(),c={width:l.width,height:l.height};return eo.widthCache[s]=c,++eo.cacheCount>LX&&(eo.cacheCount=0,eo.widthCache={}),c}catch{return{width:0,height:0}}},UX=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Mc(e){"@babel/helpers - typeof";return Mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mc(e)}function Gu(e,t){return zX(e)||HX(e,t)||WX(e,t)||qX()}function qX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WX(e,t){if(e){if(typeof e=="string")return q_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q_(e,t)}}function q_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function HX(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function zX(e){if(Array.isArray(e))return e}function VX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W_(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,KX(a.key),a)}}function GX(e,t,r){return t&&W_(e.prototype,t),r&&W_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KX(e){var t=XX(e,"string");return Mc(t)=="symbol"?t:t+""}function XX(e,t){if(Mc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Mc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var H_=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,z_=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,YX=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,JX=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,u3={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},QX=Object.keys(u3),io="NaN";function ZX(e,t){return e*u3[t]}var Qd=(function(){function e(t,r){VX(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!YX.test(r)&&(this.num=NaN,this.unit=""),QX.includes(r)&&(this.num=ZX(t,r),this.unit="px")}return GX(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var a,s=(a=JX.exec(r))!==null&&a!==void 0?a:[],i=Gu(s,3),o=i[1],l=i[2];return new e(parseFloat(o),l??"")}}])})();function f3(e){if(e.includes(io))return io;for(var t=e;t.includes("*")||t.includes("/");){var r,a=(r=H_.exec(t))!==null&&r!==void 0?r:[],s=Gu(a,4),i=s[1],o=s[2],l=s[3],c=Qd.parse(i??""),d=Qd.parse(l??""),u=o==="*"?c.multiply(d):c.divide(d);if(u.isNaN())return io;t=t.replace(H_,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,x=(f=z_.exec(t))!==null&&f!==void 0?f:[],p=Gu(x,4),h=p[1],m=p[2],g=p[3],v=Qd.parse(h??""),b=Qd.parse(g??""),y=m==="+"?v.add(b):v.subtract(b);if(y.isNaN())return io;t=t.replace(z_,y.toString())}return t}var V_=/\(([^()]*)\)/;function eY(e){for(var t=e;t.includes("(");){var r=V_.exec(t),a=Gu(r,2),s=a[1];t=t.replace(V_,f3(s))}return t}function tY(e){var t=e.replace(/\s+/g,"");return t=eY(t),t=f3(t),t}function rY(e){try{return tY(e)}catch{return io}}function xp(e){var t=rY(e.slice(5,-1));return t===io?"":t}var aY=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],nY=["dx","dy","angle","className","breakAll"];function ry(){return ry=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ry.apply(this,arguments)}function G_(e,t){if(e==null)return{};var r=sY(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function sY(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function K_(e,t){return cY(e)||lY(e,t)||oY(e,t)||iY()}function iY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oY(e,t){if(e){if(typeof e=="string")return X_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X_(e,t)}}function X_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function lY(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function cY(e){if(Array.isArray(e))return e}var h3=/[ \f\n\r\t\v\u2028\u2029]+/,m3=function(t){var r=t.children,a=t.breakAll,s=t.style;try{var i=[];Je(r)||(a?i=r.toString().split(""):i=r.toString().split(h3));var o=i.map(function(c){return{word:c,width:ic(c,s).width}}),l=a?0:ic(" ",s).width;return{wordsWithComputedWidth:o,spaceWidth:l}}catch{return null}},dY=function(t,r,a,s,i){var o=t.maxLines,l=t.children,c=t.style,d=t.breakAll,u=be(o),f=l,x=function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return I.reduce(function(D,V){var F=V.word,U=V.width,q=D[D.length-1];if(q&&(s==null||i||q.width+U+a<Number(s)))q.words.push(F),q.width+=U+a;else{var K={words:[F],width:U};D.push(K)}return D},[])},p=x(r),h=function(I){return I.reduce(function(D,V){return D.width>V.width?D:V})};if(!u)return p;for(var m="…",g=function(I){var D=f.slice(0,I),V=m3({breakAll:d,style:c,children:D+m}).wordsWithComputedWidth,F=x(V),U=F.length>o||h(F).width>Number(s);return[U,F]},v=0,b=f.length-1,y=0,N;v<=b&&y<=f.length-1;){var j=Math.floor((v+b)/2),w=j-1,_=g(w),S=K_(_,2),k=S[0],E=S[1],A=g(j),P=K_(A,1),L=P[0];if(!k&&!L&&(v=j+1),k&&L&&(b=j-1),!k&&L){N=E;break}y++}return N||p},Y_=function(t){var r=Je(t)?[]:t.toString().split(h3);return[{words:r}]},uY=function(t){var r=t.width,a=t.scaleToFit,s=t.children,i=t.style,o=t.breakAll,l=t.maxLines;if((r||a)&&!Ui.isSsr){var c,d,u=m3({breakAll:o,children:s,style:i});if(u){var f=u.wordsWithComputedWidth,x=u.spaceWidth;c=f,d=x}else return Y_(s);return dY({breakAll:o,children:s,maxLines:l,style:i},c,d,r,a)}return Y_(s)},J_="#808080",Ai=function(t){var r=t.x,a=r===void 0?0:r,s=t.y,i=s===void 0?0:s,o=t.lineHeight,l=o===void 0?"1em":o,c=t.capHeight,d=c===void 0?"0.71em":c,u=t.scaleToFit,f=u===void 0?!1:u,x=t.textAnchor,p=x===void 0?"start":x,h=t.verticalAnchor,m=h===void 0?"end":h,g=t.fill,v=g===void 0?J_:g,b=G_(t,aY),y=C.useMemo(function(){return uY({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:f,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,f,b.style,b.width]),N=b.dx,j=b.dy,w=b.angle,_=b.className,S=b.breakAll,k=G_(b,nY);if(!Ar(a)||!Ar(i))return null;var E=a+(be(N)?N:0),A=i+(be(j)?j:0),P;switch(m){case"start":P=xp("calc(".concat(d,")"));break;case"middle":P=xp("calc(".concat((y.length-1)/2," * -").concat(l," + (").concat(d," / 2))"));break;default:P=xp("calc(".concat(y.length-1," * -").concat(l,")"));break}var L=[];if(f){var R=y[0].width,I=b.width;L.push("scale(".concat((be(I)?I/R:1)/R,")"))}return w&&L.push("rotate(".concat(w,", ").concat(E,", ").concat(A,")")),L.length&&(k.transform=L.join(" ")),ee.createElement("text",ry({},Re(k,!0),{x:E,y:A,className:tt("recharts-text",_),textAnchor:p,fill:v.includes("url")?J_:v}),y.map(function(D,V){var F=D.words.join(S?"":" ");return ee.createElement("tspan",{x:E,dy:V===0?P:l,key:"".concat(F,"-").concat(V)},F)}))};function Es(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function fY(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function wb(e){let t,r,a;e.length!==2?(t=Es,r=(l,c)=>Es(e(l),c),a=(l,c)=>e(l)-c):(t=e===Es||e===fY?e:hY,r=e,a=e);function s(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<0?d=f+1:u=f}while(d<u)}return d}function i(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<=0?d=f+1:u=f}while(d<u)}return d}function o(l,c,d=0,u=l.length){const f=s(l,c,d,u-1);return f>d&&a(l[f-1],c)>-a(l[f],c)?f-1:f}return{left:s,center:o,right:i}}function hY(){return 0}function x3(e){return e===null?NaN:+e}function*mY(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const xY=wb(Es),Sd=xY.right;wb(x3).center;class Q_ extends Map{constructor(t,r=yY){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[a,s]of t)this.set(a,s)}get(t){return super.get(Z_(this,t))}has(t){return super.has(Z_(this,t))}set(t,r){return super.set(pY(this,t),r)}delete(t){return super.delete(gY(this,t))}}function Z_({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):r}function pY({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):(e.set(a,r),r)}function gY({_intern:e,_key:t},r){const a=t(r);return e.has(a)&&(r=e.get(a),e.delete(a)),r}function yY(e){return e!==null&&typeof e=="object"?e.valueOf():e}function vY(e=Es){if(e===Es)return p3;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const a=e(t,r);return a||a===0?a:(e(r,r)===0)-(e(t,t)===0)}}function p3(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const bY=Math.sqrt(50),jY=Math.sqrt(10),wY=Math.sqrt(2);function Ku(e,t,r){const a=(t-e)/Math.max(0,r),s=Math.floor(Math.log10(a)),i=a/Math.pow(10,s),o=i>=bY?10:i>=jY?5:i>=wY?2:1;let l,c,d;return s<0?(d=Math.pow(10,-s)/o,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,s)*o,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?Ku(e,t,r*2):[l,c,d]}function ay(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const a=t<e,[s,i,o]=a?Ku(t,e,r):Ku(e,t,r);if(!(i>=s))return[];const l=i-s+1,c=new Array(l);if(a)if(o<0)for(let d=0;d<l;++d)c[d]=(i-d)/-o;else for(let d=0;d<l;++d)c[d]=(i-d)*o;else if(o<0)for(let d=0;d<l;++d)c[d]=(s+d)/-o;else for(let d=0;d<l;++d)c[d]=(s+d)*o;return c}function ny(e,t,r){return t=+t,e=+e,r=+r,Ku(e,t,r)[2]}function sy(e,t,r){t=+t,e=+e,r=+r;const a=t<e,s=a?ny(t,e,r):ny(e,t,r);return(a?-1:1)*(s<0?1/-s:s)}function eS(e,t){let r;for(const a of e)a!=null&&(r<a||r===void 0&&a>=a)&&(r=a);return r}function tS(e,t){let r;for(const a of e)a!=null&&(r>a||r===void 0&&a>=a)&&(r=a);return r}function g3(e,t,r=0,a=1/0,s){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),a=Math.floor(Math.min(e.length-1,a)),!(r<=t&&t<=a))return e;for(s=s===void 0?p3:vY(s);a>r;){if(a-r>600){const c=a-r+1,d=t-r+1,u=Math.log(c),f=.5*Math.exp(2*u/3),x=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),p=Math.max(r,Math.floor(t-d*f/c+x)),h=Math.min(a,Math.floor(t+(c-d)*f/c+x));g3(e,t,p,h,s)}const i=e[t];let o=r,l=a;for(Ol(e,r,t),s(e[a],i)>0&&Ol(e,r,a);o<l;){for(Ol(e,o,l),++o,--l;s(e[o],i)<0;)++o;for(;s(e[l],i)>0;)--l}s(e[r],i)===0?Ol(e,r,l):(++l,Ol(e,l,a)),l<=t&&(r=l+1),t<=l&&(a=l-1)}return e}function Ol(e,t,r){const a=e[t];e[t]=e[r],e[r]=a}function NY(e,t,r){if(e=Float64Array.from(mY(e)),!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return tS(e);if(t>=1)return eS(e);var a,s=(a-1)*t,i=Math.floor(s),o=eS(g3(e,i).subarray(0,i+1)),l=tS(e.subarray(i+1));return o+(l-o)*(s-i)}}function _Y(e,t,r=x3){if(!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return+r(e[0],0,e);if(t>=1)return+r(e[a-1],a-1,e);var a,s=(a-1)*t,i=Math.floor(s),o=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return o+(l-o)*(s-i)}}function SY(e,t,r){e=+e,t=+t,r=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+r;for(var a=-1,s=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(s);++a<s;)i[a]=e+a*r;return i}function nn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function hs(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const iy=Symbol("implicit");function Nb(){var e=new Q_,t=[],r=[],a=iy;function s(i){let o=e.get(i);if(o===void 0){if(a!==iy)return a;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return s.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new Q_;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return s},s.range=function(i){return arguments.length?(r=Array.from(i),s):r.slice()},s.unknown=function(i){return arguments.length?(a=i,s):a},s.copy=function(){return Nb(t,r).unknown(a)},nn.apply(s,arguments),s}function Lc(){var e=Nb().unknown(void 0),t=e.domain,r=e.range,a=0,s=1,i,o,l=!1,c=0,d=0,u=.5;delete e.unknown;function f(){var x=t().length,p=s<a,h=p?s:a,m=p?a:s;i=(m-h)/Math.max(1,x-c+d*2),l&&(i=Math.floor(i)),h+=(m-h-i*(x-c))*u,o=i*(1-c),l&&(h=Math.round(h),o=Math.round(o));var g=SY(x).map(function(v){return h+i*v});return r(p?g.reverse():g)}return e.domain=function(x){return arguments.length?(t(x),f()):t()},e.range=function(x){return arguments.length?([a,s]=x,a=+a,s=+s,f()):[a,s]},e.rangeRound=function(x){return[a,s]=x,a=+a,s=+s,l=!0,f()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(x){return arguments.length?(l=!!x,f()):l},e.padding=function(x){return arguments.length?(c=Math.min(1,d=+x),f()):c},e.paddingInner=function(x){return arguments.length?(c=Math.min(1,x),f()):c},e.paddingOuter=function(x){return arguments.length?(d=+x,f()):d},e.align=function(x){return arguments.length?(u=Math.max(0,Math.min(1,x)),f()):u},e.copy=function(){return Lc(t(),[a,s]).round(l).paddingInner(c).paddingOuter(d).align(u)},nn.apply(f(),arguments)}function y3(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return y3(t())},e}function oc(){return y3(Lc.apply(null,arguments).paddingInner(1))}function _b(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function v3(e,t){var r=Object.create(e.prototype);for(var a in t)r[a]=t[a];return r}function kd(){}var $c=.7,Xu=1/$c,yo="\\s*([+-]?\\d+)\\s*",Bc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",En="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",kY=/^#([0-9a-f]{3,8})$/,EY=new RegExp(`^rgb\\(${yo},${yo},${yo}\\)$`),TY=new RegExp(`^rgb\\(${En},${En},${En}\\)$`),AY=new RegExp(`^rgba\\(${yo},${yo},${yo},${Bc}\\)$`),CY=new RegExp(`^rgba\\(${En},${En},${En},${Bc}\\)$`),PY=new RegExp(`^hsl\\(${Bc},${En},${En}\\)$`),OY=new RegExp(`^hsla\\(${Bc},${En},${En},${Bc}\\)$`),rS={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};_b(kd,Uc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:aS,formatHex:aS,formatHex8:IY,formatHsl:FY,formatRgb:nS,toString:nS});function aS(){return this.rgb().formatHex()}function IY(){return this.rgb().formatHex8()}function FY(){return b3(this).formatHsl()}function nS(){return this.rgb().formatRgb()}function Uc(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=kY.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?sS(t):r===3?new ya(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Zd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Zd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=EY.exec(e))?new ya(t[1],t[2],t[3],1):(t=TY.exec(e))?new ya(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=AY.exec(e))?Zd(t[1],t[2],t[3],t[4]):(t=CY.exec(e))?Zd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=PY.exec(e))?lS(t[1],t[2]/100,t[3]/100,1):(t=OY.exec(e))?lS(t[1],t[2]/100,t[3]/100,t[4]):rS.hasOwnProperty(e)?sS(rS[e]):e==="transparent"?new ya(NaN,NaN,NaN,0):null}function sS(e){return new ya(e>>16&255,e>>8&255,e&255,1)}function Zd(e,t,r,a){return a<=0&&(e=t=r=NaN),new ya(e,t,r,a)}function DY(e){return e instanceof kd||(e=Uc(e)),e?(e=e.rgb(),new ya(e.r,e.g,e.b,e.opacity)):new ya}function oy(e,t,r,a){return arguments.length===1?DY(e):new ya(e,t,r,a??1)}function ya(e,t,r,a){this.r=+e,this.g=+t,this.b=+r,this.opacity=+a}_b(ya,oy,v3(kd,{brighter(e){return e=e==null?Xu:Math.pow(Xu,e),new ya(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?$c:Math.pow($c,e),new ya(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ya(pi(this.r),pi(this.g),pi(this.b),Yu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:iS,formatHex:iS,formatHex8:RY,formatRgb:oS,toString:oS}));function iS(){return`#${si(this.r)}${si(this.g)}${si(this.b)}`}function RY(){return`#${si(this.r)}${si(this.g)}${si(this.b)}${si((isNaN(this.opacity)?1:this.opacity)*255)}`}function oS(){const e=Yu(this.opacity);return`${e===1?"rgb(":"rgba("}${pi(this.r)}, ${pi(this.g)}, ${pi(this.b)}${e===1?")":`, ${e})`}`}function Yu(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function pi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function si(e){return e=pi(e),(e<16?"0":"")+e.toString(16)}function lS(e,t,r,a){return a<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new dn(e,t,r,a)}function b3(e){if(e instanceof dn)return new dn(e.h,e.s,e.l,e.opacity);if(e instanceof kd||(e=Uc(e)),!e)return new dn;if(e instanceof dn)return e;e=e.rgb();var t=e.r/255,r=e.g/255,a=e.b/255,s=Math.min(t,r,a),i=Math.max(t,r,a),o=NaN,l=i-s,c=(i+s)/2;return l?(t===i?o=(r-a)/l+(r<a)*6:r===i?o=(a-t)/l+2:o=(t-r)/l+4,l/=c<.5?i+s:2-i-s,o*=60):l=c>0&&c<1?0:o,new dn(o,l,c,e.opacity)}function MY(e,t,r,a){return arguments.length===1?b3(e):new dn(e,t,r,a??1)}function dn(e,t,r,a){this.h=+e,this.s=+t,this.l=+r,this.opacity=+a}_b(dn,MY,v3(kd,{brighter(e){return e=e==null?Xu:Math.pow(Xu,e),new dn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?$c:Math.pow($c,e),new dn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,a=r+(r<.5?r:1-r)*t,s=2*r-a;return new ya(pp(e>=240?e-240:e+120,s,a),pp(e,s,a),pp(e<120?e+240:e-120,s,a),this.opacity)},clamp(){return new dn(cS(this.h),eu(this.s),eu(this.l),Yu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Yu(this.opacity);return`${e===1?"hsl(":"hsla("}${cS(this.h)}, ${eu(this.s)*100}%, ${eu(this.l)*100}%${e===1?")":`, ${e})`}`}}));function cS(e){return e=(e||0)%360,e<0?e+360:e}function eu(e){return Math.max(0,Math.min(1,e||0))}function pp(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Sb=e=>()=>e;function LY(e,t){return function(r){return e+r*t}}function $Y(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(a){return Math.pow(e+a*t,r)}}function BY(e){return(e=+e)==1?j3:function(t,r){return r-t?$Y(t,r,e):Sb(isNaN(t)?r:t)}}function j3(e,t){var r=t-e;return r?LY(e,r):Sb(isNaN(e)?t:e)}const dS=(function e(t){var r=BY(t);function a(s,i){var o=r((s=oy(s)).r,(i=oy(i)).r),l=r(s.g,i.g),c=r(s.b,i.b),d=j3(s.opacity,i.opacity);return function(u){return s.r=o(u),s.g=l(u),s.b=c(u),s.opacity=d(u),s+""}}return a.gamma=e,a})(1);function UY(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,a=t.slice(),s;return function(i){for(s=0;s<r;++s)a[s]=e[s]*(1-i)+t[s]*i;return a}}function qY(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function WY(e,t){var r=t?t.length:0,a=e?Math.min(r,e.length):0,s=new Array(a),i=new Array(r),o;for(o=0;o<a;++o)s[o]=gl(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(l){for(o=0;o<a;++o)i[o]=s[o](l);return i}}function HY(e,t){var r=new Date;return e=+e,t=+t,function(a){return r.setTime(e*(1-a)+t*a),r}}function Ju(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function zY(e,t){var r={},a={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?r[s]=gl(e[s],t[s]):a[s]=t[s];return function(i){for(s in r)a[s]=r[s](i);return a}}var ly=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gp=new RegExp(ly.source,"g");function VY(e){return function(){return e}}function GY(e){return function(t){return e(t)+""}}function KY(e,t){var r=ly.lastIndex=gp.lastIndex=0,a,s,i,o=-1,l=[],c=[];for(e=e+"",t=t+"";(a=ly.exec(e))&&(s=gp.exec(t));)(i=s.index)>r&&(i=t.slice(r,i),l[o]?l[o]+=i:l[++o]=i),(a=a[0])===(s=s[0])?l[o]?l[o]+=s:l[++o]=s:(l[++o]=null,c.push({i:o,x:Ju(a,s)})),r=gp.lastIndex;return r<t.length&&(i=t.slice(r),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?GY(c[0].x):VY(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}function gl(e,t){var r=typeof t,a;return t==null||r==="boolean"?Sb(t):(r==="number"?Ju:r==="string"?(a=Uc(t))?(t=a,dS):KY:t instanceof Uc?dS:t instanceof Date?HY:qY(t)?UY:Array.isArray(t)?WY:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?zY:Ju)(e,t)}function kb(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function XY(e,t){t===void 0&&(t=e,e=gl);for(var r=0,a=t.length-1,s=t[0],i=new Array(a<0?0:a);r<a;)i[r]=e(s,s=t[++r]);return function(o){var l=Math.max(0,Math.min(a-1,Math.floor(o*=a)));return i[l](o-l)}}function YY(e){return function(){return e}}function Qu(e){return+e}var uS=[0,1];function ua(e){return e}function cy(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:YY(isNaN(t)?NaN:.5)}function JY(e,t){var r;return e>t&&(r=e,e=t,t=r),function(a){return Math.max(e,Math.min(t,a))}}function QY(e,t,r){var a=e[0],s=e[1],i=t[0],o=t[1];return s<a?(a=cy(s,a),i=r(o,i)):(a=cy(a,s),i=r(i,o)),function(l){return i(a(l))}}function ZY(e,t,r){var a=Math.min(e.length,t.length)-1,s=new Array(a),i=new Array(a),o=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<a;)s[o]=cy(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(l){var c=Sd(e,l,1,a)-1;return i[c](s[c](l))}}function Ed(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function f0(){var e=uS,t=uS,r=gl,a,s,i,o=ua,l,c,d;function u(){var x=Math.min(e.length,t.length);return o!==ua&&(o=JY(e[0],e[x-1])),l=x>2?ZY:QY,c=d=null,f}function f(x){return x==null||isNaN(x=+x)?i:(c||(c=l(e.map(a),t,r)))(a(o(x)))}return f.invert=function(x){return o(s((d||(d=l(t,e.map(a),Ju)))(x)))},f.domain=function(x){return arguments.length?(e=Array.from(x,Qu),u()):e.slice()},f.range=function(x){return arguments.length?(t=Array.from(x),u()):t.slice()},f.rangeRound=function(x){return t=Array.from(x),r=kb,u()},f.clamp=function(x){return arguments.length?(o=x?!0:ua,u()):o!==ua},f.interpolate=function(x){return arguments.length?(r=x,u()):r},f.unknown=function(x){return arguments.length?(i=x,f):i},function(x,p){return a=x,s=p,u()}}function Eb(){return f0()(ua,ua)}function eJ(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Zu(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,a=e.slice(0,r);return[a.length>1?a[0]+a.slice(2):a,+e.slice(r+1)]}function Do(e){return e=Zu(Math.abs(e)),e?e[1]:NaN}function tJ(e,t){return function(r,a){for(var s=r.length,i=[],o=0,l=e[0],c=0;s>0&&l>0&&(c+l+1>a&&(l=Math.max(1,a-c)),i.push(r.substring(s-=l,s+l)),!((c+=l+1)>a));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function rJ(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var aJ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function qc(e){if(!(t=aJ.exec(e)))throw new Error("invalid format: "+e);var t;return new Tb({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}qc.prototype=Tb.prototype;function Tb(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Tb.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function nJ(e){e:for(var t=e.length,r=1,a=-1,s;r<t;++r)switch(e[r]){case".":a=s=r;break;case"0":a===0&&(a=r),s=r;break;default:if(!+e[r])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(s+1):e}var w3;function sJ(e,t){var r=Zu(e,t);if(!r)return e+"";var a=r[0],s=r[1],i=s-(w3=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=a.length;return i===o?a:i>o?a+new Array(i-o+1).join("0"):i>0?a.slice(0,i)+"."+a.slice(i):"0."+new Array(1-i).join("0")+Zu(e,Math.max(0,t+i-1))[0]}function fS(e,t){var r=Zu(e,t);if(!r)return e+"";var a=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+a:a.length>s+1?a.slice(0,s+1)+"."+a.slice(s+1):a+new Array(s-a.length+2).join("0")}const hS={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:eJ,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>fS(e*100,t),r:fS,s:sJ,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function mS(e){return e}var xS=Array.prototype.map,pS=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function iJ(e){var t=e.grouping===void 0||e.thousands===void 0?mS:tJ(xS.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?mS:rJ(xS.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"−":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(f){f=qc(f);var x=f.fill,p=f.align,h=f.sign,m=f.symbol,g=f.zero,v=f.width,b=f.comma,y=f.precision,N=f.trim,j=f.type;j==="n"?(b=!0,j="g"):hS[j]||(y===void 0&&(y=12),N=!0,j="g"),(g||x==="0"&&p==="=")&&(g=!0,x="0",p="=");var w=m==="$"?r:m==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():"",_=m==="$"?a:/[%p]/.test(j)?o:"",S=hS[j],k=/[defgprs%]/.test(j);y=y===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function E(A){var P=w,L=_,R,I,D;if(j==="c")L=S(A)+L,A="";else{A=+A;var V=A<0||1/A<0;if(A=isNaN(A)?c:S(Math.abs(A),y),N&&(A=nJ(A)),V&&+A==0&&h!=="+"&&(V=!1),P=(V?h==="("?h:l:h==="-"||h==="("?"":h)+P,L=(j==="s"?pS[8+w3/3]:"")+L+(V&&h==="("?")":""),k){for(R=-1,I=A.length;++R<I;)if(D=A.charCodeAt(R),48>D||D>57){L=(D===46?s+A.slice(R+1):A.slice(R))+L,A=A.slice(0,R);break}}}b&&!g&&(A=t(A,1/0));var F=P.length+A.length+L.length,U=F<v?new Array(v-F+1).join(x):"";switch(b&&g&&(A=t(U+A,U.length?v-L.length:1/0),U=""),p){case"<":A=P+A+L+U;break;case"=":A=P+U+A+L;break;case"^":A=U.slice(0,F=U.length>>1)+P+A+L+U.slice(F);break;default:A=U+P+A+L;break}return i(A)}return E.toString=function(){return f+""},E}function u(f,x){var p=d((f=qc(f),f.type="f",f)),h=Math.max(-8,Math.min(8,Math.floor(Do(x)/3)))*3,m=Math.pow(10,-h),g=pS[8+h/3];return function(v){return p(m*v)+g}}return{format:d,formatPrefix:u}}var tu,Ab,N3;oJ({thousands:",",grouping:[3],currency:["$",""]});function oJ(e){return tu=iJ(e),Ab=tu.format,N3=tu.formatPrefix,tu}function lJ(e){return Math.max(0,-Do(Math.abs(e)))}function cJ(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Do(t)/3)))*3-Do(Math.abs(e)))}function dJ(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Do(t)-Do(e))+1}function _3(e,t,r,a){var s=sy(e,t,r),i;switch(a=qc(a??",f"),a.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return a.precision==null&&!isNaN(i=cJ(s,o))&&(a.precision=i),N3(a,o)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(i=dJ(s,Math.max(Math.abs(e),Math.abs(t))))&&(a.precision=i-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(i=lJ(s))&&(a.precision=i-(a.type==="%")*2);break}}return Ab(a)}function qs(e){var t=e.domain;return e.ticks=function(r){var a=t();return ay(a[0],a[a.length-1],r??10)},e.tickFormat=function(r,a){var s=t();return _3(s[0],s[s.length-1],r??10,a)},e.nice=function(r){r==null&&(r=10);var a=t(),s=0,i=a.length-1,o=a[s],l=a[i],c,d,u=10;for(l<o&&(d=o,o=l,l=d,d=s,s=i,i=d);u-- >0;){if(d=ny(o,l,r),d===c)return a[s]=o,a[i]=l,t(a);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function ef(){var e=Eb();return e.copy=function(){return Ed(e,ef())},nn.apply(e,arguments),qs(e)}function S3(e){var t;function r(a){return a==null||isNaN(a=+a)?t:a}return r.invert=r,r.domain=r.range=function(a){return arguments.length?(e=Array.from(a,Qu),r):e.slice()},r.unknown=function(a){return arguments.length?(t=a,r):t},r.copy=function(){return S3(e).unknown(t)},e=arguments.length?Array.from(e,Qu):[0,1],qs(r)}function k3(e,t){e=e.slice();var r=0,a=e.length-1,s=e[r],i=e[a],o;return i<s&&(o=r,r=a,a=o,o=s,s=i,i=o),e[r]=t.floor(s),e[a]=t.ceil(i),e}function gS(e){return Math.log(e)}function yS(e){return Math.exp(e)}function uJ(e){return-Math.log(-e)}function fJ(e){return-Math.exp(-e)}function hJ(e){return isFinite(e)?+("1e"+e):e<0?0:e}function mJ(e){return e===10?hJ:e===Math.E?Math.exp:t=>Math.pow(e,t)}function xJ(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function vS(e){return(t,r)=>-e(-t,r)}function Cb(e){const t=e(gS,yS),r=t.domain;let a=10,s,i;function o(){return s=xJ(a),i=mJ(a),r()[0]<0?(s=vS(s),i=vS(i),e(uJ,fJ)):e(gS,yS),t}return t.base=function(l){return arguments.length?(a=+l,o()):a},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const f=u<d;f&&([d,u]=[u,d]);let x=s(d),p=s(u),h,m;const g=l==null?10:+l;let v=[];if(!(a%1)&&p-x<g){if(x=Math.floor(x),p=Math.ceil(p),d>0){for(;x<=p;++x)for(h=1;h<a;++h)if(m=x<0?h/i(-x):h*i(x),!(m<d)){if(m>u)break;v.push(m)}}else for(;x<=p;++x)for(h=a-1;h>=1;--h)if(m=x>0?h/i(-x):h*i(x),!(m<d)){if(m>u)break;v.push(m)}v.length*2<g&&(v=ay(d,u,g))}else v=ay(x,p,Math.min(p-x,g)).map(i);return f?v.reverse():v},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=a===10?"s":","),typeof c!="function"&&(!(a%1)&&(c=qc(c)).precision==null&&(c.trim=!0),c=Ab(c)),l===1/0)return c;const d=Math.max(1,a*l/t.ticks().length);return u=>{let f=u/i(Math.round(s(u)));return f*a<a-.5&&(f*=a),f<=d?c(u):""}},t.nice=()=>r(k3(r(),{floor:l=>i(Math.floor(s(l))),ceil:l=>i(Math.ceil(s(l)))})),t}function E3(){const e=Cb(f0()).domain([1,10]);return e.copy=()=>Ed(e,E3()).base(e.base()),nn.apply(e,arguments),e}function bS(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function jS(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Pb(e){var t=1,r=e(bS(t),jS(t));return r.constant=function(a){return arguments.length?e(bS(t=+a),jS(t)):t},qs(r)}function T3(){var e=Pb(f0());return e.copy=function(){return Ed(e,T3()).constant(e.constant())},nn.apply(e,arguments)}function wS(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function pJ(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function gJ(e){return e<0?-e*e:e*e}function Ob(e){var t=e(ua,ua),r=1;function a(){return r===1?e(ua,ua):r===.5?e(pJ,gJ):e(wS(r),wS(1/r))}return t.exponent=function(s){return arguments.length?(r=+s,a()):r},qs(t)}function Ib(){var e=Ob(f0());return e.copy=function(){return Ed(e,Ib()).exponent(e.exponent())},nn.apply(e,arguments),e}function yJ(){return Ib.apply(null,arguments).exponent(.5)}function NS(e){return Math.sign(e)*e*e}function vJ(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function A3(){var e=Eb(),t=[0,1],r=!1,a;function s(i){var o=vJ(e(i));return isNaN(o)?a:r?Math.round(o):o}return s.invert=function(i){return e.invert(NS(i))},s.domain=function(i){return arguments.length?(e.domain(i),s):e.domain()},s.range=function(i){return arguments.length?(e.range((t=Array.from(i,Qu)).map(NS)),s):t.slice()},s.rangeRound=function(i){return s.range(i).round(!0)},s.round=function(i){return arguments.length?(r=!!i,s):r},s.clamp=function(i){return arguments.length?(e.clamp(i),s):e.clamp()},s.unknown=function(i){return arguments.length?(a=i,s):a},s.copy=function(){return A3(e.domain(),t).round(r).clamp(e.clamp()).unknown(a)},nn.apply(s,arguments),qs(s)}function C3(){var e=[],t=[],r=[],a;function s(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=_Y(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?a:t[Sd(r,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Es),s()},i.range=function(o){return arguments.length?(t=Array.from(o),s()):t.slice()},i.unknown=function(o){return arguments.length?(a=o,i):a},i.quantiles=function(){return r.slice()},i.copy=function(){return C3().domain(e).range(t).unknown(a)},nn.apply(i,arguments)}function P3(){var e=0,t=1,r=1,a=[.5],s=[0,1],i;function o(c){return c!=null&&c<=c?s[Sd(a,c,0,r)]:i}function l(){var c=-1;for(a=new Array(r);++c<r;)a[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(s=Array.from(c)).length-1,l()):s.slice()},o.invertExtent=function(c){var d=s.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,a[0]]:d>=r?[a[r-1],t]:[a[d-1],a[d]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return a.slice()},o.copy=function(){return P3().domain([e,t]).range(s).unknown(i)},nn.apply(qs(o),arguments)}function O3(){var e=[.5],t=[0,1],r,a=1;function s(i){return i!=null&&i<=i?t[Sd(e,i,0,a)]:r}return s.domain=function(i){return arguments.length?(e=Array.from(i),a=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(i){return arguments.length?(t=Array.from(i),a=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},s.unknown=function(i){return arguments.length?(r=i,s):r},s.copy=function(){return O3().domain(e).range(t).unknown(r)},nn.apply(s,arguments)}const yp=new Date,vp=new Date;function Or(e,t,r,a){function s(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return s.floor=i=>(e(i=new Date(+i)),i),s.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),s.round=i=>{const o=s(i),l=s.ceil(i);return i-o<l-i?o:l},s.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),s.range=(i,o,l)=>{const c=[];if(i=s.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let d;do c.push(d=new Date(+i)),t(i,l),e(i);while(d<i&&i<o);return c},s.filter=i=>Or(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),r&&(s.count=(i,o)=>(yp.setTime(+i),vp.setTime(+o),e(yp),e(vp),Math.floor(r(yp,vp))),s.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?s.filter(a?o=>a(o)%i===0:o=>s.count(0,o)%i===0):s)),s}const tf=Or(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);tf.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Or(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):tf);tf.range;const Gn=1e3,Ya=Gn*60,Kn=Ya*60,ns=Kn*24,Fb=ns*7,_S=ns*30,bp=ns*365,ii=Or(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Gn)},(e,t)=>(t-e)/Gn,e=>e.getUTCSeconds());ii.range;const Db=Or(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Gn)},(e,t)=>{e.setTime(+e+t*Ya)},(e,t)=>(t-e)/Ya,e=>e.getMinutes());Db.range;const Rb=Or(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ya)},(e,t)=>(t-e)/Ya,e=>e.getUTCMinutes());Rb.range;const Mb=Or(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Gn-e.getMinutes()*Ya)},(e,t)=>{e.setTime(+e+t*Kn)},(e,t)=>(t-e)/Kn,e=>e.getHours());Mb.range;const Lb=Or(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Kn)},(e,t)=>(t-e)/Kn,e=>e.getUTCHours());Lb.range;const Td=Or(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ya)/ns,e=>e.getDate()-1);Td.range;const h0=Or(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ns,e=>e.getUTCDate()-1);h0.range;const I3=Or(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ns,e=>Math.floor(e/ns));I3.range;function qi(e){return Or(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ya)/Fb)}const m0=qi(0),rf=qi(1),bJ=qi(2),jJ=qi(3),Ro=qi(4),wJ=qi(5),NJ=qi(6);m0.range;rf.range;bJ.range;jJ.range;Ro.range;wJ.range;NJ.range;function Wi(e){return Or(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Fb)}const x0=Wi(0),af=Wi(1),_J=Wi(2),SJ=Wi(3),Mo=Wi(4),kJ=Wi(5),EJ=Wi(6);x0.range;af.range;_J.range;SJ.range;Mo.range;kJ.range;EJ.range;const $b=Or(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());$b.range;const Bb=Or(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Bb.range;const ss=Or(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ss.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Or(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ss.range;const is=Or(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());is.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Or(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});is.range;function F3(e,t,r,a,s,i){const o=[[ii,1,Gn],[ii,5,5*Gn],[ii,15,15*Gn],[ii,30,30*Gn],[i,1,Ya],[i,5,5*Ya],[i,15,15*Ya],[i,30,30*Ya],[s,1,Kn],[s,3,3*Kn],[s,6,6*Kn],[s,12,12*Kn],[a,1,ns],[a,2,2*ns],[r,1,Fb],[t,1,_S],[t,3,3*_S],[e,1,bp]];function l(d,u,f){const x=u<d;x&&([d,u]=[u,d]);const p=f&&typeof f.range=="function"?f:c(d,u,f),h=p?p.range(d,+u+1):[];return x?h.reverse():h}function c(d,u,f){const x=Math.abs(u-d)/f,p=wb(([,,g])=>g).right(o,x);if(p===o.length)return e.every(sy(d/bp,u/bp,f));if(p===0)return tf.every(Math.max(sy(d,u,f),1));const[h,m]=o[x/o[p-1][2]<o[p][2]/x?p-1:p];return h.every(m)}return[l,c]}const[TJ,AJ]=F3(is,Bb,x0,I3,Lb,Rb),[CJ,PJ]=F3(ss,$b,m0,Td,Mb,Db);function jp(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function wp(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Il(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function OJ(e){var t=e.dateTime,r=e.date,a=e.time,s=e.periods,i=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,d=Fl(s),u=Dl(s),f=Fl(i),x=Dl(i),p=Fl(o),h=Dl(o),m=Fl(l),g=Dl(l),v=Fl(c),b=Dl(c),y={a:V,A:F,b:U,B:q,c:null,d:CS,e:CS,f:tQ,g:uQ,G:hQ,H:QJ,I:ZJ,j:eQ,L:D3,m:rQ,M:aQ,p:K,q:T,Q:IS,s:FS,S:nQ,u:sQ,U:iQ,V:oQ,w:lQ,W:cQ,x:null,X:null,y:dQ,Y:fQ,Z:mQ,"%":OS},N={a:O,A:W,b:z,B:te,c:null,d:PS,e:PS,f:yQ,g:TQ,G:CQ,H:xQ,I:pQ,j:gQ,L:M3,m:vQ,M:bQ,p:ae,q:se,Q:IS,s:FS,S:jQ,u:wQ,U:NQ,V:_Q,w:SQ,W:kQ,x:null,X:null,y:EQ,Y:AQ,Z:PQ,"%":OS},j={a:E,A,b:P,B:L,c:R,d:TS,e:TS,f:KJ,g:ES,G:kS,H:AS,I:AS,j:HJ,L:GJ,m:WJ,M:zJ,p:k,q:qJ,Q:YJ,s:JJ,S:VJ,u:MJ,U:LJ,V:$J,w:RJ,W:BJ,x:I,X:D,y:ES,Y:kS,Z:UJ,"%":XJ};y.x=w(r,y),y.X=w(a,y),y.c=w(t,y),N.x=w(r,N),N.X=w(a,N),N.c=w(t,N);function w(M,G){return function(ne){var B=[],pe=-1,ye=0,Te=M.length,de,xe,We;for(ne instanceof Date||(ne=new Date(+ne));++pe<Te;)M.charCodeAt(pe)===37&&(B.push(M.slice(ye,pe)),(xe=SS[de=M.charAt(++pe)])!=null?de=M.charAt(++pe):xe=de==="e"?" ":"0",(We=G[de])&&(de=We(ne,xe)),B.push(de),ye=pe+1);return B.push(M.slice(ye,pe)),B.join("")}}function _(M,G){return function(ne){var B=Il(1900,void 0,1),pe=S(B,M,ne+="",0),ye,Te;if(pe!=ne.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(B.s*1e3+("L"in B?B.L:0));if(G&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+B.p*12),B.m===void 0&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(ye=wp(Il(B.y,0,1)),Te=ye.getUTCDay(),ye=Te>4||Te===0?af.ceil(ye):af(ye),ye=h0.offset(ye,(B.V-1)*7),B.y=ye.getUTCFullYear(),B.m=ye.getUTCMonth(),B.d=ye.getUTCDate()+(B.w+6)%7):(ye=jp(Il(B.y,0,1)),Te=ye.getDay(),ye=Te>4||Te===0?rf.ceil(ye):rf(ye),ye=Td.offset(ye,(B.V-1)*7),B.y=ye.getFullYear(),B.m=ye.getMonth(),B.d=ye.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),Te="Z"in B?wp(Il(B.y,0,1)).getUTCDay():jp(Il(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+B.W*7-(Te+5)%7:B.w+B.U*7-(Te+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,wp(B)):jp(B)}}function S(M,G,ne,B){for(var pe=0,ye=G.length,Te=ne.length,de,xe;pe<ye;){if(B>=Te)return-1;if(de=G.charCodeAt(pe++),de===37){if(de=G.charAt(pe++),xe=j[de in SS?G.charAt(pe++):de],!xe||(B=xe(M,ne,B))<0)return-1}else if(de!=ne.charCodeAt(B++))return-1}return B}function k(M,G,ne){var B=d.exec(G.slice(ne));return B?(M.p=u.get(B[0].toLowerCase()),ne+B[0].length):-1}function E(M,G,ne){var B=p.exec(G.slice(ne));return B?(M.w=h.get(B[0].toLowerCase()),ne+B[0].length):-1}function A(M,G,ne){var B=f.exec(G.slice(ne));return B?(M.w=x.get(B[0].toLowerCase()),ne+B[0].length):-1}function P(M,G,ne){var B=v.exec(G.slice(ne));return B?(M.m=b.get(B[0].toLowerCase()),ne+B[0].length):-1}function L(M,G,ne){var B=m.exec(G.slice(ne));return B?(M.m=g.get(B[0].toLowerCase()),ne+B[0].length):-1}function R(M,G,ne){return S(M,t,G,ne)}function I(M,G,ne){return S(M,r,G,ne)}function D(M,G,ne){return S(M,a,G,ne)}function V(M){return o[M.getDay()]}function F(M){return i[M.getDay()]}function U(M){return c[M.getMonth()]}function q(M){return l[M.getMonth()]}function K(M){return s[+(M.getHours()>=12)]}function T(M){return 1+~~(M.getMonth()/3)}function O(M){return o[M.getUTCDay()]}function W(M){return i[M.getUTCDay()]}function z(M){return c[M.getUTCMonth()]}function te(M){return l[M.getUTCMonth()]}function ae(M){return s[+(M.getUTCHours()>=12)]}function se(M){return 1+~~(M.getUTCMonth()/3)}return{format:function(M){var G=w(M+="",y);return G.toString=function(){return M},G},parse:function(M){var G=_(M+="",!1);return G.toString=function(){return M},G},utcFormat:function(M){var G=w(M+="",N);return G.toString=function(){return M},G},utcParse:function(M){var G=_(M+="",!0);return G.toString=function(){return M},G}}}var SS={"-":"",_:" ",0:"0"},$r=/^\s*\d+/,IJ=/^%/,FJ=/[\\^$*+?|[\]().{}]/g;function jt(e,t,r){var a=e<0?"-":"",s=(a?-e:e)+"",i=s.length;return a+(i<r?new Array(r-i+1).join(t)+s:s)}function DJ(e){return e.replace(FJ,"\\$&")}function Fl(e){return new RegExp("^(?:"+e.map(DJ).join("|")+")","i")}function Dl(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function RJ(e,t,r){var a=$r.exec(t.slice(r,r+1));return a?(e.w=+a[0],r+a[0].length):-1}function MJ(e,t,r){var a=$r.exec(t.slice(r,r+1));return a?(e.u=+a[0],r+a[0].length):-1}function LJ(e,t,r){var a=$r.exec(t.slice(r,r+2));return a?(e.U=+a[0],r+a[0].length):-1}function $J(e,t,r){var a=$r.exec(t.slice(r,r+2));return a?(e.V=+a[0],r+a[0].length):-1}function BJ(e,t,r){var a=$r.exec(t.slice(r,r+2));return a?(e.W=+a[0],r+a[0].length):-1}function kS(e,t,r){var a=$r.exec(t.slice(r,r+4));return a?(e.y=+a[0],r+a[0].length):-1}function ES(e,t,r){var a=$r.exec(t.slice(r,r+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),r+a[0].length):-1}function UJ(e,t,r){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),r+a[0].length):-1}function qJ(e,t,r){var a=$r.exec(t.slice(r,r+1));return a?(e.q=a[0]*3-3,r+a[0].length):-1}function WJ(e,t,r){var a=$r.exec(t.slice(r,r+2));return a?(e.m=a[0]-1,r+a[0].length):-1}function TS(e,t,r){var a=$r.exec(t.slice(r,r+2));return a?(e.d=+a[0],r+a[0].length):-1}function HJ(e,t,r){var a=$r.exec(t.slice(r,r+3));return a?(e.m=0,e.d=+a[0],r+a[0].length):-1}function AS(e,t,r){var a=$r.exec(t.slice(r,r+2));return a?(e.H=+a[0],r+a[0].length):-1}function zJ(e,t,r){var a=$r.exec(t.slice(r,r+2));return a?(e.M=+a[0],r+a[0].length):-1}function VJ(e,t,r){var a=$r.exec(t.slice(r,r+2));return a?(e.S=+a[0],r+a[0].length):-1}function GJ(e,t,r){var a=$r.exec(t.slice(r,r+3));return a?(e.L=+a[0],r+a[0].length):-1}function KJ(e,t,r){var a=$r.exec(t.slice(r,r+6));return a?(e.L=Math.floor(a[0]/1e3),r+a[0].length):-1}function XJ(e,t,r){var a=IJ.exec(t.slice(r,r+1));return a?r+a[0].length:-1}function YJ(e,t,r){var a=$r.exec(t.slice(r));return a?(e.Q=+a[0],r+a[0].length):-1}function JJ(e,t,r){var a=$r.exec(t.slice(r));return a?(e.s=+a[0],r+a[0].length):-1}function CS(e,t){return jt(e.getDate(),t,2)}function QJ(e,t){return jt(e.getHours(),t,2)}function ZJ(e,t){return jt(e.getHours()%12||12,t,2)}function eQ(e,t){return jt(1+Td.count(ss(e),e),t,3)}function D3(e,t){return jt(e.getMilliseconds(),t,3)}function tQ(e,t){return D3(e,t)+"000"}function rQ(e,t){return jt(e.getMonth()+1,t,2)}function aQ(e,t){return jt(e.getMinutes(),t,2)}function nQ(e,t){return jt(e.getSeconds(),t,2)}function sQ(e){var t=e.getDay();return t===0?7:t}function iQ(e,t){return jt(m0.count(ss(e)-1,e),t,2)}function R3(e){var t=e.getDay();return t>=4||t===0?Ro(e):Ro.ceil(e)}function oQ(e,t){return e=R3(e),jt(Ro.count(ss(e),e)+(ss(e).getDay()===4),t,2)}function lQ(e){return e.getDay()}function cQ(e,t){return jt(rf.count(ss(e)-1,e),t,2)}function dQ(e,t){return jt(e.getFullYear()%100,t,2)}function uQ(e,t){return e=R3(e),jt(e.getFullYear()%100,t,2)}function fQ(e,t){return jt(e.getFullYear()%1e4,t,4)}function hQ(e,t){var r=e.getDay();return e=r>=4||r===0?Ro(e):Ro.ceil(e),jt(e.getFullYear()%1e4,t,4)}function mQ(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+jt(t/60|0,"0",2)+jt(t%60,"0",2)}function PS(e,t){return jt(e.getUTCDate(),t,2)}function xQ(e,t){return jt(e.getUTCHours(),t,2)}function pQ(e,t){return jt(e.getUTCHours()%12||12,t,2)}function gQ(e,t){return jt(1+h0.count(is(e),e),t,3)}function M3(e,t){return jt(e.getUTCMilliseconds(),t,3)}function yQ(e,t){return M3(e,t)+"000"}function vQ(e,t){return jt(e.getUTCMonth()+1,t,2)}function bQ(e,t){return jt(e.getUTCMinutes(),t,2)}function jQ(e,t){return jt(e.getUTCSeconds(),t,2)}function wQ(e){var t=e.getUTCDay();return t===0?7:t}function NQ(e,t){return jt(x0.count(is(e)-1,e),t,2)}function L3(e){var t=e.getUTCDay();return t>=4||t===0?Mo(e):Mo.ceil(e)}function _Q(e,t){return e=L3(e),jt(Mo.count(is(e),e)+(is(e).getUTCDay()===4),t,2)}function SQ(e){return e.getUTCDay()}function kQ(e,t){return jt(af.count(is(e)-1,e),t,2)}function EQ(e,t){return jt(e.getUTCFullYear()%100,t,2)}function TQ(e,t){return e=L3(e),jt(e.getUTCFullYear()%100,t,2)}function AQ(e,t){return jt(e.getUTCFullYear()%1e4,t,4)}function CQ(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Mo(e):Mo.ceil(e),jt(e.getUTCFullYear()%1e4,t,4)}function PQ(){return"+0000"}function OS(){return"%"}function IS(e){return+e}function FS(e){return Math.floor(+e/1e3)}var to,$3,B3;OQ({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function OQ(e){return to=OJ(e),$3=to.format,to.parse,B3=to.utcFormat,to.utcParse,to}function IQ(e){return new Date(e)}function FQ(e){return e instanceof Date?+e:+new Date(+e)}function Ub(e,t,r,a,s,i,o,l,c,d){var u=Eb(),f=u.invert,x=u.domain,p=d(".%L"),h=d(":%S"),m=d("%I:%M"),g=d("%I %p"),v=d("%a %d"),b=d("%b %d"),y=d("%B"),N=d("%Y");function j(w){return(c(w)<w?p:l(w)<w?h:o(w)<w?m:i(w)<w?g:a(w)<w?s(w)<w?v:b:r(w)<w?y:N)(w)}return u.invert=function(w){return new Date(f(w))},u.domain=function(w){return arguments.length?x(Array.from(w,FQ)):x().map(IQ)},u.ticks=function(w){var _=x();return e(_[0],_[_.length-1],w??10)},u.tickFormat=function(w,_){return _==null?j:d(_)},u.nice=function(w){var _=x();return(!w||typeof w.range!="function")&&(w=t(_[0],_[_.length-1],w??10)),w?x(k3(_,w)):u},u.copy=function(){return Ed(u,Ub(e,t,r,a,s,i,o,l,c,d))},u}function DQ(){return nn.apply(Ub(CJ,PJ,ss,$b,m0,Td,Mb,Db,ii,$3).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function RQ(){return nn.apply(Ub(TJ,AJ,is,Bb,x0,h0,Lb,Rb,ii,B3).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function p0(){var e=0,t=1,r,a,s,i,o=ua,l=!1,c;function d(f){return f==null||isNaN(f=+f)?c:o(s===0?.5:(f=(i(f)-r)*s,l?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),a=i(t=+t),s=r===a?0:1/(a-r),d):[e,t]},d.clamp=function(f){return arguments.length?(l=!!f,d):l},d.interpolator=function(f){return arguments.length?(o=f,d):o};function u(f){return function(x){var p,h;return arguments.length?([p,h]=x,o=f(p,h),d):[o(0),o(1)]}}return d.range=u(gl),d.rangeRound=u(kb),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return i=f,r=f(e),a=f(t),s=r===a?0:1/(a-r),d}}function Ws(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function U3(){var e=qs(p0()(ua));return e.copy=function(){return Ws(e,U3())},hs.apply(e,arguments)}function q3(){var e=Cb(p0()).domain([1,10]);return e.copy=function(){return Ws(e,q3()).base(e.base())},hs.apply(e,arguments)}function W3(){var e=Pb(p0());return e.copy=function(){return Ws(e,W3()).constant(e.constant())},hs.apply(e,arguments)}function qb(){var e=Ob(p0());return e.copy=function(){return Ws(e,qb()).exponent(e.exponent())},hs.apply(e,arguments)}function MQ(){return qb.apply(null,arguments).exponent(.5)}function H3(){var e=[],t=ua;function r(a){if(a!=null&&!isNaN(a=+a))return t((Sd(e,a,1)-1)/(e.length-1))}return r.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let s of a)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Es),r},r.interpolator=function(a){return arguments.length?(t=a,r):t},r.range=function(){return e.map((a,s)=>t(s/(e.length-1)))},r.quantiles=function(a){return Array.from({length:a+1},(s,i)=>NY(e,i/a))},r.copy=function(){return H3(t).domain(e)},hs.apply(r,arguments)}function g0(){var e=0,t=.5,r=1,a=1,s,i,o,l,c,d=ua,u,f=!1,x;function p(m){return isNaN(m=+m)?x:(m=.5+((m=+u(m))-i)*(a*m<a*i?l:c),d(f?Math.max(0,Math.min(1,m)):m))}p.domain=function(m){return arguments.length?([e,t,r]=m,s=u(e=+e),i=u(t=+t),o=u(r=+r),l=s===i?0:.5/(i-s),c=i===o?0:.5/(o-i),a=i<s?-1:1,p):[e,t,r]},p.clamp=function(m){return arguments.length?(f=!!m,p):f},p.interpolator=function(m){return arguments.length?(d=m,p):d};function h(m){return function(g){var v,b,y;return arguments.length?([v,b,y]=g,d=XY(m,[v,b,y]),p):[d(0),d(.5),d(1)]}}return p.range=h(gl),p.rangeRound=h(kb),p.unknown=function(m){return arguments.length?(x=m,p):x},function(m){return u=m,s=m(e),i=m(t),o=m(r),l=s===i?0:.5/(i-s),c=i===o?0:.5/(o-i),a=i<s?-1:1,p}}function z3(){var e=qs(g0()(ua));return e.copy=function(){return Ws(e,z3())},hs.apply(e,arguments)}function V3(){var e=Cb(g0()).domain([.1,1,10]);return e.copy=function(){return Ws(e,V3()).base(e.base())},hs.apply(e,arguments)}function G3(){var e=Pb(g0());return e.copy=function(){return Ws(e,G3()).constant(e.constant())},hs.apply(e,arguments)}function Wb(){var e=Ob(g0());return e.copy=function(){return Ws(e,Wb()).exponent(e.exponent())},hs.apply(e,arguments)}function LQ(){return Wb.apply(null,arguments).exponent(.5)}const DS=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Lc,scaleDiverging:z3,scaleDivergingLog:V3,scaleDivergingPow:Wb,scaleDivergingSqrt:LQ,scaleDivergingSymlog:G3,scaleIdentity:S3,scaleImplicit:iy,scaleLinear:ef,scaleLog:E3,scaleOrdinal:Nb,scalePoint:oc,scalePow:Ib,scaleQuantile:C3,scaleQuantize:P3,scaleRadial:A3,scaleSequential:U3,scaleSequentialLog:q3,scaleSequentialPow:qb,scaleSequentialQuantile:H3,scaleSequentialSqrt:MQ,scaleSequentialSymlog:W3,scaleSqrt:yJ,scaleSymlog:T3,scaleThreshold:O3,scaleTime:DQ,scaleUtc:RQ,tickFormat:_3},Symbol.toStringTag,{value:"Module"}));var Np,RS;function y0(){if(RS)return Np;RS=1;var e=fl();function t(r,a,s){for(var i=-1,o=r.length;++i<o;){var l=r[i],c=a(l);if(c!=null&&(d===void 0?c===c&&!e(c):s(c,d)))var d=c,u=l}return u}return Np=t,Np}var _p,MS;function K3(){if(MS)return _p;MS=1;function e(t,r){return t>r}return _p=e,_p}var Sp,LS;function $Q(){if(LS)return Sp;LS=1;var e=y0(),t=K3(),r=pl();function a(s){return s&&s.length?e(s,r,t):void 0}return Sp=a,Sp}var BQ=$Q();const _s=Ct(BQ);var kp,$S;function X3(){if($S)return kp;$S=1;function e(t,r){return t<r}return kp=e,kp}var Ep,BS;function UQ(){if(BS)return Ep;BS=1;var e=y0(),t=X3(),r=pl();function a(s){return s&&s.length?e(s,r,t):void 0}return Ep=a,Ep}var qQ=UQ();const v0=Ct(qQ);var Tp,US;function WQ(){if(US)return Tp;US=1;var e=sb(),t=Mn(),r=a3(),a=Na();function s(i,o){var l=a(i)?e:r;return l(i,t(o,3))}return Tp=s,Tp}var Ap,qS;function HQ(){if(qS)return Ap;qS=1;var e=t3(),t=WQ();function r(a,s){return e(t(a,s),1)}return Ap=r,Ap}var zQ=HQ();const VQ=Ct(zQ);var Cp,WS;function GQ(){if(WS)return Cp;WS=1;var e=yb();function t(r,a){return e(r,a)}return Cp=t,Cp}var KQ=GQ();const Lo=Ct(KQ);var yl=1e9,XQ={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},zb,Gt=!0,tn="[DecimalError] ",gi=tn+"Invalid argument: ",Hb=tn+"Exponent out of range: ",vl=Math.floor,Qs=Math.pow,YQ=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Pa,Fr=1e7,qt=7,Y3=9007199254740991,nf=vl(Y3/qt),Pe={};Pe.absoluteValue=Pe.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Pe.comparedTo=Pe.cmp=function(e){var t,r,a,s,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(a=i.d.length,s=e.d.length,t=0,r=a<s?a:s;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return a===s?0:a>s^i.s<0?1:-1};Pe.decimalPlaces=Pe.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*qt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Pe.dividedBy=Pe.div=function(e){return ts(this,new this.constructor(e))};Pe.dividedToIntegerBy=Pe.idiv=function(e){var t=this,r=t.constructor;return Rt(ts(t,new r(e),0,1),r.precision)};Pe.equals=Pe.eq=function(e){return!this.cmp(e)};Pe.exponent=function(){return Nr(this)};Pe.greaterThan=Pe.gt=function(e){return this.cmp(e)>0};Pe.greaterThanOrEqualTo=Pe.gte=function(e){return this.cmp(e)>=0};Pe.isInteger=Pe.isint=function(){return this.e>this.d.length-2};Pe.isNegative=Pe.isneg=function(){return this.s<0};Pe.isPositive=Pe.ispos=function(){return this.s>0};Pe.isZero=function(){return this.s===0};Pe.lessThan=Pe.lt=function(e){return this.cmp(e)<0};Pe.lessThanOrEqualTo=Pe.lte=function(e){return this.cmp(e)<1};Pe.logarithm=Pe.log=function(e){var t,r=this,a=r.constructor,s=a.precision,i=s+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(Pa))throw Error(tn+"NaN");if(r.s<1)throw Error(tn+(r.s?"NaN":"-Infinity"));return r.eq(Pa)?new a(0):(Gt=!1,t=ts(Wc(r,i),Wc(e,i),i),Gt=!0,Rt(t,s))};Pe.minus=Pe.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Z3(t,e):J3(t,(e.s=-e.s,e))};Pe.modulo=Pe.mod=function(e){var t,r=this,a=r.constructor,s=a.precision;if(e=new a(e),!e.s)throw Error(tn+"NaN");return r.s?(Gt=!1,t=ts(r,e,0,1).times(e),Gt=!0,r.minus(t)):Rt(new a(r),s)};Pe.naturalExponential=Pe.exp=function(){return Q3(this)};Pe.naturalLogarithm=Pe.ln=function(){return Wc(this)};Pe.negated=Pe.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Pe.plus=Pe.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?J3(t,e):Z3(t,(e.s=-e.s,e))};Pe.precision=Pe.sd=function(e){var t,r,a,s=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(gi+e);if(t=Nr(s)+1,a=s.d.length-1,r=a*qt+1,a=s.d[a],a){for(;a%10==0;a/=10)r--;for(a=s.d[0];a>=10;a/=10)r++}return e&&t>r?t:r};Pe.squareRoot=Pe.sqrt=function(){var e,t,r,a,s,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(tn+"NaN")}for(e=Nr(l),Gt=!1,s=Math.sqrt(+l),s==0||s==1/0?(t=Sn(l.d),(t.length+e)%2==0&&(t+="0"),s=Math.sqrt(t),e=vl((e+1)/2)-(e<0||e%2),s==1/0?t="5e"+e:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),a=new c(t)):a=new c(s.toString()),r=c.precision,s=o=r+3;;)if(i=a,a=i.plus(ts(l,i,o+2)).times(.5),Sn(i.d).slice(0,o)===(t=Sn(a.d)).slice(0,o)){if(t=t.slice(o-3,o+1),s==o&&t=="4999"){if(Rt(i,r+1,0),i.times(i).eq(l)){a=i;break}}else if(t!="9999")break;o+=4}return Gt=!0,Rt(a,r)};Pe.times=Pe.mul=function(e){var t,r,a,s,i,o,l,c,d,u=this,f=u.constructor,x=u.d,p=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,c=x.length,d=p.length,c<d&&(i=x,x=p,p=i,o=c,c=d,d=o),i=[],o=c+d,a=o;a--;)i.push(0);for(a=d;--a>=0;){for(t=0,s=c+a;s>a;)l=i[s]+p[a]*x[s-a-1]+t,i[s--]=l%Fr|0,t=l/Fr|0;i[s]=(i[s]+t)%Fr|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Gt?Rt(e,f.precision):e};Pe.toDecimalPlaces=Pe.todp=function(e,t){var r=this,a=r.constructor;return r=new a(r),e===void 0?r:(On(e,0,yl),t===void 0?t=a.rounding:On(t,0,8),Rt(r,e+Nr(r)+1,t))};Pe.toExponential=function(e,t){var r,a=this,s=a.constructor;return e===void 0?r=Ci(a,!0):(On(e,0,yl),t===void 0?t=s.rounding:On(t,0,8),a=Rt(new s(a),e+1,t),r=Ci(a,!0,e+1)),r};Pe.toFixed=function(e,t){var r,a,s=this,i=s.constructor;return e===void 0?Ci(s):(On(e,0,yl),t===void 0?t=i.rounding:On(t,0,8),a=Rt(new i(s),e+Nr(s)+1,t),r=Ci(a.abs(),!1,e+Nr(a)+1),s.isneg()&&!s.isZero()?"-"+r:r)};Pe.toInteger=Pe.toint=function(){var e=this,t=e.constructor;return Rt(new t(e),Nr(e)+1,t.rounding)};Pe.toNumber=function(){return+this};Pe.toPower=Pe.pow=function(e){var t,r,a,s,i,o,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(Pa);if(l=new c(l),!l.s){if(e.s<1)throw Error(tn+"Infinity");return l}if(l.eq(Pa))return l;if(a=c.precision,e.eq(Pa))return Rt(l,a);if(t=e.e,r=e.d.length-1,o=t>=r,i=l.s,o){if((r=u<0?-u:u)<=Y3){for(s=new c(Pa),t=Math.ceil(a/qt+4),Gt=!1;r%2&&(s=s.times(l),zS(s.d,t)),r=vl(r/2),r!==0;)l=l.times(l),zS(l.d,t);return Gt=!0,e.s<0?new c(Pa).div(s):Rt(s,a)}}else if(i<0)throw Error(tn+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,Gt=!1,s=e.times(Wc(l,a+d)),Gt=!0,s=Q3(s),s.s=i,s};Pe.toPrecision=function(e,t){var r,a,s=this,i=s.constructor;return e===void 0?(r=Nr(s),a=Ci(s,r<=i.toExpNeg||r>=i.toExpPos)):(On(e,1,yl),t===void 0?t=i.rounding:On(t,0,8),s=Rt(new i(s),e,t),r=Nr(s),a=Ci(s,e<=r||r<=i.toExpNeg,e)),a};Pe.toSignificantDigits=Pe.tosd=function(e,t){var r=this,a=r.constructor;return e===void 0?(e=a.precision,t=a.rounding):(On(e,1,yl),t===void 0?t=a.rounding:On(t,0,8)),Rt(new a(r),e,t)};Pe.toString=Pe.valueOf=Pe.val=Pe.toJSON=Pe[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Nr(e),r=e.constructor;return Ci(e,t<=r.toExpNeg||t>=r.toExpPos)};function J3(e,t){var r,a,s,i,o,l,c,d,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Gt?Rt(t,f):t;if(c=e.d,d=t.d,o=e.e,s=t.e,c=c.slice(),i=o-s,i){for(i<0?(a=c,i=-i,l=d.length):(a=d,s=o,l=c.length),o=Math.ceil(f/qt),l=o>l?o+1:l+1,i>l&&(i=l,a.length=1),a.reverse();i--;)a.push(0);a.reverse()}for(l=c.length,i=d.length,l-i<0&&(i=l,a=d,d=c,c=a),r=0;i;)r=(c[--i]=c[i]+d[i]+r)/Fr|0,c[i]%=Fr;for(r&&(c.unshift(r),++s),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=s,Gt?Rt(t,f):t}function On(e,t,r){if(e!==~~e||e<t||e>r)throw Error(gi+e)}function Sn(e){var t,r,a,s=e.length-1,i="",o=e[0];if(s>0){for(i+=o,t=1;t<s;t++)a=e[t]+"",r=qt-a.length,r&&(i+=vs(r)),i+=a;o=e[t],a=o+"",r=qt-a.length,r&&(i+=vs(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var ts=(function(){function e(a,s){var i,o=0,l=a.length;for(a=a.slice();l--;)i=a[l]*s+o,a[l]=i%Fr|0,o=i/Fr|0;return o&&a.unshift(o),a}function t(a,s,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(a[l]!=s[l]){c=a[l]>s[l]?1:-1;break}return c}function r(a,s,i){for(var o=0;i--;)a[i]-=o,o=a[i]<s[i]?1:0,a[i]=o*Fr+a[i]-s[i];for(;!a[0]&&a.length>1;)a.shift()}return function(a,s,i,o){var l,c,d,u,f,x,p,h,m,g,v,b,y,N,j,w,_,S,k=a.constructor,E=a.s==s.s?1:-1,A=a.d,P=s.d;if(!a.s)return new k(a);if(!s.s)throw Error(tn+"Division by zero");for(c=a.e-s.e,_=P.length,j=A.length,p=new k(E),h=p.d=[],d=0;P[d]==(A[d]||0);)++d;if(P[d]>(A[d]||0)&&--c,i==null?b=i=k.precision:o?b=i+(Nr(a)-Nr(s))+1:b=i,b<0)return new k(0);if(b=b/qt+2|0,d=0,_==1)for(u=0,P=P[0],b++;(d<j||u)&&b--;d++)y=u*Fr+(A[d]||0),h[d]=y/P|0,u=y%P|0;else{for(u=Fr/(P[0]+1)|0,u>1&&(P=e(P,u),A=e(A,u),_=P.length,j=A.length),N=_,m=A.slice(0,_),g=m.length;g<_;)m[g++]=0;S=P.slice(),S.unshift(0),w=P[0],P[1]>=Fr/2&&++w;do u=0,l=t(P,m,_,g),l<0?(v=m[0],_!=g&&(v=v*Fr+(m[1]||0)),u=v/w|0,u>1?(u>=Fr&&(u=Fr-1),f=e(P,u),x=f.length,g=m.length,l=t(f,m,x,g),l==1&&(u--,r(f,_<x?S:P,x))):(u==0&&(l=u=1),f=P.slice()),x=f.length,x<g&&f.unshift(0),r(m,f,g),l==-1&&(g=m.length,l=t(P,m,_,g),l<1&&(u++,r(m,_<g?S:P,g))),g=m.length):l===0&&(u++,m=[0]),h[d++]=u,l&&m[0]?m[g++]=A[N]||0:(m=[A[N]],g=1);while((N++<j||m[0]!==void 0)&&b--)}return h[0]||h.shift(),p.e=c,Rt(p,o?i+Nr(p)+1:i)}})();function Q3(e,t){var r,a,s,i,o,l,c=0,d=0,u=e.constructor,f=u.precision;if(Nr(e)>16)throw Error(Hb+Nr(e));if(!e.s)return new u(Pa);for(Gt=!1,l=f,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(a=Math.log(Qs(2,d))/Math.LN10*2+5|0,l+=a,r=s=i=new u(Pa),u.precision=l;;){if(s=Rt(s.times(e),l),r=r.times(++c),o=i.plus(ts(s,r,l)),Sn(o.d).slice(0,l)===Sn(i.d).slice(0,l)){for(;d--;)i=Rt(i.times(i),l);return u.precision=f,t==null?(Gt=!0,Rt(i,f)):i}i=o}}function Nr(e){for(var t=e.e*qt,r=e.d[0];r>=10;r/=10)t++;return t}function Pp(e,t,r){if(t>e.LN10.sd())throw Gt=!0,r&&(e.precision=r),Error(tn+"LN10 precision limit exceeded");return Rt(new e(e.LN10),t)}function vs(e){for(var t="";e--;)t+="0";return t}function Wc(e,t){var r,a,s,i,o,l,c,d,u,f=1,x=10,p=e,h=p.d,m=p.constructor,g=m.precision;if(p.s<1)throw Error(tn+(p.s?"NaN":"-Infinity"));if(p.eq(Pa))return new m(0);if(t==null?(Gt=!1,d=g):d=t,p.eq(10))return t==null&&(Gt=!0),Pp(m,d);if(d+=x,m.precision=d,r=Sn(h),a=r.charAt(0),i=Nr(p),Math.abs(i)<15e14){for(;a<7&&a!=1||a==1&&r.charAt(1)>3;)p=p.times(e),r=Sn(p.d),a=r.charAt(0),f++;i=Nr(p),a>1?(p=new m("0."+r),i++):p=new m(a+"."+r.slice(1))}else return c=Pp(m,d+2,g).times(i+""),p=Wc(new m(a+"."+r.slice(1)),d-x).plus(c),m.precision=g,t==null?(Gt=!0,Rt(p,g)):p;for(l=o=p=ts(p.minus(Pa),p.plus(Pa),d),u=Rt(p.times(p),d),s=3;;){if(o=Rt(o.times(u),d),c=l.plus(ts(o,new m(s),d)),Sn(c.d).slice(0,d)===Sn(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(Pp(m,d+2,g).times(i+""))),l=ts(l,new m(f),d),m.precision=g,t==null?(Gt=!0,Rt(l,g)):l;l=c,s+=2}}function HS(e,t){var r,a,s;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(r<0&&(r=a),r+=+t.slice(a+1),t=t.substring(0,a)):r<0&&(r=t.length),a=0;t.charCodeAt(a)===48;)++a;for(s=t.length;t.charCodeAt(s-1)===48;)--s;if(t=t.slice(a,s),t){if(s-=a,r=r-a-1,e.e=vl(r/qt),e.d=[],a=(r+1)%qt,r<0&&(a+=qt),a<s){for(a&&e.d.push(+t.slice(0,a)),s-=qt;a<s;)e.d.push(+t.slice(a,a+=qt));t=t.slice(a),a=qt-t.length}else a-=s;for(;a--;)t+="0";if(e.d.push(+t),Gt&&(e.e>nf||e.e<-nf))throw Error(Hb+r)}else e.s=0,e.e=0,e.d=[0];return e}function Rt(e,t,r){var a,s,i,o,l,c,d,u,f=e.d;for(o=1,i=f[0];i>=10;i/=10)o++;if(a=t-o,a<0)a+=qt,s=t,d=f[u=0];else{if(u=Math.ceil((a+1)/qt),i=f.length,u>=i)return e;for(d=i=f[u],o=1;i>=10;i/=10)o++;a%=qt,s=a-qt+o}if(r!==void 0&&(i=Qs(10,o-s-1),l=d/i%10|0,c=t<0||f[u+1]!==void 0||d%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(a>0?s>0?d/Qs(10,o-s):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(i=Nr(e),f.length=1,t=t-i-1,f[0]=Qs(10,(qt-t%qt)%qt),e.e=vl(-t/qt)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(a==0?(f.length=u,i=1,u--):(f.length=u+1,i=Qs(10,qt-a),f[u]=s>0?(d/Qs(10,o-s)%Qs(10,s)|0)*i:0),c)for(;;)if(u==0){(f[0]+=i)==Fr&&(f[0]=1,++e.e);break}else{if(f[u]+=i,f[u]!=Fr)break;f[u--]=0,i=1}for(a=f.length;f[--a]===0;)f.pop();if(Gt&&(e.e>nf||e.e<-nf))throw Error(Hb+Nr(e));return e}function Z3(e,t){var r,a,s,i,o,l,c,d,u,f,x=e.constructor,p=x.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new x(e),Gt?Rt(t,p):t;if(c=e.d,f=t.d,a=t.e,d=e.e,c=c.slice(),o=d-a,o){for(u=o<0,u?(r=c,o=-o,l=f.length):(r=f,a=d,l=c.length),s=Math.max(Math.ceil(p/qt),l)+2,o>s&&(o=s,r.length=1),r.reverse(),s=o;s--;)r.push(0);r.reverse()}else{for(s=c.length,l=f.length,u=s<l,u&&(l=s),s=0;s<l;s++)if(c[s]!=f[s]){u=c[s]<f[s];break}o=0}for(u&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,s=f.length-l;s>0;--s)c[l++]=0;for(s=f.length;s>o;){if(c[--s]<f[s]){for(i=s;i&&c[--i]===0;)c[i]=Fr-1;--c[i],c[s]+=Fr}c[s]-=f[s]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--a;return c[0]?(t.d=c,t.e=a,Gt?Rt(t,p):t):new x(0)}function Ci(e,t,r){var a,s=Nr(e),i=Sn(e.d),o=i.length;return t?(r&&(a=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+vs(a):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(s<0?"e":"e+")+s):s<0?(i="0."+vs(-s-1)+i,r&&(a=r-o)>0&&(i+=vs(a))):s>=o?(i+=vs(s+1-o),r&&(a=r-s-1)>0&&(i=i+"."+vs(a))):((a=s+1)<o&&(i=i.slice(0,a)+"."+i.slice(a)),r&&(a=r-o)>0&&(s+1===o&&(i+="."),i+=vs(a))),e.s<0?"-"+i:i}function zS(e,t){if(e.length>t)return e.length=t,!0}function eA(e){var t,r,a;function s(i){var o=this;if(!(o instanceof s))return new s(i);if(o.constructor=s,i instanceof s){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(gi+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return HS(o,i.toString())}else if(typeof i!="string")throw Error(gi+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,YQ.test(i))HS(o,i);else throw Error(gi+i)}if(s.prototype=Pe,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=eA,s.config=s.set=JQ,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<a.length;)e.hasOwnProperty(r=a[t++])||(e[r]=this[r]);return s.config(e),s}function JQ(e){if(!e||typeof e!="object")throw Error(tn+"Object expected");var t,r,a,s=["precision",1,yl,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<s.length;t+=3)if((a=e[r=s[t]])!==void 0)if(vl(a)===a&&a>=s[t+1]&&a<=s[t+2])this[r]=a;else throw Error(gi+r+": "+a);if((a=e[r="LN10"])!==void 0)if(a==Math.LN10)this[r]=new this(a);else throw Error(gi+r+": "+a);return this}var zb=eA(XQ);Pa=new zb(1);const Ot=zb;function QQ(e){return rZ(e)||tZ(e)||eZ(e)||ZQ()}function ZQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eZ(e,t){if(e){if(typeof e=="string")return dy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dy(e,t)}}function tZ(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function rZ(e){if(Array.isArray(e))return dy(e)}function dy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var aZ=function(t){return t},tA={},rA=function(t){return t===tA},VS=function(t){return function r(){return arguments.length===0||arguments.length===1&&rA(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},nZ=function e(t,r){return t===1?r:VS(function(){for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];var o=s.filter(function(l){return l!==tA}).length;return o>=t?r.apply(void 0,s):e(t-o,VS(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var u=s.map(function(f){return rA(f)?c.shift():f});return r.apply(void 0,QQ(u).concat(c))}))})},b0=function(t){return nZ(t.length,t)},uy=function(t,r){for(var a=[],s=t;s<r;++s)a[s-t]=s;return a},sZ=b0(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),iZ=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];if(!r.length)return aZ;var s=r.reverse(),i=s[0],o=s.slice(1);return function(){return o.reduce(function(l,c){return c(l)},i.apply(void 0,arguments))}},fy=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},aA=function(t){var r=null,a=null;return function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r&&i.every(function(l,c){return l===r[c]})||(r=i,a=t.apply(void 0,i)),a}};function oZ(e){var t;return e===0?t=1:t=Math.floor(new Ot(e).abs().log(10).toNumber())+1,t}function lZ(e,t,r){for(var a=new Ot(e),s=0,i=[];a.lt(t)&&s<1e5;)i.push(a.toNumber()),a=a.add(r),s++;return i}var cZ=b0(function(e,t,r){var a=+e,s=+t;return a+r*(s-a)}),dZ=b0(function(e,t,r){var a=t-+e;return a=a||1/0,(r-e)/a}),uZ=b0(function(e,t,r){var a=t-+e;return a=a||1/0,Math.max(0,Math.min(1,(r-e)/a))});const j0={rangeStep:lZ,getDigitCount:oZ,interpolateNumber:cZ,uninterpolateNumber:dZ,uninterpolateTruncation:uZ};function hy(e){return mZ(e)||hZ(e)||nA(e)||fZ()}function fZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hZ(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function mZ(e){if(Array.isArray(e))return my(e)}function Hc(e,t){return gZ(e)||pZ(e,t)||nA(e,t)||xZ()}function xZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nA(e,t){if(e){if(typeof e=="string")return my(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return my(e,t)}}function my(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function pZ(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],a=!0,s=!1,i=void 0;try{for(var o=e[Symbol.iterator](),l;!(a=(l=o.next()).done)&&(r.push(l.value),!(t&&r.length===t));a=!0);}catch(c){s=!0,i=c}finally{try{!a&&o.return!=null&&o.return()}finally{if(s)throw i}}return r}}function gZ(e){if(Array.isArray(e))return e}function sA(e){var t=Hc(e,2),r=t[0],a=t[1],s=r,i=a;return r>a&&(s=a,i=r),[s,i]}function iA(e,t,r){if(e.lte(0))return new Ot(0);var a=j0.getDigitCount(e.toNumber()),s=new Ot(10).pow(a),i=e.div(s),o=a!==1?.05:.1,l=new Ot(Math.ceil(i.div(o).toNumber())).add(r).mul(o),c=l.mul(s);return t?c:new Ot(Math.ceil(c))}function yZ(e,t,r){var a=1,s=new Ot(e);if(!s.isint()&&r){var i=Math.abs(e);i<1?(a=new Ot(10).pow(j0.getDigitCount(e)-1),s=new Ot(Math.floor(s.div(a).toNumber())).mul(a)):i>1&&(s=new Ot(Math.floor(e)))}else e===0?s=new Ot(Math.floor((t-1)/2)):r||(s=new Ot(Math.floor(e)));var o=Math.floor((t-1)/2),l=iZ(sZ(function(c){return s.add(new Ot(c-o).mul(a)).toNumber()}),uy);return l(0,t)}function oA(e,t,r,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Ot(0),tickMin:new Ot(0),tickMax:new Ot(0)};var i=iA(new Ot(t).sub(e).div(r-1),a,s),o;e<=0&&t>=0?o=new Ot(0):(o=new Ot(e).add(t).div(2),o=o.sub(new Ot(o).mod(i)));var l=Math.ceil(o.sub(e).div(i).toNumber()),c=Math.ceil(new Ot(t).sub(o).div(i).toNumber()),d=l+c+1;return d>r?oA(e,t,r,a,s+1):(d<r&&(c=t>0?c+(r-d):c,l=t>0?l:l+(r-d)),{step:i,tickMin:o.sub(new Ot(l).mul(i)),tickMax:o.add(new Ot(c).mul(i))})}function vZ(e){var t=Hc(e,2),r=t[0],a=t[1],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(s,2),l=sA([r,a]),c=Hc(l,2),d=c[0],u=c[1];if(d===-1/0||u===1/0){var f=u===1/0?[d].concat(hy(uy(0,s-1).map(function(){return 1/0}))):[].concat(hy(uy(0,s-1).map(function(){return-1/0})),[u]);return r>a?fy(f):f}if(d===u)return yZ(d,s,i);var x=oA(d,u,o,i),p=x.step,h=x.tickMin,m=x.tickMax,g=j0.rangeStep(h,m.add(new Ot(.1).mul(p)),p);return r>a?fy(g):g}function bZ(e,t){var r=Hc(e,2),a=r[0],s=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=sA([a,s]),l=Hc(o,2),c=l[0],d=l[1];if(c===-1/0||d===1/0)return[a,s];if(c===d)return[c];var u=Math.max(t,2),f=iA(new Ot(d).sub(c).div(u-1),i,0),x=[].concat(hy(j0.rangeStep(new Ot(c),new Ot(d).sub(new Ot(.99).mul(f)),f)),[d]);return a>s?fy(x):x}var jZ=aA(vZ),wZ=aA(bZ),NZ="Invariant failed";function Pi(e,t){throw new Error(NZ)}var _Z=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function $o(e){"@babel/helpers - typeof";return $o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$o(e)}function sf(){return sf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},sf.apply(this,arguments)}function SZ(e,t){return AZ(e)||TZ(e,t)||EZ(e,t)||kZ()}function kZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EZ(e,t){if(e){if(typeof e=="string")return GS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GS(e,t)}}function GS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function TZ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function AZ(e){if(Array.isArray(e))return e}function CZ(e,t){if(e==null)return{};var r=PZ(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function PZ(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function OZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IZ(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,dA(a.key),a)}}function FZ(e,t,r){return t&&IZ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function DZ(e,t,r){return t=of(t),RZ(e,lA()?Reflect.construct(t,r||[],of(e).constructor):t.apply(e,r))}function RZ(e,t){if(t&&($o(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MZ(e)}function MZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lA=function(){return!!e})()}function of(e){return of=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},of(e)}function LZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xy(e,t)}function xy(e,t){return xy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},xy(e,t)}function cA(e,t,r){return t=dA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dA(e){var t=$Z(e,"string");return $o(t)=="symbol"?t:t+""}function $Z(e,t){if($o(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if($o(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var w0=(function(e){function t(){return OZ(this,t),DZ(this,t,arguments)}return LZ(t,e),FZ(t,[{key:"render",value:function(){var a=this.props,s=a.offset,i=a.layout,o=a.width,l=a.dataKey,c=a.data,d=a.dataPointFormatter,u=a.xAxis,f=a.yAxis,x=CZ(a,_Z),p=Re(x,!1);this.props.direction==="x"&&u.type!=="number"&&Pi();var h=c.map(function(m){var g=d(m,l),v=g.x,b=g.y,y=g.value,N=g.errorVal;if(!N)return null;var j=[],w,_;if(Array.isArray(N)){var S=SZ(N,2);w=S[0],_=S[1]}else w=_=N;if(i==="vertical"){var k=u.scale,E=b+s,A=E+o,P=E-o,L=k(y-w),R=k(y+_);j.push({x1:R,y1:A,x2:R,y2:P}),j.push({x1:L,y1:E,x2:R,y2:E}),j.push({x1:L,y1:A,x2:L,y2:P})}else if(i==="horizontal"){var I=f.scale,D=v+s,V=D-o,F=D+o,U=I(y-w),q=I(y+_);j.push({x1:V,y1:q,x2:F,y2:q}),j.push({x1:D,y1:U,x2:D,y2:q}),j.push({x1:V,y1:U,x2:F,y2:U})}return ee.createElement(ht,sf({className:"recharts-errorBar",key:"bar-".concat(j.map(function(K){return"".concat(K.x1,"-").concat(K.x2,"-").concat(K.y1,"-").concat(K.y2)}))},p),j.map(function(K){return ee.createElement("line",sf({},K,{key:"line-".concat(K.x1,"-").concat(K.x2,"-").concat(K.y1,"-").concat(K.y2)}))}))});return ee.createElement(ht,{className:"recharts-errorBars"},h)}}])})(ee.Component);cA(w0,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});cA(w0,"displayName","ErrorBar");function zc(e){"@babel/helpers - typeof";return zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zc(e)}function KS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Gs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KS(Object(r),!0).forEach(function(a){BZ(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KS(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function BZ(e,t,r){return t=UZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UZ(e){var t=qZ(e,"string");return zc(t)=="symbol"?t:t+""}function qZ(e,t){if(zc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(zc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uA=function(t){var r=t.children,a=t.formattedGraphicalItems,s=t.legendWidth,i=t.legendContent,o=ka(r,go);if(!o)return null;var l=go.defaultProps,c=l!==void 0?Gs(Gs({},l),o.props):{},d;return o.props&&o.props.payload?d=o.props&&o.props.payload:i==="children"?d=(a||[]).reduce(function(u,f){var x=f.item,p=f.props,h=p.sectors||p.data||[];return u.concat(h.map(function(m){return{type:o.props.iconType||x.props.legendType,value:m.name,color:m.fill,payload:m}}))},[]):d=(a||[]).map(function(u){var f=u.item,x=f.type.defaultProps,p=x!==void 0?Gs(Gs({},x),f.props):{},h=p.dataKey,m=p.name,g=p.legendType,v=p.hide;return{inactive:v,dataKey:h,type:c.iconType||g||"square",color:Vb(f),value:m||h,payload:p}}),Gs(Gs(Gs({},c),go.getWithHeight(o,s)),{},{payload:d,item:o})};function Vc(e){"@babel/helpers - typeof";return Vc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vc(e)}function XS(e){return VZ(e)||zZ(e)||HZ(e)||WZ()}function WZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HZ(e,t){if(e){if(typeof e=="string")return py(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return py(e,t)}}function zZ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VZ(e){if(Array.isArray(e))return py(e)}function py(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function YS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function or(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YS(Object(r),!0).forEach(function(a){vo(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YS(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function vo(e,t,r){return t=GZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GZ(e){var t=KZ(e,"string");return Vc(t)=="symbol"?t:t+""}function KZ(e,t){if(Vc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Vc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tr(e,t,r){return Je(e)||Je(t)?r:Ar(t)?Oa(e,t,r):qe(t)?t(e):r}function lc(e,t,r,a){var s=VQ(e,function(l){return Tr(l,t)});if(r==="number"){var i=s.filter(function(l){return be(l)||parseFloat(l)});return i.length?[v0(i),_s(i)]:[1/0,-1/0]}var o=a?s.filter(function(l){return!Je(l)}):s;return o.map(function(l){return Ar(l)||l instanceof Date?l:""})}var XZ=function(t){var r,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,l=(r=a==null?void 0:a.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,d=0;d<l;d++){var u=d>0?s[d-1].coordinate:s[l-1].coordinate,f=s[d].coordinate,x=d>=l-1?s[0].coordinate:s[d+1].coordinate,p=void 0;if(ca(f-u)!==ca(x-f)){var h=[];if(ca(x-f)===ca(c[1]-c[0])){p=x;var m=f+c[1]-c[0];h[0]=Math.min(m,(m+u)/2),h[1]=Math.max(m,(m+u)/2)}else{p=u;var g=x+c[1]-c[0];h[0]=Math.min(f,(g+f)/2),h[1]=Math.max(f,(g+f)/2)}var v=[Math.min(f,(p+f)/2),Math.max(f,(p+f)/2)];if(t>v[0]&&t<=v[1]||t>=h[0]&&t<=h[1]){o=s[d].index;break}}else{var b=Math.min(u,x),y=Math.max(u,x);if(t>(b+f)/2&&t<=(y+f)/2){o=s[d].index;break}}}else for(var N=0;N<l;N++)if(N===0&&t<=(a[N].coordinate+a[N+1].coordinate)/2||N>0&&N<l-1&&t>(a[N].coordinate+a[N-1].coordinate)/2&&t<=(a[N].coordinate+a[N+1].coordinate)/2||N===l-1&&t>(a[N].coordinate+a[N-1].coordinate)/2){o=a[N].index;break}return o},Vb=function(t){var r,a=t,s=a.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?or(or({},t.type.defaultProps),t.props):t.props,o=i.stroke,l=i.fill,c;switch(s){case"Line":c=o;break;case"Area":case"Radar":c=o&&o!=="none"?o:l;break;default:c=l;break}return c},YZ=function(t){var r=t.barSize,a=t.totalSize,s=t.stackGroups,i=s===void 0?{}:s;if(!i)return{};for(var o={},l=Object.keys(i),c=0,d=l.length;c<d;c++)for(var u=i[l[c]].stackGroups,f=Object.keys(u),x=0,p=f.length;x<p;x++){var h=u[f[x]],m=h.items,g=h.cateAxisId,v=m.filter(function(_){return es(_.type).indexOf("Bar")>=0});if(v&&v.length){var b=v[0].type.defaultProps,y=b!==void 0?or(or({},b),v[0].props):v[0].props,N=y.barSize,j=y[g];o[j]||(o[j]=[]);var w=Je(N)?r:N;o[j].push({item:v[0],stackList:v.slice(1),barSize:Je(w)?void 0:da(w,a,0)})}}return o},JZ=function(t){var r=t.barGap,a=t.barCategoryGap,s=t.bandSize,i=t.sizeList,o=i===void 0?[]:i,l=t.maxBarSize,c=o.length;if(c<1)return null;var d=da(r,s,0,!0),u,f=[];if(o[0].barSize===+o[0].barSize){var x=!1,p=s/c,h=o.reduce(function(N,j){return N+j.barSize||0},0);h+=(c-1)*d,h>=s&&(h-=(c-1)*d,d=0),h>=s&&p>0&&(x=!0,p*=.9,h=c*p);var m=(s-h)/2>>0,g={offset:m-d,size:0};u=o.reduce(function(N,j){var w={item:j.item,position:{offset:g.offset+g.size+d,size:x?p:j.barSize}},_=[].concat(XS(N),[w]);return g=_[_.length-1].position,j.stackList&&j.stackList.length&&j.stackList.forEach(function(S){_.push({item:S,position:g})}),_},f)}else{var v=da(a,s,0,!0);s-2*v-(c-1)*d<=0&&(d=0);var b=(s-2*v-(c-1)*d)/c;b>1&&(b>>=0);var y=l===+l?Math.min(b,l):b;u=o.reduce(function(N,j,w){var _=[].concat(XS(N),[{item:j.item,position:{offset:v+(b+d)*w+(b-y)/2,size:y}}]);return j.stackList&&j.stackList.length&&j.stackList.forEach(function(S){_.push({item:S,position:_[_.length-1].position})}),_},f)}return u},QZ=function(t,r,a,s){var i=a.children,o=a.width,l=a.margin,c=o-(l.left||0)-(l.right||0),d=uA({children:i,legendWidth:c});if(d){var u=s||{},f=u.width,x=u.height,p=d.align,h=d.verticalAlign,m=d.layout;if((m==="vertical"||m==="horizontal"&&h==="middle")&&p!=="center"&&be(t[p]))return or(or({},t),{},vo({},p,t[p]+(f||0)));if((m==="horizontal"||m==="vertical"&&p==="center")&&h!=="middle"&&be(t[h]))return or(or({},t),{},vo({},h,t[h]+(x||0)))}return t},ZZ=function(t,r,a){return Je(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||a==="x"?r==="xAxis":a==="y"?r==="yAxis":!0},fA=function(t,r,a,s,i){var o=r.props.children,l=Qa(o,w0).filter(function(d){return ZZ(s,i,d.props.direction)});if(l&&l.length){var c=l.map(function(d){return d.props.dataKey});return t.reduce(function(d,u){var f=Tr(u,a);if(Je(f))return d;var x=Array.isArray(f)?[v0(f),_s(f)]:[f,f],p=c.reduce(function(h,m){var g=Tr(u,m,0),v=x[0]-Math.abs(Array.isArray(g)?g[0]:g),b=x[1]+Math.abs(Array.isArray(g)?g[1]:g);return[Math.min(v,h[0]),Math.max(b,h[1])]},[1/0,-1/0]);return[Math.min(p[0],d[0]),Math.max(p[1],d[1])]},[1/0,-1/0])}return null},eee=function(t,r,a,s,i){var o=r.map(function(l){return fA(t,l,a,i,s)}).filter(function(l){return!Je(l)});return o&&o.length?o.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},hA=function(t,r,a,s,i){var o=r.map(function(c){var d=c.props.dataKey;return a==="number"&&d&&fA(t,c,d,s)||lc(t,d,a,i)});if(a==="number")return o.reduce(function(c,d){return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);var l={};return o.reduce(function(c,d){for(var u=0,f=d.length;u<f;u++)l[d[u]]||(l[d[u]]=!0,c.push(d[u]));return c},[])},mA=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},xA=function(t,r,a,s){if(s)return t.map(function(c){return c.coordinate});var i,o,l=t.map(function(c){return c.coordinate===r&&(i=!0),c.coordinate===a&&(o=!0),c.coordinate});return i||l.push(r),o||l.push(a),l},Xn=function(t,r,a){if(!t)return null;var s=t.scale,i=t.duplicateDomain,o=t.type,l=t.range,c=t.realScaleType==="scaleBand"?s.bandwidth()/2:2,d=(r||a)&&o==="category"&&s.bandwidth?s.bandwidth()/c:0;if(d=t.axisType==="angleAxis"&&(l==null?void 0:l.length)>=2?ca(l[0]-l[1])*2*d:d,r&&(t.ticks||t.niceTicks)){var u=(t.ticks||t.niceTicks).map(function(f){var x=i?i.indexOf(f):f;return{coordinate:s(x)+d,value:f,offset:d}});return u.filter(function(f){return!ml(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,x){return{coordinate:s(f)+d,value:f,index:x,offset:d}}):s.ticks&&!a?s.ticks(t.tickCount).map(function(f){return{coordinate:s(f)+d,value:f,offset:d}}):s.domain().map(function(f,x){return{coordinate:s(f)+d,value:i?i[f]:f,index:x,offset:d}})},Op=new WeakMap,ru=function(t,r){if(typeof r!="function")return t;Op.has(t)||Op.set(t,new WeakMap);var a=Op.get(t);if(a.has(r))return a.get(r);var s=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return a.set(r,s),s},pA=function(t,r,a){var s=t.scale,i=t.type,o=t.layout,l=t.axisType;if(s==="auto")return o==="radial"&&l==="radiusAxis"?{scale:Lc(),realScaleType:"band"}:o==="radial"&&l==="angleAxis"?{scale:ef(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!a)?{scale:oc(),realScaleType:"point"}:i==="category"?{scale:Lc(),realScaleType:"band"}:{scale:ef(),realScaleType:"linear"};if(Ei(s)){var c="scale".concat(n0(s));return{scale:(DS[c]||oc)(),realScaleType:DS[c]?c:"point"}}return qe(s)?{scale:s}:{scale:oc(),realScaleType:"point"}},JS=1e-4,gA=function(t){var r=t.domain();if(!(!r||r.length<=2)){var a=r.length,s=t.range(),i=Math.min(s[0],s[1])-JS,o=Math.max(s[0],s[1])+JS,l=t(r[0]),c=t(r[a-1]);(l<i||l>o||c<i||c>o)&&t.domain([r[0],r[a-1]])}},tee=function(t,r){if(!t)return null;for(var a=0,s=t.length;a<s;a++)if(t[a].item===r)return t[a].position;return null},ree=function(t,r){if(!r||r.length!==2||!be(r[0])||!be(r[1]))return t;var a=Math.min(r[0],r[1]),s=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!be(t[0])||t[0]<a)&&(i[0]=a),(!be(t[1])||t[1]>s)&&(i[1]=s),i[0]>s&&(i[0]=s),i[1]<a&&(i[1]=a),i},aee=function(t){var r=t.length;if(!(r<=0))for(var a=0,s=t[0].length;a<s;++a)for(var i=0,o=0,l=0;l<r;++l){var c=ml(t[l][a][1])?t[l][a][0]:t[l][a][1];c>=0?(t[l][a][0]=i,t[l][a][1]=i+c,i=t[l][a][1]):(t[l][a][0]=o,t[l][a][1]=o+c,o=t[l][a][1])}},nee=function(t){var r=t.length;if(!(r<=0))for(var a=0,s=t[0].length;a<s;++a)for(var i=0,o=0;o<r;++o){var l=ml(t[o][a][1])?t[o][a][0]:t[o][a][1];l>=0?(t[o][a][0]=i,t[o][a][1]=i+l,i=t[o][a][1]):(t[o][a][0]=0,t[o][a][1]=0)}},see={sign:aee,expand:VV,none:Co,silhouette:GV,wiggle:KV,positive:nee},iee=function(t,r,a){var s=r.map(function(l){return l.props.dataKey}),i=see[a],o=zV().keys(s).value(function(l,c){return+Tr(l,c,0)}).order(Vg).offset(i);return o(t)},oee=function(t,r,a,s,i,o){if(!t)return null;var l=o?r.reverse():r,c={},d=l.reduce(function(f,x){var p,h=(p=x.type)!==null&&p!==void 0&&p.defaultProps?or(or({},x.type.defaultProps),x.props):x.props,m=h.stackId,g=h.hide;if(g)return f;var v=h[a],b=f[v]||{hasStack:!1,stackGroups:{}};if(Ar(m)){var y=b.stackGroups[m]||{numericAxisId:a,cateAxisId:s,items:[]};y.items.push(x),b.hasStack=!0,b.stackGroups[m]=y}else b.stackGroups[xl("_stackId_")]={numericAxisId:a,cateAxisId:s,items:[x]};return or(or({},f),{},vo({},v,b))},c),u={};return Object.keys(d).reduce(function(f,x){var p=d[x];if(p.hasStack){var h={};p.stackGroups=Object.keys(p.stackGroups).reduce(function(m,g){var v=p.stackGroups[g];return or(or({},m),{},vo({},g,{numericAxisId:a,cateAxisId:s,items:v.items,stackedData:iee(t,v.items,i)}))},h)}return or(or({},f),{},vo({},x,p))},u)},yA=function(t,r){var a=r.realScaleType,s=r.type,i=r.tickCount,o=r.originalDomain,l=r.allowDecimals,c=a||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&s==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var d=t.domain();if(!d.length)return null;var u=jZ(d,i,l);return t.domain([v0(u),_s(u)]),{niceTicks:u}}if(i&&s==="number"){var f=t.domain(),x=wZ(f,i,l);return{niceTicks:x}}return null};function QS(e){var t=e.axis,r=e.ticks,a=e.bandSize,s=e.entry,i=e.index,o=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Je(s[t.dataKey])){var l=Ru(r,"value",s[t.dataKey]);if(l)return l.coordinate+a/2}return r[i]?r[i].coordinate+a/2:null}var c=Tr(s,Je(o)?t.dataKey:o);return Je(c)?null:t.scale(c)}var ZS=function(t){var r=t.axis,a=t.ticks,s=t.offset,i=t.bandSize,o=t.entry,l=t.index;if(r.type==="category")return a[l]?a[l].coordinate+s:null;var c=Tr(o,r.dataKey,r.domain[l]);return Je(c)?null:r.scale(c)-i/2+s},lee=function(t){var r=t.numericAxis,a=r.scale.domain();if(r.type==="number"){var s=Math.min(a[0],a[1]),i=Math.max(a[0],a[1]);return s<=0&&i>=0?0:i<0?i:s}return a[0]},cee=function(t,r){var a,s=(a=t.type)!==null&&a!==void 0&&a.defaultProps?or(or({},t.type.defaultProps),t.props):t.props,i=s.stackId;if(Ar(i)){var o=r[i];if(o){var l=o.items.indexOf(t);return l>=0?o.stackedData[l]:null}}return null},dee=function(t){return t.reduce(function(r,a){return[v0(a.concat([r[0]]).filter(be)),_s(a.concat([r[1]]).filter(be))]},[1/0,-1/0])},vA=function(t,r,a){return Object.keys(t).reduce(function(s,i){var o=t[i],l=o.stackedData,c=l.reduce(function(d,u){var f=dee(u.slice(r,a+1));return[Math.min(d[0],f[0]),Math.max(d[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],s[0]),Math.max(c[1],s[1])]},[1/0,-1/0]).map(function(s){return s===1/0||s===-1/0?0:s})},e4=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,t4=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,gy=function(t,r,a){if(qe(t))return t(r,a);if(!Array.isArray(t))return r;var s=[];if(be(t[0]))s[0]=a?t[0]:Math.min(t[0],r[0]);else if(e4.test(t[0])){var i=+e4.exec(t[0])[1];s[0]=r[0]-i}else qe(t[0])?s[0]=t[0](r[0]):s[0]=r[0];if(be(t[1]))s[1]=a?t[1]:Math.max(t[1],r[1]);else if(t4.test(t[1])){var o=+t4.exec(t[1])[1];s[1]=r[1]+o}else qe(t[1])?s[1]=t[1](r[1]):s[1]=r[1];return s},lf=function(t,r,a){if(t&&t.scale&&t.scale.bandwidth){var s=t.scale.bandwidth();if(!a||s>0)return s}if(t&&r&&r.length>=2){for(var i=bb(r,function(f){return f.coordinate}),o=1/0,l=1,c=i.length;l<c;l++){var d=i[l],u=i[l-1];o=Math.min((d.coordinate||0)-(u.coordinate||0),o)}return o===1/0?0:o}return a?void 0:0},r4=function(t,r,a){return!t||!t.length||Lo(t,Oa(a,"type.defaultProps.domain"))?r:t},bA=function(t,r){var a=t.type.defaultProps?or(or({},t.type.defaultProps),t.props):t.props,s=a.dataKey,i=a.name,o=a.unit,l=a.formatter,c=a.tooltipType,d=a.chartType,u=a.hide;return or(or({},Re(t,!1)),{},{dataKey:s,unit:o,formatter:l,name:i||s,color:Vb(t),value:Tr(r,s),type:c,payload:r,chartType:d,hide:u})};function Gc(e){"@babel/helpers - typeof";return Gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gc(e)}function a4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function qn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a4(Object(r),!0).forEach(function(a){jA(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a4(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function jA(e,t,r){return t=uee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uee(e){var t=fee(e,"string");return Gc(t)=="symbol"?t:t+""}function fee(e,t){if(Gc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Gc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hee(e,t){return gee(e)||pee(e,t)||xee(e,t)||mee()}function mee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xee(e,t){if(e){if(typeof e=="string")return n4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n4(e,t)}}function n4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function pee(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function gee(e){if(Array.isArray(e))return e}var cf=Math.PI/180,yee=function(t){return t*180/Math.PI},Bt=function(t,r,a,s){return{x:t+Math.cos(-cf*s)*a,y:r+Math.sin(-cf*s)*a}},wA=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(a.left||0)-(a.right||0)),Math.abs(r-(a.top||0)-(a.bottom||0)))/2},vee=function(t,r,a,s,i){var o=t.width,l=t.height,c=t.startAngle,d=t.endAngle,u=da(t.cx,o,o/2),f=da(t.cy,l,l/2),x=wA(o,l,a),p=da(t.innerRadius,x,0),h=da(t.outerRadius,x,x*.8),m=Object.keys(r);return m.reduce(function(g,v){var b=r[v],y=b.domain,N=b.reversed,j;if(Je(b.range))s==="angleAxis"?j=[c,d]:s==="radiusAxis"&&(j=[p,h]),N&&(j=[j[1],j[0]]);else{j=b.range;var w=j,_=hee(w,2);c=_[0],d=_[1]}var S=pA(b,i),k=S.realScaleType,E=S.scale;E.domain(y).range(j),gA(E);var A=yA(E,qn(qn({},b),{},{realScaleType:k})),P=qn(qn(qn({},b),A),{},{range:j,radius:h,realScaleType:k,scale:E,cx:u,cy:f,innerRadius:p,outerRadius:h,startAngle:c,endAngle:d});return qn(qn({},g),{},jA({},v,P))},{})},bee=function(t,r){var a=t.x,s=t.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(a-i,2)+Math.pow(s-o,2))},jee=function(t,r){var a=t.x,s=t.y,i=r.cx,o=r.cy,l=bee({x:a,y:s},{x:i,y:o});if(l<=0)return{radius:l};var c=(a-i)/l,d=Math.acos(c);return s>o&&(d=2*Math.PI-d),{radius:l,angle:yee(d),angleInRadian:d}},wee=function(t){var r=t.startAngle,a=t.endAngle,s=Math.floor(r/360),i=Math.floor(a/360),o=Math.min(s,i);return{startAngle:r-o*360,endAngle:a-o*360}},Nee=function(t,r){var a=r.startAngle,s=r.endAngle,i=Math.floor(a/360),o=Math.floor(s/360),l=Math.min(i,o);return t+l*360},s4=function(t,r){var a=t.x,s=t.y,i=jee({x:a,y:s},r),o=i.radius,l=i.angle,c=r.innerRadius,d=r.outerRadius;if(o<c||o>d)return!1;if(o===0)return!0;var u=wee(r),f=u.startAngle,x=u.endAngle,p=l,h;if(f<=x){for(;p>x;)p-=360;for(;p<f;)p+=360;h=p>=f&&p<=x}else{for(;p>f;)p-=360;for(;p<x;)p+=360;h=p>=x&&p<=f}return h?qn(qn({},r),{},{radius:o,angle:Nee(p,r)}):null},NA=function(t){return!C.isValidElement(t)&&!qe(t)&&typeof t!="boolean"?t.className:""};function Kc(e){"@babel/helpers - typeof";return Kc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kc(e)}var _ee=["offset"];function See(e){return Aee(e)||Tee(e)||Eee(e)||kee()}function kee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eee(e,t){if(e){if(typeof e=="string")return yy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yy(e,t)}}function Tee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Aee(e){if(Array.isArray(e))return yy(e)}function yy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Cee(e,t){if(e==null)return{};var r=Pee(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function Pee(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function i4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function kr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i4(Object(r),!0).forEach(function(a){Oee(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i4(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Oee(e,t,r){return t=Iee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Iee(e){var t=Fee(e,"string");return Kc(t)=="symbol"?t:t+""}function Fee(e,t){if(Kc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Kc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xc(){return Xc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Xc.apply(this,arguments)}var Dee=function(t){var r=t.value,a=t.formatter,s=Je(t.children)?r:t.children;return qe(a)?a(s):s},Ree=function(t,r){var a=ca(r-t),s=Math.min(Math.abs(r-t),360);return a*s},Mee=function(t,r,a){var s=t.position,i=t.viewBox,o=t.offset,l=t.className,c=i,d=c.cx,u=c.cy,f=c.innerRadius,x=c.outerRadius,p=c.startAngle,h=c.endAngle,m=c.clockWise,g=(f+x)/2,v=Ree(p,h),b=v>=0?1:-1,y,N;s==="insideStart"?(y=p+b*o,N=m):s==="insideEnd"?(y=h-b*o,N=!m):s==="end"&&(y=h+b*o,N=m),N=v<=0?N:!N;var j=Bt(d,u,g,y),w=Bt(d,u,g,y+(N?1:-1)*359),_="M".concat(j.x,",").concat(j.y,`
    A`).concat(g,",").concat(g,",0,1,").concat(N?0:1,`,
    `).concat(w.x,",").concat(w.y),S=Je(t.id)?xl("recharts-radial-line-"):t.id;return ee.createElement("text",Xc({},a,{dominantBaseline:"central",className:tt("recharts-radial-bar-label",l)}),ee.createElement("defs",null,ee.createElement("path",{id:S,d:_})),ee.createElement("textPath",{xlinkHref:"#".concat(S)},r))},Lee=function(t){var r=t.viewBox,a=t.offset,s=t.position,i=r,o=i.cx,l=i.cy,c=i.innerRadius,d=i.outerRadius,u=i.startAngle,f=i.endAngle,x=(u+f)/2;if(s==="outside"){var p=Bt(o,l,d+a,x),h=p.x,m=p.y;return{x:h,y:m,textAnchor:h>=o?"start":"end",verticalAnchor:"middle"}}if(s==="center")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(s==="centerTop")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"start"};if(s==="centerBottom")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"end"};var g=(c+d)/2,v=Bt(o,l,g,x),b=v.x,y=v.y;return{x:b,y,textAnchor:"middle",verticalAnchor:"middle"}},$ee=function(t){var r=t.viewBox,a=t.parentViewBox,s=t.offset,i=t.position,o=r,l=o.x,c=o.y,d=o.width,u=o.height,f=u>=0?1:-1,x=f*s,p=f>0?"end":"start",h=f>0?"start":"end",m=d>=0?1:-1,g=m*s,v=m>0?"end":"start",b=m>0?"start":"end";if(i==="top"){var y={x:l+d/2,y:c-f*s,textAnchor:"middle",verticalAnchor:p};return kr(kr({},y),a?{height:Math.max(c-a.y,0),width:d}:{})}if(i==="bottom"){var N={x:l+d/2,y:c+u+x,textAnchor:"middle",verticalAnchor:h};return kr(kr({},N),a?{height:Math.max(a.y+a.height-(c+u),0),width:d}:{})}if(i==="left"){var j={x:l-g,y:c+u/2,textAnchor:v,verticalAnchor:"middle"};return kr(kr({},j),a?{width:Math.max(j.x-a.x,0),height:u}:{})}if(i==="right"){var w={x:l+d+g,y:c+u/2,textAnchor:b,verticalAnchor:"middle"};return kr(kr({},w),a?{width:Math.max(a.x+a.width-w.x,0),height:u}:{})}var _=a?{width:d,height:u}:{};return i==="insideLeft"?kr({x:l+g,y:c+u/2,textAnchor:b,verticalAnchor:"middle"},_):i==="insideRight"?kr({x:l+d-g,y:c+u/2,textAnchor:v,verticalAnchor:"middle"},_):i==="insideTop"?kr({x:l+d/2,y:c+x,textAnchor:"middle",verticalAnchor:h},_):i==="insideBottom"?kr({x:l+d/2,y:c+u-x,textAnchor:"middle",verticalAnchor:p},_):i==="insideTopLeft"?kr({x:l+g,y:c+x,textAnchor:b,verticalAnchor:h},_):i==="insideTopRight"?kr({x:l+d-g,y:c+x,textAnchor:v,verticalAnchor:h},_):i==="insideBottomLeft"?kr({x:l+g,y:c+u-x,textAnchor:b,verticalAnchor:p},_):i==="insideBottomRight"?kr({x:l+d-g,y:c+u-x,textAnchor:v,verticalAnchor:p},_):hl(i)&&(be(i.x)||ni(i.x))&&(be(i.y)||ni(i.y))?kr({x:l+da(i.x,d),y:c+da(i.y,u),textAnchor:"end",verticalAnchor:"end"},_):kr({x:l+d/2,y:c+u/2,textAnchor:"middle",verticalAnchor:"middle"},_)},Bee=function(t){return"cx"in t&&be(t.cx)};function Dr(e){var t=e.offset,r=t===void 0?5:t,a=Cee(e,_ee),s=kr({offset:r},a),i=s.viewBox,o=s.position,l=s.value,c=s.children,d=s.content,u=s.className,f=u===void 0?"":u,x=s.textBreakAll;if(!i||Je(l)&&Je(c)&&!C.isValidElement(d)&&!qe(d))return null;if(C.isValidElement(d))return C.cloneElement(d,s);var p;if(qe(d)){if(p=C.createElement(d,s),C.isValidElement(p))return p}else p=Dee(s);var h=Bee(i),m=Re(s,!0);if(h&&(o==="insideStart"||o==="insideEnd"||o==="end"))return Mee(s,p,m);var g=h?Lee(s):$ee(s);return ee.createElement(Ai,Xc({className:tt("recharts-label",f)},m,g,{breakAll:x}),p)}Dr.displayName="Label";var _A=function(t){var r=t.cx,a=t.cy,s=t.angle,i=t.startAngle,o=t.endAngle,l=t.r,c=t.radius,d=t.innerRadius,u=t.outerRadius,f=t.x,x=t.y,p=t.top,h=t.left,m=t.width,g=t.height,v=t.clockWise,b=t.labelViewBox;if(b)return b;if(be(m)&&be(g)){if(be(f)&&be(x))return{x:f,y:x,width:m,height:g};if(be(p)&&be(h))return{x:p,y:h,width:m,height:g}}return be(f)&&be(x)?{x:f,y:x,width:0,height:0}:be(r)&&be(a)?{cx:r,cy:a,startAngle:i||s||0,endAngle:o||s||0,innerRadius:d||0,outerRadius:u||c||l||0,clockWise:v}:t.viewBox?t.viewBox:{}},Uee=function(t,r){return t?t===!0?ee.createElement(Dr,{key:"label-implicit",viewBox:r}):Ar(t)?ee.createElement(Dr,{key:"label-implicit",viewBox:r,value:t}):C.isValidElement(t)?t.type===Dr?C.cloneElement(t,{key:"label-implicit",viewBox:r}):ee.createElement(Dr,{key:"label-implicit",content:t,viewBox:r}):qe(t)?ee.createElement(Dr,{key:"label-implicit",content:t,viewBox:r}):hl(t)?ee.createElement(Dr,Xc({viewBox:r},t,{key:"label-implicit"})):null:null},qee=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&a&&!t.label)return null;var s=t.children,i=_A(t),o=Qa(s,Dr).map(function(c,d){return C.cloneElement(c,{viewBox:r||i,key:"label-".concat(d)})});if(!a)return o;var l=Uee(t.label,r||i);return[l].concat(See(o))};Dr.parseViewBox=_A;Dr.renderCallByParent=qee;var Ip,o4;function Wee(){if(o4)return Ip;o4=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return Ip=e,Ip}var Hee=Wee();const zee=Ct(Hee);function Yc(e){"@babel/helpers - typeof";return Yc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yc(e)}var Vee=["valueAccessor"],Gee=["data","dataKey","clockWise","id","textBreakAll"];function Kee(e){return Qee(e)||Jee(e)||Yee(e)||Xee()}function Xee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yee(e,t){if(e){if(typeof e=="string")return vy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vy(e,t)}}function Jee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qee(e){if(Array.isArray(e))return vy(e)}function vy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function df(){return df=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},df.apply(this,arguments)}function l4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function c4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l4(Object(r),!0).forEach(function(a){Zee(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l4(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Zee(e,t,r){return t=ete(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ete(e){var t=tte(e,"string");return Yc(t)=="symbol"?t:t+""}function tte(e,t){if(Yc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Yc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function d4(e,t){if(e==null)return{};var r=rte(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function rte(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}var ate=function(t){return Array.isArray(t.value)?zee(t.value):t.value};function rs(e){var t=e.valueAccessor,r=t===void 0?ate:t,a=d4(e,Vee),s=a.data,i=a.dataKey,o=a.clockWise,l=a.id,c=a.textBreakAll,d=d4(a,Gee);return!s||!s.length?null:ee.createElement(ht,{className:"recharts-label-list"},s.map(function(u,f){var x=Je(i)?r(u,f):Tr(u&&u.payload,i),p=Je(l)?{}:{id:"".concat(l,"-").concat(f)};return ee.createElement(Dr,df({},Re(u,!0),d,p,{parentViewBox:u.parentViewBox,value:x,textBreakAll:c,viewBox:Dr.parseViewBox(Je(o)?u:c4(c4({},u),{},{clockWise:o})),key:"label-".concat(f),index:f}))}))}rs.displayName="LabelList";function nte(e,t){return e?e===!0?ee.createElement(rs,{key:"labelList-implicit",data:t}):ee.isValidElement(e)||qe(e)?ee.createElement(rs,{key:"labelList-implicit",data:t,content:e}):hl(e)?ee.createElement(rs,df({data:t},e,{key:"labelList-implicit"})):null:null}function ste(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var a=e.children,s=Qa(a,rs).map(function(o,l){return C.cloneElement(o,{data:t,key:"labelList-".concat(l)})});if(!r)return s;var i=nte(e.label,t);return[i].concat(Kee(s))}rs.renderCallByParent=ste;function Jc(e){"@babel/helpers - typeof";return Jc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jc(e)}function by(){return by=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},by.apply(this,arguments)}function u4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function f4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u4(Object(r),!0).forEach(function(a){ite(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u4(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function ite(e,t,r){return t=ote(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ote(e){var t=lte(e,"string");return Jc(t)=="symbol"?t:t+""}function lte(e,t){if(Jc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Jc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cte=function(t,r){var a=ca(r-t),s=Math.min(Math.abs(r-t),359.999);return a*s},au=function(t){var r=t.cx,a=t.cy,s=t.radius,i=t.angle,o=t.sign,l=t.isExternal,c=t.cornerRadius,d=t.cornerIsExternal,u=c*(l?1:-1)+s,f=Math.asin(c/u)/cf,x=d?i:i+o*f,p=Bt(r,a,u,x),h=Bt(r,a,s,x),m=d?i-o*f:i,g=Bt(r,a,u*Math.cos(f*cf),m);return{center:p,circleTangency:h,lineTangency:g,theta:f}},SA=function(t){var r=t.cx,a=t.cy,s=t.innerRadius,i=t.outerRadius,o=t.startAngle,l=t.endAngle,c=cte(o,l),d=o+c,u=Bt(r,a,i,o),f=Bt(r,a,i,d),x="M ".concat(u.x,",").concat(u.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(o>d),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(s>0){var p=Bt(r,a,s,o),h=Bt(r,a,s,d);x+="L ".concat(h.x,",").concat(h.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(o<=d),`,
            `).concat(p.x,",").concat(p.y," Z")}else x+="L ".concat(r,",").concat(a," Z");return x},dte=function(t){var r=t.cx,a=t.cy,s=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,d=t.startAngle,u=t.endAngle,f=ca(u-d),x=au({cx:r,cy:a,radius:i,angle:d,sign:f,cornerRadius:o,cornerIsExternal:c}),p=x.circleTangency,h=x.lineTangency,m=x.theta,g=au({cx:r,cy:a,radius:i,angle:u,sign:-f,cornerRadius:o,cornerIsExternal:c}),v=g.circleTangency,b=g.lineTangency,y=g.theta,N=c?Math.abs(d-u):Math.abs(d-u)-m-y;if(N<0)return l?"M ".concat(h.x,",").concat(h.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):SA({cx:r,cy:a,innerRadius:s,outerRadius:i,startAngle:d,endAngle:u});var j="M ".concat(h.x,",").concat(h.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(N>180),",").concat(+(f<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(b.x,",").concat(b.y,`
  `);if(s>0){var w=au({cx:r,cy:a,radius:s,angle:d,sign:f,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),_=w.circleTangency,S=w.lineTangency,k=w.theta,E=au({cx:r,cy:a,radius:s,angle:u,sign:-f,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),A=E.circleTangency,P=E.lineTangency,L=E.theta,R=c?Math.abs(d-u):Math.abs(d-u)-k-L;if(R<0&&o===0)return"".concat(j,"L").concat(r,",").concat(a,"Z");j+="L".concat(P.x,",").concat(P.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(A.x,",").concat(A.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(R>180),",").concat(+(f>0),",").concat(_.x,",").concat(_.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(S.x,",").concat(S.y,"Z")}else j+="L".concat(r,",").concat(a,"Z");return j},ute={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},kA=function(t){var r=f4(f4({},ute),t),a=r.cx,s=r.cy,i=r.innerRadius,o=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,d=r.cornerIsExternal,u=r.startAngle,f=r.endAngle,x=r.className;if(o<i||u===f)return null;var p=tt("recharts-sector",x),h=o-i,m=da(l,h,0,!0),g;return m>0&&Math.abs(u-f)<360?g=dte({cx:a,cy:s,innerRadius:i,outerRadius:o,cornerRadius:Math.min(m,h/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:f}):g=SA({cx:a,cy:s,innerRadius:i,outerRadius:o,startAngle:u,endAngle:f}),ee.createElement("path",by({},Re(r,!0),{className:p,d:g,role:"img"}))};function Qc(e){"@babel/helpers - typeof";return Qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qc(e)}function jy(){return jy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},jy.apply(this,arguments)}function h4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function m4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h4(Object(r),!0).forEach(function(a){fte(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h4(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function fte(e,t,r){return t=hte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hte(e){var t=mte(e,"string");return Qc(t)=="symbol"?t:t+""}function mte(e,t){if(Qc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Qc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x4={curveBasisClosed:FV,curveBasisOpen:DV,curveBasis:IV,curveBumpX:vV,curveBumpY:bV,curveLinearClosed:RV,curveLinear:i0,curveMonotoneX:MV,curveMonotoneY:LV,curveNatural:$V,curveStep:BV,curveStepAfter:qV,curveStepBefore:UV},nu=function(t){return t.x===+t.x&&t.y===+t.y},Rl=function(t){return t.x},Ml=function(t){return t.y},xte=function(t,r){if(qe(t))return t;var a="curve".concat(n0(t));return(a==="curveMonotone"||a==="curveBump")&&r?x4["".concat(a).concat(r==="vertical"?"Y":"X")]:x4[a]||i0},pte=function(t){var r=t.type,a=r===void 0?"linear":r,s=t.points,i=s===void 0?[]:s,o=t.baseLine,l=t.layout,c=t.connectNulls,d=c===void 0?!1:c,u=xte(a,l),f=d?i.filter(function(m){return nu(m)}):i,x;if(Array.isArray(o)){var p=d?o.filter(function(m){return nu(m)}):o,h=f.map(function(m,g){return m4(m4({},m),{},{base:p[g]})});return l==="vertical"?x=Xd().y(Ml).x1(Rl).x0(function(m){return m.base.x}):x=Xd().x(Rl).y1(Ml).y0(function(m){return m.base.y}),x.defined(nu).curve(u),x(h)}return l==="vertical"&&be(o)?x=Xd().y(Ml).x1(Rl).x0(o):be(o)?x=Xd().x(Rl).y1(Ml).y0(o):x=_6().x(Rl).y(Ml),x.defined(nu).curve(u),x(f)},bo=function(t){var r=t.className,a=t.points,s=t.path,i=t.pathRef;if((!a||!a.length)&&!s)return null;var o=a&&a.length?pte(t):s;return C.createElement("path",jy({},Re(t,!1),Mu(t),{className:tt("recharts-curve",r),d:o,ref:i}))},Fp={exports:{}},Dp,p4;function gte(){if(p4)return Dp;p4=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Dp=e,Dp}var Rp,g4;function yte(){if(g4)return Rp;g4=1;var e=gte();function t(){}function r(){}return r.resetWarningCache=t,Rp=function(){function a(o,l,c,d,u,f){if(f!==e){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}a.isRequired=a;function s(){return a}var i={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:s,element:a,elementType:a,instanceOf:s,node:a,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:r,resetWarningCache:t};return i.PropTypes=i,i},Rp}var y4;function vte(){return y4||(y4=1,Fp.exports=yte()()),Fp.exports}var bte=vte();const St=Ct(bte);var jte=Object.getOwnPropertyNames,wte=Object.getOwnPropertySymbols,Nte=Object.prototype.hasOwnProperty;function v4(e,t){return function(a,s,i){return e(a,s,i)&&t(a,s,i)}}function su(e){return function(r,a,s){if(!r||!a||typeof r!="object"||typeof a!="object")return e(r,a,s);var i=s.cache,o=i.get(r),l=i.get(a);if(o&&l)return o===a&&l===r;i.set(r,a),i.set(a,r);var c=e(r,a,s);return i.delete(r),i.delete(a),c}}function b4(e){return jte(e).concat(wte(e))}var _te=Object.hasOwn||(function(e,t){return Nte.call(e,t)});function Hi(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var Ste="__v",kte="__o",Ete="_owner",j4=Object.getOwnPropertyDescriptor,w4=Object.keys;function Tte(e,t,r){var a=e.length;if(t.length!==a)return!1;for(;a-- >0;)if(!r.equals(e[a],t[a],a,a,e,t,r))return!1;return!0}function Ate(e,t){return Hi(e.getTime(),t.getTime())}function Cte(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Pte(e,t){return e===t}function N4(e,t,r){var a=e.size;if(a!==t.size)return!1;if(!a)return!0;for(var s=new Array(a),i=e.entries(),o,l,c=0;(o=i.next())&&!o.done;){for(var d=t.entries(),u=!1,f=0;(l=d.next())&&!l.done;){if(s[f]){f++;continue}var x=o.value,p=l.value;if(r.equals(x[0],p[0],c,f,e,t,r)&&r.equals(x[1],p[1],x[0],p[0],e,t,r)){u=s[f]=!0;break}f++}if(!u)return!1;c++}return!0}var Ote=Hi;function Ite(e,t,r){var a=w4(e),s=a.length;if(w4(t).length!==s)return!1;for(;s-- >0;)if(!EA(e,t,r,a[s]))return!1;return!0}function Ll(e,t,r){var a=b4(e),s=a.length;if(b4(t).length!==s)return!1;for(var i,o,l;s-- >0;)if(i=a[s],!EA(e,t,r,i)||(o=j4(e,i),l=j4(t,i),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function Fte(e,t){return Hi(e.valueOf(),t.valueOf())}function Dte(e,t){return e.source===t.source&&e.flags===t.flags}function _4(e,t,r){var a=e.size;if(a!==t.size)return!1;if(!a)return!0;for(var s=new Array(a),i=e.values(),o,l;(o=i.next())&&!o.done;){for(var c=t.values(),d=!1,u=0;(l=c.next())&&!l.done;){if(!s[u]&&r.equals(o.value,l.value,o.value,l.value,e,t,r)){d=s[u]=!0;break}u++}if(!d)return!1}return!0}function Rte(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function Mte(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function EA(e,t,r,a){return(a===Ete||a===kte||a===Ste)&&(e.$$typeof||t.$$typeof)?!0:_te(t,a)&&r.equals(e[a],t[a],a,a,e,t,r)}var Lte="[object Arguments]",$te="[object Boolean]",Bte="[object Date]",Ute="[object Error]",qte="[object Map]",Wte="[object Number]",Hte="[object Object]",zte="[object RegExp]",Vte="[object Set]",Gte="[object String]",Kte="[object URL]",Xte=Array.isArray,S4=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,k4=Object.assign,Yte=Object.prototype.toString.call.bind(Object.prototype.toString);function Jte(e){var t=e.areArraysEqual,r=e.areDatesEqual,a=e.areErrorsEqual,s=e.areFunctionsEqual,i=e.areMapsEqual,o=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,u=e.areSetsEqual,f=e.areTypedArraysEqual,x=e.areUrlsEqual;return function(h,m,g){if(h===m)return!0;if(h==null||m==null)return!1;var v=typeof h;if(v!==typeof m)return!1;if(v!=="object")return v==="number"?o(h,m,g):v==="function"?s(h,m,g):!1;var b=h.constructor;if(b!==m.constructor)return!1;if(b===Object)return l(h,m,g);if(Xte(h))return t(h,m,g);if(S4!=null&&S4(h))return f(h,m,g);if(b===Date)return r(h,m,g);if(b===RegExp)return d(h,m,g);if(b===Map)return i(h,m,g);if(b===Set)return u(h,m,g);var y=Yte(h);return y===Bte?r(h,m,g):y===zte?d(h,m,g):y===qte?i(h,m,g):y===Vte?u(h,m,g):y===Hte?typeof h.then!="function"&&typeof m.then!="function"&&l(h,m,g):y===Kte?x(h,m,g):y===Ute?a(h,m,g):y===Lte?l(h,m,g):y===$te||y===Wte||y===Gte?c(h,m,g):!1}}function Qte(e){var t=e.circular,r=e.createCustomConfig,a=e.strict,s={areArraysEqual:a?Ll:Tte,areDatesEqual:Ate,areErrorsEqual:Cte,areFunctionsEqual:Pte,areMapsEqual:a?v4(N4,Ll):N4,areNumbersEqual:Ote,areObjectsEqual:a?Ll:Ite,arePrimitiveWrappersEqual:Fte,areRegExpsEqual:Dte,areSetsEqual:a?v4(_4,Ll):_4,areTypedArraysEqual:a?Ll:Rte,areUrlsEqual:Mte};if(r&&(s=k4({},s,r(s))),t){var i=su(s.areArraysEqual),o=su(s.areMapsEqual),l=su(s.areObjectsEqual),c=su(s.areSetsEqual);s=k4({},s,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:c})}return s}function Zte(e){return function(t,r,a,s,i,o,l){return e(t,r,l)}}function ere(e){var t=e.circular,r=e.comparator,a=e.createState,s=e.equals,i=e.strict;if(a)return function(c,d){var u=a(),f=u.cache,x=f===void 0?t?new WeakMap:void 0:f,p=u.meta;return r(c,d,{cache:x,equals:s,meta:p,strict:i})};if(t)return function(c,d){return r(c,d,{cache:new WeakMap,equals:s,meta:void 0,strict:i})};var o={cache:void 0,equals:s,meta:void 0,strict:i};return function(c,d){return r(c,d,o)}}var tre=Hs();Hs({strict:!0});Hs({circular:!0});Hs({circular:!0,strict:!0});Hs({createInternalComparator:function(){return Hi}});Hs({strict:!0,createInternalComparator:function(){return Hi}});Hs({circular:!0,createInternalComparator:function(){return Hi}});Hs({circular:!0,createInternalComparator:function(){return Hi},strict:!0});function Hs(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,a=e.createInternalComparator,s=e.createState,i=e.strict,o=i===void 0?!1:i,l=Qte(e),c=Jte(l),d=a?a(c):Zte(c);return ere({circular:r,comparator:c,createState:s,equals:d,strict:o})}function rre(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function E4(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,a=function s(i){r<0&&(r=i),i-r>t?(e(i),r=-1):rre(s)};requestAnimationFrame(a)}function wy(e){"@babel/helpers - typeof";return wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wy(e)}function are(e){return ore(e)||ire(e)||sre(e)||nre()}function nre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sre(e,t){if(e){if(typeof e=="string")return T4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T4(e,t)}}function T4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function ire(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ore(e){if(Array.isArray(e))return e}function lre(){var e={},t=function(){return null},r=!1,a=function s(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,l=are(o),c=l[0],d=l.slice(1);if(typeof c=="number"){E4(s.bind(null,d),c);return}s(c),E4(s.bind(null,d));return}wy(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,a(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function Zc(e){"@babel/helpers - typeof";return Zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zc(e)}function A4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function C4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A4(Object(r),!0).forEach(function(a){TA(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A4(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function TA(e,t,r){return t=cre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cre(e){var t=dre(e,"string");return Zc(t)==="symbol"?t:String(t)}function dre(e,t){if(Zc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Zc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ure=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(a,s){return a.filter(function(i){return s.includes(i)})})},fre=function(t){return t},hre=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},cc=function(t,r){return Object.keys(r).reduce(function(a,s){return C4(C4({},a),{},TA({},s,t(s,r[s])))},{})},P4=function(t,r,a){return t.map(function(s){return"".concat(hre(s)," ").concat(r,"ms ").concat(a)}).join(",")};function mre(e,t){return gre(e)||pre(e,t)||AA(e,t)||xre()}function xre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pre(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function gre(e){if(Array.isArray(e))return e}function yre(e){return jre(e)||bre(e)||AA(e)||vre()}function vre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AA(e,t){if(e){if(typeof e=="string")return Ny(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ny(e,t)}}function bre(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jre(e){if(Array.isArray(e))return Ny(e)}function Ny(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var uf=1e-4,CA=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},PA=function(t,r){return t.map(function(a,s){return a*Math.pow(r,s)}).reduce(function(a,s){return a+s})},O4=function(t,r){return function(a){var s=CA(t,r);return PA(s,a)}},wre=function(t,r){return function(a){var s=CA(t,r),i=[].concat(yre(s.map(function(o,l){return o*l}).slice(1)),[0]);return PA(i,a)}},I4=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var s=r[0],i=r[1],o=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":s=0,i=0,o=1,l=1;break;case"ease":s=.25,i=.1,o=.25,l=1;break;case"ease-in":s=.42,i=0,o=1,l=1;break;case"ease-out":s=.42,i=0,o=.58,l=1;break;case"ease-in-out":s=0,i=0,o=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var d=c[1].split(")")[0].split(",").map(function(g){return parseFloat(g)}),u=mre(d,4);s=u[0],i=u[1],o=u[2],l=u[3]}}}var f=O4(s,o),x=O4(i,l),p=wre(s,o),h=function(v){return v>1?1:v<0?0:v},m=function(v){for(var b=v>1?1:v,y=b,N=0;N<8;++N){var j=f(y)-b,w=p(y);if(Math.abs(j-b)<uf||w<uf)return x(y);y=h(y-j/w)}return x(y)};return m.isStepper=!1,m},Nre=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,a=r===void 0?100:r,s=t.damping,i=s===void 0?8:s,o=t.dt,l=o===void 0?17:o,c=function(u,f,x){var p=-(u-f)*a,h=x*i,m=x+(p-h)*l/1e3,g=x*l/1e3+u;return Math.abs(g-f)<uf&&Math.abs(m)<uf?[f,0]:[g,m]};return c.isStepper=!0,c.dt=l,c},_re=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var s=r[0];if(typeof s=="string")switch(s){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return I4(s);case"spring":return Nre();default:if(s.split("(")[0]==="cubic-bezier")return I4(s)}return typeof s=="function"?s:null};function ed(e){"@babel/helpers - typeof";return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ed(e)}function F4(e){return Ere(e)||kre(e)||OA(e)||Sre()}function Sre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kre(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ere(e){if(Array.isArray(e))return Sy(e)}function D4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Ur(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D4(Object(r),!0).forEach(function(a){_y(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D4(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function _y(e,t,r){return t=Tre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tre(e){var t=Are(e,"string");return ed(t)==="symbol"?t:String(t)}function Are(e,t){if(ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(ed(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cre(e,t){return Ire(e)||Ore(e,t)||OA(e,t)||Pre()}function Pre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OA(e,t){if(e){if(typeof e=="string")return Sy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sy(e,t)}}function Sy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Ore(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function Ire(e){if(Array.isArray(e))return e}var ff=function(t,r,a){return t+(r-t)*a},ky=function(t){var r=t.from,a=t.to;return r!==a},Fre=function e(t,r,a){var s=cc(function(i,o){if(ky(o)){var l=t(o.from,o.to,o.velocity),c=Cre(l,2),d=c[0],u=c[1];return Ur(Ur({},o),{},{from:d,velocity:u})}return o},r);return a<1?cc(function(i,o){return ky(o)?Ur(Ur({},o),{},{velocity:ff(o.velocity,s[i].velocity,a),from:ff(o.from,s[i].from,a)}):o},r):e(t,s,a-1)};const Dre=(function(e,t,r,a,s){var i=ure(e,t),o=i.reduce(function(g,v){return Ur(Ur({},g),{},_y({},v,[e[v],t[v]]))},{}),l=i.reduce(function(g,v){return Ur(Ur({},g),{},_y({},v,{from:e[v],velocity:0,to:t[v]}))},{}),c=-1,d,u,f=function(){return null},x=function(){return cc(function(v,b){return b.from},l)},p=function(){return!Object.values(l).filter(ky).length},h=function(v){d||(d=v);var b=v-d,y=b/r.dt;l=Fre(r,l,y),s(Ur(Ur(Ur({},e),t),x())),d=v,p()||(c=requestAnimationFrame(f))},m=function(v){u||(u=v);var b=(v-u)/a,y=cc(function(j,w){return ff.apply(void 0,F4(w).concat([r(b)]))},o);if(s(Ur(Ur(Ur({},e),t),y)),b<1)c=requestAnimationFrame(f);else{var N=cc(function(j,w){return ff.apply(void 0,F4(w).concat([r(1)]))},o);s(Ur(Ur(Ur({},e),t),N))}};return f=r.isStepper?h:m,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(c)}}});function Bo(e){"@babel/helpers - typeof";return Bo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bo(e)}var Rre=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Mre(e,t){if(e==null)return{};var r=Lre(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function Lre(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function Mp(e){return qre(e)||Ure(e)||Bre(e)||$re()}function $re(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bre(e,t){if(e){if(typeof e=="string")return Ey(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ey(e,t)}}function Ure(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qre(e){if(Array.isArray(e))return Ey(e)}function Ey(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function R4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ln(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R4(Object(r),!0).forEach(function(a){Vl(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R4(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Vl(e,t,r){return t=IA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hre(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,IA(a.key),a)}}function zre(e,t,r){return t&&Hre(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function IA(e){var t=Vre(e,"string");return Bo(t)==="symbol"?t:String(t)}function Vre(e,t){if(Bo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Bo(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ty(e,t)}function Ty(e,t){return Ty=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Ty(e,t)}function Kre(e){var t=Xre();return function(){var a=hf(e),s;if(t){var i=hf(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return Ay(this,s)}}function Ay(e,t){if(t&&(Bo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cy(e)}function Cy(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xre(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hf(e){return hf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hf(e)}var In=(function(e){Gre(r,e);var t=Kre(r);function r(a,s){var i;Wre(this,r),i=t.call(this,a,s);var o=i.props,l=o.isActive,c=o.attributeName,d=o.from,u=o.to,f=o.steps,x=o.children,p=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(Cy(i)),i.changeStyle=i.changeStyle.bind(Cy(i)),!l||p<=0)return i.state={style:{}},typeof x=="function"&&(i.state={style:u}),Ay(i);if(f&&f.length)i.state={style:f[0].style};else if(d){if(typeof x=="function")return i.state={style:d},Ay(i);i.state={style:c?Vl({},c,d):d}}else i.state={style:{}};return i}return zre(r,[{key:"componentDidMount",value:function(){var s=this.props,i=s.isActive,o=s.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(s){var i=this.props,o=i.isActive,l=i.canBegin,c=i.attributeName,d=i.shouldReAnimate,u=i.to,f=i.from,x=this.state.style;if(l){if(!o){var p={style:c?Vl({},c,u):u};this.state&&x&&(c&&x[c]!==u||!c&&x!==u)&&this.setState(p);return}if(!(tre(s.to,u)&&s.canBegin&&s.isActive)){var h=!s.canBegin||!s.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var m=h||d?f:s.to;if(this.state&&x){var g={style:c?Vl({},c,m):m};(c&&x[c]!==m||!c&&x!==m)&&this.setState(g)}this.runAnimation(ln(ln({},this.props),{},{from:m,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var s=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),s&&s()}},{key:"handleStyleChange",value:function(s){this.changeStyle(s)}},{key:"changeStyle",value:function(s){this.mounted&&this.setState({style:s})}},{key:"runJSAnimation",value:function(s){var i=this,o=s.from,l=s.to,c=s.duration,d=s.easing,u=s.begin,f=s.onAnimationEnd,x=s.onAnimationStart,p=Dre(o,l,_re(d),c,this.changeStyle),h=function(){i.stopJSAnimation=p()};this.manager.start([x,u,h,c,f])}},{key:"runStepAnimation",value:function(s){var i=this,o=s.steps,l=s.begin,c=s.onAnimationStart,d=o[0],u=d.style,f=d.duration,x=f===void 0?0:f,p=function(m,g,v){if(v===0)return m;var b=g.duration,y=g.easing,N=y===void 0?"ease":y,j=g.style,w=g.properties,_=g.onAnimationEnd,S=v>0?o[v-1]:g,k=w||Object.keys(j);if(typeof N=="function"||N==="spring")return[].concat(Mp(m),[i.runJSAnimation.bind(i,{from:S.style,to:j,duration:b,easing:N}),b]);var E=P4(k,b,N),A=ln(ln(ln({},S.style),j),{},{transition:E});return[].concat(Mp(m),[A,b,_]).filter(fre)};return this.manager.start([c].concat(Mp(o.reduce(p,[u,Math.max(x,l)])),[s.onAnimationEnd]))}},{key:"runAnimation",value:function(s){this.manager||(this.manager=lre());var i=s.begin,o=s.duration,l=s.attributeName,c=s.to,d=s.easing,u=s.onAnimationStart,f=s.onAnimationEnd,x=s.steps,p=s.children,h=this.manager;if(this.unSubscribe=h.subscribe(this.handleStyleChange),typeof d=="function"||typeof p=="function"||d==="spring"){this.runJSAnimation(s);return}if(x.length>1){this.runStepAnimation(s);return}var m=l?Vl({},l,c):c,g=P4(Object.keys(m),o,d);h.start([u,i,ln(ln({},m),{},{transition:g}),o,f])}},{key:"render",value:function(){var s=this.props,i=s.children;s.begin;var o=s.duration;s.attributeName,s.easing;var l=s.isActive;s.steps,s.from,s.to,s.canBegin,s.onAnimationEnd,s.shouldReAnimate,s.onAnimationReStart;var c=Mre(s,Rre),d=C.Children.count(i),u=this.state.style;if(typeof i=="function")return i(u);if(!l||d===0||o<=0)return i;var f=function(p){var h=p.props,m=h.style,g=m===void 0?{}:m,v=h.className,b=C.cloneElement(p,ln(ln({},c),{},{style:ln(ln({},g),u),className:v}));return b};return d===1?f(C.Children.only(i)):ee.createElement("div",null,C.Children.map(i,function(x){return f(x)}))}}]),r})(C.PureComponent);In.displayName="Animate";In.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};In.propTypes={from:St.oneOfType([St.object,St.string]),to:St.oneOfType([St.object,St.string]),attributeName:St.string,duration:St.number,begin:St.number,easing:St.oneOfType([St.string,St.func]),steps:St.arrayOf(St.shape({duration:St.number.isRequired,style:St.object.isRequired,easing:St.oneOfType([St.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),St.func]),properties:St.arrayOf("string"),onAnimationEnd:St.func})),children:St.oneOfType([St.node,St.func]),isActive:St.bool,canBegin:St.bool,onAnimationEnd:St.func,shouldReAnimate:St.bool,onAnimationStart:St.func,onAnimationReStart:St.func};function td(e){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},td(e)}function mf(){return mf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},mf.apply(this,arguments)}function Yre(e,t){return eae(e)||Zre(e,t)||Qre(e,t)||Jre()}function Jre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qre(e,t){if(e){if(typeof e=="string")return M4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M4(e,t)}}function M4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Zre(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function eae(e){if(Array.isArray(e))return e}function L4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function $4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L4(Object(r),!0).forEach(function(a){tae(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L4(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function tae(e,t,r){return t=rae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rae(e){var t=aae(e,"string");return td(t)=="symbol"?t:t+""}function aae(e,t){if(td(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(td(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var B4=function(t,r,a,s,i){var o=Math.min(Math.abs(a)/2,Math.abs(s)/2),l=s>=0?1:-1,c=a>=0?1:-1,d=s>=0&&a>=0||s<0&&a<0?1:0,u;if(o>0&&i instanceof Array){for(var f=[0,0,0,0],x=0,p=4;x<p;x++)f[x]=i[x]>o?o:i[x];u="M".concat(t,",").concat(r+l*f[0]),f[0]>0&&(u+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(d,",").concat(t+c*f[0],",").concat(r)),u+="L ".concat(t+a-c*f[1],",").concat(r),f[1]>0&&(u+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(d,`,
        `).concat(t+a,",").concat(r+l*f[1])),u+="L ".concat(t+a,",").concat(r+s-l*f[2]),f[2]>0&&(u+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(d,`,
        `).concat(t+a-c*f[2],",").concat(r+s)),u+="L ".concat(t+c*f[3],",").concat(r+s),f[3]>0&&(u+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(r+s-l*f[3])),u+="Z"}else if(o>0&&i===+i&&i>0){var h=Math.min(o,i);u="M ".concat(t,",").concat(r+l*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(d,",").concat(t+c*h,",").concat(r,`
            L `).concat(t+a-c*h,",").concat(r,`
            A `).concat(h,",").concat(h,",0,0,").concat(d,",").concat(t+a,",").concat(r+l*h,`
            L `).concat(t+a,",").concat(r+s-l*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(d,",").concat(t+a-c*h,",").concat(r+s,`
            L `).concat(t+c*h,",").concat(r+s,`
            A `).concat(h,",").concat(h,",0,0,").concat(d,",").concat(t,",").concat(r+s-l*h," Z")}else u="M ".concat(t,",").concat(r," h ").concat(a," v ").concat(s," h ").concat(-a," Z");return u},nae=function(t,r){if(!t||!r)return!1;var a=t.x,s=t.y,i=r.x,o=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var d=Math.min(i,i+l),u=Math.max(i,i+l),f=Math.min(o,o+c),x=Math.max(o,o+c);return a>=d&&a<=u&&s>=f&&s<=x}return!1},sae={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Gb=function(t){var r=$4($4({},sae),t),a=C.useRef(),s=C.useState(-1),i=Yre(s,2),o=i[0],l=i[1];C.useEffect(function(){if(a.current&&a.current.getTotalLength)try{var N=a.current.getTotalLength();N&&l(N)}catch{}},[]);var c=r.x,d=r.y,u=r.width,f=r.height,x=r.radius,p=r.className,h=r.animationEasing,m=r.animationDuration,g=r.animationBegin,v=r.isAnimationActive,b=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||u===0||f===0)return null;var y=tt("recharts-rectangle",p);return b?ee.createElement(In,{canBegin:o>0,from:{width:u,height:f,x:c,y:d},to:{width:u,height:f,x:c,y:d},duration:m,animationEasing:h,isActive:b},function(N){var j=N.width,w=N.height,_=N.x,S=N.y;return ee.createElement(In,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:m,isActive:v,easing:h},ee.createElement("path",mf({},Re(r,!0),{className:y,d:B4(_,S,j,w,x),ref:a})))}):ee.createElement("path",mf({},Re(r,!0),{className:y,d:B4(c,d,u,f,x)}))},iae=["points","className","baseLinePoints","connectNulls"];function oo(){return oo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},oo.apply(this,arguments)}function oae(e,t){if(e==null)return{};var r=lae(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function lae(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function U4(e){return fae(e)||uae(e)||dae(e)||cae()}function cae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dae(e,t){if(e){if(typeof e=="string")return Py(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Py(e,t)}}function uae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fae(e){if(Array.isArray(e))return Py(e)}function Py(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var q4=function(t){return t&&t.x===+t.x&&t.y===+t.y},hae=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(a){q4(a)?r[r.length-1].push(a):r[r.length-1].length>0&&r.push([])}),q4(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},dc=function(t,r){var a=hae(t);r&&(a=[a.reduce(function(i,o){return[].concat(U4(i),U4(o))},[])]);var s=a.map(function(i){return i.reduce(function(o,l,c){return"".concat(o).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return a.length===1?"".concat(s,"Z"):s},mae=function(t,r,a){var s=dc(t,a);return"".concat(s.slice(-1)==="Z"?s.slice(0,-1):s,"L").concat(dc(r.reverse(),a).slice(1))},xae=function(t){var r=t.points,a=t.className,s=t.baseLinePoints,i=t.connectNulls,o=oae(t,iae);if(!r||!r.length)return null;var l=tt("recharts-polygon",a);if(s&&s.length){var c=o.stroke&&o.stroke!=="none",d=mae(r,s,i);return ee.createElement("g",{className:l},ee.createElement("path",oo({},Re(o,!0),{fill:d.slice(-1)==="Z"?o.fill:"none",stroke:"none",d})),c?ee.createElement("path",oo({},Re(o,!0),{fill:"none",d:dc(r,i)})):null,c?ee.createElement("path",oo({},Re(o,!0),{fill:"none",d:dc(s,i)})):null)}var u=dc(r,i);return ee.createElement("path",oo({},Re(o,!0),{fill:u.slice(-1)==="Z"?o.fill:"none",className:l,d:u}))};function Oy(){return Oy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Oy.apply(this,arguments)}var N0=function(t){var r=t.cx,a=t.cy,s=t.r,i=t.className,o=tt("recharts-dot",i);return r===+r&&a===+a&&s===+s?C.createElement("circle",Oy({},Re(t,!1),Mu(t),{className:o,cx:r,cy:a,r:s})):null};function rd(e){"@babel/helpers - typeof";return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rd(e)}var pae=["x","y","top","left","width","height","className"];function Iy(){return Iy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Iy.apply(this,arguments)}function W4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function gae(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W4(Object(r),!0).forEach(function(a){yae(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W4(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function yae(e,t,r){return t=vae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vae(e){var t=bae(e,"string");return rd(t)=="symbol"?t:t+""}function bae(e,t){if(rd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(rd(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jae(e,t){if(e==null)return{};var r=wae(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function wae(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}var Nae=function(t,r,a,s,i,o){return"M".concat(t,",").concat(i,"v").concat(s,"M").concat(o,",").concat(r,"h").concat(a)},_ae=function(t){var r=t.x,a=r===void 0?0:r,s=t.y,i=s===void 0?0:s,o=t.top,l=o===void 0?0:o,c=t.left,d=c===void 0?0:c,u=t.width,f=u===void 0?0:u,x=t.height,p=x===void 0?0:x,h=t.className,m=jae(t,pae),g=gae({x:a,y:i,top:l,left:d,width:f,height:p},m);return!be(a)||!be(i)||!be(f)||!be(p)||!be(l)||!be(d)?null:ee.createElement("path",Iy({},Re(g,!0),{className:tt("recharts-cross",h),d:Nae(a,i,f,p,l,d)}))},Lp,H4;function Sae(){if(H4)return Lp;H4=1;var e=y0(),t=K3(),r=Mn();function a(s,i){return s&&s.length?e(s,r(i,2),t):void 0}return Lp=a,Lp}var kae=Sae();const Eae=Ct(kae);var $p,z4;function Tae(){if(z4)return $p;z4=1;var e=y0(),t=Mn(),r=X3();function a(s,i){return s&&s.length?e(s,t(i,2),r):void 0}return $p=a,$p}var Aae=Tae();const Cae=Ct(Aae);var Pae=["cx","cy","angle","ticks","axisLine"],Oae=["ticks","tick","angle","tickFormatter","stroke"];function Uo(e){"@babel/helpers - typeof";return Uo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uo(e)}function uc(){return uc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},uc.apply(this,arguments)}function V4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Ks(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V4(Object(r),!0).forEach(function(a){_0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V4(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function G4(e,t){if(e==null)return{};var r=Iae(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function Iae(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function Fae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K4(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,DA(a.key),a)}}function Dae(e,t,r){return t&&K4(e.prototype,t),r&&K4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rae(e,t,r){return t=xf(t),Mae(e,FA()?Reflect.construct(t,r||[],xf(e).constructor):t.apply(e,r))}function Mae(e,t){if(t&&(Uo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lae(e)}function Lae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(FA=function(){return!!e})()}function xf(e){return xf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xf(e)}function $ae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fy(e,t)}function Fy(e,t){return Fy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Fy(e,t)}function _0(e,t,r){return t=DA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DA(e){var t=Bae(e,"string");return Uo(t)=="symbol"?t:t+""}function Bae(e,t){if(Uo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Uo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var S0=(function(e){function t(){return Fae(this,t),Rae(this,t,arguments)}return $ae(t,e),Dae(t,[{key:"getTickValueCoord",value:function(a){var s=a.coordinate,i=this.props,o=i.angle,l=i.cx,c=i.cy;return Bt(l,c,s,o)}},{key:"getTickTextAnchor",value:function(){var a=this.props.orientation,s;switch(a){case"left":s="end";break;case"right":s="start";break;default:s="middle";break}return s}},{key:"getViewBox",value:function(){var a=this.props,s=a.cx,i=a.cy,o=a.angle,l=a.ticks,c=Eae(l,function(u){return u.coordinate||0}),d=Cae(l,function(u){return u.coordinate||0});return{cx:s,cy:i,startAngle:o,endAngle:o,innerRadius:d.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var a=this.props,s=a.cx,i=a.cy,o=a.angle,l=a.ticks,c=a.axisLine,d=G4(a,Pae),u=l.reduce(function(h,m){return[Math.min(h[0],m.coordinate),Math.max(h[1],m.coordinate)]},[1/0,-1/0]),f=Bt(s,i,u[0],o),x=Bt(s,i,u[1],o),p=Ks(Ks(Ks({},Re(d,!1)),{},{fill:"none"},Re(c,!1)),{},{x1:f.x,y1:f.y,x2:x.x,y2:x.y});return ee.createElement("line",uc({className:"recharts-polar-radius-axis-line"},p))}},{key:"renderTicks",value:function(){var a=this,s=this.props,i=s.ticks,o=s.tick,l=s.angle,c=s.tickFormatter,d=s.stroke,u=G4(s,Oae),f=this.getTickTextAnchor(),x=Re(u,!1),p=Re(o,!1),h=i.map(function(m,g){var v=a.getTickValueCoord(m),b=Ks(Ks(Ks(Ks({textAnchor:f,transform:"rotate(".concat(90-l,", ").concat(v.x,", ").concat(v.y,")")},x),{},{stroke:"none",fill:d},p),{},{index:g},v),{},{payload:m});return ee.createElement(ht,uc({className:tt("recharts-polar-radius-axis-tick",NA(o)),key:"tick-".concat(m.coordinate)},Ti(a.props,m,g)),t.renderTickItem(o,b,c?c(m.value,g):m.value))});return ee.createElement(ht,{className:"recharts-polar-radius-axis-ticks"},h)}},{key:"render",value:function(){var a=this.props,s=a.ticks,i=a.axisLine,o=a.tick;return!s||!s.length?null:ee.createElement(ht,{className:tt("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),o&&this.renderTicks(),Dr.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(a,s,i){var o;return ee.isValidElement(a)?o=ee.cloneElement(a,s):qe(a)?o=a(s):o=ee.createElement(Ai,uc({},s,{className:"recharts-polar-radius-axis-tick-value"}),i),o}}])})(C.PureComponent);_0(S0,"displayName","PolarRadiusAxis");_0(S0,"axisType","radiusAxis");_0(S0,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function qo(e){"@babel/helpers - typeof";return qo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qo(e)}function ei(){return ei=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ei.apply(this,arguments)}function X4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Xs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X4(Object(r),!0).forEach(function(a){k0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X4(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Uae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y4(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,MA(a.key),a)}}function qae(e,t,r){return t&&Y4(e.prototype,t),r&&Y4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wae(e,t,r){return t=pf(t),Hae(e,RA()?Reflect.construct(t,r||[],pf(e).constructor):t.apply(e,r))}function Hae(e,t){if(t&&(qo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zae(e)}function zae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RA=function(){return!!e})()}function pf(e){return pf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pf(e)}function Vae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dy(e,t)}function Dy(e,t){return Dy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Dy(e,t)}function k0(e,t,r){return t=MA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MA(e){var t=Gae(e,"string");return qo(t)=="symbol"?t:t+""}function Gae(e,t){if(qo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(qo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Kae=Math.PI/180,J4=1e-5,E0=(function(e){function t(){return Uae(this,t),Wae(this,t,arguments)}return Vae(t,e),qae(t,[{key:"getTickLineCoord",value:function(a){var s=this.props,i=s.cx,o=s.cy,l=s.radius,c=s.orientation,d=s.tickSize,u=d||8,f=Bt(i,o,l,a.coordinate),x=Bt(i,o,l+(c==="inner"?-1:1)*u,a.coordinate);return{x1:f.x,y1:f.y,x2:x.x,y2:x.y}}},{key:"getTickTextAnchor",value:function(a){var s=this.props.orientation,i=Math.cos(-a.coordinate*Kae),o;return i>J4?o=s==="outer"?"start":"end":i<-J4?o=s==="outer"?"end":"start":o="middle",o}},{key:"renderAxisLine",value:function(){var a=this.props,s=a.cx,i=a.cy,o=a.radius,l=a.axisLine,c=a.axisLineType,d=Xs(Xs({},Re(this.props,!1)),{},{fill:"none"},Re(l,!1));if(c==="circle")return ee.createElement(N0,ei({className:"recharts-polar-angle-axis-line"},d,{cx:s,cy:i,r:o}));var u=this.props.ticks,f=u.map(function(x){return Bt(s,i,o,x.coordinate)});return ee.createElement(xae,ei({className:"recharts-polar-angle-axis-line"},d,{points:f}))}},{key:"renderTicks",value:function(){var a=this,s=this.props,i=s.ticks,o=s.tick,l=s.tickLine,c=s.tickFormatter,d=s.stroke,u=Re(this.props,!1),f=Re(o,!1),x=Xs(Xs({},u),{},{fill:"none"},Re(l,!1)),p=i.map(function(h,m){var g=a.getTickLineCoord(h),v=a.getTickTextAnchor(h),b=Xs(Xs(Xs({textAnchor:v},u),{},{stroke:"none",fill:d},f),{},{index:m,payload:h,x:g.x2,y:g.y2});return ee.createElement(ht,ei({className:tt("recharts-polar-angle-axis-tick",NA(o)),key:"tick-".concat(h.coordinate)},Ti(a.props,h,m)),l&&ee.createElement("line",ei({className:"recharts-polar-angle-axis-tick-line"},x,g)),o&&t.renderTickItem(o,b,c?c(h.value,m):h.value))});return ee.createElement(ht,{className:"recharts-polar-angle-axis-ticks"},p)}},{key:"render",value:function(){var a=this.props,s=a.ticks,i=a.radius,o=a.axisLine;return i<=0||!s||!s.length?null:ee.createElement(ht,{className:tt("recharts-polar-angle-axis",this.props.className)},o&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(a,s,i){var o;return ee.isValidElement(a)?o=ee.cloneElement(a,s):qe(a)?o=a(s):o=ee.createElement(Ai,ei({},s,{className:"recharts-polar-angle-axis-tick-value"}),i),o}}])})(C.PureComponent);k0(E0,"displayName","PolarAngleAxis");k0(E0,"axisType","angleAxis");k0(E0,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var Bp,Q4;function Xae(){if(Q4)return Bp;Q4=1;var e=G6(),t=e(Object.getPrototypeOf,Object);return Bp=t,Bp}var Up,Z4;function Yae(){if(Z4)return Up;Z4=1;var e=us(),t=Xae(),r=fs(),a="[object Object]",s=Function.prototype,i=Object.prototype,o=s.toString,l=i.hasOwnProperty,c=o.call(Object);function d(u){if(!r(u)||e(u)!=a)return!1;var f=t(u);if(f===null)return!0;var x=l.call(f,"constructor")&&f.constructor;return typeof x=="function"&&x instanceof x&&o.call(x)==c}return Up=d,Up}var Jae=Yae();const Qae=Ct(Jae);var qp,ek;function Zae(){if(ek)return qp;ek=1;var e=us(),t=fs(),r="[object Boolean]";function a(s){return s===!0||s===!1||t(s)&&e(s)==r}return qp=a,qp}var ene=Zae();const tne=Ct(ene);function ad(e){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(e)}function gf(){return gf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},gf.apply(this,arguments)}function rne(e,t){return ine(e)||sne(e,t)||nne(e,t)||ane()}function ane(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nne(e,t){if(e){if(typeof e=="string")return tk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tk(e,t)}}function tk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function sne(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function ine(e){if(Array.isArray(e))return e}function rk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ak(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rk(Object(r),!0).forEach(function(a){one(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rk(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function one(e,t,r){return t=lne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lne(e){var t=cne(e,"string");return ad(t)=="symbol"?t:t+""}function cne(e,t){if(ad(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(ad(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nk=function(t,r,a,s,i){var o=a-s,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+a,",").concat(r),l+="L ".concat(t+a-o/2,",").concat(r+i),l+="L ".concat(t+a-o/2-s,",").concat(r+i),l+="L ".concat(t,",").concat(r," Z"),l},dne={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},une=function(t){var r=ak(ak({},dne),t),a=C.useRef(),s=C.useState(-1),i=rne(s,2),o=i[0],l=i[1];C.useEffect(function(){if(a.current&&a.current.getTotalLength)try{var y=a.current.getTotalLength();y&&l(y)}catch{}},[]);var c=r.x,d=r.y,u=r.upperWidth,f=r.lowerWidth,x=r.height,p=r.className,h=r.animationEasing,m=r.animationDuration,g=r.animationBegin,v=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||x!==+x||u===0&&f===0||x===0)return null;var b=tt("recharts-trapezoid",p);return v?ee.createElement(In,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:x,x:c,y:d},to:{upperWidth:u,lowerWidth:f,height:x,x:c,y:d},duration:m,animationEasing:h,isActive:v},function(y){var N=y.upperWidth,j=y.lowerWidth,w=y.height,_=y.x,S=y.y;return ee.createElement(In,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:m,easing:h},ee.createElement("path",gf({},Re(r,!0),{className:b,d:nk(_,S,N,j,w),ref:a})))}):ee.createElement("g",null,ee.createElement("path",gf({},Re(r,!0),{className:b,d:nk(c,d,u,f,x)})))},fne=["option","shapeType","propTransformer","activeClassName","isActive"];function nd(e){"@babel/helpers - typeof";return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nd(e)}function hne(e,t){if(e==null)return{};var r=mne(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function mne(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function sk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function yf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sk(Object(r),!0).forEach(function(a){xne(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sk(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function xne(e,t,r){return t=pne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pne(e){var t=gne(e,"string");return nd(t)=="symbol"?t:t+""}function gne(e,t){if(nd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(nd(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yne(e,t){return yf(yf({},t),e)}function vne(e,t){return e==="symbols"}function ik(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return ee.createElement(Gb,r);case"trapezoid":return ee.createElement(une,r);case"sector":return ee.createElement(kA,r);case"symbols":if(vne(t))return ee.createElement(fb,r);break;default:return null}}function bne(e){return C.isValidElement(e)?e.props:e}function LA(e){var t=e.option,r=e.shapeType,a=e.propTransformer,s=a===void 0?yne:a,i=e.activeClassName,o=i===void 0?"recharts-active-shape":i,l=e.isActive,c=hne(e,fne),d;if(C.isValidElement(t))d=C.cloneElement(t,yf(yf({},c),bne(t)));else if(qe(t))d=t(c);else if(Qae(t)&&!tne(t)){var u=s(t,c);d=ee.createElement(ik,{shapeType:r,elementProps:u})}else{var f=c;d=ee.createElement(ik,{shapeType:r,elementProps:f})}return l?ee.createElement(ht,{className:o},d):d}function T0(e,t){return t!=null&&"trapezoids"in e.props}function A0(e,t){return t!=null&&"sectors"in e.props}function sd(e,t){return t!=null&&"points"in e.props}function jne(e,t){var r,a,s=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(a=t.labelViewBox)===null||a===void 0?void 0:a.y)||e.y===t.y;return s&&i}function wne(e,t){var r=e.endAngle===t.endAngle,a=e.startAngle===t.startAngle;return r&&a}function Nne(e,t){var r=e.x===t.x,a=e.y===t.y,s=e.z===t.z;return r&&a&&s}function _ne(e,t){var r;return T0(e,t)?r=jne:A0(e,t)?r=wne:sd(e,t)&&(r=Nne),r}function Sne(e,t){var r;return T0(e,t)?r="trapezoids":A0(e,t)?r="sectors":sd(e,t)&&(r="points"),r}function kne(e,t){if(T0(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(A0(e,t)){var a;return(a=t.tooltipPayload)===null||a===void 0||(a=a[0])===null||a===void 0||(a=a.payload)===null||a===void 0?void 0:a.payload}return sd(e,t)?t.payload:{}}function Ene(e){var t=e.activeTooltipItem,r=e.graphicalItem,a=e.itemData,s=Sne(r,t),i=kne(r,t),o=a.filter(function(c,d){var u=Lo(i,c),f=r.props[s].filter(function(h){var m=_ne(r,t);return m(h,t)}),x=r.props[s].indexOf(f[f.length-1]),p=d===x;return u&&p}),l=a.indexOf(o[o.length-1]);return l}var cu;function Wo(e){"@babel/helpers - typeof";return Wo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wo(e)}function lo(){return lo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},lo.apply(this,arguments)}function ok(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Lt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ok(Object(r),!0).forEach(function(a){Ka(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ok(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Tne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lk(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,BA(a.key),a)}}function Ane(e,t,r){return t&&lk(e.prototype,t),r&&lk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cne(e,t,r){return t=vf(t),Pne(e,$A()?Reflect.construct(t,r||[],vf(e).constructor):t.apply(e,r))}function Pne(e,t){if(t&&(Wo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return One(e)}function One(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $A(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($A=function(){return!!e})()}function vf(e){return vf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vf(e)}function Ine(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ry(e,t)}function Ry(e,t){return Ry=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Ry(e,t)}function Ka(e,t,r){return t=BA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BA(e){var t=Fne(e,"string");return Wo(t)=="symbol"?t:t+""}function Fne(e,t){if(Wo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Wo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ms=(function(e){function t(r){var a;return Tne(this,t),a=Cne(this,t,[r]),Ka(a,"pieRef",null),Ka(a,"sectorRefs",[]),Ka(a,"id",xl("recharts-pie-")),Ka(a,"handleAnimationEnd",function(){var s=a.props.onAnimationEnd;a.setState({isAnimationFinished:!0}),qe(s)&&s()}),Ka(a,"handleAnimationStart",function(){var s=a.props.onAnimationStart;a.setState({isAnimationFinished:!1}),qe(s)&&s()}),a.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},a}return Ine(t,e),Ane(t,[{key:"isActiveIndex",value:function(a){var s=this.props.activeIndex;return Array.isArray(s)?s.indexOf(a)!==-1:a===s}},{key:"hasActiveIndex",value:function(){var a=this.props.activeIndex;return Array.isArray(a)?a.length!==0:a||a===0}},{key:"renderLabels",value:function(a){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.label,l=i.labelLine,c=i.dataKey,d=i.valueKey,u=Re(this.props,!1),f=Re(o,!1),x=Re(l,!1),p=o&&o.offsetRadius||20,h=a.map(function(m,g){var v=(m.startAngle+m.endAngle)/2,b=Bt(m.cx,m.cy,m.outerRadius+p,v),y=Lt(Lt(Lt(Lt({},u),m),{},{stroke:"none"},f),{},{index:g,textAnchor:t.getTextAnchor(b.x,m.cx)},b),N=Lt(Lt(Lt(Lt({},u),m),{},{fill:"none",stroke:m.fill},x),{},{index:g,points:[Bt(m.cx,m.cy,m.outerRadius,v),b]}),j=c;return Je(c)&&Je(d)?j="value":Je(c)&&(j=d),ee.createElement(ht,{key:"label-".concat(m.startAngle,"-").concat(m.endAngle,"-").concat(m.midAngle,"-").concat(g)},l&&t.renderLabelLineItem(l,N,"line"),t.renderLabelItem(o,y,Tr(m,j)))});return ee.createElement(ht,{className:"recharts-pie-labels"},h)}},{key:"renderSectorsStatically",value:function(a){var s=this,i=this.props,o=i.activeShape,l=i.blendStroke,c=i.inactiveShape;return a.map(function(d,u){if((d==null?void 0:d.startAngle)===0&&(d==null?void 0:d.endAngle)===0&&a.length!==1)return null;var f=s.isActiveIndex(u),x=c&&s.hasActiveIndex()?c:null,p=f?o:x,h=Lt(Lt({},d),{},{stroke:l?d.fill:d.stroke,tabIndex:-1});return ee.createElement(ht,lo({ref:function(g){g&&!s.sectorRefs.includes(g)&&s.sectorRefs.push(g)},tabIndex:-1,className:"recharts-pie-sector"},Ti(s.props,d,u),{key:"sector-".concat(d==null?void 0:d.startAngle,"-").concat(d==null?void 0:d.endAngle,"-").concat(d.midAngle,"-").concat(u)}),ee.createElement(LA,lo({option:p,isActive:f,shapeType:"sector"},h)))})}},{key:"renderSectorsWithAnimation",value:function(){var a=this,s=this.props,i=s.sectors,o=s.isAnimationActive,l=s.animationBegin,c=s.animationDuration,d=s.animationEasing,u=s.animationId,f=this.state,x=f.prevSectors,p=f.prevIsAnimationActive;return ee.createElement(In,{begin:l,duration:c,isActive:o,easing:d,from:{t:0},to:{t:1},key:"pie-".concat(u,"-").concat(p),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(h){var m=h.t,g=[],v=i&&i[0],b=v.startAngle;return i.forEach(function(y,N){var j=x&&x[N],w=N>0?Oa(y,"paddingAngle",0):0;if(j){var _=ga(j.endAngle-j.startAngle,y.endAngle-y.startAngle),S=Lt(Lt({},y),{},{startAngle:b+w,endAngle:b+_(m)+w});g.push(S),b=S.endAngle}else{var k=y.endAngle,E=y.startAngle,A=ga(0,k-E),P=A(m),L=Lt(Lt({},y),{},{startAngle:b+w,endAngle:b+P+w});g.push(L),b=L.endAngle}}),ee.createElement(ht,null,a.renderSectorsStatically(g))})}},{key:"attachKeyboardHandlers",value:function(a){var s=this;a.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var o=++s.state.sectorToFocus%s.sectorRefs.length;s.sectorRefs[o].focus(),s.setState({sectorToFocus:o});break}case"ArrowRight":{var l=--s.state.sectorToFocus<0?s.sectorRefs.length-1:s.state.sectorToFocus%s.sectorRefs.length;s.sectorRefs[l].focus(),s.setState({sectorToFocus:l});break}case"Escape":{s.sectorRefs[s.state.sectorToFocus].blur(),s.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var a=this.props,s=a.sectors,i=a.isAnimationActive,o=this.state.prevSectors;return i&&s&&s.length&&(!o||!Lo(o,s))?this.renderSectorsWithAnimation():this.renderSectorsStatically(s)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var a=this,s=this.props,i=s.hide,o=s.sectors,l=s.className,c=s.label,d=s.cx,u=s.cy,f=s.innerRadius,x=s.outerRadius,p=s.isAnimationActive,h=this.state.isAnimationFinished;if(i||!o||!o.length||!be(d)||!be(u)||!be(f)||!be(x))return null;var m=tt("recharts-pie",l);return ee.createElement(ht,{tabIndex:this.props.rootTabIndex,className:m,ref:function(v){a.pieRef=v}},this.renderSectors(),c&&this.renderLabels(o),Dr.renderCallByParent(this.props,null,!1),(!p||h)&&rs.renderCallByParent(this.props,o,!1))}}],[{key:"getDerivedStateFromProps",value:function(a,s){return s.prevIsAnimationActive!==a.isAnimationActive?{prevIsAnimationActive:a.isAnimationActive,prevAnimationId:a.animationId,curSectors:a.sectors,prevSectors:[],isAnimationFinished:!0}:a.isAnimationActive&&a.animationId!==s.prevAnimationId?{prevAnimationId:a.animationId,curSectors:a.sectors,prevSectors:s.curSectors,isAnimationFinished:!0}:a.sectors!==s.curSectors?{curSectors:a.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(a,s){return a>s?"start":a<s?"end":"middle"}},{key:"renderLabelLineItem",value:function(a,s,i){if(ee.isValidElement(a))return ee.cloneElement(a,s);if(qe(a))return a(s);var o=tt("recharts-pie-label-line",typeof a!="boolean"?a.className:"");return ee.createElement(bo,lo({},s,{key:i,type:"linear",className:o}))}},{key:"renderLabelItem",value:function(a,s,i){if(ee.isValidElement(a))return ee.cloneElement(a,s);var o=i;if(qe(a)&&(o=a(s),ee.isValidElement(o)))return o;var l=tt("recharts-pie-label-text",typeof a!="boolean"&&!qe(a)?a.className:"");return ee.createElement(Ai,lo({},s,{alignmentBaseline:"middle",className:l}),o)}}])})(C.PureComponent);cu=ms;Ka(ms,"displayName","Pie");Ka(ms,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Ui.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Ka(ms,"parseDeltaAngle",function(e,t){var r=ca(t-e),a=Math.min(Math.abs(t-e),360);return r*a});Ka(ms,"getRealPieData",function(e){var t=e.data,r=e.children,a=Re(e,!1),s=Qa(r,u0);return t&&t.length?t.map(function(i,o){return Lt(Lt(Lt({payload:i},a),i),s&&s[o]&&s[o].props)}):s&&s.length?s.map(function(i){return Lt(Lt({},a),i.props)}):[]});Ka(ms,"parseCoordinateOfPie",function(e,t){var r=t.top,a=t.left,s=t.width,i=t.height,o=wA(s,i),l=a+da(e.cx,s,s/2),c=r+da(e.cy,i,i/2),d=da(e.innerRadius,o,0),u=da(e.outerRadius,o,o*.8),f=e.maxRadius||Math.sqrt(s*s+i*i)/2;return{cx:l,cy:c,innerRadius:d,outerRadius:u,maxRadius:f}});Ka(ms,"getComposedData",function(e){var t=e.item,r=e.offset,a=t.type.defaultProps!==void 0?Lt(Lt({},t.type.defaultProps),t.props):t.props,s=cu.getRealPieData(a);if(!s||!s.length)return null;var i=a.cornerRadius,o=a.startAngle,l=a.endAngle,c=a.paddingAngle,d=a.dataKey,u=a.nameKey,f=a.valueKey,x=a.tooltipType,p=Math.abs(a.minAngle),h=cu.parseCoordinateOfPie(a,r),m=cu.parseDeltaAngle(o,l),g=Math.abs(m),v=d;Je(d)&&Je(f)?(pn(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),v="value"):Je(d)&&(pn(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),v=f);var b=s.filter(function(S){return Tr(S,v,0)!==0}).length,y=(g>=360?b:b-1)*c,N=g-b*p-y,j=s.reduce(function(S,k){var E=Tr(k,v,0);return S+(be(E)?E:0)},0),w;if(j>0){var _;w=s.map(function(S,k){var E=Tr(S,v,0),A=Tr(S,u,k),P=(be(E)?E:0)/j,L;k?L=_.endAngle+ca(m)*c*(E!==0?1:0):L=o;var R=L+ca(m)*((E!==0?p:0)+P*N),I=(L+R)/2,D=(h.innerRadius+h.outerRadius)/2,V=[{name:A,value:E,payload:S,dataKey:v,type:x}],F=Bt(h.cx,h.cy,D,I);return _=Lt(Lt(Lt({percent:P,cornerRadius:i,name:A,tooltipPayload:V,midAngle:I,middleRadius:D,tooltipPosition:F},S),h),{},{value:Tr(S,v),startAngle:L,endAngle:R,payload:S,paddingAngle:ca(m)*c}),_})}return Lt(Lt({},h),{},{sectors:w,data:s})});var Wp,ck;function Dne(){if(ck)return Wp;ck=1;var e=Math.ceil,t=Math.max;function r(a,s,i,o){for(var l=-1,c=t(e((s-a)/(i||1)),0),d=Array(c);c--;)d[o?c:++l]=a,a+=i;return d}return Wp=r,Wp}var Hp,dk;function UA(){if(dk)return Hp;dk=1;var e=c3(),t=1/0,r=17976931348623157e292;function a(s){if(!s)return s===0?s:0;if(s=e(s),s===t||s===-t){var i=s<0?-1:1;return i*r}return s===s?s:0}return Hp=a,Hp}var zp,uk;function Rne(){if(uk)return zp;uk=1;var e=Dne(),t=d0(),r=UA();function a(s){return function(i,o,l){return l&&typeof l!="number"&&t(i,o,l)&&(o=l=void 0),i=r(i),o===void 0?(o=i,i=0):o=r(o),l=l===void 0?i<o?1:-1:r(l),e(i,o,l,s)}}return zp=a,zp}var Vp,fk;function Mne(){if(fk)return Vp;fk=1;var e=Rne(),t=e();return Vp=t,Vp}var Lne=Mne();const bf=Ct(Lne);function id(e){"@babel/helpers - typeof";return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},id(e)}function hk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function mk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hk(Object(r),!0).forEach(function(a){qA(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hk(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function qA(e,t,r){return t=$ne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $ne(e){var t=Bne(e,"string");return id(t)=="symbol"?t:t+""}function Bne(e,t){if(id(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(id(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Une=["Webkit","Moz","O","ms"],qne=function(t,r){var a=t.replace(/(\w)/,function(i){return i.toUpperCase()}),s=Une.reduce(function(i,o){return mk(mk({},i),{},qA({},o+a,r))},{});return s[t]=r,s};function Ho(e){"@babel/helpers - typeof";return Ho=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ho(e)}function jf(){return jf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},jf.apply(this,arguments)}function xk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Gp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xk(Object(r),!0).forEach(function(a){_a(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xk(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Wne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pk(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,HA(a.key),a)}}function Hne(e,t,r){return t&&pk(e.prototype,t),r&&pk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zne(e,t,r){return t=wf(t),Vne(e,WA()?Reflect.construct(t,r||[],wf(e).constructor):t.apply(e,r))}function Vne(e,t){if(t&&(Ho(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gne(e)}function Gne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WA=function(){return!!e})()}function wf(e){return wf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wf(e)}function Kne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&My(e,t)}function My(e,t){return My=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},My(e,t)}function _a(e,t,r){return t=HA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HA(e){var t=Xne(e,"string");return Ho(t)=="symbol"?t:t+""}function Xne(e,t){if(Ho(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Ho(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Yne=function(t){var r=t.data,a=t.startIndex,s=t.endIndex,i=t.x,o=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,d=oc().domain(bf(0,c)).range([i,i+o-l]),u=d.domain().map(function(f){return d(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:d(a),endX:d(s),scale:d,scaleValues:u}},gk=function(t){return t.changedTouches&&!!t.changedTouches.length},zo=(function(e){function t(r){var a;return Wne(this,t),a=zne(this,t,[r]),_a(a,"handleDrag",function(s){a.leaveTimer&&(clearTimeout(a.leaveTimer),a.leaveTimer=null),a.state.isTravellerMoving?a.handleTravellerMove(s):a.state.isSlideMoving&&a.handleSlideDrag(s)}),_a(a,"handleTouchMove",function(s){s.changedTouches!=null&&s.changedTouches.length>0&&a.handleDrag(s.changedTouches[0])}),_a(a,"handleDragEnd",function(){a.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var s=a.props,i=s.endIndex,o=s.onDragEnd,l=s.startIndex;o==null||o({endIndex:i,startIndex:l})}),a.detachDragEndListener()}),_a(a,"handleLeaveWrapper",function(){(a.state.isTravellerMoving||a.state.isSlideMoving)&&(a.leaveTimer=window.setTimeout(a.handleDragEnd,a.props.leaveTimeOut))}),_a(a,"handleEnterSlideOrTraveller",function(){a.setState({isTextActive:!0})}),_a(a,"handleLeaveSlideOrTraveller",function(){a.setState({isTextActive:!1})}),_a(a,"handleSlideDragStart",function(s){var i=gk(s)?s.changedTouches[0]:s;a.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),a.attachDragEndListener()}),a.travellerDragStartHandlers={startX:a.handleTravellerDragStart.bind(a,"startX"),endX:a.handleTravellerDragStart.bind(a,"endX")},a.state={},a}return Kne(t,e),Hne(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(a){var s=a.startX,i=a.endX,o=this.state.scaleValues,l=this.props,c=l.gap,d=l.data,u=d.length-1,f=Math.min(s,i),x=Math.max(s,i),p=t.getIndexInRange(o,f),h=t.getIndexInRange(o,x);return{startIndex:p-p%c,endIndex:h===u?u:h-h%c}}},{key:"getTextOfTick",value:function(a){var s=this.props,i=s.data,o=s.tickFormatter,l=s.dataKey,c=Tr(i[a],l,a);return qe(o)?o(c,a):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(a){var s=this.state,i=s.slideMoveStartX,o=s.startX,l=s.endX,c=this.props,d=c.x,u=c.width,f=c.travellerWidth,x=c.startIndex,p=c.endIndex,h=c.onChange,m=a.pageX-i;m>0?m=Math.min(m,d+u-f-l,d+u-f-o):m<0&&(m=Math.max(m,d-o,d-l));var g=this.getIndex({startX:o+m,endX:l+m});(g.startIndex!==x||g.endIndex!==p)&&h&&h(g),this.setState({startX:o+m,endX:l+m,slideMoveStartX:a.pageX})}},{key:"handleTravellerDragStart",value:function(a,s){var i=gk(s)?s.changedTouches[0]:s;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:a,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(a){var s=this.state,i=s.brushMoveStartX,o=s.movingTravellerId,l=s.endX,c=s.startX,d=this.state[o],u=this.props,f=u.x,x=u.width,p=u.travellerWidth,h=u.onChange,m=u.gap,g=u.data,v={startX:this.state.startX,endX:this.state.endX},b=a.pageX-i;b>0?b=Math.min(b,f+x-p-d):b<0&&(b=Math.max(b,f-d)),v[o]=d+b;var y=this.getIndex(v),N=y.startIndex,j=y.endIndex,w=function(){var S=g.length-1;return o==="startX"&&(l>c?N%m===0:j%m===0)||l<c&&j===S||o==="endX"&&(l>c?j%m===0:N%m===0)||l>c&&j===S};this.setState(_a(_a({},o,d+b),"brushMoveStartX",a.pageX),function(){h&&w()&&h(y)})}},{key:"handleTravellerMoveKeyboard",value:function(a,s){var i=this,o=this.state,l=o.scaleValues,c=o.startX,d=o.endX,u=this.state[s],f=l.indexOf(u);if(f!==-1){var x=f+a;if(!(x===-1||x>=l.length)){var p=l[x];s==="startX"&&p>=d||s==="endX"&&p<=c||this.setState(_a({},s,p),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var a=this.props,s=a.x,i=a.y,o=a.width,l=a.height,c=a.fill,d=a.stroke;return ee.createElement("rect",{stroke:d,fill:c,x:s,y:i,width:o,height:l})}},{key:"renderPanorama",value:function(){var a=this.props,s=a.x,i=a.y,o=a.width,l=a.height,c=a.data,d=a.children,u=a.padding,f=C.Children.only(d);return f?ee.cloneElement(f,{x:s,y:i,width:o,height:l,margin:u,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(a,s){var i,o,l=this,c=this.props,d=c.y,u=c.travellerWidth,f=c.height,x=c.traveller,p=c.ariaLabel,h=c.data,m=c.startIndex,g=c.endIndex,v=Math.max(a,this.props.x),b=Gp(Gp({},Re(this.props,!1)),{},{x:v,y:d,width:u,height:f}),y=p||"Min value: ".concat((i=h[m])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=h[g])===null||o===void 0?void 0:o.name);return ee.createElement(ht,{tabIndex:0,role:"slider","aria-label":y,"aria-valuenow":a,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[s],onTouchStart:this.travellerDragStartHandlers[s],onKeyDown:function(j){["ArrowLeft","ArrowRight"].includes(j.key)&&(j.preventDefault(),j.stopPropagation(),l.handleTravellerMoveKeyboard(j.key==="ArrowRight"?1:-1,s))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(x,b))}},{key:"renderSlide",value:function(a,s){var i=this.props,o=i.y,l=i.height,c=i.stroke,d=i.travellerWidth,u=Math.min(a,s)+d,f=Math.max(Math.abs(s-a)-d,0);return ee.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:u,y:o,width:f,height:l})}},{key:"renderText",value:function(){var a=this.props,s=a.startIndex,i=a.endIndex,o=a.y,l=a.height,c=a.travellerWidth,d=a.stroke,u=this.state,f=u.startX,x=u.endX,p=5,h={pointerEvents:"none",fill:d};return ee.createElement(ht,{className:"recharts-brush-texts"},ee.createElement(Ai,jf({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,x)-p,y:o+l/2},h),this.getTextOfTick(s)),ee.createElement(Ai,jf({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,x)+c+p,y:o+l/2},h),this.getTextOfTick(i)))}},{key:"render",value:function(){var a=this.props,s=a.data,i=a.className,o=a.children,l=a.x,c=a.y,d=a.width,u=a.height,f=a.alwaysShowText,x=this.state,p=x.startX,h=x.endX,m=x.isTextActive,g=x.isSlideMoving,v=x.isTravellerMoving,b=x.isTravellerFocused;if(!s||!s.length||!be(l)||!be(c)||!be(d)||!be(u)||d<=0||u<=0)return null;var y=tt("recharts-brush",i),N=ee.Children.count(o)===1,j=qne("userSelect","none");return ee.createElement(ht,{className:y,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:j},this.renderBackground(),N&&this.renderPanorama(),this.renderSlide(p,h),this.renderTravellerLayer(p,"startX"),this.renderTravellerLayer(h,"endX"),(m||g||v||b||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(a){var s=a.x,i=a.y,o=a.width,l=a.height,c=a.stroke,d=Math.floor(i+l/2)-1;return ee.createElement(ee.Fragment,null,ee.createElement("rect",{x:s,y:i,width:o,height:l,fill:c,stroke:"none"}),ee.createElement("line",{x1:s+1,y1:d,x2:s+o-1,y2:d,fill:"none",stroke:"#fff"}),ee.createElement("line",{x1:s+1,y1:d+2,x2:s+o-1,y2:d+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(a,s){var i;return ee.isValidElement(a)?i=ee.cloneElement(a,s):qe(a)?i=a(s):i=t.renderDefaultTraveller(s),i}},{key:"getDerivedStateFromProps",value:function(a,s){var i=a.data,o=a.width,l=a.x,c=a.travellerWidth,d=a.updateId,u=a.startIndex,f=a.endIndex;if(i!==s.prevData||d!==s.prevUpdateId)return Gp({prevData:i,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:o},i&&i.length?Yne({data:i,width:o,x:l,travellerWidth:c,startIndex:u,endIndex:f}):{scale:null,scaleValues:null});if(s.scale&&(o!==s.prevWidth||l!==s.prevX||c!==s.prevTravellerWidth)){s.scale.range([l,l+o-c]);var x=s.scale.domain().map(function(p){return s.scale(p)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:o,startX:s.scale(a.startIndex),endX:s.scale(a.endIndex),scaleValues:x}}return null}},{key:"getIndexInRange",value:function(a,s){for(var i=a.length,o=0,l=i-1;l-o>1;){var c=Math.floor((o+l)/2);a[c]>s?l=c:o=c}return s>=a[l]?l:o}}])})(C.PureComponent);_a(zo,"displayName","Brush");_a(zo,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var Kp,yk;function Jne(){if(yk)return Kp;yk=1;var e=vb();function t(r,a){var s;return e(r,function(i,o,l){return s=a(i,o,l),!s}),!!s}return Kp=t,Kp}var Xp,vk;function Qne(){if(vk)return Xp;vk=1;var e=B6(),t=Mn(),r=Jne(),a=Na(),s=d0();function i(o,l,c){var d=a(o)?e:r;return c&&s(o,l,c)&&(l=void 0),d(o,t(l,3))}return Xp=i,Xp}var Zne=Qne();const ese=Ct(Zne);var Tn=function(t,r){var a=t.alwaysShow,s=t.ifOverflow;return a&&(s="extendDomain"),s===r},Yp,bk;function tse(){if(bk)return Yp;bk=1;var e=n3();function t(r,a,s){a=="__proto__"&&e?e(r,a,{configurable:!0,enumerable:!0,value:s,writable:!0}):r[a]=s}return Yp=t,Yp}var Jp,jk;function rse(){if(jk)return Jp;jk=1;var e=tse(),t=r3(),r=Mn();function a(s,i){var o={};return i=r(i,3),t(s,function(l,c,d){e(o,c,i(l,c,d))}),o}return Jp=a,Jp}var ase=rse();const nse=Ct(ase);var Qp,wk;function sse(){if(wk)return Qp;wk=1;function e(t,r){for(var a=-1,s=t==null?0:t.length;++a<s;)if(!r(t[a],a,t))return!1;return!0}return Qp=e,Qp}var Zp,Nk;function ise(){if(Nk)return Zp;Nk=1;var e=vb();function t(r,a){var s=!0;return e(r,function(i,o,l){return s=!!a(i,o,l),s}),s}return Zp=t,Zp}var eg,_k;function ose(){if(_k)return eg;_k=1;var e=sse(),t=ise(),r=Mn(),a=Na(),s=d0();function i(o,l,c){var d=a(o)?e:t;return c&&s(o,l,c)&&(l=void 0),d(o,r(l,3))}return eg=i,eg}var lse=ose();const zA=Ct(lse);var cse=["x","y"];function od(e){"@babel/helpers - typeof";return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},od(e)}function Ly(){return Ly=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ly.apply(this,arguments)}function Sk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function $l(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sk(Object(r),!0).forEach(function(a){dse(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sk(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function dse(e,t,r){return t=use(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function use(e){var t=fse(e,"string");return od(t)=="symbol"?t:t+""}function fse(e,t){if(od(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(od(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hse(e,t){if(e==null)return{};var r=mse(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function mse(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function xse(e,t){var r=e.x,a=e.y,s=hse(e,cse),i="".concat(r),o=parseInt(i,10),l="".concat(a),c=parseInt(l,10),d="".concat(t.height||s.height),u=parseInt(d,10),f="".concat(t.width||s.width),x=parseInt(f,10);return $l($l($l($l($l({},t),s),o?{x:o}:{}),c?{y:c}:{}),{},{height:u,width:x,name:t.name,radius:t.radius})}function kk(e){return ee.createElement(LA,Ly({shapeType:"rectangle",propTransformer:xse,activeClassName:"recharts-active-bar"},e))}var pse=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(a,s){if(typeof t=="number")return t;var i=be(a)||Bz(a);return i?t(a,s):(i||Pi(),r)}},gse=["value","background"],VA;function Vo(e){"@babel/helpers - typeof";return Vo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vo(e)}function yse(e,t){if(e==null)return{};var r=vse(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function vse(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function Nf(){return Nf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Nf.apply(this,arguments)}function Ek(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function br(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ek(Object(r),!0).forEach(function(a){Ss(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ek(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function bse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tk(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,KA(a.key),a)}}function jse(e,t,r){return t&&Tk(e.prototype,t),r&&Tk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wse(e,t,r){return t=_f(t),Nse(e,GA()?Reflect.construct(t,r||[],_f(e).constructor):t.apply(e,r))}function Nse(e,t){if(t&&(Vo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _se(e)}function _se(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(GA=function(){return!!e})()}function _f(e){return _f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_f(e)}function Sse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$y(e,t)}function $y(e,t){return $y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},$y(e,t)}function Ss(e,t,r){return t=KA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KA(e){var t=kse(e,"string");return Vo(t)=="symbol"?t:t+""}function kse(e,t){if(Vo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Vo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var zi=(function(e){function t(){var r;bse(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return r=wse(this,t,[].concat(s)),Ss(r,"state",{isAnimationFinished:!1}),Ss(r,"id",xl("recharts-bar-")),Ss(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),Ss(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return Sse(t,e),jse(t,[{key:"renderRectanglesStatically",value:function(a){var s=this,i=this.props,o=i.shape,l=i.dataKey,c=i.activeIndex,d=i.activeBar,u=Re(this.props,!1);return a&&a.map(function(f,x){var p=x===c,h=p?d:o,m=br(br(br({},u),f),{},{isActive:p,option:h,index:x,dataKey:l,onAnimationStart:s.handleAnimationStart,onAnimationEnd:s.handleAnimationEnd});return ee.createElement(ht,Nf({className:"recharts-bar-rectangle"},Ti(s.props,f,x),{key:"rectangle-".concat(f==null?void 0:f.x,"-").concat(f==null?void 0:f.y,"-").concat(f==null?void 0:f.value,"-").concat(x)}),ee.createElement(kk,m))})}},{key:"renderRectanglesWithAnimation",value:function(){var a=this,s=this.props,i=s.data,o=s.layout,l=s.isAnimationActive,c=s.animationBegin,d=s.animationDuration,u=s.animationEasing,f=s.animationId,x=this.state.prevData;return ee.createElement(In,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var h=p.t,m=i.map(function(g,v){var b=x&&x[v];if(b){var y=ga(b.x,g.x),N=ga(b.y,g.y),j=ga(b.width,g.width),w=ga(b.height,g.height);return br(br({},g),{},{x:y(h),y:N(h),width:j(h),height:w(h)})}if(o==="horizontal"){var _=ga(0,g.height),S=_(h);return br(br({},g),{},{y:g.y+g.height-S,height:S})}var k=ga(0,g.width),E=k(h);return br(br({},g),{},{width:E})});return ee.createElement(ht,null,a.renderRectanglesStatically(m))})}},{key:"renderRectangles",value:function(){var a=this.props,s=a.data,i=a.isAnimationActive,o=this.state.prevData;return i&&s&&s.length&&(!o||!Lo(o,s))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(s)}},{key:"renderBackground",value:function(){var a=this,s=this.props,i=s.data,o=s.dataKey,l=s.activeIndex,c=Re(this.props.background,!1);return i.map(function(d,u){d.value;var f=d.background,x=yse(d,gse);if(!f)return null;var p=br(br(br(br(br({},x),{},{fill:"#eee"},f),c),Ti(a.props,d,u)),{},{onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd,dataKey:o,index:u,className:"recharts-bar-background-rectangle"});return ee.createElement(kk,Nf({key:"background-bar-".concat(u),option:a.props.background,isActive:u===l},p))})}},{key:"renderErrorBar",value:function(a,s){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,l=i.xAxis,c=i.yAxis,d=i.layout,u=i.children,f=Qa(u,w0);if(!f)return null;var x=d==="vertical"?o[0].height/2:o[0].width/2,p=function(g,v){var b=Array.isArray(g.value)?g.value[1]:g.value;return{x:g.x,y:g.y,value:b,errorVal:Tr(g,v)}},h={clipPath:a?"url(#clipPath-".concat(s,")"):null};return ee.createElement(ht,h,f.map(function(m){return ee.cloneElement(m,{key:"error-bar-".concat(s,"-").concat(m.props.dataKey),data:o,xAxis:l,yAxis:c,layout:d,offset:x,dataPointFormatter:p})}))}},{key:"render",value:function(){var a=this.props,s=a.hide,i=a.data,o=a.className,l=a.xAxis,c=a.yAxis,d=a.left,u=a.top,f=a.width,x=a.height,p=a.isAnimationActive,h=a.background,m=a.id;if(s||!i||!i.length)return null;var g=this.state.isAnimationFinished,v=tt("recharts-bar",o),b=l&&l.allowDataOverflow,y=c&&c.allowDataOverflow,N=b||y,j=Je(m)?this.id:m;return ee.createElement(ht,{className:v},b||y?ee.createElement("defs",null,ee.createElement("clipPath",{id:"clipPath-".concat(j)},ee.createElement("rect",{x:b?d:d-f/2,y:y?u:u-x/2,width:b?f:f*2,height:y?x:x*2}))):null,ee.createElement(ht,{className:"recharts-bar-rectangles",clipPath:N?"url(#clipPath-".concat(j,")"):null},h?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(N,j),(!p||g)&&rs.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(a,s){return a.animationId!==s.prevAnimationId?{prevAnimationId:a.animationId,curData:a.data,prevData:s.curData}:a.data!==s.curData?{curData:a.data}:null}}])})(C.PureComponent);VA=zi;Ss(zi,"displayName","Bar");Ss(zi,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Ui.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Ss(zi,"getComposedData",function(e){var t=e.props,r=e.item,a=e.barPosition,s=e.bandSize,i=e.xAxis,o=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,x=e.offset,p=tee(a,r);if(!p)return null;var h=t.layout,m=r.type.defaultProps,g=m!==void 0?br(br({},m),r.props):r.props,v=g.dataKey,b=g.children,y=g.minPointSize,N=h==="horizontal"?o:i,j=d?N.scale.domain():null,w=lee({numericAxis:N}),_=Qa(b,u0),S=f.map(function(k,E){var A,P,L,R,I,D;d?A=ree(d[u+E],j):(A=Tr(k,v),Array.isArray(A)||(A=[w,A]));var V=pse(y,VA.defaultProps.minPointSize)(A[1],E);if(h==="horizontal"){var F,U=[o.scale(A[0]),o.scale(A[1])],q=U[0],K=U[1];P=ZS({axis:i,ticks:l,bandSize:s,offset:p.offset,entry:k,index:E}),L=(F=K??q)!==null&&F!==void 0?F:void 0,R=p.size;var T=q-K;if(I=Number.isNaN(T)?0:T,D={x:P,y:o.y,width:R,height:o.height},Math.abs(V)>0&&Math.abs(I)<Math.abs(V)){var O=ca(I||V)*(Math.abs(V)-Math.abs(I));L-=O,I+=O}}else{var W=[i.scale(A[0]),i.scale(A[1])],z=W[0],te=W[1];if(P=z,L=ZS({axis:o,ticks:c,bandSize:s,offset:p.offset,entry:k,index:E}),R=te-z,I=p.size,D={x:i.x,y:L,width:i.width,height:I},Math.abs(V)>0&&Math.abs(R)<Math.abs(V)){var ae=ca(R||V)*(Math.abs(V)-Math.abs(R));R+=ae}}return br(br(br({},k),{},{x:P,y:L,width:R,height:I,value:d?A:A[1],payload:k,background:D},_&&_[E]&&_[E].props),{},{tooltipPayload:[bA(r,k)],tooltipPosition:{x:P+R/2,y:L+I/2}})});return br({data:S,layout:h},x)});function ld(e){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(e)}function Ese(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ak(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,XA(a.key),a)}}function Tse(e,t,r){return t&&Ak(e.prototype,t),r&&Ak(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ck(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function cn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ck(Object(r),!0).forEach(function(a){C0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ck(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function C0(e,t,r){return t=XA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XA(e){var t=Ase(e,"string");return ld(t)=="symbol"?t:t+""}function Ase(e,t){if(ld(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(ld(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YA=function(t,r,a,s,i){var o=t.width,l=t.height,c=t.layout,d=t.children,u=Object.keys(r),f={left:a.left,leftMirror:a.left,right:o-a.right,rightMirror:o-a.right,top:a.top,topMirror:a.top,bottom:l-a.bottom,bottomMirror:l-a.bottom},x=!!ka(d,zi);return u.reduce(function(p,h){var m=r[h],g=m.orientation,v=m.domain,b=m.padding,y=b===void 0?{}:b,N=m.mirror,j=m.reversed,w="".concat(g).concat(N?"Mirror":""),_,S,k,E,A;if(m.type==="number"&&(m.padding==="gap"||m.padding==="no-gap")){var P=v[1]-v[0],L=1/0,R=m.categoricalDomain.sort(Wz);if(R.forEach(function(W,z){z>0&&(L=Math.min((W||0)-(R[z-1]||0),L))}),Number.isFinite(L)){var I=L/P,D=m.layout==="vertical"?a.height:a.width;if(m.padding==="gap"&&(_=I*D/2),m.padding==="no-gap"){var V=da(t.barCategoryGap,I*D),F=I*D/2;_=F-V-(F-V)/D*V}}}s==="xAxis"?S=[a.left+(y.left||0)+(_||0),a.left+a.width-(y.right||0)-(_||0)]:s==="yAxis"?S=c==="horizontal"?[a.top+a.height-(y.bottom||0),a.top+(y.top||0)]:[a.top+(y.top||0)+(_||0),a.top+a.height-(y.bottom||0)-(_||0)]:S=m.range,j&&(S=[S[1],S[0]]);var U=pA(m,i,x),q=U.scale,K=U.realScaleType;q.domain(v).range(S),gA(q);var T=yA(q,cn(cn({},m),{},{realScaleType:K}));s==="xAxis"?(A=g==="top"&&!N||g==="bottom"&&N,k=a.left,E=f[w]-A*m.height):s==="yAxis"&&(A=g==="left"&&!N||g==="right"&&N,k=f[w]-A*m.width,E=a.top);var O=cn(cn(cn({},m),T),{},{realScaleType:K,x:k,y:E,scale:q,width:s==="xAxis"?a.width:m.width,height:s==="yAxis"?a.height:m.height});return O.bandSize=lf(O,T),!m.hide&&s==="xAxis"?f[w]+=(A?-1:1)*O.height:m.hide||(f[w]+=(A?-1:1)*O.width),cn(cn({},p),{},C0({},h,O))},{})},JA=function(t,r){var a=t.x,s=t.y,i=r.x,o=r.y;return{x:Math.min(a,i),y:Math.min(s,o),width:Math.abs(i-a),height:Math.abs(o-s)}},Cse=function(t){var r=t.x1,a=t.y1,s=t.x2,i=t.y2;return JA({x:r,y:a},{x:s,y:i})},QA=(function(){function e(t){Ese(this,e),this.scale=t}return Tse(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=a.bandAware,i=a.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(s){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var a=this.range(),s=a[0],i=a[a.length-1];return s<=i?r>=s&&r<=i:r>=i&&r<=s}}],[{key:"create",value:function(r){return new e(r)}}])})();C0(QA,"EPS",1e-4);var Kb=function(t){var r=Object.keys(t).reduce(function(a,s){return cn(cn({},a),{},C0({},s,QA.create(t[s])))},{});return cn(cn({},r),{},{apply:function(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,l=i.position;return nse(s,function(c,d){return r[d].apply(c,{bandAware:o,position:l})})},isInRange:function(s){return zA(s,function(i,o){return r[o].isInRange(i)})}})};function Pse(e){return(e%180+180)%180}var Ose=function(t){var r=t.width,a=t.height,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=Pse(s),o=i*Math.PI/180,l=Math.atan(a/r),c=o>l&&o<Math.PI-l?a/Math.sin(o):r/Math.cos(o);return Math.abs(c)},tg,Pk;function Ise(){if(Pk)return tg;Pk=1;var e=Mn(),t=_d(),r=l0();function a(s){return function(i,o,l){var c=Object(i);if(!t(i)){var d=e(o,3);i=r(i),o=function(f){return d(c[f],f,c)}}var u=s(i,o,l);return u>-1?c[d?i[u]:u]:void 0}}return tg=a,tg}var rg,Ok;function Fse(){if(Ok)return rg;Ok=1;var e=UA();function t(r){var a=e(r),s=a%1;return a===a?s?a-s:a:0}return rg=t,rg}var ag,Ik;function Dse(){if(Ik)return ag;Ik=1;var e=J6(),t=Mn(),r=Fse(),a=Math.max;function s(i,o,l){var c=i==null?0:i.length;if(!c)return-1;var d=l==null?0:r(l);return d<0&&(d=a(c+d,0)),e(i,t(o,3),d)}return ag=s,ag}var ng,Fk;function Rse(){if(Fk)return ng;Fk=1;var e=Ise(),t=Dse(),r=e(t);return ng=r,ng}var Mse=Rse();const Lse=Ct(Mse);var $se=h6();const Bse=Ct($se);var Use=Bse(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),Xb=C.createContext(void 0),Yb=C.createContext(void 0),ZA=C.createContext(void 0),eC=C.createContext({}),tC=C.createContext(void 0),rC=C.createContext(0),aC=C.createContext(0),Dk=function(t){var r=t.state,a=r.xAxisMap,s=r.yAxisMap,i=r.offset,o=t.clipPathId,l=t.children,c=t.width,d=t.height,u=Use(i);return ee.createElement(Xb.Provider,{value:a},ee.createElement(Yb.Provider,{value:s},ee.createElement(eC.Provider,{value:i},ee.createElement(ZA.Provider,{value:u},ee.createElement(tC.Provider,{value:o},ee.createElement(rC.Provider,{value:d},ee.createElement(aC.Provider,{value:c},l)))))))},qse=function(){return C.useContext(tC)},nC=function(t){var r=C.useContext(Xb);r==null&&Pi();var a=r[t];return a==null&&Pi(),a},Wse=function(){var t=C.useContext(Xb);return bs(t)},Hse=function(){var t=C.useContext(Yb),r=Lse(t,function(a){return zA(a.domain,Number.isFinite)});return r||bs(t)},sC=function(t){var r=C.useContext(Yb);r==null&&Pi();var a=r[t];return a==null&&Pi(),a},zse=function(){var t=C.useContext(ZA);return t},Vse=function(){return C.useContext(eC)},Jb=function(){return C.useContext(aC)},Qb=function(){return C.useContext(rC)};function Go(e){"@babel/helpers - typeof";return Go=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Go(e)}function Gse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kse(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,oC(a.key),a)}}function Xse(e,t,r){return t&&Kse(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yse(e,t,r){return t=Sf(t),Jse(e,iC()?Reflect.construct(t,r||[],Sf(e).constructor):t.apply(e,r))}function Jse(e,t){if(t&&(Go(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qse(e)}function Qse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iC=function(){return!!e})()}function Sf(e){return Sf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sf(e)}function Zse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&By(e,t)}function By(e,t){return By=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},By(e,t)}function Rk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Mk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rk(Object(r),!0).forEach(function(a){Zb(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rk(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Zb(e,t,r){return t=oC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oC(e){var t=eie(e,"string");return Go(t)=="symbol"?t:t+""}function eie(e,t){if(Go(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Go(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function tie(e,t){return sie(e)||nie(e,t)||aie(e,t)||rie()}function rie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aie(e,t){if(e){if(typeof e=="string")return Lk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lk(e,t)}}function Lk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function nie(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function sie(e){if(Array.isArray(e))return e}function Uy(){return Uy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Uy.apply(this,arguments)}var iie=function(t,r){var a;return ee.isValidElement(t)?a=ee.cloneElement(t,r):qe(t)?a=t(r):a=ee.createElement("line",Uy({},r,{className:"recharts-reference-line-line"})),a},oie=function(t,r,a,s,i,o,l,c,d){var u=i.x,f=i.y,x=i.width,p=i.height;if(a){var h=d.y,m=t.y.apply(h,{position:o});if(Tn(d,"discard")&&!t.y.isInRange(m))return null;var g=[{x:u+x,y:m},{x:u,y:m}];return c==="left"?g.reverse():g}if(r){var v=d.x,b=t.x.apply(v,{position:o});if(Tn(d,"discard")&&!t.x.isInRange(b))return null;var y=[{x:b,y:f+p},{x:b,y:f}];return l==="top"?y.reverse():y}if(s){var N=d.segment,j=N.map(function(w){return t.apply(w,{position:o})});return Tn(d,"discard")&&ese(j,function(w){return!t.isInRange(w)})?null:j}return null};function lie(e){var t=e.x,r=e.y,a=e.segment,s=e.xAxisId,i=e.yAxisId,o=e.shape,l=e.className,c=e.alwaysShow,d=qse(),u=nC(s),f=sC(i),x=zse();if(!d||!x)return null;pn(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=Kb({x:u.scale,y:f.scale}),h=Ar(t),m=Ar(r),g=a&&a.length===2,v=oie(p,h,m,g,x,e.position,u.orientation,f.orientation,e);if(!v)return null;var b=tie(v,2),y=b[0],N=y.x,j=y.y,w=b[1],_=w.x,S=w.y,k=Tn(e,"hidden")?"url(#".concat(d,")"):void 0,E=Mk(Mk({clipPath:k},Re(e,!0)),{},{x1:N,y1:j,x2:_,y2:S});return ee.createElement(ht,{className:tt("recharts-reference-line",l)},iie(o,E),Dr.renderCallByParent(e,Cse({x1:N,y1:j,x2:_,y2:S})))}var e1=(function(e){function t(){return Gse(this,t),Yse(this,t,arguments)}return Zse(t,e),Xse(t,[{key:"render",value:function(){return ee.createElement(lie,this.props)}}])})(ee.Component);Zb(e1,"displayName","ReferenceLine");Zb(e1,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function qy(){return qy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},qy.apply(this,arguments)}function Ko(e){"@babel/helpers - typeof";return Ko=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ko(e)}function $k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Bk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$k(Object(r),!0).forEach(function(a){P0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$k(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function cie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function die(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,cC(a.key),a)}}function uie(e,t,r){return t&&die(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function fie(e,t,r){return t=kf(t),hie(e,lC()?Reflect.construct(t,r||[],kf(e).constructor):t.apply(e,r))}function hie(e,t){if(t&&(Ko(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mie(e)}function mie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lC=function(){return!!e})()}function kf(e){return kf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kf(e)}function xie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wy(e,t)}function Wy(e,t){return Wy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Wy(e,t)}function P0(e,t,r){return t=cC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cC(e){var t=pie(e,"string");return Ko(t)=="symbol"?t:t+""}function pie(e,t){if(Ko(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Ko(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var gie=function(t){var r=t.x,a=t.y,s=t.xAxis,i=t.yAxis,o=Kb({x:s.scale,y:i.scale}),l=o.apply({x:r,y:a},{bandAware:!0});return Tn(t,"discard")&&!o.isInRange(l)?null:l},O0=(function(e){function t(){return cie(this,t),fie(this,t,arguments)}return xie(t,e),uie(t,[{key:"render",value:function(){var a=this.props,s=a.x,i=a.y,o=a.r,l=a.alwaysShow,c=a.clipPathId,d=Ar(s),u=Ar(i);if(pn(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!d||!u)return null;var f=gie(this.props);if(!f)return null;var x=f.x,p=f.y,h=this.props,m=h.shape,g=h.className,v=Tn(this.props,"hidden")?"url(#".concat(c,")"):void 0,b=Bk(Bk({clipPath:v},Re(this.props,!0)),{},{cx:x,cy:p});return ee.createElement(ht,{className:tt("recharts-reference-dot",g)},t.renderDot(m,b),Dr.renderCallByParent(this.props,{x:x-o,y:p-o,width:2*o,height:2*o}))}}])})(ee.Component);P0(O0,"displayName","ReferenceDot");P0(O0,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});P0(O0,"renderDot",function(e,t){var r;return ee.isValidElement(e)?r=ee.cloneElement(e,t):qe(e)?r=e(t):r=ee.createElement(N0,qy({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function Hy(){return Hy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Hy.apply(this,arguments)}function Xo(e){"@babel/helpers - typeof";return Xo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xo(e)}function Uk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function qk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Uk(Object(r),!0).forEach(function(a){I0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uk(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function yie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vie(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,uC(a.key),a)}}function bie(e,t,r){return t&&vie(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jie(e,t,r){return t=Ef(t),wie(e,dC()?Reflect.construct(t,r||[],Ef(e).constructor):t.apply(e,r))}function wie(e,t){if(t&&(Xo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nie(e)}function Nie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dC=function(){return!!e})()}function Ef(e){return Ef=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ef(e)}function _ie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zy(e,t)}function zy(e,t){return zy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},zy(e,t)}function I0(e,t,r){return t=uC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uC(e){var t=Sie(e,"string");return Xo(t)=="symbol"?t:t+""}function Sie(e,t){if(Xo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Xo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var kie=function(t,r,a,s,i){var o=i.x1,l=i.x2,c=i.y1,d=i.y2,u=i.xAxis,f=i.yAxis;if(!u||!f)return null;var x=Kb({x:u.scale,y:f.scale}),p={x:t?x.x.apply(o,{position:"start"}):x.x.rangeMin,y:a?x.y.apply(c,{position:"start"}):x.y.rangeMin},h={x:r?x.x.apply(l,{position:"end"}):x.x.rangeMax,y:s?x.y.apply(d,{position:"end"}):x.y.rangeMax};return Tn(i,"discard")&&(!x.isInRange(p)||!x.isInRange(h))?null:JA(p,h)},F0=(function(e){function t(){return yie(this,t),jie(this,t,arguments)}return _ie(t,e),bie(t,[{key:"render",value:function(){var a=this.props,s=a.x1,i=a.x2,o=a.y1,l=a.y2,c=a.className,d=a.alwaysShow,u=a.clipPathId;pn(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=Ar(s),x=Ar(i),p=Ar(o),h=Ar(l),m=this.props.shape;if(!f&&!x&&!p&&!h&&!m)return null;var g=kie(f,x,p,h,this.props);if(!g&&!m)return null;var v=Tn(this.props,"hidden")?"url(#".concat(u,")"):void 0;return ee.createElement(ht,{className:tt("recharts-reference-area",c)},t.renderRect(m,qk(qk({clipPath:v},Re(this.props,!0)),g)),Dr.renderCallByParent(this.props,g))}}])})(ee.Component);I0(F0,"displayName","ReferenceArea");I0(F0,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});I0(F0,"renderRect",function(e,t){var r;return ee.isValidElement(e)?r=ee.cloneElement(e,t):qe(e)?r=e(t):r=ee.createElement(Gb,Hy({},t,{className:"recharts-reference-area-rect"})),r});function fC(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var a=[],s=0;s<e.length;s+=t)a.push(e[s]);return a}function Eie(e,t,r){var a={width:e.width+t.width,height:e.height+t.height};return Ose(a,r)}function Tie(e,t,r){var a=r==="width",s=e.x,i=e.y,o=e.width,l=e.height;return t===1?{start:a?s:i,end:a?s+o:i+l}:{start:a?s+o:i+l,end:a?s:i}}function Tf(e,t,r,a,s){if(e*t<e*a||e*t>e*s)return!1;var i=r();return e*(t-e*i/2-a)>=0&&e*(t+e*i/2-s)<=0}function Aie(e,t){return fC(e,t+1)}function Cie(e,t,r,a,s){for(var i=(a||[]).slice(),o=t.start,l=t.end,c=0,d=1,u=o,f=function(){var h=a==null?void 0:a[c];if(h===void 0)return{v:fC(a,d)};var m=c,g,v=function(){return g===void 0&&(g=r(h,m)),g},b=h.coordinate,y=c===0||Tf(e,b,v,u,l);y||(c=0,u=o,d+=1),y&&(u=b+e*(v()/2+s),c+=d)},x;d<=i.length;)if(x=f(),x)return x.v;return[]}function cd(e){"@babel/helpers - typeof";return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cd(e)}function Wk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Kr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wk(Object(r),!0).forEach(function(a){Pie(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wk(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Pie(e,t,r){return t=Oie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oie(e){var t=Iie(e,"string");return cd(t)=="symbol"?t:t+""}function Iie(e,t){if(cd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(cd(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fie(e,t,r,a,s){for(var i=(a||[]).slice(),o=i.length,l=t.start,c=t.end,d=function(x){var p=i[x],h,m=function(){return h===void 0&&(h=r(p,x)),h};if(x===o-1){var g=e*(p.coordinate+e*m()/2-c);i[x]=p=Kr(Kr({},p),{},{tickCoord:g>0?p.coordinate-g*e:p.coordinate})}else i[x]=p=Kr(Kr({},p),{},{tickCoord:p.coordinate});var v=Tf(e,p.tickCoord,m,l,c);v&&(c=p.tickCoord-e*(m()/2+s),i[x]=Kr(Kr({},p),{},{isShow:!0}))},u=o-1;u>=0;u--)d(u);return i}function Die(e,t,r,a,s,i){var o=(a||[]).slice(),l=o.length,c=t.start,d=t.end;if(i){var u=a[l-1],f=r(u,l-1),x=e*(u.coordinate+e*f/2-d);o[l-1]=u=Kr(Kr({},u),{},{tickCoord:x>0?u.coordinate-x*e:u.coordinate});var p=Tf(e,u.tickCoord,function(){return f},c,d);p&&(d=u.tickCoord-e*(f/2+s),o[l-1]=Kr(Kr({},u),{},{isShow:!0}))}for(var h=i?l-1:l,m=function(b){var y=o[b],N,j=function(){return N===void 0&&(N=r(y,b)),N};if(b===0){var w=e*(y.coordinate-e*j()/2-c);o[b]=y=Kr(Kr({},y),{},{tickCoord:w<0?y.coordinate-w*e:y.coordinate})}else o[b]=y=Kr(Kr({},y),{},{tickCoord:y.coordinate});var _=Tf(e,y.tickCoord,j,c,d);_&&(c=y.tickCoord+e*(j()/2+s),o[b]=Kr(Kr({},y),{},{isShow:!0}))},g=0;g<h;g++)m(g);return o}function t1(e,t,r){var a=e.tick,s=e.ticks,i=e.viewBox,o=e.minTickGap,l=e.orientation,c=e.interval,d=e.tickFormatter,u=e.unit,f=e.angle;if(!s||!s.length||!a)return[];if(be(c)||Ui.isSsr)return Aie(s,typeof c=="number"&&be(c)?c:0);var x=[],p=l==="top"||l==="bottom"?"width":"height",h=u&&p==="width"?ic(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},m=function(y,N){var j=qe(d)?d(y.value,N):y.value;return p==="width"?Eie(ic(j,{fontSize:t,letterSpacing:r}),h,f):ic(j,{fontSize:t,letterSpacing:r})[p]},g=s.length>=2?ca(s[1].coordinate-s[0].coordinate):1,v=Tie(i,g,p);return c==="equidistantPreserveStart"?Cie(g,v,m,s,o):(c==="preserveStart"||c==="preserveStartEnd"?x=Die(g,v,m,s,o,c==="preserveStartEnd"):x=Fie(g,v,m,s,o),x.filter(function(b){return b.isShow}))}var Rie=["viewBox"],Mie=["viewBox"],Lie=["ticks"];function Yo(e){"@babel/helpers - typeof";return Yo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yo(e)}function co(){return co=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},co.apply(this,arguments)}function Hk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Sr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hk(Object(r),!0).forEach(function(a){r1(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hk(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function sg(e,t){if(e==null)return{};var r=$ie(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function $ie(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function Bie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zk(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,mC(a.key),a)}}function Uie(e,t,r){return t&&zk(e.prototype,t),r&&zk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qie(e,t,r){return t=Af(t),Wie(e,hC()?Reflect.construct(t,r||[],Af(e).constructor):t.apply(e,r))}function Wie(e,t){if(t&&(Yo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hie(e)}function Hie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hC=function(){return!!e})()}function Af(e){return Af=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Af(e)}function zie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vy(e,t)}function Vy(e,t){return Vy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Vy(e,t)}function r1(e,t,r){return t=mC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mC(e){var t=Vie(e,"string");return Yo(t)=="symbol"?t:t+""}function Vie(e,t){if(Yo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Yo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var bl=(function(e){function t(r){var a;return Bie(this,t),a=qie(this,t,[r]),a.state={fontSize:"",letterSpacing:""},a}return zie(t,e),Uie(t,[{key:"shouldComponentUpdate",value:function(a,s){var i=a.viewBox,o=sg(a,Rie),l=this.props,c=l.viewBox,d=sg(l,Mie);return!po(i,c)||!po(o,d)||!po(s,this.state)}},{key:"componentDidMount",value:function(){var a=this.layerReference;if(a){var s=a.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];s&&this.setState({fontSize:window.getComputedStyle(s).fontSize,letterSpacing:window.getComputedStyle(s).letterSpacing})}}},{key:"getTickLineCoord",value:function(a){var s=this.props,i=s.x,o=s.y,l=s.width,c=s.height,d=s.orientation,u=s.tickSize,f=s.mirror,x=s.tickMargin,p,h,m,g,v,b,y=f?-1:1,N=a.tickSize||u,j=be(a.tickCoord)?a.tickCoord:a.coordinate;switch(d){case"top":p=h=a.coordinate,g=o+ +!f*c,m=g-y*N,b=m-y*x,v=j;break;case"left":m=g=a.coordinate,h=i+ +!f*l,p=h-y*N,v=p-y*x,b=j;break;case"right":m=g=a.coordinate,h=i+ +f*l,p=h+y*N,v=p+y*x,b=j;break;default:p=h=a.coordinate,g=o+ +f*c,m=g+y*N,b=m+y*x,v=j;break}return{line:{x1:p,y1:m,x2:h,y2:g},tick:{x:v,y:b}}}},{key:"getTickTextAnchor",value:function(){var a=this.props,s=a.orientation,i=a.mirror,o;switch(s){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var a=this.props,s=a.orientation,i=a.mirror,o="end";switch(s){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var a=this.props,s=a.x,i=a.y,o=a.width,l=a.height,c=a.orientation,d=a.mirror,u=a.axisLine,f=Sr(Sr(Sr({},Re(this.props,!1)),Re(u,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var x=+(c==="top"&&!d||c==="bottom"&&d);f=Sr(Sr({},f),{},{x1:s,y1:i+x*l,x2:s+o,y2:i+x*l})}else{var p=+(c==="left"&&!d||c==="right"&&d);f=Sr(Sr({},f),{},{x1:s+p*o,y1:i,x2:s+p*o,y2:i+l})}return ee.createElement("line",co({},f,{className:tt("recharts-cartesian-axis-line",Oa(u,"className"))}))}},{key:"renderTicks",value:function(a,s,i){var o=this,l=this.props,c=l.tickLine,d=l.stroke,u=l.tick,f=l.tickFormatter,x=l.unit,p=t1(Sr(Sr({},this.props),{},{ticks:a}),s,i),h=this.getTickTextAnchor(),m=this.getTickVerticalAnchor(),g=Re(this.props,!1),v=Re(u,!1),b=Sr(Sr({},g),{},{fill:"none"},Re(c,!1)),y=p.map(function(N,j){var w=o.getTickLineCoord(N),_=w.line,S=w.tick,k=Sr(Sr(Sr(Sr({textAnchor:h,verticalAnchor:m},g),{},{stroke:"none",fill:d},v),S),{},{index:j,payload:N,visibleTicksCount:p.length,tickFormatter:f});return ee.createElement(ht,co({className:"recharts-cartesian-axis-tick",key:"tick-".concat(N.value,"-").concat(N.coordinate,"-").concat(N.tickCoord)},Ti(o.props,N,j)),c&&ee.createElement("line",co({},b,_,{className:tt("recharts-cartesian-axis-tick-line",Oa(c,"className"))})),u&&t.renderTickItem(u,k,"".concat(qe(f)?f(N.value,j):N.value).concat(x||"")))});return ee.createElement("g",{className:"recharts-cartesian-axis-ticks"},y)}},{key:"render",value:function(){var a=this,s=this.props,i=s.axisLine,o=s.width,l=s.height,c=s.ticksGenerator,d=s.className,u=s.hide;if(u)return null;var f=this.props,x=f.ticks,p=sg(f,Lie),h=x;return qe(c)&&(h=x&&x.length>0?c(this.props):c(p)),o<=0||l<=0||!h||!h.length?null:ee.createElement(ht,{className:tt("recharts-cartesian-axis",d),ref:function(g){a.layerReference=g}},i&&this.renderAxisLine(),this.renderTicks(h,this.state.fontSize,this.state.letterSpacing),Dr.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(a,s,i){var o,l=tt(s.className,"recharts-cartesian-axis-tick-value");return ee.isValidElement(a)?o=ee.cloneElement(a,Sr(Sr({},s),{},{className:l})):qe(a)?o=a(Sr(Sr({},s),{},{className:l})):o=ee.createElement(Ai,co({},s,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])})(C.Component);r1(bl,"displayName","CartesianAxis");r1(bl,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Gie=["x1","y1","x2","y2","key"],Kie=["offset"];function Oi(e){"@babel/helpers - typeof";return Oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oi(e)}function Vk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Qr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vk(Object(r),!0).forEach(function(a){Xie(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vk(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Xie(e,t,r){return t=Yie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yie(e){var t=Jie(e,"string");return Oi(t)=="symbol"?t:t+""}function Jie(e,t){if(Oi(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Oi(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oi(){return oi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},oi.apply(this,arguments)}function Gk(e,t){if(e==null)return{};var r=Qie(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function Qie(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}var Zie=function(t){var r=t.fill;if(!r||r==="none")return null;var a=t.fillOpacity,s=t.x,i=t.y,o=t.width,l=t.height,c=t.ry;return ee.createElement("rect",{x:s,y:i,ry:c,width:o,height:l,stroke:"none",fill:r,fillOpacity:a,className:"recharts-cartesian-grid-bg"})};function xC(e,t){var r;if(ee.isValidElement(e))r=ee.cloneElement(e,t);else if(qe(e))r=e(t);else{var a=t.x1,s=t.y1,i=t.x2,o=t.y2,l=t.key,c=Gk(t,Gie),d=Re(c,!1);d.offset;var u=Gk(d,Kie);r=ee.createElement("line",oi({},u,{x1:a,y1:s,x2:i,y2:o,fill:"none",key:l}))}return r}function eoe(e){var t=e.x,r=e.width,a=e.horizontal,s=a===void 0?!0:a,i=e.horizontalPoints;if(!s||!i||!i.length)return null;var o=i.map(function(l,c){var d=Qr(Qr({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return xC(s,d)});return ee.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function toe(e){var t=e.y,r=e.height,a=e.vertical,s=a===void 0?!0:a,i=e.verticalPoints;if(!s||!i||!i.length)return null;var o=i.map(function(l,c){var d=Qr(Qr({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return xC(s,d)});return ee.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function roe(e){var t=e.horizontalFill,r=e.fillOpacity,a=e.x,s=e.y,i=e.width,o=e.height,l=e.horizontalPoints,c=e.horizontal,d=c===void 0?!0:c;if(!d||!t||!t.length)return null;var u=l.map(function(x){return Math.round(x+s-s)}).sort(function(x,p){return x-p});s!==u[0]&&u.unshift(0);var f=u.map(function(x,p){var h=!u[p+1],m=h?s+o-x:u[p+1]-x;if(m<=0)return null;var g=p%t.length;return ee.createElement("rect",{key:"react-".concat(p),y:x,x:a,height:m,width:i,stroke:"none",fill:t[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return ee.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function aoe(e){var t=e.vertical,r=t===void 0?!0:t,a=e.verticalFill,s=e.fillOpacity,i=e.x,o=e.y,l=e.width,c=e.height,d=e.verticalPoints;if(!r||!a||!a.length)return null;var u=d.map(function(x){return Math.round(x+i-i)}).sort(function(x,p){return x-p});i!==u[0]&&u.unshift(0);var f=u.map(function(x,p){var h=!u[p+1],m=h?i+l-x:u[p+1]-x;if(m<=0)return null;var g=p%a.length;return ee.createElement("rect",{key:"react-".concat(p),x,y:o,width:m,height:c,stroke:"none",fill:a[g],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return ee.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var noe=function(t,r){var a=t.xAxis,s=t.width,i=t.height,o=t.offset;return xA(t1(Qr(Qr(Qr({},bl.defaultProps),a),{},{ticks:Xn(a,!0),viewBox:{x:0,y:0,width:s,height:i}})),o.left,o.left+o.width,r)},soe=function(t,r){var a=t.yAxis,s=t.width,i=t.height,o=t.offset;return xA(t1(Qr(Qr(Qr({},bl.defaultProps),a),{},{ticks:Xn(a,!0),viewBox:{x:0,y:0,width:s,height:i}})),o.top,o.top+o.height,r)},ro={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Gy(e){var t,r,a,s,i,o,l=Jb(),c=Qb(),d=Vse(),u=Qr(Qr({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:ro.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:ro.fill,horizontal:(a=e.horizontal)!==null&&a!==void 0?a:ro.horizontal,horizontalFill:(s=e.horizontalFill)!==null&&s!==void 0?s:ro.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:ro.vertical,verticalFill:(o=e.verticalFill)!==null&&o!==void 0?o:ro.verticalFill,x:be(e.x)?e.x:d.left,y:be(e.y)?e.y:d.top,width:be(e.width)?e.width:d.width,height:be(e.height)?e.height:d.height}),f=u.x,x=u.y,p=u.width,h=u.height,m=u.syncWithTicks,g=u.horizontalValues,v=u.verticalValues,b=Wse(),y=Hse();if(!be(p)||p<=0||!be(h)||h<=0||!be(f)||f!==+f||!be(x)||x!==+x)return null;var N=u.verticalCoordinatesGenerator||noe,j=u.horizontalCoordinatesGenerator||soe,w=u.horizontalPoints,_=u.verticalPoints;if((!w||!w.length)&&qe(j)){var S=g&&g.length,k=j({yAxis:y?Qr(Qr({},y),{},{ticks:S?g:y.ticks}):void 0,width:l,height:c,offset:d},S?!0:m);pn(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Oi(k),"]")),Array.isArray(k)&&(w=k)}if((!_||!_.length)&&qe(N)){var E=v&&v.length,A=N({xAxis:b?Qr(Qr({},b),{},{ticks:E?v:b.ticks}):void 0,width:l,height:c,offset:d},E?!0:m);pn(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Oi(A),"]")),Array.isArray(A)&&(_=A)}return ee.createElement("g",{className:"recharts-cartesian-grid"},ee.createElement(Zie,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),ee.createElement(eoe,oi({},u,{offset:d,horizontalPoints:w,xAxis:b,yAxis:y})),ee.createElement(toe,oi({},u,{offset:d,verticalPoints:_,xAxis:b,yAxis:y})),ee.createElement(roe,oi({},u,{horizontalPoints:w})),ee.createElement(aoe,oi({},u,{verticalPoints:_})))}Gy.displayName="CartesianGrid";var ioe=["layout","type","stroke","connectNulls","isRange","ref"],ooe=["key"],pC;function Jo(e){"@babel/helpers - typeof";return Jo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jo(e)}function gC(e,t){if(e==null)return{};var r=loe(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function loe(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function li(){return li=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},li.apply(this,arguments)}function Kk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ys(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Kk(Object(r),!0).forEach(function(a){kn(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kk(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function coe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xk(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,vC(a.key),a)}}function doe(e,t,r){return t&&Xk(e.prototype,t),r&&Xk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uoe(e,t,r){return t=Cf(t),foe(e,yC()?Reflect.construct(t,r||[],Cf(e).constructor):t.apply(e,r))}function foe(e,t){if(t&&(Jo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hoe(e)}function hoe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yC=function(){return!!e})()}function Cf(e){return Cf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cf(e)}function moe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ky(e,t)}function Ky(e,t){return Ky=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Ky(e,t)}function kn(e,t,r){return t=vC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vC(e){var t=xoe(e,"string");return Jo(t)=="symbol"?t:t+""}function xoe(e,t){if(Jo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Jo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var os=(function(e){function t(){var r;coe(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return r=uoe(this,t,[].concat(s)),kn(r,"state",{isAnimationFinished:!0}),kn(r,"id",xl("recharts-area-")),kn(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),qe(o)&&o()}),kn(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),qe(o)&&o()}),r}return moe(t,e),doe(t,[{key:"renderDots",value:function(a,s,i){var o=this.props.isAnimationActive,l=this.state.isAnimationFinished;if(o&&!l)return null;var c=this.props,d=c.dot,u=c.points,f=c.dataKey,x=Re(this.props,!1),p=Re(d,!0),h=u.map(function(g,v){var b=ys(ys(ys({key:"dot-".concat(v),r:3},x),p),{},{index:v,cx:g.x,cy:g.y,dataKey:f,value:g.value,payload:g.payload,points:u});return t.renderDotItem(d,b)}),m={clipPath:a?"url(#clipPath-".concat(s?"":"dots-").concat(i,")"):null};return ee.createElement(ht,li({className:"recharts-area-dots"},m),h)}},{key:"renderHorizontalRect",value:function(a){var s=this.props,i=s.baseLine,o=s.points,l=s.strokeWidth,c=o[0].x,d=o[o.length-1].x,u=a*Math.abs(c-d),f=_s(o.map(function(x){return x.y||0}));return be(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(_s(i.map(function(x){return x.y||0})),f)),be(f)?ee.createElement("rect",{x:c<d?c:c-u,y:0,width:u,height:Math.floor(f+(l?parseInt("".concat(l),10):1))}):null}},{key:"renderVerticalRect",value:function(a){var s=this.props,i=s.baseLine,o=s.points,l=s.strokeWidth,c=o[0].y,d=o[o.length-1].y,u=a*Math.abs(c-d),f=_s(o.map(function(x){return x.x||0}));return be(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(_s(i.map(function(x){return x.x||0})),f)),be(f)?ee.createElement("rect",{x:0,y:c<d?c:c-u,width:f+(l?parseInt("".concat(l),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(a){var s=this.props.layout;return s==="vertical"?this.renderVerticalRect(a):this.renderHorizontalRect(a)}},{key:"renderAreaStatically",value:function(a,s,i,o){var l=this.props,c=l.layout,d=l.type,u=l.stroke,f=l.connectNulls,x=l.isRange;l.ref;var p=gC(l,ioe);return ee.createElement(ht,{clipPath:i?"url(#clipPath-".concat(o,")"):null},ee.createElement(bo,li({},Re(p,!0),{points:a,connectNulls:f,type:d,baseLine:s,layout:c,stroke:"none",className:"recharts-area-area"})),u!=="none"&&ee.createElement(bo,li({},Re(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:a})),u!=="none"&&x&&ee.createElement(bo,li({},Re(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:s})))}},{key:"renderAreaWithAnimation",value:function(a,s){var i=this,o=this.props,l=o.points,c=o.baseLine,d=o.isAnimationActive,u=o.animationBegin,f=o.animationDuration,x=o.animationEasing,p=o.animationId,h=this.state,m=h.prevPoints,g=h.prevBaseLine;return ee.createElement(In,{begin:u,duration:f,isActive:d,easing:x,from:{t:0},to:{t:1},key:"area-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(v){var b=v.t;if(m){var y=m.length/l.length,N=l.map(function(S,k){var E=Math.floor(k*y);if(m[E]){var A=m[E],P=ga(A.x,S.x),L=ga(A.y,S.y);return ys(ys({},S),{},{x:P(b),y:L(b)})}return S}),j;if(be(c)&&typeof c=="number"){var w=ga(g,c);j=w(b)}else if(Je(c)||ml(c)){var _=ga(g,0);j=_(b)}else j=c.map(function(S,k){var E=Math.floor(k*y);if(g[E]){var A=g[E],P=ga(A.x,S.x),L=ga(A.y,S.y);return ys(ys({},S),{},{x:P(b),y:L(b)})}return S});return i.renderAreaStatically(N,j,a,s)}return ee.createElement(ht,null,ee.createElement("defs",null,ee.createElement("clipPath",{id:"animationClipPath-".concat(s)},i.renderClipRect(b))),ee.createElement(ht,{clipPath:"url(#animationClipPath-".concat(s,")")},i.renderAreaStatically(l,c,a,s)))})}},{key:"renderArea",value:function(a,s){var i=this.props,o=i.points,l=i.baseLine,c=i.isAnimationActive,d=this.state,u=d.prevPoints,f=d.prevBaseLine,x=d.totalLength;return c&&o&&o.length&&(!u&&x>0||!Lo(u,o)||!Lo(f,l))?this.renderAreaWithAnimation(a,s):this.renderAreaStatically(o,l,a,s)}},{key:"render",value:function(){var a,s=this.props,i=s.hide,o=s.dot,l=s.points,c=s.className,d=s.top,u=s.left,f=s.xAxis,x=s.yAxis,p=s.width,h=s.height,m=s.isAnimationActive,g=s.id;if(i||!l||!l.length)return null;var v=this.state.isAnimationFinished,b=l.length===1,y=tt("recharts-area",c),N=f&&f.allowDataOverflow,j=x&&x.allowDataOverflow,w=N||j,_=Je(g)?this.id:g,S=(a=Re(o,!1))!==null&&a!==void 0?a:{r:3,strokeWidth:2},k=S.r,E=k===void 0?3:k,A=S.strokeWidth,P=A===void 0?2:A,L=Qz(o)?o:{},R=L.clipDot,I=R===void 0?!0:R,D=E*2+P;return ee.createElement(ht,{className:y},N||j?ee.createElement("defs",null,ee.createElement("clipPath",{id:"clipPath-".concat(_)},ee.createElement("rect",{x:N?u:u-p/2,y:j?d:d-h/2,width:N?p:p*2,height:j?h:h*2})),!I&&ee.createElement("clipPath",{id:"clipPath-dots-".concat(_)},ee.createElement("rect",{x:u-D/2,y:d-D/2,width:p+D,height:h+D}))):null,b?null:this.renderArea(w,_),(o||b)&&this.renderDots(w,I,_),(!m||v)&&rs.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(a,s){return a.animationId!==s.prevAnimationId?{prevAnimationId:a.animationId,curPoints:a.points,curBaseLine:a.baseLine,prevPoints:s.curPoints,prevBaseLine:s.curBaseLine}:a.points!==s.curPoints||a.baseLine!==s.curBaseLine?{curPoints:a.points,curBaseLine:a.baseLine}:null}}])})(C.PureComponent);pC=os;kn(os,"displayName","Area");kn(os,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Ui.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});kn(os,"getBaseValue",function(e,t,r,a){var s=e.layout,i=e.baseValue,o=t.props.baseValue,l=o??i;if(be(l)&&typeof l=="number")return l;var c=s==="horizontal"?a:r,d=c.scale.domain();if(c.type==="number"){var u=Math.max(d[0],d[1]),f=Math.min(d[0],d[1]);return l==="dataMin"?f:l==="dataMax"||u<0?u:Math.max(Math.min(d[0],d[1]),0)}return l==="dataMin"?d[0]:l==="dataMax"?d[1]:d[0]});kn(os,"getComposedData",function(e){var t=e.props,r=e.item,a=e.xAxis,s=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,l=e.bandSize,c=e.dataKey,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,x=e.offset,p=t.layout,h=d&&d.length,m=pC.getBaseValue(t,r,a,s),g=p==="horizontal",v=!1,b=f.map(function(N,j){var w;h?w=d[u+j]:(w=Tr(N,c),Array.isArray(w)?v=!0:w=[m,w]);var _=w[1]==null||h&&Tr(N,c)==null;return g?{x:QS({axis:a,ticks:i,bandSize:l,entry:N,index:j}),y:_?null:s.scale(w[1]),value:w,payload:N}:{x:_?null:a.scale(w[1]),y:QS({axis:s,ticks:o,bandSize:l,entry:N,index:j}),value:w,payload:N}}),y;return h||v?y=b.map(function(N){var j=Array.isArray(N.value)?N.value[0]:null;return g?{x:N.x,y:j!=null&&N.y!=null?s.scale(j):null}:{x:j!=null?a.scale(j):null,y:N.y}}):y=g?s.scale(m):a.scale(m),ys({points:b,baseLine:y,layout:p,isRange:v},x)});kn(os,"renderDotItem",function(e,t){var r;if(ee.isValidElement(e))r=ee.cloneElement(e,t);else if(qe(e))r=e(t);else{var a=tt("recharts-area-dot",typeof e!="boolean"?e.className:""),s=t.key,i=gC(t,ooe);r=ee.createElement(N0,li({},i,{key:s,className:a}))}return r});function Qo(e){"@babel/helpers - typeof";return Qo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qo(e)}function poe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function goe(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,wC(a.key),a)}}function yoe(e,t,r){return t&&goe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function voe(e,t,r){return t=Pf(t),boe(e,bC()?Reflect.construct(t,r||[],Pf(e).constructor):t.apply(e,r))}function boe(e,t){if(t&&(Qo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return joe(e)}function joe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bC=function(){return!!e})()}function Pf(e){return Pf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pf(e)}function woe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xy(e,t)}function Xy(e,t){return Xy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Xy(e,t)}function jC(e,t,r){return t=wC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wC(e){var t=Noe(e,"string");return Qo(t)=="symbol"?t:t+""}function Noe(e,t){if(Qo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Qo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Yy(){return Yy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Yy.apply(this,arguments)}function _oe(e){var t=e.xAxisId,r=Jb(),a=Qb(),s=nC(t);return s==null?null:C.createElement(bl,Yy({},s,{className:tt("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:r,height:a},ticksGenerator:function(o){return Xn(o,!0)}}))}var Zo=(function(e){function t(){return poe(this,t),voe(this,t,arguments)}return woe(t,e),yoe(t,[{key:"render",value:function(){return C.createElement(_oe,this.props)}}])})(C.Component);jC(Zo,"displayName","XAxis");jC(Zo,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function el(e){"@babel/helpers - typeof";return el=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},el(e)}function Soe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function koe(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,SC(a.key),a)}}function Eoe(e,t,r){return t&&koe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Toe(e,t,r){return t=Of(t),Aoe(e,NC()?Reflect.construct(t,r||[],Of(e).constructor):t.apply(e,r))}function Aoe(e,t){if(t&&(el(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Coe(e)}function Coe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NC=function(){return!!e})()}function Of(e){return Of=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Of(e)}function Poe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jy(e,t)}function Jy(e,t){return Jy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Jy(e,t)}function _C(e,t,r){return t=SC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SC(e){var t=Ooe(e,"string");return el(t)=="symbol"?t:t+""}function Ooe(e,t){if(el(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(el(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Qy(){return Qy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Qy.apply(this,arguments)}var Ioe=function(t){var r=t.yAxisId,a=Jb(),s=Qb(),i=sC(r);return i==null?null:C.createElement(bl,Qy({},i,{className:tt("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:a,height:s},ticksGenerator:function(l){return Xn(l,!0)}}))},tl=(function(e){function t(){return Soe(this,t),Toe(this,t,arguments)}return Poe(t,e),Eoe(t,[{key:"render",value:function(){return C.createElement(Ioe,this.props)}}])})(C.Component);_C(tl,"displayName","YAxis");_C(tl,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function Yk(e){return Moe(e)||Roe(e)||Doe(e)||Foe()}function Foe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Doe(e,t){if(e){if(typeof e=="string")return Zy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zy(e,t)}}function Roe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Moe(e){if(Array.isArray(e))return Zy(e)}function Zy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var ev=function(t,r,a,s,i){var o=Qa(t,e1),l=Qa(t,O0),c=[].concat(Yk(o),Yk(l)),d=Qa(t,F0),u="".concat(s,"Id"),f=s[0],x=r;if(c.length&&(x=c.reduce(function(m,g){if(g.props[u]===a&&Tn(g.props,"extendDomain")&&be(g.props[f])){var v=g.props[f];return[Math.min(m[0],v),Math.max(m[1],v)]}return m},x)),d.length){var p="".concat(f,"1"),h="".concat(f,"2");x=d.reduce(function(m,g){if(g.props[u]===a&&Tn(g.props,"extendDomain")&&be(g.props[p])&&be(g.props[h])){var v=g.props[p],b=g.props[h];return[Math.min(m[0],v,b),Math.max(m[1],v,b)]}return m},x)}return i&&i.length&&(x=i.reduce(function(m,g){return be(g)?[Math.min(m[0],g),Math.max(m[1],g)]:m},x)),x},ig={exports:{}},Jk;function Loe(){return Jk||(Jk=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(r=!1));function s(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function i(c,d,u,f,x){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new s(u,f||c,x),h=r?r+d:d;return c._events[h]?c._events[h].fn?c._events[h]=[c._events[h],p]:c._events[h].push(p):(c._events[h]=p,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new a:delete c._events[d]}function l(){this._events=new a,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)t.call(u,f)&&d.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var x=0,p=f.length,h=new Array(p);x<p;x++)h[x]=f[x].fn;return h},l.prototype.listenerCount=function(d){var u=r?r+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,x,p,h){var m=r?r+d:d;if(!this._events[m])return!1;var g=this._events[m],v=arguments.length,b,y;if(g.fn){switch(g.once&&this.removeListener(d,g.fn,void 0,!0),v){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,f),!0;case 4:return g.fn.call(g.context,u,f,x),!0;case 5:return g.fn.call(g.context,u,f,x,p),!0;case 6:return g.fn.call(g.context,u,f,x,p,h),!0}for(y=1,b=new Array(v-1);y<v;y++)b[y-1]=arguments[y];g.fn.apply(g.context,b)}else{var N=g.length,j;for(y=0;y<N;y++)switch(g[y].once&&this.removeListener(d,g[y].fn,void 0,!0),v){case 1:g[y].fn.call(g[y].context);break;case 2:g[y].fn.call(g[y].context,u);break;case 3:g[y].fn.call(g[y].context,u,f);break;case 4:g[y].fn.call(g[y].context,u,f,x);break;default:if(!b)for(j=1,b=new Array(v-1);j<v;j++)b[j-1]=arguments[j];g[y].fn.apply(g[y].context,b)}}return!0},l.prototype.on=function(d,u,f){return i(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return i(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,x){var p=r?r+d:d;if(!this._events[p])return this;if(!u)return o(this,p),this;var h=this._events[p];if(h.fn)h.fn===u&&(!x||h.once)&&(!f||h.context===f)&&o(this,p);else{for(var m=0,g=[],v=h.length;m<v;m++)(h[m].fn!==u||x&&!h[m].once||f&&h[m].context!==f)&&g.push(h[m]);g.length?this._events[p]=g.length===1?g[0]:g:o(this,p)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&o(this,u)):(this._events=new a,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(ig)),ig.exports}var $oe=Loe();const Boe=Ct($oe);var og=new Boe,lg="recharts.syncMouseEvents";function dd(e){"@babel/helpers - typeof";return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dd(e)}function Uoe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qoe(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,kC(a.key),a)}}function Woe(e,t,r){return t&&qoe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function cg(e,t,r){return t=kC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kC(e){var t=Hoe(e,"string");return dd(t)=="symbol"?t:t+""}function Hoe(e,t){if(dd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(dd(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var zoe=(function(){function e(){Uoe(this,e),cg(this,"activeIndex",0),cg(this,"coordinateList",[]),cg(this,"layout","horizontal")}return Woe(e,[{key:"setDetails",value:function(r){var a,s=r.coordinateList,i=s===void 0?null:s,o=r.container,l=o===void 0?null:o,c=r.layout,d=c===void 0?null:c,u=r.offset,f=u===void 0?null:u,x=r.mouseHandlerCallback,p=x===void 0?null:x;this.coordinateList=(a=i??this.coordinateList)!==null&&a!==void 0?a:[],this.container=l??this.container,this.layout=d??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=p??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,a;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var s=this.container.getBoundingClientRect(),i=s.x,o=s.y,l=s.height,c=this.coordinateList[this.activeIndex].coordinate,d=((r=window)===null||r===void 0?void 0:r.scrollX)||0,u=((a=window)===null||a===void 0?void 0:a.scrollY)||0,f=i+c+d,x=o+this.offset.top+l/2+u;this.mouseHandlerCallback({pageX:f,pageY:x})}}}])})();function Voe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var a=e==null?void 0:e[0],s=e==null?void 0:e[1];if(a&&s&&be(a)&&be(s))return!0}return!1}function Goe(e,t,r,a){var s=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-s:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-s,width:e==="horizontal"?a:r.width-1,height:e==="horizontal"?r.height-1:a}}function EC(e){var t=e.cx,r=e.cy,a=e.radius,s=e.startAngle,i=e.endAngle,o=Bt(t,r,a,s),l=Bt(t,r,a,i);return{points:[o,l],cx:t,cy:r,radius:a,startAngle:s,endAngle:i}}function Koe(e,t,r){var a,s,i,o;if(e==="horizontal")a=t.x,i=a,s=r.top,o=r.top+r.height;else if(e==="vertical")s=t.y,o=s,a=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,d=t.innerRadius,u=t.outerRadius,f=t.angle,x=Bt(l,c,d,f),p=Bt(l,c,u,f);a=x.x,s=x.y,i=p.x,o=p.y}else return EC(t);return[{x:a,y:s},{x:i,y:o}]}function ud(e){"@babel/helpers - typeof";return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ud(e)}function Qk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function iu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qk(Object(r),!0).forEach(function(a){Xoe(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qk(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Xoe(e,t,r){return t=Yoe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yoe(e){var t=Joe(e,"string");return ud(t)=="symbol"?t:t+""}function Joe(e,t){if(ud(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(ud(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qoe(e){var t,r,a=e.element,s=e.tooltipEventType,i=e.isActive,o=e.activeCoordinate,l=e.activePayload,c=e.offset,d=e.activeTooltipIndex,u=e.tooltipAxisBandSize,f=e.layout,x=e.chartName,p=(t=a.props.cursor)!==null&&t!==void 0?t:(r=a.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!a||!p||!i||!o||x!=="ScatterChart"&&s!=="axis")return null;var h,m=bo;if(x==="ScatterChart")h=o,m=_ae;else if(x==="BarChart")h=Goe(f,o,c,u),m=Gb;else if(f==="radial"){var g=EC(o),v=g.cx,b=g.cy,y=g.radius,N=g.startAngle,j=g.endAngle;h={cx:v,cy:b,startAngle:N,endAngle:j,innerRadius:y,outerRadius:y},m=kA}else h={points:Koe(f,o,c)},m=bo;var w=iu(iu(iu(iu({stroke:"#ccc",pointerEvents:"none"},c),h),Re(p,!1)),{},{payload:l,payloadIndex:d,className:tt("recharts-tooltip-cursor",p.className)});return C.isValidElement(p)?C.cloneElement(p,w):C.createElement(m,w)}var Zoe=["item"],ele=["children","className","width","height","style","compact","title","desc"];function rl(e){"@babel/helpers - typeof";return rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rl(e)}function uo(){return uo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},uo.apply(this,arguments)}function Zk(e,t){return ale(e)||rle(e,t)||AC(e,t)||tle()}function tle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function ale(e){if(Array.isArray(e))return e}function eE(e,t){if(e==null)return{};var r=nle(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function nle(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function sle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ile(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,CC(a.key),a)}}function ole(e,t,r){return t&&ile(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function lle(e,t,r){return t=If(t),cle(e,TC()?Reflect.construct(t,r||[],If(e).constructor):t.apply(e,r))}function cle(e,t){if(t&&(rl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dle(e)}function dle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(TC=function(){return!!e})()}function If(e){return If=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},If(e)}function ule(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tv(e,t)}function tv(e,t){return tv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},tv(e,t)}function al(e){return mle(e)||hle(e)||AC(e)||fle()}function fle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AC(e,t){if(e){if(typeof e=="string")return rv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rv(e,t)}}function hle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mle(e){if(Array.isArray(e))return rv(e)}function rv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function tE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function fe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tE(Object(r),!0).forEach(function(a){$e(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tE(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function $e(e,t,r){return t=CC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CC(e){var t=xle(e,"string");return rl(t)=="symbol"?t:t+""}function xle(e,t){if(rl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(rl(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ple={xAxis:["bottom","top"],yAxis:["left","right"]},gle={width:"100%",height:"100%"},PC={x:0,y:0};function ou(e){return e}var yle=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},vle=function(t,r,a,s){var i=r.find(function(u){return u&&u.index===a});if(i){if(t==="horizontal")return{x:i.coordinate,y:s.y};if(t==="vertical")return{x:s.x,y:i.coordinate};if(t==="centric"){var o=i.coordinate,l=s.radius;return fe(fe(fe({},s),Bt(s.cx,s.cy,l,o)),{},{angle:o,radius:l})}var c=i.coordinate,d=s.angle;return fe(fe(fe({},s),Bt(s.cx,s.cy,c,d)),{},{angle:d,radius:c})}return PC},D0=function(t,r){var a=r.graphicalItems,s=r.dataStartIndex,i=r.dataEndIndex,o=(a??[]).reduce(function(l,c){var d=c.props.data;return d&&d.length?[].concat(al(l),al(d)):l},[]);return o.length>0?o:t&&t.length&&be(s)&&be(i)?t.slice(s,i+1):[]};function OC(e){return e==="number"?[0,"auto"]:void 0}var av=function(t,r,a,s){var i=t.graphicalItems,o=t.tooltipAxis,l=D0(r,t);return a<0||!i||!i.length||a>=l.length?null:i.reduce(function(c,d){var u,f=(u=d.props.data)!==null&&u!==void 0?u:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=a&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var x;if(o.dataKey&&!o.allowDuplicatedCategory){var p=f===void 0?l:f;x=Ru(p,o.dataKey,s)}else x=f&&f[a]||l[a];return x?[].concat(al(c),[bA(d,x)]):c},[])},rE=function(t,r,a,s){var i=s||{x:t.chartX,y:t.chartY},o=yle(i,a),l=t.orderedTooltipTicks,c=t.tooltipAxis,d=t.tooltipTicks,u=XZ(o,l,d,c);if(u>=0&&d){var f=d[u]&&d[u].value,x=av(t,r,u,f),p=vle(a,l,u,i);return{activeTooltipIndex:u,activeLabel:f,activePayload:x,activeCoordinate:p}}return null},ble=function(t,r){var a=r.axes,s=r.graphicalItems,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,x=t.stackOffset,p=mA(u,i);return a.reduce(function(h,m){var g,v=m.type.defaultProps!==void 0?fe(fe({},m.type.defaultProps),m.props):m.props,b=v.type,y=v.dataKey,N=v.allowDataOverflow,j=v.allowDuplicatedCategory,w=v.scale,_=v.ticks,S=v.includeHidden,k=v[o];if(h[k])return h;var E=D0(t.data,{graphicalItems:s.filter(function(T){var O,W=o in T.props?T.props[o]:(O=T.type.defaultProps)===null||O===void 0?void 0:O[o];return W===k}),dataStartIndex:c,dataEndIndex:d}),A=E.length,P,L,R;Voe(v.domain,N,b)&&(P=gy(v.domain,null,N),p&&(b==="number"||w!=="auto")&&(R=lc(E,y,"category")));var I=OC(b);if(!P||P.length===0){var D,V=(D=v.domain)!==null&&D!==void 0?D:I;if(y){if(P=lc(E,y,b),b==="category"&&p){var F=qz(P);j&&F?(L=P,P=bf(0,A)):j||(P=r4(V,P,m).reduce(function(T,O){return T.indexOf(O)>=0?T:[].concat(al(T),[O])},[]))}else if(b==="category")j?P=P.filter(function(T){return T!==""&&!Je(T)}):P=r4(V,P,m).reduce(function(T,O){return T.indexOf(O)>=0||O===""||Je(O)?T:[].concat(al(T),[O])},[]);else if(b==="number"){var U=eee(E,s.filter(function(T){var O,W,z=o in T.props?T.props[o]:(O=T.type.defaultProps)===null||O===void 0?void 0:O[o],te="hide"in T.props?T.props.hide:(W=T.type.defaultProps)===null||W===void 0?void 0:W.hide;return z===k&&(S||!te)}),y,i,u);U&&(P=U)}p&&(b==="number"||w!=="auto")&&(R=lc(E,y,"category"))}else p?P=bf(0,A):l&&l[k]&&l[k].hasStack&&b==="number"?P=x==="expand"?[0,1]:vA(l[k].stackGroups,c,d):P=hA(E,s.filter(function(T){var O=o in T.props?T.props[o]:T.type.defaultProps[o],W="hide"in T.props?T.props.hide:T.type.defaultProps.hide;return O===k&&(S||!W)}),b,u,!0);if(b==="number")P=ev(f,P,k,i,_),V&&(P=gy(V,P,N));else if(b==="category"&&V){var q=V,K=P.every(function(T){return q.indexOf(T)>=0});K&&(P=q)}}return fe(fe({},h),{},$e({},k,fe(fe({},v),{},{axisType:i,domain:P,categoricalDomain:R,duplicateDomain:L,originalDomain:(g=v.domain)!==null&&g!==void 0?g:I,isCategorical:p,layout:u})))},{})},jle=function(t,r){var a=r.graphicalItems,s=r.Axis,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,x=D0(t.data,{graphicalItems:a,dataStartIndex:c,dataEndIndex:d}),p=x.length,h=mA(u,i),m=-1;return a.reduce(function(g,v){var b=v.type.defaultProps!==void 0?fe(fe({},v.type.defaultProps),v.props):v.props,y=b[o],N=OC("number");if(!g[y]){m++;var j;return h?j=bf(0,p):l&&l[y]&&l[y].hasStack?(j=vA(l[y].stackGroups,c,d),j=ev(f,j,y,i)):(j=gy(N,hA(x,a.filter(function(w){var _,S,k=o in w.props?w.props[o]:(_=w.type.defaultProps)===null||_===void 0?void 0:_[o],E="hide"in w.props?w.props.hide:(S=w.type.defaultProps)===null||S===void 0?void 0:S.hide;return k===y&&!E}),"number",u),s.defaultProps.allowDataOverflow),j=ev(f,j,y,i)),fe(fe({},g),{},$e({},y,fe(fe({axisType:i},s.defaultProps),{},{hide:!0,orientation:Oa(ple,"".concat(i,".").concat(m%2),null),domain:j,originalDomain:N,isCategorical:h,layout:u})))}return g},{})},wle=function(t,r){var a=r.axisType,s=a===void 0?"xAxis":a,i=r.AxisComp,o=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.children,f="".concat(s,"Id"),x=Qa(u,i),p={};return x&&x.length?p=ble(t,{axes:x,graphicalItems:o,axisType:s,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d}):o&&o.length&&(p=jle(t,{Axis:i,graphicalItems:o,axisType:s,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d})),p},Nle=function(t){var r=bs(t),a=Xn(r,!1,!0);return{tooltipTicks:a,orderedTooltipTicks:bb(a,function(s){return s.coordinate}),tooltipAxis:r,tooltipAxisBandSize:lf(r,a)}},aE=function(t){var r=t.children,a=t.defaultShowTooltip,s=ka(r,zo),i=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),s&&s.props&&(s.props.startIndex>=0&&(i=s.props.startIndex),s.props.endIndex>=0&&(o=s.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!a}},_le=function(t){return!t||!t.length?!1:t.some(function(r){var a=es(r&&r.type);return a&&a.indexOf("Bar")>=0})},nE=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Sle=function(t,r){var a=t.props,s=t.graphicalItems,i=t.xAxisMap,o=i===void 0?{}:i,l=t.yAxisMap,c=l===void 0?{}:l,d=a.width,u=a.height,f=a.children,x=a.margin||{},p=ka(f,zo),h=ka(f,go),m=Object.keys(c).reduce(function(j,w){var _=c[w],S=_.orientation;return!_.mirror&&!_.hide?fe(fe({},j),{},$e({},S,j[S]+_.width)):j},{left:x.left||0,right:x.right||0}),g=Object.keys(o).reduce(function(j,w){var _=o[w],S=_.orientation;return!_.mirror&&!_.hide?fe(fe({},j),{},$e({},S,Oa(j,"".concat(S))+_.height)):j},{top:x.top||0,bottom:x.bottom||0}),v=fe(fe({},g),m),b=v.bottom;p&&(v.bottom+=p.props.height||zo.defaultProps.height),h&&r&&(v=QZ(v,s,a,r));var y=d-v.left-v.right,N=u-v.top-v.bottom;return fe(fe({brushBottom:b},v),{},{width:Math.max(y,0),height:Math.max(N,0)})},kle=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},a1=function(t){var r=t.chartName,a=t.GraphicalChild,s=t.defaultTooltipEventType,i=s===void 0?"axis":s,o=t.validateTooltipEventTypes,l=o===void 0?["axis"]:o,c=t.axisComponents,d=t.legendContent,u=t.formatAxisMap,f=t.defaultProps,x=function(v,b){var y=b.graphicalItems,N=b.stackGroups,j=b.offset,w=b.updateId,_=b.dataStartIndex,S=b.dataEndIndex,k=v.barSize,E=v.layout,A=v.barGap,P=v.barCategoryGap,L=v.maxBarSize,R=nE(E),I=R.numericAxisName,D=R.cateAxisName,V=_le(y),F=[];return y.forEach(function(U,q){var K=D0(v.data,{graphicalItems:[U],dataStartIndex:_,dataEndIndex:S}),T=U.type.defaultProps!==void 0?fe(fe({},U.type.defaultProps),U.props):U.props,O=T.dataKey,W=T.maxBarSize,z=T["".concat(I,"Id")],te=T["".concat(D,"Id")],ae={},se=c.reduce(function(He,Ft){var _r=b["".concat(Ft.axisType,"Map")],Ut=T["".concat(Ft.axisType,"Id")];_r&&_r[Ut]||Ft.axisType==="zAxis"||Pi();var aa=_r[Ut];return fe(fe({},He),{},$e($e({},Ft.axisType,aa),"".concat(Ft.axisType,"Ticks"),Xn(aa)))},ae),M=se[D],G=se["".concat(D,"Ticks")],ne=N&&N[z]&&N[z].hasStack&&cee(U,N[z].stackGroups),B=es(U.type).indexOf("Bar")>=0,pe=lf(M,G),ye=[],Te=V&&YZ({barSize:k,stackGroups:N,totalSize:kle(se,D)});if(B){var de,xe,We=Je(W)?L:W,Nt=(de=(xe=lf(M,G,!0))!==null&&xe!==void 0?xe:We)!==null&&de!==void 0?de:0;ye=JZ({barGap:A,barCategoryGap:P,bandSize:Nt!==pe?Nt:pe,sizeList:Te[te],maxBarSize:We}),Nt!==pe&&(ye=ye.map(function(He){return fe(fe({},He),{},{position:fe(fe({},He.position),{},{offset:He.position.offset-Nt/2})})}))}var _e=U&&U.type&&U.type.getComposedData;_e&&F.push({props:fe(fe({},_e(fe(fe({},se),{},{displayedData:K,props:v,dataKey:O,item:U,bandSize:pe,barPosition:ye,offset:j,stackedData:ne,layout:E,dataStartIndex:_,dataEndIndex:S}))),{},$e($e($e({key:U.key||"item-".concat(q)},I,se[I]),D,se[D]),"animationId",w)),childIndex:tV(U,v.children),item:U})}),F},p=function(v,b){var y=v.props,N=v.dataStartIndex,j=v.dataEndIndex,w=v.updateId;if(!pN({props:y}))return null;var _=y.children,S=y.layout,k=y.stackOffset,E=y.data,A=y.reverseStackOrder,P=nE(S),L=P.numericAxisName,R=P.cateAxisName,I=Qa(_,a),D=oee(E,I,"".concat(L,"Id"),"".concat(R,"Id"),k,A),V=c.reduce(function(T,O){var W="".concat(O.axisType,"Map");return fe(fe({},T),{},$e({},W,wle(y,fe(fe({},O),{},{graphicalItems:I,stackGroups:O.axisType===L&&D,dataStartIndex:N,dataEndIndex:j}))))},{}),F=Sle(fe(fe({},V),{},{props:y,graphicalItems:I}),b==null?void 0:b.legendBBox);Object.keys(V).forEach(function(T){V[T]=u(y,V[T],F,T.replace("Map",""),r)});var U=V["".concat(R,"Map")],q=Nle(U),K=x(y,fe(fe({},V),{},{dataStartIndex:N,dataEndIndex:j,updateId:w,graphicalItems:I,stackGroups:D,offset:F}));return fe(fe({formattedGraphicalItems:K,graphicalItems:I,offset:F,stackGroups:D},q),V)},h=(function(g){function v(b){var y,N,j;return sle(this,v),j=lle(this,v,[b]),$e(j,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),$e(j,"accessibilityManager",new zoe),$e(j,"handleLegendBBoxUpdate",function(w){if(w){var _=j.state,S=_.dataStartIndex,k=_.dataEndIndex,E=_.updateId;j.setState(fe({legendBBox:w},p({props:j.props,dataStartIndex:S,dataEndIndex:k,updateId:E},fe(fe({},j.state),{},{legendBBox:w}))))}}),$e(j,"handleReceiveSyncEvent",function(w,_,S){if(j.props.syncId===w){if(S===j.eventEmitterSymbol&&typeof j.props.syncMethod!="function")return;j.applySyncEvent(_)}}),$e(j,"handleBrushChange",function(w){var _=w.startIndex,S=w.endIndex;if(_!==j.state.dataStartIndex||S!==j.state.dataEndIndex){var k=j.state.updateId;j.setState(function(){return fe({dataStartIndex:_,dataEndIndex:S},p({props:j.props,dataStartIndex:_,dataEndIndex:S,updateId:k},j.state))}),j.triggerSyncEvent({dataStartIndex:_,dataEndIndex:S})}}),$e(j,"handleMouseEnter",function(w){var _=j.getMouseInfo(w);if(_){var S=fe(fe({},_),{},{isTooltipActive:!0});j.setState(S),j.triggerSyncEvent(S);var k=j.props.onMouseEnter;qe(k)&&k(S,w)}}),$e(j,"triggeredAfterMouseMove",function(w){var _=j.getMouseInfo(w),S=_?fe(fe({},_),{},{isTooltipActive:!0}):{isTooltipActive:!1};j.setState(S),j.triggerSyncEvent(S);var k=j.props.onMouseMove;qe(k)&&k(S,w)}),$e(j,"handleItemMouseEnter",function(w){j.setState(function(){return{isTooltipActive:!0,activeItem:w,activePayload:w.tooltipPayload,activeCoordinate:w.tooltipPosition||{x:w.cx,y:w.cy}}})}),$e(j,"handleItemMouseLeave",function(){j.setState(function(){return{isTooltipActive:!1}})}),$e(j,"handleMouseMove",function(w){w.persist(),j.throttleTriggeredAfterMouseMove(w)}),$e(j,"handleMouseLeave",function(w){j.throttleTriggeredAfterMouseMove.cancel();var _={isTooltipActive:!1};j.setState(_),j.triggerSyncEvent(_);var S=j.props.onMouseLeave;qe(S)&&S(_,w)}),$e(j,"handleOuterEvent",function(w){var _=eV(w),S=Oa(j.props,"".concat(_));if(_&&qe(S)){var k,E;/.*touch.*/i.test(_)?E=j.getMouseInfo(w.changedTouches[0]):E=j.getMouseInfo(w),S((k=E)!==null&&k!==void 0?k:{},w)}}),$e(j,"handleClick",function(w){var _=j.getMouseInfo(w);if(_){var S=fe(fe({},_),{},{isTooltipActive:!0});j.setState(S),j.triggerSyncEvent(S);var k=j.props.onClick;qe(k)&&k(S,w)}}),$e(j,"handleMouseDown",function(w){var _=j.props.onMouseDown;if(qe(_)){var S=j.getMouseInfo(w);_(S,w)}}),$e(j,"handleMouseUp",function(w){var _=j.props.onMouseUp;if(qe(_)){var S=j.getMouseInfo(w);_(S,w)}}),$e(j,"handleTouchMove",function(w){w.changedTouches!=null&&w.changedTouches.length>0&&j.throttleTriggeredAfterMouseMove(w.changedTouches[0])}),$e(j,"handleTouchStart",function(w){w.changedTouches!=null&&w.changedTouches.length>0&&j.handleMouseDown(w.changedTouches[0])}),$e(j,"handleTouchEnd",function(w){w.changedTouches!=null&&w.changedTouches.length>0&&j.handleMouseUp(w.changedTouches[0])}),$e(j,"handleDoubleClick",function(w){var _=j.props.onDoubleClick;if(qe(_)){var S=j.getMouseInfo(w);_(S,w)}}),$e(j,"handleContextMenu",function(w){var _=j.props.onContextMenu;if(qe(_)){var S=j.getMouseInfo(w);_(S,w)}}),$e(j,"triggerSyncEvent",function(w){j.props.syncId!==void 0&&og.emit(lg,j.props.syncId,w,j.eventEmitterSymbol)}),$e(j,"applySyncEvent",function(w){var _=j.props,S=_.layout,k=_.syncMethod,E=j.state.updateId,A=w.dataStartIndex,P=w.dataEndIndex;if(w.dataStartIndex!==void 0||w.dataEndIndex!==void 0)j.setState(fe({dataStartIndex:A,dataEndIndex:P},p({props:j.props,dataStartIndex:A,dataEndIndex:P,updateId:E},j.state)));else if(w.activeTooltipIndex!==void 0){var L=w.chartX,R=w.chartY,I=w.activeTooltipIndex,D=j.state,V=D.offset,F=D.tooltipTicks;if(!V)return;if(typeof k=="function")I=k(F,w);else if(k==="value"){I=-1;for(var U=0;U<F.length;U++)if(F[U].value===w.activeLabel){I=U;break}}var q=fe(fe({},V),{},{x:V.left,y:V.top}),K=Math.min(L,q.x+q.width),T=Math.min(R,q.y+q.height),O=F[I]&&F[I].value,W=av(j.state,j.props.data,I),z=F[I]?{x:S==="horizontal"?F[I].coordinate:K,y:S==="horizontal"?T:F[I].coordinate}:PC;j.setState(fe(fe({},w),{},{activeLabel:O,activeCoordinate:z,activePayload:W,activeTooltipIndex:I}))}else j.setState(w)}),$e(j,"renderCursor",function(w){var _,S=j.state,k=S.isTooltipActive,E=S.activeCoordinate,A=S.activePayload,P=S.offset,L=S.activeTooltipIndex,R=S.tooltipAxisBandSize,I=j.getTooltipEventType(),D=(_=w.props.active)!==null&&_!==void 0?_:k,V=j.props.layout,F=w.key||"_recharts-cursor";return ee.createElement(Qoe,{key:F,activeCoordinate:E,activePayload:A,activeTooltipIndex:L,chartName:r,element:w,isActive:D,layout:V,offset:P,tooltipAxisBandSize:R,tooltipEventType:I})}),$e(j,"renderPolarAxis",function(w,_,S){var k=Oa(w,"type.axisType"),E=Oa(j.state,"".concat(k,"Map")),A=w.type.defaultProps,P=A!==void 0?fe(fe({},A),w.props):w.props,L=E&&E[P["".concat(k,"Id")]];return C.cloneElement(w,fe(fe({},L),{},{className:tt(k,L.className),key:w.key||"".concat(_,"-").concat(S),ticks:Xn(L,!0)}))}),$e(j,"renderPolarGrid",function(w){var _=w.props,S=_.radialLines,k=_.polarAngles,E=_.polarRadius,A=j.state,P=A.radiusAxisMap,L=A.angleAxisMap,R=bs(P),I=bs(L),D=I.cx,V=I.cy,F=I.innerRadius,U=I.outerRadius;return C.cloneElement(w,{polarAngles:Array.isArray(k)?k:Xn(I,!0).map(function(q){return q.coordinate}),polarRadius:Array.isArray(E)?E:Xn(R,!0).map(function(q){return q.coordinate}),cx:D,cy:V,innerRadius:F,outerRadius:U,key:w.key||"polar-grid",radialLines:S})}),$e(j,"renderLegend",function(){var w=j.state.formattedGraphicalItems,_=j.props,S=_.children,k=_.width,E=_.height,A=j.props.margin||{},P=k-(A.left||0)-(A.right||0),L=uA({children:S,formattedGraphicalItems:w,legendWidth:P,legendContent:d});if(!L)return null;var R=L.item,I=eE(L,Zoe);return C.cloneElement(R,fe(fe({},I),{},{chartWidth:k,chartHeight:E,margin:A,onBBoxUpdate:j.handleLegendBBoxUpdate}))}),$e(j,"renderTooltip",function(){var w,_=j.props,S=_.children,k=_.accessibilityLayer,E=ka(S,Ga);if(!E)return null;var A=j.state,P=A.isTooltipActive,L=A.activeCoordinate,R=A.activePayload,I=A.activeLabel,D=A.offset,V=(w=E.props.active)!==null&&w!==void 0?w:P;return C.cloneElement(E,{viewBox:fe(fe({},D),{},{x:D.left,y:D.top}),active:V,label:I,payload:V?R:[],coordinate:L,accessibilityLayer:k})}),$e(j,"renderBrush",function(w){var _=j.props,S=_.margin,k=_.data,E=j.state,A=E.offset,P=E.dataStartIndex,L=E.dataEndIndex,R=E.updateId;return C.cloneElement(w,{key:w.key||"_recharts-brush",onChange:ru(j.handleBrushChange,w.props.onChange),data:k,x:be(w.props.x)?w.props.x:A.left,y:be(w.props.y)?w.props.y:A.top+A.height+A.brushBottom-(S.bottom||0),width:be(w.props.width)?w.props.width:A.width,startIndex:P,endIndex:L,updateId:"brush-".concat(R)})}),$e(j,"renderReferenceElement",function(w,_,S){if(!w)return null;var k=j,E=k.clipPathId,A=j.state,P=A.xAxisMap,L=A.yAxisMap,R=A.offset,I=w.type.defaultProps||{},D=w.props,V=D.xAxisId,F=V===void 0?I.xAxisId:V,U=D.yAxisId,q=U===void 0?I.yAxisId:U;return C.cloneElement(w,{key:w.key||"".concat(_,"-").concat(S),xAxis:P[F],yAxis:L[q],viewBox:{x:R.left,y:R.top,width:R.width,height:R.height},clipPathId:E})}),$e(j,"renderActivePoints",function(w){var _=w.item,S=w.activePoint,k=w.basePoint,E=w.childIndex,A=w.isRange,P=[],L=_.props.key,R=_.item.type.defaultProps!==void 0?fe(fe({},_.item.type.defaultProps),_.item.props):_.item.props,I=R.activeDot,D=R.dataKey,V=fe(fe({index:E,dataKey:D,cx:S.x,cy:S.y,r:4,fill:Vb(_.item),strokeWidth:2,stroke:"#fff",payload:S.payload,value:S.value},Re(I,!1)),Mu(I));return P.push(v.renderActiveDot(I,V,"".concat(L,"-activePoint-").concat(E))),k?P.push(v.renderActiveDot(I,fe(fe({},V),{},{cx:k.x,cy:k.y}),"".concat(L,"-basePoint-").concat(E))):A&&P.push(null),P}),$e(j,"renderGraphicChild",function(w,_,S){var k=j.filterFormatItem(w,_,S);if(!k)return null;var E=j.getTooltipEventType(),A=j.state,P=A.isTooltipActive,L=A.tooltipAxis,R=A.activeTooltipIndex,I=A.activeLabel,D=j.props.children,V=ka(D,Ga),F=k.props,U=F.points,q=F.isRange,K=F.baseLine,T=k.item.type.defaultProps!==void 0?fe(fe({},k.item.type.defaultProps),k.item.props):k.item.props,O=T.activeDot,W=T.hide,z=T.activeBar,te=T.activeShape,ae=!!(!W&&P&&V&&(O||z||te)),se={};E!=="axis"&&V&&V.props.trigger==="click"?se={onClick:ru(j.handleItemMouseEnter,w.props.onClick)}:E!=="axis"&&(se={onMouseLeave:ru(j.handleItemMouseLeave,w.props.onMouseLeave),onMouseEnter:ru(j.handleItemMouseEnter,w.props.onMouseEnter)});var M=C.cloneElement(w,fe(fe({},k.props),se));function G(Ft){return typeof L.dataKey=="function"?L.dataKey(Ft.payload):null}if(ae)if(R>=0){var ne,B;if(L.dataKey&&!L.allowDuplicatedCategory){var pe=typeof L.dataKey=="function"?G:"payload.".concat(L.dataKey.toString());ne=Ru(U,pe,I),B=q&&K&&Ru(K,pe,I)}else ne=U==null?void 0:U[R],B=q&&K&&K[R];if(te||z){var ye=w.props.activeIndex!==void 0?w.props.activeIndex:R;return[C.cloneElement(w,fe(fe(fe({},k.props),se),{},{activeIndex:ye})),null,null]}if(!Je(ne))return[M].concat(al(j.renderActivePoints({item:k,activePoint:ne,basePoint:B,childIndex:R,isRange:q})))}else{var Te,de=(Te=j.getItemByXY(j.state.activeCoordinate))!==null&&Te!==void 0?Te:{graphicalItem:M},xe=de.graphicalItem,We=xe.item,Nt=We===void 0?w:We,_e=xe.childIndex,He=fe(fe(fe({},k.props),se),{},{activeIndex:_e});return[C.cloneElement(Nt,He),null,null]}return q?[M,null,null]:[M,null]}),$e(j,"renderCustomized",function(w,_,S){return C.cloneElement(w,fe(fe({key:"recharts-customized-".concat(S)},j.props),j.state))}),$e(j,"renderMap",{CartesianGrid:{handler:ou,once:!0},ReferenceArea:{handler:j.renderReferenceElement},ReferenceLine:{handler:ou},ReferenceDot:{handler:j.renderReferenceElement},XAxis:{handler:ou},YAxis:{handler:ou},Brush:{handler:j.renderBrush,once:!0},Bar:{handler:j.renderGraphicChild},Line:{handler:j.renderGraphicChild},Area:{handler:j.renderGraphicChild},Radar:{handler:j.renderGraphicChild},RadialBar:{handler:j.renderGraphicChild},Scatter:{handler:j.renderGraphicChild},Pie:{handler:j.renderGraphicChild},Funnel:{handler:j.renderGraphicChild},Tooltip:{handler:j.renderCursor,once:!0},PolarGrid:{handler:j.renderPolarGrid,once:!0},PolarAngleAxis:{handler:j.renderPolarAxis},PolarRadiusAxis:{handler:j.renderPolarAxis},Customized:{handler:j.renderCustomized}}),j.clipPathId="".concat((y=b.id)!==null&&y!==void 0?y:xl("recharts"),"-clip"),j.throttleTriggeredAfterMouseMove=d3(j.triggeredAfterMouseMove,(N=b.throttleDelay)!==null&&N!==void 0?N:1e3/60),j.state={},j}return ule(v,g),ole(v,[{key:"componentDidMount",value:function(){var y,N;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(y=this.props.margin.left)!==null&&y!==void 0?y:0,top:(N=this.props.margin.top)!==null&&N!==void 0?N:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var y=this.props,N=y.children,j=y.data,w=y.height,_=y.layout,S=ka(N,Ga);if(S){var k=S.props.defaultIndex;if(!(typeof k!="number"||k<0||k>this.state.tooltipTicks.length-1)){var E=this.state.tooltipTicks[k]&&this.state.tooltipTicks[k].value,A=av(this.state,j,k,E),P=this.state.tooltipTicks[k].coordinate,L=(this.state.offset.top+w)/2,R=_==="horizontal",I=R?{x:P,y:L}:{y:P,x:L},D=this.state.formattedGraphicalItems.find(function(F){var U=F.item;return U.type.name==="Scatter"});D&&(I=fe(fe({},I),D.props.points[k].tooltipPosition),A=D.props.points[k].tooltipPayload);var V={activeTooltipIndex:k,isTooltipActive:!0,activeLabel:E,activePayload:A,activeCoordinate:I};this.setState(V),this.renderCursor(S),this.accessibilityManager.setIndex(k)}}}},{key:"getSnapshotBeforeUpdate",value:function(y,N){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==N.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==y.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==y.margin){var j,w;this.accessibilityManager.setDetails({offset:{left:(j=this.props.margin.left)!==null&&j!==void 0?j:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0}})}return null}},{key:"componentDidUpdate",value:function(y){$g([ka(y.children,Ga)],[ka(this.props.children,Ga)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var y=ka(this.props.children,Ga);if(y&&typeof y.props.shared=="boolean"){var N=y.props.shared?"axis":"item";return l.indexOf(N)>=0?N:i}return i}},{key:"getMouseInfo",value:function(y){if(!this.container)return null;var N=this.container,j=N.getBoundingClientRect(),w=UX(j),_={chartX:Math.round(y.pageX-w.left),chartY:Math.round(y.pageY-w.top)},S=j.width/N.offsetWidth||1,k=this.inRange(_.chartX,_.chartY,S);if(!k)return null;var E=this.state,A=E.xAxisMap,P=E.yAxisMap,L=this.getTooltipEventType(),R=rE(this.state,this.props.data,this.props.layout,k);if(L!=="axis"&&A&&P){var I=bs(A).scale,D=bs(P).scale,V=I&&I.invert?I.invert(_.chartX):null,F=D&&D.invert?D.invert(_.chartY):null;return fe(fe({},_),{},{xValue:V,yValue:F},R)}return R?fe(fe({},_),R):null}},{key:"inRange",value:function(y,N){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,w=this.props.layout,_=y/j,S=N/j;if(w==="horizontal"||w==="vertical"){var k=this.state.offset,E=_>=k.left&&_<=k.left+k.width&&S>=k.top&&S<=k.top+k.height;return E?{x:_,y:S}:null}var A=this.state,P=A.angleAxisMap,L=A.radiusAxisMap;if(P&&L){var R=bs(P);return s4({x:_,y:S},R)}return null}},{key:"parseEventsOfWrapper",value:function(){var y=this.props.children,N=this.getTooltipEventType(),j=ka(y,Ga),w={};j&&N==="axis"&&(j.props.trigger==="click"?w={onClick:this.handleClick}:w={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var _=Mu(this.props,this.handleOuterEvent);return fe(fe({},_),w)}},{key:"addListener",value:function(){og.on(lg,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){og.removeListener(lg,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(y,N,j){for(var w=this.state.formattedGraphicalItems,_=0,S=w.length;_<S;_++){var k=w[_];if(k.item===y||k.props.key===y.key||N===es(k.item.type)&&j===k.childIndex)return k}return null}},{key:"renderClipPath",value:function(){var y=this.clipPathId,N=this.state.offset,j=N.left,w=N.top,_=N.height,S=N.width;return ee.createElement("defs",null,ee.createElement("clipPath",{id:y},ee.createElement("rect",{x:j,y:w,height:_,width:S})))}},{key:"getXScales",value:function(){var y=this.state.xAxisMap;return y?Object.entries(y).reduce(function(N,j){var w=Zk(j,2),_=w[0],S=w[1];return fe(fe({},N),{},$e({},_,S.scale))},{}):null}},{key:"getYScales",value:function(){var y=this.state.yAxisMap;return y?Object.entries(y).reduce(function(N,j){var w=Zk(j,2),_=w[0],S=w[1];return fe(fe({},N),{},$e({},_,S.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(y){var N;return(N=this.state.xAxisMap)===null||N===void 0||(N=N[y])===null||N===void 0?void 0:N.scale}},{key:"getYScaleByAxisId",value:function(y){var N;return(N=this.state.yAxisMap)===null||N===void 0||(N=N[y])===null||N===void 0?void 0:N.scale}},{key:"getItemByXY",value:function(y){var N=this.state,j=N.formattedGraphicalItems,w=N.activeItem;if(j&&j.length)for(var _=0,S=j.length;_<S;_++){var k=j[_],E=k.props,A=k.item,P=A.type.defaultProps!==void 0?fe(fe({},A.type.defaultProps),A.props):A.props,L=es(A.type);if(L==="Bar"){var R=(E.data||[]).find(function(F){return nae(y,F)});if(R)return{graphicalItem:k,payload:R}}else if(L==="RadialBar"){var I=(E.data||[]).find(function(F){return s4(y,F)});if(I)return{graphicalItem:k,payload:I}}else if(T0(k,w)||A0(k,w)||sd(k,w)){var D=Ene({graphicalItem:k,activeTooltipItem:w,itemData:P.data}),V=P.activeIndex===void 0?D:P.activeIndex;return{graphicalItem:fe(fe({},k),{},{childIndex:V}),payload:sd(k,w)?P.data[D]:k.props.data[D]}}}return null}},{key:"render",value:function(){var y=this;if(!pN(this))return null;var N=this.props,j=N.children,w=N.className,_=N.width,S=N.height,k=N.style,E=N.compact,A=N.title,P=N.desc,L=eE(N,ele),R=Re(L,!1);if(E)return ee.createElement(Dk,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ee.createElement(Ug,uo({},R,{width:_,height:S,title:A,desc:P}),this.renderClipPath(),yN(j,this.renderMap)));if(this.props.accessibilityLayer){var I,D;R.tabIndex=(I=this.props.tabIndex)!==null&&I!==void 0?I:0,R.role=(D=this.props.role)!==null&&D!==void 0?D:"application",R.onKeyDown=function(F){y.accessibilityManager.keyboardEvent(F)},R.onFocus=function(){y.accessibilityManager.focus()}}var V=this.parseEventsOfWrapper();return ee.createElement(Dk,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ee.createElement("div",uo({className:tt("recharts-wrapper",w),style:fe({position:"relative",cursor:"default",width:_,height:S},k)},V,{ref:function(U){y.container=U}}),ee.createElement(Ug,uo({},R,{width:_,height:S,title:A,desc:P,style:gle}),this.renderClipPath(),yN(j,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])})(C.Component);$e(h,"displayName",r),$e(h,"defaultProps",fe({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),$e(h,"getDerivedStateFromProps",function(g,v){var b=g.dataKey,y=g.data,N=g.children,j=g.width,w=g.height,_=g.layout,S=g.stackOffset,k=g.margin,E=v.dataStartIndex,A=v.dataEndIndex;if(v.updateId===void 0){var P=aE(g);return fe(fe(fe({},P),{},{updateId:0},p(fe(fe({props:g},P),{},{updateId:0}),v)),{},{prevDataKey:b,prevData:y,prevWidth:j,prevHeight:w,prevLayout:_,prevStackOffset:S,prevMargin:k,prevChildren:N})}if(b!==v.prevDataKey||y!==v.prevData||j!==v.prevWidth||w!==v.prevHeight||_!==v.prevLayout||S!==v.prevStackOffset||!po(k,v.prevMargin)){var L=aE(g),R={chartX:v.chartX,chartY:v.chartY,isTooltipActive:v.isTooltipActive},I=fe(fe({},rE(v,y,_)),{},{updateId:v.updateId+1}),D=fe(fe(fe({},L),R),I);return fe(fe(fe({},D),p(fe({props:g},D),v)),{},{prevDataKey:b,prevData:y,prevWidth:j,prevHeight:w,prevLayout:_,prevStackOffset:S,prevMargin:k,prevChildren:N})}if(!$g(N,v.prevChildren)){var V,F,U,q,K=ka(N,zo),T=K&&(V=(F=K.props)===null||F===void 0?void 0:F.startIndex)!==null&&V!==void 0?V:E,O=K&&(U=(q=K.props)===null||q===void 0?void 0:q.endIndex)!==null&&U!==void 0?U:A,W=T!==E||O!==A,z=!Je(y),te=z&&!W?v.updateId:v.updateId+1;return fe(fe({updateId:te},p(fe(fe({props:g},v),{},{updateId:te,dataStartIndex:T,dataEndIndex:O}),v)),{},{prevChildren:N,dataStartIndex:T,dataEndIndex:O})}return null}),$e(h,"renderActiveDot",function(g,v,b){var y;return C.isValidElement(g)?y=C.cloneElement(g,v):qe(g)?y=g(v):y=ee.createElement(N0,v),ee.createElement(ht,{className:"recharts-active-dot",key:b},y)});var m=C.forwardRef(function(v,b){return ee.createElement(h,uo({},v,{ref:b}))});return m.displayName=h.displayName,m},Ele=a1({chartName:"BarChart",GraphicalChild:zi,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Zo},{axisType:"yAxis",AxisComp:tl}],formatAxisMap:YA}),Tle=a1({chartName:"PieChart",GraphicalChild:ms,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:E0},{axisType:"radiusAxis",AxisComp:S0}],formatAxisMap:vee,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),Ale=a1({chartName:"AreaChart",GraphicalChild:os,axisComponents:[{axisType:"xAxis",AxisComp:Zo},{axisType:"yAxis",AxisComp:tl}],formatAxisMap:YA});const Cle=()=>{const[e,t]=C.useState(null),[r,a]=C.useState(!0),[s,i]=C.useState(null),{user:o}=ut(),l=async()=>{if(o)try{a(!0),i(null),console.log("Fetching reports data for user:",o.role,o.id);let d;const u=Oe(he,"projects");if(o.role==="teacher"){const K=Me(u,De("teacher_id","==",o.id)),T=Me(u,De("school_id","==",o.school_id),De("status","==","draft")),[O,W]=await Promise.all([Ie(K),Ie(T)]),z=new Map;[...O.docs,...W.docs].forEach(te=>{z.set(te.id,{id:te.id,...te.data()})});var c=Array.from(z.values())}else if(o.role==="school"){d=Me(u,De("school_id","==",o.id));var c=(await Ie(d)).docs.map(O=>({id:O.id,...O.data()}))}else if(o.role==="admin")var c=(await Ie(u)).docs.map(O=>({id:O.id,...O.data()}));else{t({totalProjects:0,activeProjects:0,completedProjects:0,draftProjects:0,averageProgress:0,averageRating:0,projects:[],students:[],teachers:[],schools:[],projectsByCategory:[],projectsByStatus:[],progressDistribution:[],monthlyProgress:[]}),a(!1);return}console.log("Fetched projects:",c.length);const f=Oe(he,"project_evaluations"),x=await Ie(f),p=new Map;x.docs.forEach(K=>{const T=K.data();p.set(T.projectId,T)});const h=Oe(he,"users"),m=await Ie(h),g=new Map;m.docs.forEach(K=>{g.set(K.id,{id:K.id,...K.data()})});const v=Oe(he,"project_students"),b=await Ie(v),y=new Map;b.docs.forEach(K=>{const T=K.data();y.has(T.project_id)||y.set(T.project_id,[]),y.get(T.project_id).push(T)});const N=c.map(K=>{const T=p.get(K.id),O=g.get(K.teacher_id),W=g.get(K.school_id),z=y.get(K.id)||[];let te=0,ae=0;if(T&&T.criteria){const se=T.criteria.find(M=>M.name==="نسبة الإنجاز");te=se?se.score:0,ae=T.criteria.reduce((M,G)=>M+G.score*G.weight,0)}return{id:K.id,title:K.title||"مشروع بدون عنوان",description:K.description||"",category:K.category||"غير محدد",status:K.status||"draft",progress:te,rating:ae,created_at:K.created_at?new Date(K.created_at.toDate()).toISOString():new Date().toISOString(),due_date:K.due_date?new Date(K.due_date.toDate()).toISOString():null,teacher_name:(O==null?void 0:O.name)||"غير محدد",school_name:(W==null?void 0:W.name)||"غير محدد",students_count:z.length,tasks_completed:0,tasks_total:0,evaluation_score:te,weighted_score:ae}});let j=[];o.role==="admin"?j=Array.from(g.values()).filter(T=>T.role==="student").map(T=>{const O=b.docs.filter(G=>G.data().student_id===T.id).map(G=>G.data().project_id),W=c.filter(G=>O.includes(G.id)),z=W.filter(G=>G.status==="completed");let te=0,ae=0,se=0;W.forEach(G=>{const ne=p.get(G.id);if(ne&&ne.criteria){const B=ne.criteria.reduce((ye,Te)=>ye+Te.score*Te.weight,0);te+=B,ae++;const pe=ne.criteria.find(ye=>ye.name==="نسبة الإنجاز");pe&&(se+=pe.score)}});const M=g.get(T.school_id);return{id:T.id,name:T.name||"طالب غير معروف",email:T.email||"",grade:T.grade||"غير محدد",school_name:(M==null?void 0:M.name)||"غير محدد",projects_count:W.length,completed_projects:z.length,average_rating:ae>0?te/ae:0,total_evaluation_score:se}}):o.role==="school"?j=Array.from(g.values()).filter(T=>T.role==="student"&&T.school_id===o.id).map(T=>{const O=b.docs.filter(M=>M.data().student_id===T.id).map(M=>M.data().project_id),W=c.filter(M=>O.includes(M.id)&&M.school_id===o.id),z=W.filter(M=>M.status==="completed");let te=0,ae=0,se=0;return W.forEach(M=>{const G=p.get(M.id);if(G&&G.criteria){const ne=G.criteria.reduce((pe,ye)=>pe+ye.score*ye.weight,0);te+=ne,ae++;const B=G.criteria.find(pe=>pe.name==="نسبة الإنجاز");B&&(se+=B.score)}}),{id:T.id,name:T.name||"طالب غير معروف",email:T.email||"",grade:T.grade||"غير محدد",school_name:o.name||"غير محدد",projects_count:W.length,completed_projects:z.length,average_rating:ae>0?te/ae:0,total_evaluation_score:se}}):o.role==="teacher"&&(j=Array.from(g.values()).filter(T=>T.role==="student"&&T.school_id===o.school_id).map(T=>{const O=b.docs.filter(G=>G.data().student_id===T.id).map(G=>G.data().project_id),W=c.filter(G=>O.includes(G.id)&&G.school_id===o.school_id),z=W.filter(G=>G.status==="completed");let te=0,ae=0,se=0;W.forEach(G=>{const ne=p.get(G.id);if(ne&&ne.criteria){const B=ne.criteria.reduce((ye,Te)=>ye+Te.score*Te.weight,0);te+=B,ae++;const pe=ne.criteria.find(ye=>ye.name==="نسبة الإنجاز");pe&&(se+=pe.score)}});const M=g.get(o.school_id);return{id:T.id,name:T.name||"طالب غير معروف",email:T.email||"",grade:T.grade||"غير محدد",school_name:(M==null?void 0:M.name)||"غير محدد",projects_count:W.length,completed_projects:z.length,average_rating:ae>0?te/ae:0,total_evaluation_score:se}}));let w=[];o.role==="admin"?w=Array.from(g.values()).filter(T=>T.role==="teacher").map(T=>{const O=c.filter(M=>M.teacher_id===T.id),W=O.filter(M=>M.status==="completed");let z=0,te=0;O.forEach(M=>{const G=p.get(M.id);if(G&&G.criteria){const ne=G.criteria.reduce((B,pe)=>B+pe.score*pe.weight,0);z+=ne,te++}});const ae=new Set;O.forEach(M=>{(y.get(M.id)||[]).forEach(ne=>ae.add(ne.student_id))});const se=g.get(T.school_id);return{id:T.id,name:T.name||"مشرف غير معروف",email:T.email||"",subject:T.subject||"غير محدد",school_name:(se==null?void 0:se.name)||"غير محدد",projects_count:O.length,students_count:ae.size,average_project_rating:te>0?z/te:0,completed_projects:W.length}}):o.role==="school"&&(w=Array.from(g.values()).filter(T=>T.role==="teacher"&&T.school_id===o.id).map(T=>{const O=c.filter(se=>se.teacher_id===T.id&&se.school_id===o.id),W=O.filter(se=>se.status==="completed");let z=0,te=0;O.forEach(se=>{const M=p.get(se.id);if(M&&M.criteria){const G=M.criteria.reduce((ne,B)=>ne+B.score*B.weight,0);z+=G,te++}});const ae=new Set;return O.forEach(se=>{(y.get(se.id)||[]).forEach(G=>ae.add(G.student_id))}),{id:T.id,name:T.name||"مشرف غير معروف",email:T.email||"",subject:T.subject||"غير محدد",school_name:o.name||"غير محدد",projects_count:O.length,students_count:ae.size,average_project_rating:te>0?z/te:0,completed_projects:W.length}}));let _=[];o.role==="admin"&&(_=Array.from(g.values()).filter(T=>T.role==="school").map(T=>{const O=c.filter(G=>G.school_id===T.id),W=Array.from(g.values()).filter(G=>G.role==="teacher"&&G.school_id===T.id).length,z=Array.from(g.values()).filter(G=>G.role==="student"&&G.school_id===T.id).length;let te=0,ae=0;O.forEach(G=>{const ne=p.get(G.id);if(ne&&ne.criteria){const B=ne.criteria.reduce((pe,ye)=>pe+ye.score*ye.weight,0);te+=B,ae++}});const se=O.filter(G=>G.status==="completed"),M=O.length>0?se.length/O.length*100:0;return{id:T.id,name:T.name||"مدرسة غير معروفة",email:T.email||"",projects_count:O.length,teachers_count:W,students_count:z,average_rating:ae>0?te/ae:0,completion_rate:M}}));const S=N.length,k=N.filter(K=>K.status==="active").length,E=N.filter(K=>K.status==="completed").length,A=N.filter(K=>K.status==="draft").length,P=S>0?N.reduce((K,T)=>K+T.progress,0)/S:0,L=S>0?N.reduce((K,T)=>K+T.rating,0)/S:0,R=new Map;N.forEach(K=>{const T=K.category;R.set(T,(R.get(T)||0)+1)});const I=Array.from(R.entries()).map(([K,T])=>({name:K==="stem"?"العلوم والتقنية":K==="entrepreneurship"?"ريادة الأعمال":K==="volunteer"?"التطوع":K==="ethics"?"الأخلاق":K,value:T,color:K==="stem"?"#3B82F6":K==="entrepreneurship"?"#10B981":K==="volunteer"?"#F59E0B":K==="ethics"?"#EF4444":"#6B7280"})),D=[];for(let K=5;K>=0;K--){const T=new Date;T.setMonth(T.getMonth()-K);const O=T.toLocaleDateString("ar-SA",{month:"long"}),W=N.filter(ae=>{const se=new Date(ae.created_at);return se.getMonth()===T.getMonth()&&se.getFullYear()===T.getFullYear()}),z=W.filter(ae=>ae.status==="completed").length,te=W.length>0?z/W.length*100:0;D.push({name:O,projects:W.length,completion:te})}const F=[{range:"0-20%",min:0,max:2},{range:"21-40%",min:2.1,max:4},{range:"41-60%",min:4.1,max:6},{range:"61-80%",min:6.1,max:8},{range:"81-100%",min:8.1,max:10}].map(K=>({range:K.range,count:N.filter(T=>T.progress>=K.min&&T.progress<=K.max).length})),q={totalProjects:S,activeProjects:k,completedProjects:E,draftProjects:A,averageProgress:P,averageRating:L,projects:N,students:j,teachers:w,schools:_,projectsByCategory:I,projectsByStatus:[{name:"المشاريع",مكتملة:E,نشطة:k,مسودة:A}],progressDistribution:F,monthlyProgress:D};console.log("Reports data processed:",{totalProjects:q.totalProjects,projectsCount:q.projects.length,studentsCount:q.students.length,teachersCount:q.teachers.length,schoolsCount:q.schools.length}),t(q)}catch(d){console.error("Error fetching reports data:",d),i(d instanceof Error?d.message:"حدث خطأ في تحميل بيانات التقارير")}finally{a(!1)}};return C.useEffect(()=>{o&&l()},[o]),{reportsData:e,loading:r,error:s,refetchData:l}},lu=({data:e,columns:t,title:r,searchPlaceholder:a="البحث...",exportFileName:s="report",className:i=""})=>{const[o,l]=C.useState(""),[c,d]=C.useState(null),u=C.useMemo(()=>{let m=[...e];if(o){const g=t.filter(v=>v.searchable!==!1);m=m.filter(v=>g.some(b=>{const y=v[b.key];return y&&y.toString().toLowerCase().includes(o.toLowerCase())}))}return c&&m.sort((g,v)=>{const b=g[c.key],y=v[c.key];if(b==null)return 1;if(y==null)return-1;if(typeof b=="number"&&typeof y=="number")return c.direction==="asc"?b-y:y-b;const N=b.toString().toLowerCase(),j=y.toString().toLowerCase();return N<j?c.direction==="asc"?-1:1:N>j?c.direction==="asc"?1:-1:0}),m},[e,o,c,t]),f=m=>{const g=t.find(v=>v.key===m);!g||g.sortable===!1||d(v=>(v==null?void 0:v.key)===m?{key:m,direction:v.direction==="asc"?"desc":"asc"}:{key:m,direction:"asc"})},x=m=>{const g=t.find(v=>v.key===m);return!g||g.sortable===!1?null:(c==null?void 0:c.key)===m?c.direction==="asc"?n.jsx(iP,{className:"w-4 h-4"}):n.jsx(oP,{className:"w-4 h-4"}):n.jsx(lP,{className:"w-4 h-4 opacity-50"})},p=()=>{try{const m=u.map(b=>{const y={};return t.forEach(N=>{y[N.label]=b[N.key]}),y}),g=Vt.json_to_sheet(m),v=Vt.book_new();Vt.book_append_sheet(v,g,r),wd(v,`${s}.xlsx`)}catch(m){console.error("Error exporting to Excel:",m),alert("حدث خطأ أثناء تصدير البيانات")}},h=()=>{try{const m=u.map(j=>{const w={};return t.forEach(_=>{w[_.label]=j[_.key]}),w}),g=Vt.json_to_sheet(m),v=Vt.sheet_to_csv(g),b=new Blob([v],{type:"text/csv;charset=utf-8;"}),y=document.createElement("a"),N=URL.createObjectURL(b);y.setAttribute("href",N),y.setAttribute("download",`${s}.csv`),y.style.visibility="hidden",document.body.appendChild(y),y.click(),document.body.removeChild(y)}catch(m){console.error("Error exporting to CSV:",m),alert("حدث خطأ أثناء تصدير البيانات")}};return n.jsxs("div",{className:`bg-white rounded-2xl shadow-lg overflow-hidden ${i}`,children:[n.jsxs("div",{className:"p-6 border-b border-gray-200",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:r}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:p,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors flex items-center gap-2 text-sm",children:[n.jsx(Yl,{className:"w-4 h-4"}),"Excel"]}),n.jsxs("button",{onClick:h,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 text-sm",children:[n.jsx(cr,{className:"w-4 h-4"}),"CSV"]})]})]}),n.jsxs("div",{className:"relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:a,value:o,onChange:m=>l(m.target.value),className:"w-full pr-12 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:["عرض ",u.length," من أصل ",e.length," عنصر"]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsx("tr",{children:t.map(m=>n.jsx("th",{scope:"col",className:`px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 ${m.className||""}`,onClick:()=>f(m.key),children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:m.label}),x(m.key)]})},m.key))})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.length>0?u.map((m,g)=>n.jsx("tr",{className:"hover:bg-gray-50",children:t.map(v=>n.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${v.className||""}`,children:v.render?v.render(m[v.key],m):m[v.key]||"-"},v.key))},m.id||g)):n.jsx("tr",{children:n.jsx("td",{colSpan:t.length,className:"px-6 py-12 text-center text-gray-500",children:o?"لم يتم العثور على نتائج تطابق البحث":"لا توجد بيانات متاحة"})})})]})})]})},Ple=e=>{const t=[{id:"overview",name:"نظرة عامة",icon:Ts},{id:"projects",name:"تقارير المشاريع",icon:bt}];return e==="admin"?[...t,{id:"schools",name:"تقارير المدارس",icon:fa},{id:"users",name:"تقارير المستخدمين",icon:dt},{id:"performance",name:"تقارير الأداء",icon:di}]:e==="school"?[...t,{id:"teachers",name:"تقارير المشرفين",icon:dt},{id:"students",name:"تقارير الطلاب",icon:dt}]:e==="teacher"?[...t,{id:"students",name:"تقارير الطلاب",icon:dt}]:t},Ole=()=>{const{user:e}=ut(),{reportsData:t,loading:r,error:a}=Cle(),[s,i]=C.useState("overview"),o=Ple((e==null?void 0:e.role)||"student"),l=[{key:"title",label:"عنوان المشروع",render:(x,p)=>n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-gray-900",children:x}),n.jsx("div",{className:"text-sm text-gray-500 line-clamp-1",children:p.description})]})},{key:"category",label:"الفئة",render:x=>n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:x==="stem"?"العلوم والتقنية":x==="entrepreneurship"?"ريادة الأعمال":x==="volunteer"?"التطوع":x==="ethics"?"الأخلاق":x})},{key:"status",label:"الحالة",render:x=>n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${x==="completed"?"bg-green-100 text-green-800":x==="active"?"bg-blue-100 text-blue-800":x==="draft"?"bg-gray-100 text-gray-800":"bg-purple-100 text-purple-800"}`,children:x==="completed"?"مكتمل":x==="active"?"نشط":x==="draft"?"مسودة":"مؤرشف"})},{key:"progress",label:"نسبة الإنجاز",render:x=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:`h-2 rounded-full ${x>=8?"bg-green-500":x>=5?"bg-blue-500":"bg-yellow-500"}`,style:{width:`${x/10*100}%`}})}),n.jsxs("span",{className:"font-medium",children:[x,"/10"]})]})},{key:"weighted_score",label:"الدرجة الموزونة",render:x=>n.jsxs("span",{className:"font-medium text-purple-600",children:[x.toFixed(2),"/10"]})},{key:"teacher_name",label:"المشرف"},{key:"school_name",label:"المدرسة"},{key:"students_count",label:"عدد الطلاب"},{key:"created_at",label:"تاريخ الإنشاء",render:x=>Ye(x)}],c=[{key:"name",label:"اسم الطالب",render:(x,p)=>n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-gray-900",children:x}),n.jsx("div",{className:"text-sm text-gray-500",children:p.email})]})},{key:"grade",label:"الصف الدراسي"},{key:"school_name",label:"المدرسة"},{key:"projects_count",label:"عدد المشاريع"},{key:"completed_projects",label:"المشاريع المكتملة"},{key:"average_rating",label:"متوسط التقييم",render:x=>n.jsxs("span",{className:"font-medium text-blue-600",children:[x.toFixed(1),"/10"]})},{key:"total_evaluation_score",label:"مجموع درجات الإنجاز",render:x=>n.jsx("span",{className:"font-medium text-green-600",children:x.toFixed(1)})}],d=[{key:"name",label:"اسم المشرف",render:(x,p)=>n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-gray-900",children:x}),n.jsx("div",{className:"text-sm text-gray-500",children:p.email})]})},{key:"subject",label:"التخصص"},{key:"school_name",label:"المدرسة"},{key:"projects_count",label:"عدد المشاريع"},{key:"completed_projects",label:"المشاريع المكتملة"},{key:"students_count",label:"عدد الطلاب"},{key:"average_project_rating",label:"متوسط تقييم المشاريع",render:x=>n.jsxs("span",{className:"font-medium text-blue-600",children:[x.toFixed(1),"/10"]})}],u=[{key:"name",label:"اسم المدرسة",render:(x,p)=>n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-gray-900",children:x}),n.jsx("div",{className:"text-sm text-gray-500",children:p.email})]})},{key:"projects_count",label:"عدد المشاريع"},{key:"teachers_count",label:"عدد المشرفين"},{key:"students_count",label:"عدد الطلاب"},{key:"completion_rate",label:"معدل الإنجاز",render:x=>n.jsxs("span",{className:"font-medium text-green-600",children:[x.toFixed(1),"%"]})},{key:"average_rating",label:"متوسط التقييم",render:x=>n.jsxs("span",{className:"font-medium text-blue-600",children:[x.toFixed(1),"/10"]})}],f=()=>{if(t)try{const x=Vt.book_new();if(t.projects.length>0){const p=t.projects.map(m=>({"عنوان المشروع":m.title,الوصف:m.description,الفئة:m.category==="stem"?"العلوم والتقنية":m.category==="entrepreneurship"?"ريادة الأعمال":m.category==="volunteer"?"التطوع":m.category==="ethics"?"الأخلاق":m.category,الحالة:m.status==="completed"?"مكتمل":m.status==="active"?"نشط":m.status==="draft"?"مسودة":"مؤرشف","نسبة الإنجاز":`${m.progress}/10`,"الدرجة الموزونة":m.weighted_score.toFixed(2),المشرف:m.teacher_name,المدرسة:m.school_name,"عدد الطلاب":m.students_count,"تاريخ الإنشاء":Ye(m.created_at),"الموعد النهائي":m.due_date?Ye(m.due_date):"غير محدد"})),h=Vt.json_to_sheet(p);Vt.book_append_sheet(x,h,"المشاريع")}if(t.students.length>0){const p=t.students.map(m=>({"اسم الطالب":m.name,"البريد الإلكتروني":m.email,"الصف الدراسي":m.grade,المدرسة:m.school_name,"عدد المشاريع":m.projects_count,"المشاريع المكتملة":m.completed_projects,"متوسط التقييم":m.average_rating.toFixed(1),"مجموع درجات الإنجاز":m.total_evaluation_score.toFixed(1)})),h=Vt.json_to_sheet(p);Vt.book_append_sheet(x,h,"الطلاب")}if(t.teachers.length>0){const p=t.teachers.map(m=>({"اسم المشرف":m.name,"البريد الإلكتروني":m.email,التخصص:m.subject,المدرسة:m.school_name,"عدد المشاريع":m.projects_count,"المشاريع المكتملة":m.completed_projects,"عدد الطلاب":m.students_count,"متوسط تقييم المشاريع":m.average_project_rating.toFixed(1)})),h=Vt.json_to_sheet(p);Vt.book_append_sheet(x,h,"المشرفين")}if(t.schools.length>0){const p=t.schools.map(m=>({"اسم المدرسة":m.name,"البريد الإلكتروني":m.email,"عدد المشاريع":m.projects_count,"عدد المشرفين":m.teachers_count,"عدد الطلاب":m.students_count,"معدل الإنجاز":`${m.completion_rate.toFixed(1)}%`,"متوسط التقييم":m.average_rating.toFixed(1)})),h=Vt.json_to_sheet(p);Vt.book_append_sheet(x,h,"المدارس")}wd(x,`تقرير_شامل_${new Date().toISOString().split("T")[0]}.xlsx`)}catch(x){console.error("Error exporting data:",x),alert("حدث خطأ أثناء تصدير البيانات")}};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-indigo-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ge,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:a})]})}):t?n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Ts,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"التقارير والإحصائيات"}),n.jsx("p",{className:"opacity-90",children:"تحليل شامل لأداء المنصة والمشاريع"})]})]}),n.jsx("div",{className:"flex items-center gap-3",children:n.jsxs("button",{onClick:f,className:"bg-white text-indigo-600 px-6 py-2 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(Mr,{className:"w-5 h-5"}),"تصدير شامل"]})})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.totalProjects}),n.jsx("div",{className:"text-sm opacity-80",children:"مشروع نشط"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.completedProjects}),n.jsx("div",{className:"text-sm opacity-80",children:"مشروع مكتمل"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.averageProgress.toFixed(1)}),n.jsx("div",{className:"text-sm opacity-80",children:"متوسط نسبة الإنجاز"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.averageRating.toFixed(1)}),n.jsx("div",{className:"text-sm opacity-80",children:"متوسط التقييم"})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("div",{className:"border-b border-gray-200 mb-6",children:n.jsx("nav",{className:"flex space-x-8",children:o.map(x=>n.jsxs("button",{onClick:()=>i(x.id),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${s===x.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(x.icon,{className:"w-4 h-4"}),x.name]},x.id))})}),s==="overview"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:[{title:"إجمالي المشاريع",value:t.totalProjects.toString(),change:"+12%",trend:"up",icon:bt,color:"from-blue-500 to-blue-600"},{title:"المشاريع النشطة",value:t.activeProjects.toString(),change:"+8%",trend:"up",icon:l1,color:"from-green-500 to-green-600"},{title:"متوسط نسبة الإنجاز",value:`${t.averageProgress.toFixed(1)}/10`,change:"+5%",trend:"up",icon:lr,color:"from-purple-500 to-purple-600"},{title:"متوسط التقييم",value:t.averageRating.toFixed(1),change:"+0.2",trend:"up",icon:di,color:"from-orange-500 to-orange-600"}].map((x,p)=>n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:p*.1},className:"bg-white border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-all",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("div",{className:`w-12 h-12 bg-gradient-to-r ${x.color} rounded-xl flex items-center justify-center`,children:n.jsx(x.icon,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{className:`flex items-center gap-1 text-sm font-medium ${x.trend==="up"?"text-green-600":"text-red-600"}`,children:[n.jsx(di,{className:"w-4 h-4"}),x.change]})]}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-1",children:x.value}),n.jsx("p",{className:"text-gray-600 text-sm",children:x.title})]},x.title))}),n.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"تطور المشاريع الشهرية"}),n.jsx(mp,{width:"100%",height:300,children:n.jsxs(Ale,{data:t.monthlyProgress,children:[n.jsx(Gy,{strokeDasharray:"3 3"}),n.jsx(Zo,{dataKey:"name"}),n.jsx(tl,{}),n.jsx(Ga,{}),n.jsx(os,{type:"monotone",dataKey:"projects",stackId:"1",stroke:"#3B82F6",fill:"#3B82F6"}),n.jsx(os,{type:"monotone",dataKey:"completion",stackId:"2",stroke:"#10B981",fill:"#10B981"})]})})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"توزيع المشاريع حسب الفئة"}),n.jsx(mp,{width:"100%",height:300,children:n.jsxs(Tle,{children:[n.jsx(ms,{data:t.projectsByCategory,cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",label:({name:x,percent:p})=>`${x} ${(p*100).toFixed(0)}%`,children:t.projectsByCategory.map((x,p)=>n.jsx(u0,{fill:x.color},`cell-${p}`))}),n.jsx(Ga,{})]})})]})]})]}),s==="projects"&&n.jsx(lu,{data:t.projects,columns:l,title:"تقرير المشاريع التفصيلي",searchPlaceholder:"البحث في المشاريع...",exportFileName:"تقرير_المشاريع"}),s==="students"&&n.jsx(lu,{data:t.students,columns:c,title:"تقرير الطلاب التفصيلي",searchPlaceholder:"البحث في الطلاب...",exportFileName:"تقرير_الطلاب"}),s==="teachers"&&n.jsx(lu,{data:t.teachers,columns:d,title:"تقرير المشرفين التفصيلي",searchPlaceholder:"البحث في المشرفين...",exportFileName:"تقرير_المشرفين"}),s==="schools"&&n.jsx(lu,{data:t.schools,columns:u,title:"تقرير المدارس التفصيلي",searchPlaceholder:"البحث في المدارس...",exportFileName:"تقرير_المدارس"}),s==="performance"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"توزيع نسب الإنجاز"}),n.jsx(mp,{width:"100%",height:400,children:n.jsxs(Ele,{data:t.progressDistribution,children:[n.jsx(Gy,{strokeDasharray:"3 3"}),n.jsx(Zo,{dataKey:"range"}),n.jsx(tl,{}),n.jsx(Ga,{}),n.jsx(zi,{dataKey:"count",fill:"#3B82F6"})]})})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(di,{className:"w-8 h-8 text-blue-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:t.averageProgress.toFixed(1)}),n.jsx("p",{className:"text-gray-600",children:"متوسط نسبة الإنجاز"}),n.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"من 10 درجات"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(lr,{className:"w-8 h-8 text-green-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:t.averageRating.toFixed(1)}),n.jsx("p",{className:"text-gray-600",children:"متوسط التقييم الموزون"}),n.jsx("p",{className:"text-green-600 text-sm mt-1",children:"من 10 درجات"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(l1,{className:"w-8 h-8 text-yellow-600"})}),n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:[t.totalProjects>0?(t.completedProjects/t.totalProjects*100).toFixed(1):0,"%"]}),n.jsx("p",{className:"text-gray-600",children:"معدل إكمال المشاريع"}),n.jsxs("p",{className:"text-yellow-600 text-sm mt-1",children:[t.completedProjects," من ",t.totalProjects]})]})]})]})]}),((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="school")&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(bt,{className:"w-8 h-8 text-blue-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:t.projects.length}),n.jsx("p",{className:"text-gray-600",children:"إجمالي المشاريع"})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(dt,{className:"w-8 h-8 text-green-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:t.students.length}),n.jsx("p",{className:"text-gray-600",children:"إجمالي الطلاب"})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(bt,{className:"w-8 h-8 text-purple-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:t.teachers.length}),n.jsx("p",{className:"text-gray-600",children:"إجمالي المشرفين"})]}),(e==null?void 0:e.role)==="admin"&&n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(fa,{className:"w-8 h-8 text-yellow-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:t.schools.length}),n.jsx("p",{className:"text-gray-600",children:"إجمالي المدارس"})]})]})]}):n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ts,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لا توجد بيانات"}),n.jsx("p",{className:"text-gray-600",children:"لا توجد بيانات تقارير متاحة"})]})})},Ile=()=>{const{t:e}=ft(),{consultants:t,loading:r,error:a}=Ms(),[s,i]=C.useState(""),[o,l]=C.useState("all"),[c,d]=C.useState(0),[u,f]=C.useState(!1),[x,p]=C.useState(!1),[h,m]=C.useState(null),g=["all",...new Set(t.flatMap(b=>b.specialties))],v=t.filter(b=>{const y=b.name.toLowerCase().includes(s.toLowerCase())||b.title.toLowerCase().includes(s.toLowerCase())||b.specialties.some(w=>w.toLowerCase().includes(s.toLowerCase())),N=o==="all"||b.specialties.includes(o),j=b.rating>=c;return y&&N&&j});return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ge,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(wt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("search.title")}),n.jsx("p",{className:"opacity-90",children:e("search.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("search.stats.availableConsultants")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:g.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("search.stats.specialties")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"24/7"}),n.jsx("div",{className:"text-sm opacity-80",children:e("search.stats.support")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"100%"}),n.jsx("div",{className:"text-sm opacity-80",children:e("search.stats.satisfaction")})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("search.searchPlaceholder"),value:s,onChange:b=>i(b.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>f(!u),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(nl,{className:"w-5 h-5"}),e("common.filter")]})]}),n.jsxs("div",{className:`mt-4 space-y-4 ${u?"block":"hidden lg:block"}`,children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("search.specialty")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(b=>n.jsx("button",{onClick:()=>l(b),className:`px-4 py-2 rounded-xl transition-all ${o===b?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:b==="all"?e("search.allSpecialties"):b},b))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("search.rating")}),n.jsx("div",{className:"flex items-center gap-2",children:[0,3,3.5,4,4.5].map(b=>n.jsx("button",{onClick:()=>d(b),className:`flex items-center gap-1 px-4 py-2 rounded-xl transition-all ${c===b?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:b===0?e("common.all"):n.jsxs(n.Fragment,{children:[n.jsx(lt,{className:"w-4 h-4"}),b,"+"]})},b))})]})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("search.showing")," ",v.length," ",e("search.of")," ",t.length," ",e("search.consultant")]})}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map((b,y)=>n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:y*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300",children:[n.jsxs("div",{className:"text-center mb-4",children:[n.jsx("img",{src:b.avatar,alt:b.name,className:"w-24 h-24 rounded-full object-cover mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:b.name}),n.jsx("p",{className:"text-gray-600 mb-2",children:b.title}),n.jsxs("div",{className:"flex items-center justify-center gap-1 mb-2",children:[n.jsx(lt,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:b.rating}),n.jsxs("span",{className:"text-gray-500 text-sm",children:["(",b.reviews," ",e("search.reviews"),")"]})]}),n.jsx("span",{className:"inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:b.availability})]}),n.jsxs("div",{className:"space-y-3 mb-4",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("search.specialties"),":"]}),n.jsx("div",{className:"flex flex-wrap gap-1",children:b.specialties.map((N,j)=>n.jsx("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-800 text-xs rounded-lg",children:N},j))})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("search.experience"),":"]}),n.jsx("span",{className:"font-medium",children:b.experience})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("search.price"),":"]}),n.jsxs("span",{className:"font-medium text-emerald-600",children:[b.hourlyRate," ",e("search.pricePerHour")]})]}),n.jsxs("div",{children:[n.jsxs("span",{className:"text-gray-600 text-sm",children:[e("search.languages"),": "]}),n.jsx("span",{className:"text-sm",children:b.languages.join(", ")})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>{m(b.id),p(!0)},className:"flex-1 bg-emerald-500 text-white py-2 px-4 rounded-xl hover:bg-emerald-600 transition-colors font-medium",children:e("search.bookConsultation")}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:n.jsx(rr,{className:"w-4 h-4"})})]})]},b.id))}),v.length===0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(wt,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("search.noConsultantsFound")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("search.tryChangingFilters")}),n.jsx("button",{onClick:()=>{l("all"),d(0),i("")},className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:e("common.resetFilters")})]}),x&&h&&n.jsx(BE,{consultant:t.find(b=>b.id===h),onClose:()=>{p(!1),m(null)},onSubmit:b=>{console.log("Booking consultation:",b),p(!1),m(null)}})]})},Fle=()=>{const{t:e}=ft(),[t,r]=C.useState([]),[a,s]=C.useState(""),[i,o]=C.useState("all"),l=["all",...new Set(t.flatMap(u=>u.specialties))],c=t.filter(u=>{const f=u.name.toLowerCase().includes(a.toLowerCase())||u.title.toLowerCase().includes(a.toLowerCase())||u.specialties.some(p=>p.toLowerCase().includes(a.toLowerCase())),x=i==="all"||u.specialties.includes(i);return f&&x}),d=u=>{r(f=>f.filter(x=>x.id!==u))};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(lt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("favorites.title")}),n.jsx("p",{className:"opacity-90",children:e("favorites.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("favorites.stats.favoriteConsultants")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:l.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("favorites.stats.differentSpecialties")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:Math.round(t.reduce((u,f)=>u+f.rating,0)/t.length*10)/10}),n.jsx("div",{className:"text-sm opacity-80",children:e("favorites.stats.averageRating")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:Math.round(t.reduce((u,f)=>u+f.hourlyRate,0)/t.length)}),n.jsx("div",{className:"text-sm opacity-80",children:e("favorites.stats.averagePrice")})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("favorites.searchPlaceholder"),value:a,onChange:u=>s(u.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]})}),n.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("favorites.specialty")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(u=>n.jsx("button",{onClick:()=>o(u),className:`px-4 py-2 rounded-xl transition-all ${i===u?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:u==="all"?e("favorites.allSpecialties"):u},u))})]})})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("favorites.showing")," ",c.length," ",e("favorites.of")," ",t.length," ",e("favorites.consultant")]})}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map((u,f)=>n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:f*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300",children:[n.jsxs("div",{className:"text-center mb-4 relative",children:[n.jsx("button",{onClick:()=>d(u.id),className:"absolute top-0 left-0 p-2 bg-red-100 text-red-600 rounded-full hover:bg-red-200 transition-colors",children:n.jsx(Xa,{className:"w-5 h-5 fill-current"})}),n.jsx("img",{src:u.avatar,alt:u.name,className:"w-24 h-24 rounded-full object-cover mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:u.name}),n.jsx("p",{className:"text-gray-600 mb-2",children:u.title}),n.jsxs("div",{className:"flex items-center justify-center gap-1 mb-2",children:[n.jsx(lt,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:u.rating}),n.jsxs("span",{className:"text-gray-500 text-sm",children:["(",u.reviews," ",e("favorites.reviews"),")"]})]}),n.jsx("span",{className:"inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium flex items-center gap-1",children:u.availability})]}),n.jsxs("div",{className:"space-y-3 mb-4",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("favorites.specialties"),":"]}),n.jsx("div",{className:"flex flex-wrap gap-1",children:u.specialties.map((x,p)=>n.jsx("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-800 text-xs rounded-lg",children:x},p))})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("favorites.experience"),":"]}),n.jsx("span",{className:"font-medium",children:u.experience})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("favorites.price"),":"]}),n.jsxs("span",{className:"font-medium text-emerald-600",children:[u.hourlyRate," ",e("favorites.pricePerHour")]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("favorites.location"),":"]}),n.jsx("span",{className:"font-medium",children:u.location})]}),n.jsxs("div",{children:[n.jsxs("span",{className:"text-gray-600 text-sm",children:[e("favorites.languages"),": "]}),n.jsx("span",{className:"text-sm",children:u.languages.join(", ")})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(ke,{to:`/consultations?consultant=${u.id}`,className:"flex-1 bg-emerald-500 text-white py-2 px-4 rounded-xl hover:bg-emerald-600 transition-colors font-medium",children:e("favorites.bookConsultation")}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:n.jsx(rr,{className:"w-4 h-4"})})]})]},u.id))}),c.length===0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(lt,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("favorites.noFavorites")}),n.jsx("p",{className:"text-gray-600 mb-4",children:t.length===0?e("favorites.noFavoritesAdded"):e("favorites.noFavoritesMatch")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsx(ke,{to:"/search",className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:e("favorites.searchConsultants")}),t.length>0&&n.jsx("button",{onClick:()=>{o("all"),s("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.resetFilters")})]})]})]})},Dle=()=>{const{user:e}=ut(),{consultations:t,loading:r,error:a,acceptConsultation:s}=Ms(),[i,o]=C.useState("all"),[l,c]=C.useState(""),[d,u]=C.useState(!1),f=t.filter(y=>y.status==="pending"&&y.mentor_id===null),x=t.filter(y=>y.mentor_id===(e==null?void 0:e.id)),p=x.filter(y=>{const N=i==="all"||y.status===i,j=y.topic.toLowerCase().includes(l.toLowerCase())||y.description.toLowerCase().includes(l.toLowerCase());return N&&j}),h=async y=>{try{u(!0),await s(y)}catch(N){console.error("Error accepting consultation:",N)}finally{u(!1)}},m=y=>{switch(y){case"pending":return"bg-yellow-100 text-yellow-800";case"scheduled":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},g=y=>{switch(y){case"pending":return"في الانتظار";case"scheduled":return"مجدولة";case"completed":return"مكتملة";case"cancelled":return"ملغية";default:return y}},v=y=>{switch(y){case"video":return n.jsx(ar,{className:"w-4 h-4"});case"phone":return n.jsx(Cr,{className:"w-4 h-4"});case"chat":return n.jsx(Hr,{className:"w-4 h-4"});default:return n.jsx(rr,{className:"w-4 h-4"})}},b=y=>{switch(y){case"video":return"مكالمة فيديو";case"phone":return"مكالمة صوتية";case"chat":return"محادثة نصية";default:return y}};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ja,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(As,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"لوحة تحكم المستشار"}),n.jsxs("p",{className:"opacity-90",children:["مرحباً ",e==null?void 0:e.name,"، إدارة الاستشارات والمواعيد"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x.length}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي الاستشارات"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x.filter(y=>y.status==="scheduled").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مجدولة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x.filter(y=>y.status==="completed").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مكتملة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:f.length}),n.jsx("div",{className:"text-sm opacity-80",children:"طلبات جديدة"})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(rr,{className:"w-6 h-6 text-emerald-600"}),"طلبات الاستشارة الجديدة"]}),f.length>0?n.jsx("div",{className:"space-y-4",children:f.map(y=>n.jsx(re.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-xl p-6 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:y.topic}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${m(y.status)}`,children:g(y.status)})]}),n.jsx("p",{className:"text-gray-600 mb-2",children:y.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[v(y.method),b(y.method)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(xt,{className:"w-4 h-4"}),y.duration," دقيقة"]}),y.preferredDate&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ot,{className:"w-4 h-4"}),"التاريخ المفضل: ",Ye(y.preferredDate)]})]})]}),n.jsx("button",{onClick:()=>h(y.id),disabled:d,className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d?"جاري القبول...":"قبول الطلب"})]})},y.id))}):n.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(rr,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد طلبات جديدة"}),n.jsx("p",{className:"text-gray-600",children:"ستظهر هنا طلبات الاستشارة الجديدة التي يمكنك قبولها"})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs(ke,{to:"/consultation-requests",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:["عرض جميع الطلبات",n.jsx(fc,{className:"w-4 h-4"})]})})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(ot,{className:"w-6 h-6 text-emerald-600"}),"استشاراتي"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في الاستشارات...",value:l,onChange:y=>c(y.target.value),className:"w-64 pr-12 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("select",{value:i,onChange:y=>o(y.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:"جميع الحالات"}),n.jsx("option",{value:"scheduled",children:"مجدولة"}),n.jsx("option",{value:"completed",children:"مكتملة"}),n.jsx("option",{value:"cancelled",children:"ملغية"})]})]})]}),p.length>0?n.jsx("div",{className:"space-y-4",children:p.map(y=>n.jsxs(re.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-xl p-6 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:y.topic}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${m(y.status)}`,children:g(y.status)})]}),n.jsx("p",{className:"text-gray-600 mb-2",children:y.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[v(y.method),b(y.method)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(xt,{className:"w-4 h-4"}),y.duration," دقيقة"]}),y.scheduledDate&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ot,{className:"w-4 h-4"}),"موعد الاستشارة: ",Ye(y.scheduledDate)]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[y.status==="scheduled"&&n.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",onClick:()=>window.open("https://meet.google.com/new","_blank"),children:"بدء الاستشارة"}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"عرض التفاصيل"})]})]}),y.status==="completed"&&y.rating&&n.jsxs("div",{className:"mt-2 flex items-center gap-1",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"التقييم:"}),n.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(N=>n.jsx(lt,{className:`w-4 h-4 ${N<=y.rating?"text-yellow-400 fill-current":"text-gray-300"}`},N))}),y.feedback&&n.jsxs("span",{className:"text-sm text-gray-600 mr-2",children:['"',y.feedback,'"']})]})]},y.id))}):n.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ot,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد استشارات"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم العثور على استشارات تطابق معايير البحث"})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs(ke,{to:"/consultant-schedule",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:["عرض جدول المواعيد",n.jsx(fc,{className:"w-4 h-4"})]})})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center",children:n.jsx(lt,{className:"w-6 h-6 text-emerald-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"التقييمات"}),n.jsx("p",{className:"text-gray-600",children:"متوسط تقييم استشاراتك"})]})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(y=>n.jsx(lt,{className:`w-6 h-6 ${y<=4.5?"text-yellow-400 fill-current":"text-gray-300"}`},y))}),n.jsx("span",{className:"text-2xl font-bold text-gray-800",children:"4.5"})]}),n.jsxs("p",{className:"text-sm text-gray-600",children:["من ",x.filter(y=>y.rating).length," تقييم"]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:n.jsx(dt,{className:"w-6 h-6 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"العملاء"}),n.jsx("p",{className:"text-gray-600",children:"عدد العملاء الذين قدمت لهم استشارات"})]})]}),n.jsx("div",{className:"text-2xl font-bold text-gray-800 mb-2",children:new Set(x.map(y=>y.student_id)).size}),n.jsx("p",{className:"text-sm text-gray-600",children:"عميل فريد"})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:n.jsx(di,{className:"w-6 h-6 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"الإيرادات"}),n.jsx("p",{className:"text-gray-600",children:"إجمالي الإيرادات من الاستشارات"})]})]}),n.jsxs("div",{className:"text-2xl font-bold text-gray-800 mb-2",children:[x.filter(y=>y.status==="completed").reduce((y,N)=>y+N.duration/60*((e==null?void 0:e.hourly_rate)||150),0).toFixed(0)," ر.س"]}),n.jsxs("p",{className:"text-sm text-gray-600",children:["من ",x.filter(y=>y.status==="completed").length," استشارة مكتملة"]})]})]})]})},Rle=()=>{const{user:e}=ut(),{consultations:t,loading:r,error:a,acceptConsultation:s}=Ms(),[i,o]=C.useState(""),[l,c]=C.useState("all"),[d,u]=C.useState(!1),[f,x]=C.useState(1),p=5,h=t.filter(j=>j.status==="pending"&&j.mentor_id===null),m=h.filter(j=>{const w=l==="all"||j.type===l,_=j.topic.toLowerCase().includes(i.toLowerCase())||j.description.toLowerCase().includes(i.toLowerCase());return w&&_}),g=Math.ceil(m.length/p),v=m.slice((f-1)*p,f*p),b=async j=>{try{u(!0),await s(j)}catch(w){console.error("Error accepting consultation:",w)}finally{u(!1)}},y=j=>{switch(j){case"video":return n.jsx(ar,{className:"w-4 h-4"});case"phone":return n.jsx(Cr,{className:"w-4 h-4"});case"chat":return n.jsx(Hr,{className:"w-4 h-4"});default:return n.jsx(rr,{className:"w-4 h-4"})}},N=j=>{switch(j){case"video":return"مكالمة فيديو";case"phone":return"مكالمة صوتية";case"chat":return"محادثة نصية";default:return j}};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ge,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(rr,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"طلبات الاستشارة"}),n.jsx("p",{className:"opacity-90",children:"اختر الطلبات التي ترغب في قبولها"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:h.length}),n.jsx("div",{className:"text-sm opacity-80",children:"طلب استشارة متاح"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:h.filter(j=>j.type==="technical").length}),n.jsx("div",{className:"text-sm opacity-80",children:"استشارة تقنية"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:h.filter(j=>j.type==="academic").length}),n.jsx("div",{className:"text-sm opacity-80",children:"استشارة أكاديمية"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:h.filter(j=>j.type==="project").length}),n.jsx("div",{className:"text-sm opacity-80",children:"استشارة مشروع"})]})]})]}),n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في طلبات الاستشارة...",value:i,onChange:j=>o(j.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("select",{value:l,onChange:j=>c(j.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:"جميع الأنواع"}),n.jsx("option",{value:"technical",children:"استشارة تقنية"}),n.jsx("option",{value:"academic",children:"استشارة أكاديمية"}),n.jsx("option",{value:"career",children:"استشارة مهنية"}),n.jsx("option",{value:"project",children:"استشارة مشروع"})]})]})}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:["عرض ",m.length," من أصل ",h.length," طلب استشارة"]})}),n.jsx("div",{className:"space-y-4",children:v.length>0?v.map(j=>n.jsxs(re.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:j.topic}),n.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:"في الانتظار"})]}),n.jsx("p",{className:"text-gray-600 mb-3",children:j.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[y(j.method),N(j.method)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(xt,{className:"w-4 h-4"}),j.duration," دقيقة"]}),j.preferredDate&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ot,{className:"w-4 h-4"}),"التاريخ المفضل: ",Ye(j.preferredDate)]})]})]}),n.jsx("button",{onClick:()=>b(j.id),disabled:d,className:"px-6 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:d?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري القبول..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Le,{className:"w-5 h-5"}),"قبول الطلب"]})})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl",children:[n.jsx(Xt,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-800",children:"الطالب"}),n.jsxs("p",{className:"text-xs text-gray-600",children:["معرف الطالب: ",j.student_id]})]})]})]},j.id)):n.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl shadow-lg",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(rr,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لا توجد طلبات استشارة"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"لم يتم العثور على طلبات استشارة تطابق معايير البحث"}),n.jsx("button",{onClick:()=>{c("all"),o("")},className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:"إعادة تعيين الفلاتر"})]})}),g>1&&n.jsx("div",{className:"flex justify-center mt-6",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>x(j=>Math.max(j-1,1)),disabled:f===1,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:n.jsx(Cn,{className:"w-5 h-5"})}),n.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:g},(j,w)=>w+1).map(j=>n.jsx("button",{onClick:()=>x(j),className:`w-8 h-8 rounded-lg ${f===j?"bg-emerald-500 text-white":"border border-gray-300 hover:bg-gray-50"}`,children:j},j))}),n.jsx("button",{onClick:()=>x(j=>Math.min(j+1,g)),disabled:f===g,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:n.jsx(fc,{className:"w-5 h-5"})})]})}),n.jsx("div",{className:"text-center mt-6",children:n.jsxs(ke,{to:"/consultant-dashboard",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:[n.jsx(Cn,{className:"w-5 h-5"}),"العودة إلى لوحة التحكم"]})})]})},Mle=()=>{const{user:e}=ut(),{consultations:t,loading:r,error:a}=Ms(),[s,i]=C.useState(new Date),[o,l]=C.useState("week"),c=t.filter(v=>v.status==="scheduled"&&v.consultant_id===(e==null?void 0:e.id)),d=v=>{switch(v){case"video":return n.jsx(ar,{className:"w-4 h-4"});case"phone":return n.jsx(Cr,{className:"w-4 h-4"});case"chat":return n.jsx(Hr,{className:"w-4 h-4"});default:return n.jsx(Hr,{className:"w-4 h-4"})}},u=v=>{switch(v){case"video":return"مكالمة فيديو";case"phone":return"مكالمة صوتية";case"chat":return"محادثة نصية";default:return v}},x=(()=>{const v=[],b=new Date(s);b.setDate(s.getDate()-s.getDay());for(let y=0;y<7;y++){const N=new Date(b);N.setDate(b.getDate()+y),v.push(N)}return v})(),p=v=>c.filter(b=>{if(!b.scheduledDate)return!1;const y=new Date(b.scheduledDate);return y.getDate()===v.getDate()&&y.getMonth()===v.getMonth()&&y.getFullYear()===v.getFullYear()}),h=()=>{const v=new Date(s);v.setDate(s.getDate()-7),i(v)},m=()=>{const v=new Date(s);v.setDate(s.getDate()+7),i(v)},g=()=>{i(new Date)};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ge,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ot,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"جدول المواعيد"}),n.jsx("p",{className:"opacity-90",children:"إدارة مواعيد الاستشارات الخاصة بك"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.length}),n.jsx("div",{className:"text-sm opacity-80",children:"استشارة مجدولة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.filter(v=>{if(!v.scheduledDate)return!1;const b=new Date;b.setHours(0,0,0,0);const y=new Date(v.scheduledDate);return y.setHours(0,0,0,0),y.getTime()===b.getTime()}).length}),n.jsx("div",{className:"text-sm opacity-80",children:"اليوم"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.filter(v=>{if(!v.scheduledDate)return!1;const b=new Date;b.setHours(0,0,0,0);const y=new Date(b);y.setDate(b.getDate()+1);const N=new Date(v.scheduledDate);return N.setHours(0,0,0,0),N.getTime()===y.getTime()}).length}),n.jsx("div",{className:"text-sm opacity-80",children:"غداً"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.filter(v=>{if(!v.scheduledDate)return!1;const b=new Date;b.setHours(0,0,0,0);const y=new Date(b);y.setDate(b.getDate()+7);const N=new Date(v.scheduledDate);return N.setHours(0,0,0,0),N.getTime()>b.getTime()&&N.getTime()<=y.getTime()}).length}),n.jsx("div",{className:"text-sm opacity-80",children:"هذا الأسبوع"})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:h,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Gl,{className:"w-5 h-5 text-gray-600"})}),n.jsx("button",{onClick:g,className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors",children:"اليوم"}),n.jsx("button",{onClick:m,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Kl,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"text-lg font-bold text-gray-800",children:[Ye(x[0])," - ",Ye(x[6])]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>l("day"),className:`px-4 py-2 rounded-lg ${o==="day"?"bg-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"يوم"}),n.jsx("button",{onClick:()=>l("week"),className:`px-4 py-2 rounded-lg ${o==="week"?"bg-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"أسبوع"}),n.jsx("button",{onClick:()=>l("month"),className:`px-4 py-2 rounded-lg ${o==="month"?"bg-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"شهر"})]})]}),o==="week"&&n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("div",{className:"grid grid-cols-7 gap-4 min-w-[800px]",children:[x.map((v,b)=>n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:`mb-2 font-medium ${v.getDate()===new Date().getDate()&&v.getMonth()===new Date().getMonth()&&v.getFullYear()===new Date().getFullYear()?"text-emerald-600":"text-gray-800"}`,children:v.toLocaleDateString("ar-SA",{weekday:"long"})}),n.jsx("div",{className:`w-10 h-10 rounded-full mx-auto flex items-center justify-center ${v.getDate()===new Date().getDate()&&v.getMonth()===new Date().getMonth()&&v.getFullYear()===new Date().getFullYear()?"bg-emerald-500 text-white":"bg-gray-100 text-gray-800"}`,children:v.getDate()})]},b)),x.map((v,b)=>n.jsx("div",{className:"mt-4 space-y-2",children:p(v).length>0?p(v).map(y=>n.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-3 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium text-emerald-800",children:y.scheduledDate&&q0(y.scheduledDate)}),n.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-600",children:[d(y.method),u(y.method)]})]}),n.jsx("h4",{className:"font-medium text-gray-800 mb-1 line-clamp-1",children:y.topic}),n.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:y.description}),n.jsx("div",{className:"mt-2 flex justify-end",children:n.jsx("button",{onClick:()=>window.open("https://meet.google.com/new","_blank"),className:"px-3 py-1 bg-emerald-500 text-white text-xs rounded-lg hover:bg-emerald-600 transition-colors",children:"بدء الاستشارة"})})]},y.id)):n.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 text-center text-gray-500 text-sm",children:"لا توجد مواعيد"})},`consultations-${b}`))]})}),o==="day"&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"text-center mb-4",children:n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:Ye(s)})}),p(s).length>0?p(s).map(v=>n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:v.topic}),n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:"مجدولة"})]}),n.jsx("p",{className:"text-gray-600 text-sm mb-2",children:v.description}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(xt,{className:"w-4 h-4"}),v.scheduledDate&&q0(v.scheduledDate)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[d(v.method),u(v.method)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(xt,{className:"w-4 h-4"}),v.duration," دقيقة"]})]})]}),n.jsx("button",{onClick:()=>window.open("https://meet.google.com/new","_blank"),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors",children:"بدء الاستشارة"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl",children:[n.jsx(Xt,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-800",children:"الطالب"}),n.jsxs("p",{className:"text-xs text-gray-600",children:["معرف الطالب: ",v.student_id]})]})]})]},v.id)):n.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ot,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد مواعيد لهذا اليوم"}),n.jsx("p",{className:"text-gray-600",children:"يمكنك قبول طلبات استشارة جديدة من صفحة طلبات الاستشارة"})]})]}),o==="month"&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ot,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"عرض الشهر قيد التطوير"}),n.jsx("p",{className:"text-gray-600",children:"يرجى استخدام عرض اليوم أو الأسبوع في الوقت الحالي"})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(xt,{className:"w-6 h-6 text-emerald-600"}),"الاستشارات القادمة"]}),c.length>0?n.jsx("div",{className:"space-y-4",children:c.filter(v=>{if(!v.scheduledDate)return!1;const b=new Date;return new Date(v.scheduledDate)>b}).sort((v,b)=>!v.scheduledDate||!b.scheduledDate?0:new Date(v.scheduledDate).getTime()-new Date(b.scheduledDate).getTime()).slice(0,3).map(v=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:v.topic}),n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:"مجدولة"})]}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ot,{className:"w-4 h-4"}),v.scheduledDate&&Ye(v.scheduledDate)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(xt,{className:"w-4 h-4"}),v.scheduledDate&&q0(v.scheduledDate)]})]})]}),n.jsx("button",{onClick:()=>window.open("https://meet.google.com/new","_blank"),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors",children:"بدء الاستشارة"})]})},v.id))}):n.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ot,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد استشارات قادمة"}),n.jsx("p",{className:"text-gray-600",children:"يمكنك قبول طلبات استشارة جديدة من صفحة طلبات الاستشارة"})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs(ke,{to:"/consultation-requests",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:["عرض طلبات الاستشارة",n.jsx(fc,{className:"w-4 h-4"})]})})]}),n.jsx("div",{className:"text-center mt-6",children:n.jsxs(ke,{to:"/consultant-dashboard",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:[n.jsx(Cn,{className:"w-5 h-5"}),"العودة إلى لوحة التحكم"]})})]})},Lle=()=>{const{user:e}=ut(),[t,r]=C.useState(!1),[a,s]=C.useState({name:(e==null?void 0:e.name)||"",bio:(e==null?void 0:e.bio)||"",phone:(e==null?void 0:e.phone)||"",specializations:(e==null?void 0:e.specializations)||[],experience:(e==null?void 0:e.experience)||"",hourlyRate:(e==null?void 0:e.hourlyRate)||0,languages:(e==null?void 0:e.languages)||[]}),[i,o]=C.useState(!1),l=["الاستشارات الهندسية","الاستشارات القانونية","الاستشارات الإدارية","الاستشارات التقنية","الاستشارات المالية","الاستشارات التسويقية","الاستشارات الطبية","الاستشارات التعليمية","الاستشارات البيئية","الاستشارات الأمنية"],c=["العربية","الإنجليزية","الفرنسية","الإسبانية","الألمانية","الصينية","اليابانية","الروسية","الهندية","البرتغالية"],d=(p,h)=>{s(m=>({...m,[p]:h}))},u=p=>{s(h=>({...h,specializations:h.specializations.includes(p)?h.specializations.filter(m=>m!==p):[...h.specializations,p]}))},f=p=>{s(h=>({...h,languages:h.languages.includes(p)?h.languages.filter(m=>m!==p):[...h.languages,p]}))},x=async()=>{o(!0),setTimeout(()=>{o(!1),r(!1)},1e3)};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:(e==null?void 0:e.avatar)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:e==null?void 0:e.name,className:"w-24 h-24 rounded-full object-cover border-4 border-white"}),n.jsx("button",{className:"absolute bottom-0 right-0 w-8 h-8 bg-white text-emerald-600 rounded-full flex items-center justify-center hover:bg-gray-100 transition-colors",children:n.jsx(Pn,{className:"w-4 h-4"})})]}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold mb-2",children:e==null?void 0:e.name}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(As,{className:"w-4 h-4"}),n.jsx("span",{children:(e==null?void 0:e.role)==="consultant"?"مستشار":e==null?void 0:e.role})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4"}),n.jsxs("span",{children:[(e==null?void 0:e.rating)||5," (",(e==null?void 0:e.reviewsCount)||0," تقييم)"]})]})]})]})]})}),n.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"lg:col-span-2",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Xt,{className:"w-6 h-6 text-emerald-600"}),"المعلومات الشخصية"]}),n.jsx("button",{onClick:()=>r(!t),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors flex items-center gap-2",children:t?n.jsxs(n.Fragment,{children:[n.jsx(Za,{className:"w-4 h-4"}),"حفظ"]}):n.jsxs(n.Fragment,{children:[n.jsx(Ia,{className:"w-4 h-4"}),"تعديل"]})})]}),t?n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الاسم الكامل"}),n.jsx("input",{type:"text",value:a.name,onChange:p=>d("name",p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نبذة مهنية"}),n.jsx("textarea",{value:a.bio,onChange:p=>d("bio",p.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"اكتب نبذة مختصرة عن خبرتك المهنية..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الهاتف"}),n.jsx("input",{type:"tel",value:a.phone,onChange:p=>d("phone",p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"05xxxxxxxx"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التخصصات"}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:l.map(p=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${a.specializations.includes(p)?"bg-emerald-50 border-emerald-500 text-emerald-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:a.specializations.includes(p),onChange:()=>u(p),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:p})]},p))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اللغات"}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:c.map(p=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${a.languages.includes(p)?"bg-emerald-50 border-emerald-500 text-emerald-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:a.languages.includes(p),onChange:()=>f(p),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:p})]},p))})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سنوات الخبرة"}),n.jsx("input",{type:"text",value:a.experience,onChange:p=>d("experience",p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"مثال: 5 سنوات"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"السعر بالساعة (ريال سعودي)"}),n.jsx("input",{type:"number",value:a.hourlyRate,onChange:p=>d("hourlyRate",parseInt(p.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"200",min:"0"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:()=>r(!1),className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"button",onClick:x,disabled:i,className:"px-6 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:i?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Za,{className:"w-5 h-5"}),"حفظ التغييرات"]})})]})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"البريد الإلكتروني"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ma,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:e==null?void 0:e.email})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"رقم الهاتف"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Cr,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:(e==null?void 0:e.phone)||"غير محدد"})]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"نبذة مهنية"}),n.jsx("p",{className:"text-gray-800 leading-relaxed",children:(e==null?void 0:e.bio)||"لا توجد نبذة مهنية. قم بتعديل ملفك الشخصي لإضافة نبذة عن خبرتك المهنية."})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"التخصصات"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:e!=null&&e.specializations&&e.specializations.length>0?e.specializations.map((p,h)=>n.jsx("span",{className:"px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full text-sm",children:p},h)):n.jsx("span",{className:"text-gray-500",children:"لم يتم تحديد تخصصات"})})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"سنوات الخبرة"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(xt,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:(e==null?void 0:e.experience)||"غير محدد"})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"السعر بالساعة"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(hu,{className:"w-5 h-5 text-gray-400"}),n.jsxs("span",{className:"text-gray-800",children:[(e==null?void 0:e.hourlyRate)||0," ر.س"]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"اللغات"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(uE,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:e!=null&&e.languages&&e.languages.length>0?e.languages.join("، "):"غير محدد"})]})]})]})]})]})}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(lr,{className:"w-5 h-5 text-emerald-600"}),"الإحصائيات"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"التقييم"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:"flex",children:[1,2,3,4,5].map(p=>n.jsx(lt,{className:`w-4 h-4 ${p<=((e==null?void 0:e.rating)||5)?"text-yellow-400 fill-current":"text-gray-300"}`},p))}),n.jsx("span",{className:"font-medium",children:(e==null?void 0:e.rating)||5})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"عدد التقييمات"}),n.jsx("span",{className:"font-medium",children:(e==null?void 0:e.reviewsCount)||0})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الاستشارات المكتملة"}),n.jsx("span",{className:"font-medium",children:"0"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"معدل الاستجابة"}),n.jsx("span",{className:"font-medium",children:"100%"})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(ot,{className:"w-5 h-5 text-emerald-600"}),"أوقات الدوام"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الأحد"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الإثنين"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الثلاثاء"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الأربعاء"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الخميس"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الجمعة"}),n.jsx("span",{className:"text-gray-400",children:"مغلق"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"السبت"}),n.jsx("span",{className:"text-gray-400",children:"مغلق"})]})]}),n.jsx("button",{className:"w-full mt-4 px-4 py-2 border border-emerald-500 text-emerald-600 rounded-lg hover:bg-emerald-50 transition-colors",children:"تعديل أوقات الدوام"})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"روابط سريعة"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("a",{href:"/consultant-dashboard",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(As,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"لوحة التحكم"})]}),n.jsxs("a",{href:"/consultation-requests",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(rr,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"طلبات الاستشارة"})]}),n.jsxs("a",{href:"/consultant-schedule",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(ot,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"جدول المواعيد"})]}),n.jsxs("a",{href:"/reviews",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(lt,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"التقييمات"})]}),n.jsxs("a",{href:"/settings",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(cr,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"الإعدادات"})]})]})]})]})]})]})},$le=()=>{const{user:e}=ut(),[t,r]=C.useState([]),[a,s]=C.useState(!0),[i,o]=C.useState(null),[l,c]=C.useState(null),[d,u]=C.useState(""),[f,x]=C.useState("latest");C.useEffect(()=>{(async()=>{if(e)try{s(!0),o(null);const b=Oe(he,"reviews"),y=Me(b,De("consultant_id","==",e.id),ol("created_at","desc"),ri(50)),N=await Ie(y);if(N.empty){r([]),s(!1);return}const j=await Promise.all(N.docs.map(async w=>{const _=w.data();let S={name:"طالب غير معروف",avatar:"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150"};if(_.student_id){const E=st(he,"users",_.student_id),A=await Dt(E);if(A.exists()){const P=A.data();S={name:P.name||"طالب غير معروف",avatar:P.avatar_url||S.avatar}}}let k={topic:"استشارة",type:"عامة",date:new Date().toISOString()};if(_.consultation_id){const E=st(he,"consultations",_.consultation_id),A=await Dt(E);if(A.exists()){const P=A.data();k={topic:P.topic||"استشارة",type:P.type||"عامة",date:P.completed_at?new Date(P.completed_at.toDate()).toISOString():new Date().toISOString()}}}return{id:w.id,consultation_id:_.consultation_id,student_id:_.student_id,consultant_id:_.consultant_id,rating:_.rating||5,feedback:_.feedback||"",created_at:_.created_at?new Date(_.created_at.toDate()).toISOString():new Date().toISOString(),student:S,consultation:k}}));r(j)}catch(b){console.error("Error fetching reviews:",b),o(b instanceof Error?b.message:"حدث خطأ في تحميل التقييمات")}finally{s(!1)}})()},[e]);const p=t.filter(v=>{var N,j;const b=l===null||v.rating===l,y=v.feedback.toLowerCase().includes(d.toLowerCase())||((N=v.student)==null?void 0:N.name.toLowerCase().includes(d.toLowerCase()))||((j=v.consultation)==null?void 0:j.topic.toLowerCase().includes(d.toLowerCase()));return b&&y}).sort((v,b)=>f==="latest"?new Date(b.created_at).getTime()-new Date(v.created_at).getTime():f==="oldest"?new Date(v.created_at).getTime()-new Date(b.created_at).getTime():f==="highest"?b.rating-v.rating:f==="lowest"?v.rating-b.rating:0),h=t.length,m=h>0?t.reduce((v,b)=>v+b.rating,0)/h:0,g=[5,4,3,2,1].map(v=>({rating:v,count:t.filter(b=>b.rating===v).length,percentage:h>0?t.filter(b=>b.rating===v).length/h*100:0}));return a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):i?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ja,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:i})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-yellow-500 to-amber-500 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(lt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"التقييمات"}),n.jsx("p",{className:"opacity-90",children:"تقييمات الطلاب لاستشاراتك"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:h}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي التقييمات"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:m.toFixed(1)}),n.jsx("div",{className:"text-sm opacity-80",children:"متوسط التقييم"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:g[0].count}),n.jsx("div",{className:"text-sm opacity-80",children:"تقييم 5 نجوم"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(v=>v.rating>=4).length}),n.jsx("div",{className:"text-sm opacity-80",children:"تقييمات إيجابية"})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"grid lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2 bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx(Ts,{className:"w-6 h-6 text-yellow-500"}),"توزيع التقييمات"]}),n.jsx("div",{className:"space-y-4",children:g.map(v=>n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-1 w-24",children:[n.jsx("span",{className:"font-medium",children:v.rating}),n.jsx(lt,{className:"w-4 h-4 text-yellow-400 fill-current"})]}),n.jsx("div",{className:"flex-1",children:n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:n.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${v.percentage}%`}})})}),n.jsx("div",{className:"w-16 text-right",children:n.jsx("span",{className:"text-sm text-gray-600",children:v.count})}),n.jsx("div",{className:"w-16 text-right",children:n.jsxs("span",{className:"text-sm text-gray-600",children:[v.percentage.toFixed(0),"%"]})})]},v.rating))})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx(di,{className:"w-6 h-6 text-yellow-500"}),"إحصائيات التقييم"]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-5xl font-bold text-gray-800 mb-2",children:m.toFixed(1)}),n.jsx("div",{className:"flex items-center justify-center gap-1 mb-2",children:[1,2,3,4,5].map(v=>n.jsx(lt,{className:`w-6 h-6 ${v<=Math.round(m)?"text-yellow-400 fill-current":"text-gray-300"}`},v))}),n.jsxs("p",{className:"text-gray-600",children:["من ",h," تقييم"]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-600",children:"نسبة الرضا"}),n.jsxs("span",{className:"font-medium text-green-600",children:[h>0?(t.filter(v=>v.rating>=4).length/h*100).toFixed(0):0,"%"]})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-600",children:"متوسط التقييم الشهري"}),n.jsx("span",{className:"font-medium text-blue-600",children:t.filter(v=>{const b=new Date(v.created_at),y=new Date;return b.getMonth()===y.getMonth()&&b.getFullYear()===y.getFullYear()}).length})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-600",children:"أعلى تقييم"}),n.jsx("span",{className:"font-medium text-yellow-600",children:"5.0"})]})]})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Hr,{className:"w-6 h-6 text-yellow-500"}),"التقييمات والمراجعات"]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في التقييمات...",value:d,onChange:v=>u(v.target.value),className:"w-64 pr-12 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]}),n.jsxs("select",{value:f,onChange:v=>x(v.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",children:[n.jsx("option",{value:"latest",children:"الأحدث"}),n.jsx("option",{value:"oldest",children:"الأقدم"}),n.jsx("option",{value:"highest",children:"الأعلى تقييماً"}),n.jsx("option",{value:"lowest",children:"الأقل تقييماً"})]})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(nl,{className:"w-5 h-5 text-gray-500"}),n.jsx("span",{className:"font-medium text-gray-700",children:"تصفية حسب التقييم:"})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("button",{onClick:()=>c(null),className:`px-4 py-2 rounded-lg transition-colors ${l===null?"bg-yellow-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"الكل"}),[5,4,3,2,1].map(v=>n.jsxs("button",{onClick:()=>c(v),className:`flex items-center gap-1 px-4 py-2 rounded-lg transition-colors ${l===v?"bg-yellow-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx("span",{children:v}),n.jsx(lt,{className:"w-4 h-4"})]},v))]})]}),n.jsx("div",{className:"space-y-6",children:p.length>0?p.map(v=>{var b,y,N,j,w,_,S,k,E,A;return n.jsxs(re.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-xl p-6 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[n.jsx("img",{src:(b=v.student)==null?void 0:b.avatar,alt:(y=v.student)==null?void 0:y.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:(N=v.student)==null?void 0:N.name}),n.jsx("p",{className:"text-sm text-gray-500",children:(j=v.consultation)==null?void 0:j.topic})]}),n.jsxs("div",{className:"flex flex-col items-end",children:[n.jsx("div",{className:"flex items-center gap-1 mb-1",children:[1,2,3,4,5].map(P=>n.jsx(lt,{className:`w-4 h-4 ${P<=v.rating?"text-yellow-400 fill-current":"text-gray-300"}`},P))}),n.jsx("span",{className:"text-xs text-gray-500",children:Ye(v.created_at)})]})]}),n.jsx("p",{className:"text-gray-700 leading-relaxed",children:v.feedback}),n.jsxs("div",{className:"flex items-center gap-4 mt-4 text-sm text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ot,{className:"w-4 h-4"}),"تاريخ الاستشارة: ",Ye(((w=v.consultation)==null?void 0:w.date)||"")]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Hr,{className:"w-4 h-4"}),"نوع الاستشارة: ",((_=v.consultation)==null?void 0:_.type)==="technical"?"تقنية":((S=v.consultation)==null?void 0:S.type)==="academic"?"أكاديمية":((k=v.consultation)==null?void 0:k.type)==="career"?"مهنية":((E=v.consultation)==null?void 0:E.type)==="project"?"مشروع":(A=v.consultation)==null?void 0:A.type]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-gray-200",children:[n.jsxs("button",{className:"flex items-center gap-1 px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:[n.jsx(cP,{className:"w-4 h-4"}),"مفيد"]}),n.jsxs("button",{className:"flex items-center gap-1 px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:[n.jsx(Hr,{className:"w-4 h-4"}),"رد"]})]})]},v.id)}):n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Hr,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد تقييمات"}),n.jsx("p",{className:"text-gray-600",children:t.length===0?"لم تتلق أي تقييمات بعد":"لم يتم العثور على تقييمات تطابق معايير البحث"}),t.length>0&&n.jsx("button",{onClick:()=>{c(null),u(""),x("latest")},className:"mt-4 px-6 py-2 bg-yellow-500 text-white rounded-xl hover:bg-yellow-600 transition-colors",children:"إعادة تعيين الفلاتر"})]})})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-gradient-to-r from-yellow-50 to-amber-50 rounded-2xl p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(lr,{className:"w-6 h-6 text-yellow-500"}),"نصائح لتحسين تقييماتك"]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"الاستماع الجيد"}),n.jsx("p",{className:"text-gray-600 text-sm",children:"استمع جيداً لاحتياجات الطالب وافهم مشكلته قبل تقديم الحلول"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"التواصل الفعال"}),n.jsx("p",{className:"text-gray-600 text-sm",children:"حافظ على تواصل واضح ومباشر، واستخدم لغة مفهومة للطالب"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"المتابعة بعد الاستشارة"}),n.jsx("p",{className:"text-gray-600 text-sm",children:"تواصل مع الطالب بعد الاستشارة للتأكد من استفادته وتقديم دعم إضافي"})]})]})]})]})},Pt={TOOL_NAME:"MyProjects Platform",INITIATE_LOGIN_URL:"https://myprojectplatform.com/api/lti/login",TARGET_LINK_URI:"https://myprojectplatform.com/lti/lanuch",JWKS_URL:"https://myprojectplatform.com/.well-known/jwks.json",CLIENT_ID:"5ee30a16-c764-47d1-8314-effae92c950a",PLATFORM_ISSUER:"https://partners.classera.com",KID:"68d8c42617d92",CLASSERA_API_DOMAIN:"https://api-stg.classera.com/",DEPLOYMENT_ID:"27",ACCEPT_TYPES:["html","ltiResourceLink","image","file","link","application/pdf"],STAGING_HOST:"partners-stg.classera.com",PRODUCTION_HOST:"me.classera.com",STAGING_ACCESS_TOKEN:"e815fcea52034d3bd84cc47fcf0bd713c6094519",PRODUCTION_ACCESS_TOKEN:"e469dc5086ef1491afaece7452ff3dd8d5e2a73a",PARTNER_NAME:"MOU",IS_PRODUCTION:window.location.hostname!=="localhost"&&!window.location.hostname.includes("staging"),get HOST(){return this.IS_PRODUCTION?this.PRODUCTION_HOST:this.STAGING_HOST},get ACCESS_TOKEN(){return this.IS_PRODUCTION?this.PRODUCTION_ACCESS_TOKEN:this.STAGING_ACCESS_TOKEN},get WEBVIEW_LOGIN_URL(){const e=encodeURIComponent(`${window.location.origin}/classera-callback.html`);return`https://${this.HOST}/users/login_webview?return_url=${e}`}},Ble=()=>({keys:[{kty:"RSA",use:"sig",kid:Pt.KID,alg:"RS256",n:"your-actual-public-key-modulus-here",e:"AQAB"}]}),Ule=()=>{var j;const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),[o,l]=C.useState(!1),[c,d]=C.useState(!1),[u,f]=C.useState(!1),[x,p]=C.useState(null);C.useEffect(()=>{const w=[{id:"batch_001",status:"completed",created_at:new Date(Date.now()-864e5).toISOString(),updated_at:new Date(Date.now()-864e5+3e5).toISOString(),schools_count:5,users_count:150},{id:"batch_002",status:"processing",created_at:new Date(Date.now()-36e5).toISOString(),updated_at:new Date(Date.now()-36e5+6e4).toISOString(),schools_count:2,users_count:75},{id:"batch_003",status:"failed",created_at:new Date(Date.now()-72e5).toISOString(),updated_at:new Date(Date.now()-72e5+12e4).toISOString(),schools_count:1,users_count:25,error_message:"Connection timeout to Classera API"}];t(w),a(!1)},[]);const h=Ble(),m=async(w,_)=>{try{await navigator.clipboard.writeText(w),p(_),setTimeout(()=>p(null),2e3)}catch(S){console.error("Failed to copy:",S)}},g=w=>{switch(w){case"completed":return n.jsx(sa,{className:"w-5 h-5 text-green-600"});case"processing":return n.jsx(xt,{className:"w-5 h-5 text-blue-600 animate-pulse"});case"failed":return n.jsx(mP,{className:"w-5 h-5 text-red-600"});default:return n.jsx(xt,{className:"w-5 h-5 text-yellow-600"})}},v=w=>{switch(w){case"completed":return"مكتمل";case"processing":return"قيد المعالجة";case"failed":return"فشل";case"pending":return"في الانتظار";default:return w}},b=w=>{switch(w){case"completed":return"bg-green-100 text-green-800";case"processing":return"bg-blue-100 text-blue-800";case"failed":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},y=async()=>{l(!0),setTimeout(()=>{l(!1)},1e3)},N=async()=>{console.log("Triggering manual sync with Classera...")};return r?n.jsx("div",{className:"flex items-center justify-center p-8",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-green-600 to-emerald-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(fa,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"تكامل Classera"}),n.jsx("p",{className:"opacity-90",children:"إدارة التكامل مع منصة Classera التعليمية (Tool Provider)"})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:y,disabled:o,className:"bg-white bg-opacity-20 text-white px-4 py-2 rounded-xl hover:bg-opacity-30 transition-all duration-200 flex items-center gap-2 disabled:opacity-50",children:[n.jsx(no,{className:`w-5 h-5 ${o?"animate-spin":""}`}),"تحديث"]}),n.jsxs("button",{onClick:N,className:"bg-white text-green-600 px-6 py-2 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(no,{className:"w-5 h-5"}),"مزامنة يدوية"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-sm opacity-80",children:"دفعات المزامنة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(w=>w.status==="completed").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مكتملة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.reduce((w,_)=>w+_.schools_count,0)}),n.jsx("div",{className:"text-sm opacity-80",children:"مدارس متزامنة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.reduce((w,_)=>w+_.users_count,0)}),n.jsx("div",{className:"text-sm opacity-80",children:"مستخدمين متزامنين"})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(dP,{className:"w-6 h-6 text-green-600"}),"إعدادات LTI Tool Provider"]}),n.jsxs("button",{onClick:()=>d(!c),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[c?"إخفاء":"عرض"," الإعدادات"]})]}),c&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Initiate Login URL"}),n.jsx("button",{onClick:()=>m(Pt.INITIATE_LOGIN_URL,"initiate"),className:"p-1 text-gray-500 hover:text-gray-700",children:x==="initiate"?n.jsx(sa,{className:"w-4 h-4 text-green-600"}):n.jsx(Vs,{className:"w-4 h-4"})})]}),n.jsx("code",{className:"text-xs bg-white p-2 rounded border block overflow-x-auto",children:Pt.INITIATE_LOGIN_URL})]}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Target Link URI"}),n.jsx("button",{onClick:()=>m(Pt.TARGET_LINK_URI,"target"),className:"p-1 text-gray-500 hover:text-gray-700",children:x==="target"?n.jsx(sa,{className:"w-4 h-4 text-green-600"}):n.jsx(Vs,{className:"w-4 h-4"})})]}),n.jsx("code",{className:"text-xs bg-white p-2 rounded border block overflow-x-auto",children:Pt.TARGET_LINK_URI})]}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"text-sm font-medium text-gray-700",children:"JWKS URL"}),n.jsx("button",{onClick:()=>m(Pt.JWKS_URL,"jwks"),className:"p-1 text-gray-500 hover:text-gray-700",children:x==="jwks"?n.jsx(sa,{className:"w-4 h-4 text-green-600"}):n.jsx(Vs,{className:"w-4 h-4"})})]}),n.jsx("code",{className:"text-xs bg-white p-2 rounded border block overflow-x-auto",children:Pt.JWKS_URL})]}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Tool Name"}),n.jsx("button",{onClick:()=>m(Pt.TOOL_NAME,"name"),className:"p-1 text-gray-500 hover:text-gray-700",children:x==="name"?n.jsx(sa,{className:"w-4 h-4 text-green-600"}):n.jsx(Vs,{className:"w-4 h-4"})})]}),n.jsx("code",{className:"text-xs bg-white p-2 rounded border block overflow-x-auto",children:Pt.TOOL_NAME})]})]}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(ba,{className:"w-5 h-5 text-blue-500 mt-1"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"معلومات مهمة للتكامل"}),n.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[n.jsx("li",{children:"• هذه هي الإعدادات الرسمية المقدمة من شركة Classera"}),n.jsxs("li",{children:["• Client ID: ",Pt.CLIENT_ID]}),n.jsxs("li",{children:["• Platform Issuer: ",Pt.PLATFORM_ISSUER]}),n.jsxs("li",{children:["• Deployment ID: ",Pt.DEPLOYMENT_ID]}),n.jsxs("li",{children:["• Partner Name: ",Pt.PARTNER_NAME]}),n.jsx("li",{children:"• تأكد من تفعيل الأذونات المطلوبة للأداة"}),n.jsx("li",{children:"• يجب إعداد JWKS بشكل صحيح للتوقيع الرقمي"}),n.jsxs("li",{children:["• البيئة الحالية: ",Pt.IS_PRODUCTION?"الإنتاج":"التطوير (Staging)"]}),n.jsxs("li",{children:["• Accept Types: ",(j=Pt.ACCEPT_TYPES)==null?void 0:j.join(", ")]}),n.jsxs("li",{children:["• API Domain: ",Pt.CLASSERA_API_DOMAIN]})]})]})]})})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.15},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(yi,{className:"w-6 h-6 text-green-600"}),"إعدادات Webview Login"]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"معلومات البيئة الحالية"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"البيئة"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Pt.IS_PRODUCTION?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:Pt.IS_PRODUCTION?"الإنتاج":"التطوير (Staging)"}),n.jsx("span",{className:"text-sm text-gray-700",children:Pt.HOST})]})]}),n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"API Domain"}),n.jsx("code",{className:"text-xs bg-white p-2 rounded border block overflow-x-auto",children:Pt.CLASSERA_API_DOMAIN})]}),n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Deployment ID"}),n.jsx("code",{className:"text-xs bg-white p-2 rounded border block",children:Pt.DEPLOYMENT_ID})]}),n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("label",{className:"text-sm text-gray-600",children:"Webview Login URL"}),n.jsx("button",{onClick:()=>m(Pt.WEBVIEW_LOGIN_URL,"webview"),className:"p-1 text-gray-500 hover:text-gray-700",children:x==="webview"?n.jsx(sa,{className:"w-4 h-4 text-green-600"}):n.jsx(Vs,{className:"w-4 h-4"})})]}),n.jsx("code",{className:"text-xs bg-white p-2 rounded border block overflow-x-auto",children:Pt.WEBVIEW_LOGIN_URL})]}),n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("label",{className:"text-sm text-gray-600",children:"Access Token"}),n.jsx("button",{onClick:()=>m(Pt.ACCESS_TOKEN,"token"),className:"p-1 text-gray-500 hover:text-gray-700",children:x==="token"?n.jsx(sa,{className:"w-4 h-4 text-green-600"}):n.jsx(Vs,{className:"w-4 h-4"})})]}),n.jsx("code",{className:"text-xs bg-white p-2 rounded border block overflow-x-auto",children:Pt.ACCESS_TOKEN})]}),n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Partner Name"}),n.jsx("code",{className:"text-xs bg-white p-2 rounded border block",children:Pt.PARTNER_NAME})]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"حسابات الاختبار"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[n.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"الحسابات المفعلة"}),n.jsxs("div",{className:"space-y-1 text-xs",children:[Pt.IS_PRODUCTION?n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:["Admin: ",n.jsx("code",{children:"Hasan4ts0004"})]}),n.jsxs("div",{children:["Student: ",n.jsx("code",{children:"hasan4s0007"})]}),n.jsxs("div",{children:["Teacher: ",n.jsx("code",{children:"Hasan4t0002"})]}),n.jsxs("div",{children:["New Student: ",n.jsx("code",{children:"LtmStdPartner"})]}),n.jsxs("div",{children:["New Teacher: ",n.jsx("code",{children:"LtmTeacherPartner"})]}),n.jsxs("div",{children:["Supervisor: ",n.jsx("code",{children:"LtmSupervisorPartner"})]})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:["Admin: ",n.jsx("code",{children:"aed2ts0001"})]}),n.jsxs("div",{children:["Student: ",n.jsx("code",{children:"aed2s1228"})]}),n.jsxs("div",{children:["Student 2: ",n.jsx("code",{children:"aed2s0003"})]}),n.jsxs("div",{children:["Teacher: ",n.jsx("code",{children:"aed2t0001"})]}),n.jsxs("div",{children:["New Student: ",n.jsx("code",{children:"LtmStdPartner"})]}),n.jsxs("div",{children:["New Teacher: ",n.jsx("code",{children:"LtmTeacherPartner"})]}),n.jsxs("div",{children:["Supervisor: ",n.jsx("code",{children:"LtmSupervisorPartner"})]})]}),n.jsxs("div",{className:"mt-2 font-medium",children:["كلمة المرور للجميع: ",n.jsx("code",{children:"Class@987"})]})]})]}),n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[n.jsx("h4",{className:"font-medium text-red-800 mb-2",children:"الحسابات المعطلة"}),n.jsx("div",{className:"space-y-1 text-xs text-red-700",children:n.jsx("div",{children:"لا تستخدم هذه الحسابات - ستظهر رسالة خطأ"})})]})]})]})]}),n.jsx("div",{className:"mt-6 flex justify-center",children:n.jsxs("a",{href:Pt.WEBVIEW_LOGIN_URL,target:"_blank",rel:"noopener noreferrer",className:"bg-white text-green-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(uP,{className:"w-5 h-5"}),"اختبار تسجيل الدخول مباشرة"]})})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(wo,{className:"w-6 h-6 text-green-600"}),"حالة التكامل"]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[n.jsx(sa,{className:"w-6 h-6 text-green-600"}),n.jsx("h3",{className:"font-semibold text-green-800",children:"Webview Login متصل"})]}),n.jsx("p",{className:"text-green-700 text-sm",children:"تسجيل الدخول عبر النافذة المنبثقة يعمل بشكل طبيعي"})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[n.jsx(no,{className:"w-6 h-6 text-blue-600"}),n.jsx("h3",{className:"font-semibold text-blue-800",children:"API التحقق"})]}),n.jsx("p",{className:"text-blue-700 text-sm",children:"API التحقق من المستخدمين متاح"})]}),n.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[n.jsx(fP,{className:"w-6 h-6 text-purple-600"}),n.jsx("h3",{className:"font-semibold text-purple-800",children:"LTI Tool Provider"})]}),n.jsx("p",{className:"text-purple-700 text-sm",children:"إعدادات الأداة جاهزة للتكامل"})]})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.25},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(ba,{className:"w-6 h-6 text-green-600"}),"JWKS (JSON Web Key Set)"]}),n.jsxs("button",{onClick:()=>f(!u),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[u?"إخفاء":"عرض"," JWKS"]})]}),u&&n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"text-sm font-medium text-gray-700",children:"JWKS JSON"}),n.jsx("button",{onClick:()=>m(JSON.stringify(h,null,2),"jwks-json"),className:"p-1 text-gray-500 hover:text-gray-700",children:x==="jwks-json"?n.jsx(sa,{className:"w-4 h-4 text-green-600"}):n.jsx(Vs,{className:"w-4 h-4"})})]}),n.jsx("pre",{className:"text-xs bg-white p-4 rounded border overflow-x-auto",children:JSON.stringify(h,null,2)}),n.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"ملاحظة: هذا مثال للتطوير. في الإنتاج، يجب إنشاء مفاتيح RSA حقيقية."})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(hP,{className:"w-6 h-6 text-green-600"}),"سجل المزامنة"]}),n.jsx("div",{className:"space-y-4",children:e.map(w=>n.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[g(w.status),n.jsxs("div",{children:[n.jsxs("h3",{className:"font-semibold text-gray-800",children:["دفعة المزامنة ",w.id]}),n.jsxs("p",{className:"text-gray-600 text-sm",children:[w.schools_count," مدارس، ",w.users_count," مستخدم"]})]})]}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${b(w.status)}`,children:v(w.status)})]}),n.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[n.jsxs("div",{children:[n.jsxs("span",{children:["بدأت: ",Ye(w.created_at)]}),w.status!=="pending"&&n.jsxs("span",{className:"mr-4",children:["انتهت: ",Ye(w.updated_at)]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"p-1 text-blue-600 hover:bg-blue-100 rounded",children:n.jsx(mr,{className:"w-4 h-4"})}),w.status==="completed"&&n.jsx("button",{className:"p-1 text-green-600 hover:bg-green-100 rounded",children:n.jsx(Mr,{className:"w-4 h-4"})})]})]}),w.error_message&&n.jsx("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(Ge,{className:"w-4 h-4 text-red-600 mt-0.5 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-red-800 text-sm font-medium",children:"خطأ في المزامنة"}),n.jsx("p",{className:"text-red-700 text-xs",children:w.error_message})]})]})})]},w.id))}),e.length===0&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(no,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد عمليات مزامنة"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم تنفيذ أي عمليات مزامنة مع Classera بعد"})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.35},className:"bg-blue-50 border border-blue-200 rounded-2xl p-6",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"دليل التكامل مع Classera (Tool Provider)"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"خطوات التكامل"}),n.jsxs("ol",{className:"space-y-2 text-gray-700",children:[n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-sm font-medium text-blue-600 mt-0.5",children:"1"}),n.jsx("span",{children:"تسجيل المنصة في Classera كـ Tool Provider"})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-sm font-medium text-blue-600 mt-0.5",children:"2"}),n.jsx("span",{children:"إعداد LTI 1.3 Tool Configuration"})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-sm font-medium text-blue-600 mt-0.5",children:"3"}),n.jsx("span",{children:"تكوين Webview Login للمصادقة"})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-sm font-medium text-blue-600 mt-0.5",children:"4"}),n.jsx("span",{children:"اختبار التكامل والمزامنة"})]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"المتطلبات التقنية"}),n.jsxs("ul",{className:"space-y-2 text-gray-700",children:[n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(sa,{className:"w-4 h-4 text-green-600"}),n.jsx("span",{children:"LTI 1.3 Tool Provider Support"})]}),n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(sa,{className:"w-4 h-4 text-green-600"}),n.jsx("span",{children:"OIDC Login Initiation"})]}),n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(sa,{className:"w-4 h-4 text-green-600"}),n.jsx("span",{children:"JWKS Endpoint للتوقيع الرقمي"})]}),n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(sa,{className:"w-4 h-4 text-green-600"}),n.jsx("span",{children:"Webview Login Integration"})]}),n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(sa,{className:"w-4 h-4 text-green-600"}),n.jsx("span",{children:"Grade Passback Support"})]})]})]})]})]})]})},qle=()=>{const[e,t]=C.useState("overview"),r=[{id:"overview",name:"نظرة عامة",icon:ug},{id:"users",name:"إدارة المستخدمين",icon:dt},{id:"projects",name:"إدارة المشاريع",icon:bt},{id:"ideas",name:"أفكار المشاريع",icon:jr},{id:"videos",name:"الفيديوهات التعليمية",icon:ar},{id:"summer-program",name:"البرنامج الصيفي",icon:ot},{id:"classera",name:"تكامل Classera",icon:fa},{id:"settings",name:"الإعدادات",icon:wo}],a=[{title:"إجمالي المستخدمين",value:"2,847",change:"+12%",trend:"up",icon:dt,color:"from-blue-500 to-blue-600"},{title:"المشاريع النشطة",value:"156",change:"+8%",trend:"up",icon:bt,color:"from-green-500 to-green-600"},{title:"أفكار المشاريع",value:"89",change:"+15%",trend:"up",icon:jr,color:"from-yellow-500 to-orange-500"},{title:"معدل النجاح",value:"94%",change:"+3%",trend:"up",icon:lr,color:"from-purple-500 to-purple-600"}],s=[{title:"إدارة أفكار المشاريع",description:"إضافة وتعديل وحذف أفكار المشاريع",icon:jr,link:"/admin/manage-project-ideas",color:"from-yellow-400 to-orange-500"},{title:"إدارة الفيديوهات التعليمية",description:"إضافة وتعديل الفيديوهات التعليمية",icon:ar,link:"/admin/manage-videos",color:"from-red-500 to-pink-500"},{title:"تسجيلات البرنامج الصيفي",description:"مراجعة وإدارة طلبات البرنامج الصيفي",icon:ot,link:"/admin/summer-program-registrations",color:"from-blue-500 to-indigo-500"},{title:"إدارة المستخدمين",description:"عرض وإدارة جميع مستخدمي المنصة",icon:dt,link:"/users",color:"from-green-500 to-emerald-500"}];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ug,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"لوحة تحكم المدير"}),n.jsx("p",{className:"opacity-90",children:"إدارة شاملة لمنصة مشروعي"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"2,847"}),n.jsx("div",{className:"text-sm opacity-80",children:"مستخدم نشط"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"156"}),n.jsx("div",{className:"text-sm opacity-80",children:"مشروع نشط"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"89"}),n.jsx("div",{className:"text-sm opacity-80",children:"فكرة مشروع"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"94%"}),n.jsx("div",{className:"text-sm opacity-80",children:"معدل النجاح"})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsx("div",{className:"border-b border-gray-200",children:n.jsx("nav",{className:"flex overflow-x-auto",children:r.map(i=>n.jsxs("button",{onClick:()=>t(i.id),className:`flex items-center gap-2 px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${e===i.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(i.icon,{className:"w-4 h-4"}),i.name]},i.id))})}),n.jsxs("div",{className:"p-6",children:[e==="overview"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:a.map((i,o)=>n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:o*.1},className:"bg-white border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-all",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("div",{className:`w-12 h-12 bg-gradient-to-r ${i.color} rounded-xl flex items-center justify-center`,children:n.jsx(i.icon,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{className:`flex items-center gap-1 text-sm font-medium ${i.trend==="up"?"text-green-600":"text-red-600"}`,children:[n.jsx(di,{className:"w-4 h-4"}),i.change]})]}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-1",children:i.value}),n.jsx("p",{className:"text-gray-600 text-sm",children:i.title})]},i.title))}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"إجراءات سريعة"}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map((i,o)=>n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:o*.1},children:n.jsxs(ke,{to:i.link,className:"block bg-white border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-all group",children:[n.jsx("div",{className:`w-14 h-14 bg-gradient-to-r ${i.color} rounded-2xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform`,children:n.jsx(i.icon,{className:"w-7 h-7 text-white"})}),n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:i.title}),n.jsx("p",{className:"text-gray-600 text-sm",children:i.description})]})},i.title))})]})]}),e==="users"&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx(dt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"إدارة المستخدمين"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"عرض وإدارة جميع مستخدمي المنصة"}),n.jsx(ke,{to:"/users",className:"px-6 py-2 bg-indigo-500 text-white rounded-xl hover:bg-indigo-600 transition-colors",children:"الذهاب إلى إدارة المستخدمين"})]}),e==="projects"&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx(bt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"إدارة المشاريع"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"عرض وإدارة جميع مشاريع المنصة"}),n.jsx(ke,{to:"/projects",className:"px-6 py-2 bg-indigo-500 text-white rounded-xl hover:bg-indigo-600 transition-colors",children:"الذهاب إلى المشاريع"})]}),e==="ideas"&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx(jr,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"إدارة أفكار المشاريع"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"إضافة وتعديل وحذف أفكار المشاريع"}),n.jsx(ke,{to:"/admin/manage-project-ideas",className:"px-6 py-2 bg-indigo-500 text-white rounded-xl hover:bg-indigo-600 transition-colors",children:"إدارة أفكار المشاريع"})]}),e==="videos"&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx(ar,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"إدارة الفيديوهات التعليمية"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"إضافة وتعديل الفيديوهات التعليمية"}),n.jsx(ke,{to:"/admin/manage-videos",className:"px-6 py-2 bg-indigo-500 text-white rounded-xl hover:bg-indigo-600 transition-colors",children:"إدارة الفيديوهات"})]}),e==="summer-program"&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx(ot,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"إدارة البرنامج الصيفي"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"مراجعة وإدارة طلبات البرنامج الصيفي"}),n.jsx(ke,{to:"/admin/summer-program-registrations",className:"px-6 py-2 bg-indigo-500 text-white rounded-xl hover:bg-indigo-600 transition-colors",children:"عرض التسجيلات"})]}),e==="classera"&&n.jsx(Ule,{}),e==="settings"&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx(wo,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"إعدادات النظام"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"إدارة إعدادات المنصة العامة"}),n.jsx(ke,{to:"/settings",className:"px-6 py-2 bg-indigo-500 text-white rounded-xl hover:bg-indigo-600 transition-colors",children:"الذهاب إلى الإعدادات"})]})]})]})]})},Wle=({isOpen:e,onClose:t,onImport:r,projectIdeas:a})=>{const[s,i]=C.useState("import"),[o,l]=C.useState(!1),[c,d]=C.useState(null),[u,f]=C.useState(null),[x,p]=C.useState([]),h=C.useRef(null);if(!e)return null;const m=b=>{var j;const y=(j=b.target.files)==null?void 0:j[0];if(!y)return;l(!0),d(null),f(null),p([]);const N=new FileReader;N.onload=w=>{var _;try{const S=(_=w.target)==null?void 0:_.result,k=Rg(S,{type:"binary"}),E=k.SheetNames[0],A=k.Sheets[E],L=Vt.sheet_to_json(A).map(R=>{const I=R.objectives?R.objectives.split(",").map(U=>U.trim()):[],D=R.materials?R.materials.split(",").map(U=>U.trim()):[],V=R.steps?R.steps.split(",").map(U=>U.trim()):[],F=R.tags?R.tags.split(",").map(U=>U.trim()):[];return{title:R.title||"",description:R.description||"",category:R.category||"stem",difficulty:R.difficulty||"beginner",duration:R.duration||"",subject:R.subject||"",image:R.image||"",objectives:I,materials:D,steps:V,tags:F}});p(L),f(`تم تحليل ${L.length} فكرة مشروع بنجاح. اضغط على "استيراد" للمتابعة.`)}catch(S){console.error("Error parsing Excel file:",S),d("حدث خطأ أثناء تحليل ملف Excel. تأكد من أن الملف بالتنسيق الصحيح.")}finally{l(!1)}},N.onerror=()=>{d("حدث خطأ أثناء قراءة الملف."),l(!1)},N.readAsBinaryString(y)},g=async()=>{if(x.length===0){d("لا توجد بيانات للاستيراد.");return}l(!0),d(null),f(null);try{await r(x),f(`تم استيراد ${x.length} فكرة مشروع بنجاح.`),p([]),h.current&&(h.current.value="")}catch(b){console.error("Error importing ideas:",b),d(b instanceof Error?b.message:"حدث خطأ أثناء استيراد الأفكار.")}finally{l(!1)}},v=()=>{l(!0),d(null),f(null);try{const b=a.map(j=>{var w,_,S,k;return{title:j.title,description:j.description,category:j.category,difficulty:j.difficulty,duration:j.duration,subject:j.subject,image:j.image,objectives:(w=j.objectives)==null?void 0:w.join(", "),materials:(_=j.materials)==null?void 0:_.join(", "),steps:(S=j.steps)==null?void 0:S.join(", "),tags:(k=j.tags)==null?void 0:k.join(", ")}}),y=Vt.json_to_sheet(b),N=Vt.book_new();Vt.book_append_sheet(N,y,"أفكار المشاريع"),wd(N,"project_ideas.xlsx"),f("تم تصدير أفكار المشاريع بنجاح.")}catch(b){console.error("Error exporting ideas:",b),d("حدث خطأ أثناء تصدير الأفكار.")}finally{l(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Yl,{className:"w-6 h-6 text-blue-600"}),"استيراد وتصدير أفكار المشاريع"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[n.jsx("button",{onClick:()=>i("import"),className:`px-4 py-2 font-medium text-sm border-b-2 ${s==="import"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"استيراد من Excel"}),n.jsx("button",{onClick:()=>i("export"),className:`px-4 py-2 font-medium text-sm border-b-2 ${s==="export"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"تصدير إلى Excel"})]}),c&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:c})]}),u&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Le,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:u})]}),s==="import"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(An,{className:"w-5 h-5 text-blue-500 mt-1"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"تنسيق ملف الاستيراد"}),n.jsxs("p",{className:"text-sm text-blue-700",children:["يجب أن يحتوي ملف Excel على الأعمدة التالية: title, description, category, difficulty, duration, subject, image, objectives, materials, steps, tags.",n.jsx("br",{}),"للحقول التي تحتوي على قائمة (objectives, materials, steps, tags)، يجب فصل العناصر بفاصلة."]})]})]}),n.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center",children:[n.jsx(Yl,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"اختر ملف Excel"}),n.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"اسحب وأفلت الملف هنا أو اضغط لاختيار ملف"}),n.jsx("input",{type:"file",ref:h,onChange:m,accept:".xlsx, .xls",className:"hidden"}),n.jsx("button",{type:"button",onClick:()=>{var b;return(b=h.current)==null?void 0:b.click()},disabled:o,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"اختيار ملف"})]}),x.length>0&&n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"ملخص البيانات المستوردة"}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsxs("p",{className:"text-gray-700",children:["عدد الأفكار: ",x.length]}),n.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto",children:n.jsx("ul",{className:"space-y-1",children:x.map((b,y)=>n.jsx("li",{className:"text-sm text-gray-600",children:b.title},y))})})]})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"button",onClick:g,disabled:o||x.length===0,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري المعالجة..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Pn,{className:"w-5 h-5"}),"استيراد"]})})]})]}),s==="export"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(An,{className:"w-5 h-5 text-blue-500 mt-1"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"معلومات التصدير"}),n.jsxs("p",{className:"text-sm text-blue-700",children:["سيتم تصدير جميع أفكار المشاريع (",a.length," فكرة) إلى ملف Excel.",n.jsx("br",{}),"يمكنك تعديل الملف وإعادة استيراده لتحديث الأفكار."]})]})]}),n.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center",children:[n.jsx(Yl,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"تصدير أفكار المشاريع"}),n.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"اضغط على الزر أدناه لتصدير جميع أفكار المشاريع إلى ملف Excel"}),n.jsx("button",{type:"button",onClick:v,disabled:o||a.length===0,className:"px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2 mx-auto disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري التصدير..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Mr,{className:"w-5 h-5"}),"تصدير إلى Excel"]})})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إغلاق"})})]})]})})},Hle=()=>{const{projectIdeas:e,loading:t,error:r,fetchProjectIdeas:a,addIdea:s,editIdea:i,removeIdea:o,incrementViews:l,incrementDownloads:c,approveIdea:d,rejectIdea:u}=qf(),[f,x]=C.useState("all"),[p,h]=C.useState("all"),[m,g]=C.useState("all"),[v,b]=C.useState(""),[y,N]=C.useState(!1),[j,w]=C.useState(!1),[_,S]=C.useState(!1),[k,E]=C.useState(!1),[A,P]=C.useState(!1),[L,R]=C.useState(null),[I,D]=C.useState(null),[V,F]=C.useState(null),[U,q]=C.useState(""),[K,T]=C.useState(!1),[O,W]=C.useState(!1),[z,te]=C.useState(!1),[ae,se]=C.useState(!1),[M,G]=C.useState(null),[ne,B]=C.useState(null),[pe,ye]=C.useState(!1),[Te,de]=C.useState(null),[xe,We]=C.useState(null),Nt=[{id:"all",name:"جميع الفئات"},{id:"stem",name:"ستيم"},{id:"entrepreneurship",name:"ريادة الأعمال"},{id:"volunteer",name:"التطوع"},{id:"ethics",name:"الأخلاق"}],_e=[{id:"all",name:"جميع المستويات"},{id:"beginner",name:"مبتدئ"},{id:"intermediate",name:"متوسط"},{id:"advanced",name:"متقدم"}],He=[{id:"all",name:"جميع الحالات",color:"bg-gray-100 text-gray-800"},{id:"pending",name:"قيد المراجعة",color:"bg-yellow-100 text-yellow-800"},{id:"approved",name:"موافق عليها",color:"bg-green-100 text-green-800"},{id:"rejected",name:"مرفوضة",color:"bg-red-100 text-red-800"}],Ft=e.filter(je=>{const yn=f==="all"||je.category===f,xs=p==="all"||je.difficulty===p,Cd=m==="all"||je.status===m,Pd=je.title.toLowerCase().includes(v.toLowerCase())||je.description.toLowerCase().includes(v.toLowerCase());return yn&&xs&&Cd&&Pd}),_r=async je=>{await s(je)},Ut=async je=>{L&&await i(L.id,je)},aa=async()=>{if(I){T(!0);try{await o(I.id),S(!1)}catch(je){console.error("Error deleting idea:",je)}finally{T(!1),D(null)}}},na=async je=>{W(!0);try{await d(je),await a()}catch(yn){console.error("Error approving idea:",yn)}finally{W(!1)}},sn=async()=>{if(!(!V||!U)){te(!0);try{await u(V.id,U),P(!1),await a()}catch(je){console.error("Error rejecting idea:",je)}finally{te(!1),F(null),q("")}}},Mt=async je=>{for(const yn of je)await s(yn)},Ma=async()=>{se(!0),G(null),B(null);try{const je=await SO();G(`تم حذف ${je} فكرة مكررة بنجاح`),await a()}catch(je){console.error("Error cleaning up duplicates:",je),B("حدث خطأ أثناء حذف الأفكار المكررة")}finally{se(!1)}},rt=async()=>{ye(!0),de(null),We(null);try{const je=e.filter(xs=>xs.status!=="approved");if(je.length===0){de("لا توجد أفكار في انتظار الموافقة"),ye(!1);return}let yn=0;for(const xs of je)await i(xs.id,{status:"approved"}),yn++;await a(),de(`تمت الموافقة على ${yn} فكرة بنجاح`)}catch(je){console.error("Error approving pending ideas:",je),We("حدث خطأ أثناء الموافقة على الأفكار")}finally{ye(!1)}},Yt=je=>{switch(je){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},xa=je=>{switch(je){case"beginner":return"مبتدئ";case"intermediate":return"متوسط";case"advanced":return"متقدم";default:return je}},fr=je=>{switch(je){case"stem":return"ستيم";case"entrepreneurship":return"ريادة الأعمال";case"volunteer":return"التطوع";case"ethics":return"الأخلاق";default:return je}},Ln=je=>{switch(je){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Ad=je=>{switch(je){case"pending":return"قيد المراجعة";case"approved":return"موافق عليها";case"rejected":return"مرفوضة";default:return je}};return t?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ge,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:r})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(jr,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"إدارة أفكار المشاريع"}),n.jsx("p",{className:"opacity-90",children:"إضافة وتعديل وحذف أفكار المشاريع"})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>E(!0),className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 flex items-center gap-2",children:[n.jsx(Yl,{className:"w-5 h-5"}),"استيراد / تصدير"]}),n.jsxs("button",{onClick:Ma,disabled:ae,className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(fE,{className:"w-5 h-5"}),ae?"جاري الحذف...":"حذف المكرر"]}),n.jsxs("button",{onClick:rt,disabled:pe,className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Le,{className:"w-5 h-5"}),pe?"جاري الموافقة...":"الموافقة على الكل"]}),n.jsxs("button",{onClick:()=>{R(null),w(!0)},className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5"}),"إضافة فكرة جديدة"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-sm opacity-80",children:"فكرة مشروع"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(je=>je.status==="pending").length}),n.jsx("div",{className:"text-sm opacity-80",children:"قيد المراجعة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(je=>je.status==="approved").length}),n.jsx("div",{className:"text-sm opacity-80",children:"موافق عليها"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(je=>je.status==="rejected").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مرفوضة"})]})]})]}),M&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(Le,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{children:M})]}),ne&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{children:ne})]}),Te&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(Le,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{children:Te})]}),xe&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{children:xe})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في أفكار المشاريع...",value:v,onChange:je=>b(je.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>N(!y),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(nl,{className:"w-5 h-5"}),"الفلاتر"]})]}),n.jsxs("div",{className:`space-y-4 ${y?"block":"hidden lg:block"}`,children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"حالة الفكرة"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:He.map(je=>n.jsx("button",{onClick:()=>g(je.id),className:`px-4 py-2 rounded-xl transition-all ${m===je.id?je.color:"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:je.name},je.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"الفئات"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Nt.map(je=>n.jsx("button",{onClick:()=>x(je.id),className:`px-4 py-2 rounded-xl transition-all ${f===je.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:je.name},je.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"مستوى الصعوبة"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:_e.map(je=>n.jsx("button",{onClick:()=>h(je.id),className:`px-4 py-2 rounded-xl transition-all ${p===je.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:je.name},je.id))})]})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:["عرض ",Ft.length," من أصل ",e.length," فكرة"]})}),n.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"العنوان"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الفئة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الصعوبة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المشاهدات"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"التنزيلات"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ الإنشاء"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Ft.map(je=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-md overflow-hidden",children:n.jsx("img",{src:je.image||"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=150",alt:je.title,className:"h-10 w-10 object-cover"})}),n.jsxs("div",{className:"mr-4",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:je.title}),n.jsx("div",{className:"text-sm text-gray-500 line-clamp-1",children:je.description})]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:fr(je.category)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${Yt(je.difficulty)}`,children:xa(je.difficulty)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${Ln(je.status)}`,children:Ad(je.status)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:je.views}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:je.downloads}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:je.created_at?Ye(je.created_at):"غير محدد"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex items-center gap-2",children:[je.status==="pending"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>na(je.id),disabled:O,className:"p-1 text-green-600 hover:text-green-900 hover:bg-green-50 rounded transition-colors",title:"موافقة",children:n.jsx(Le,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>{F(je),P(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:"رفض",children:n.jsx(un,{className:"w-5 h-5"})})]}),n.jsx("button",{onClick:()=>{R(je),w(!0)},className:"p-1 text-indigo-600 hover:text-indigo-900 hover:bg-indigo-50 rounded transition-colors",title:"تعديل",children:n.jsx(Ia,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>{D(je),S(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:"حذف",children:n.jsx(nr,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>l(je.id),className:"p-1 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded transition-colors",title:"عرض",children:n.jsx(mr,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>c(je.id),className:"p-1 text-green-600 hover:text-green-900 hover:bg-green-50 rounded transition-colors",title:"تنزيل",children:n.jsx(Mr,{className:"w-5 h-5"})})]})})]},je.id))})]})})}),Ft.length===0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12 bg-white rounded-2xl shadow-lg",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(jr,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لا توجد أفكار مشاريع"}),n.jsx("p",{className:"text-gray-600 mb-4",children:e.length===0?"لم يتم إضافة أي أفكار مشاريع بعد":"لم يتم العثور على أفكار مشاريع تطابق معايير البحث"}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs("button",{onClick:()=>{R(null),w(!0)},className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(pt,{className:"w-4 h-4"}),"إضافة فكرة جديدة"]}),e.length>0&&n.jsx("button",{onClick:()=>{x("all"),h("all"),g("all"),b("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إعادة تعيين الفلاتر"})]})]}),n.jsx(YE,{isOpen:j,onClose:()=>w(!1),onSubmit:L?Ut:_r,editingIdea:L}),n.jsx(QE,{isOpen:_,onClose:()=>S(!1),onConfirm:aa,title:(I==null?void 0:I.title)||"",isDeleting:K}),n.jsx(Wle,{isOpen:k,onClose:()=>E(!1),onImport:Mt,projectIdeas:e}),A&&V&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(un,{className:"w-6 h-6 text-red-600"}),"رفض فكرة المشروع"]}),n.jsx("button",{onClick:()=>P(!1),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(un,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700 mb-4",children:"أنت على وشك رفض فكرة المشروع التالية:"}),n.jsxs("p",{className:"font-semibold text-gray-800 mb-4",children:['"',V.title,'"']}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سبب الرفض (سيتم إرساله للمستخدم)"}),n.jsx("textarea",{value:U,onChange:je=>q(je.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"اشرح سبب رفض هذه الفكرة...",required:!0})]})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:()=>P(!1),className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:sn,disabled:z||!U.trim(),className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:z?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الرفض..."]}):n.jsxs(n.Fragment,{children:[n.jsx(un,{className:"w-5 h-5"}),"تأكيد الرفض"]})})]})]})})]})},zle=({isOpen:e,onClose:t,onSubmit:r,editingVideo:a})=>{var N;const[s,i]=C.useState({title:"",description:"",type:"video",category:"",author:"",duration:"",difficulty:"beginner",thumbnail:"",contentUrl:"",videoUrl:"",watchUrl:"",embedUrl:"",tags:[],featured:!1}),[o,l]=C.useState(""),[c,d]=C.useState(!1),[u,f]=C.useState(null),[x,p]=C.useState(null);C.useEffect(()=>{var j;i(a?{...a,tags:(j=a.tags)!=null&&j.length?a.tags:[]}:{title:"",description:"",type:"video",category:"",author:"",duration:"",difficulty:"beginner",thumbnail:"",contentUrl:"",videoUrl:"",watchUrl:"",embedUrl:"",tags:[],featured:!1}),l(""),f(null),p(null)},[a,e]);const h=[{id:"project-management",name:"إدارة المشاريع"},{id:"programming",name:"البرمجة"},{id:"design",name:"التصميم"},{id:"entrepreneurship",name:"ريادة الأعمال"},{id:"stem",name:"ستيم"},{id:"soft-skills",name:"المهارات الناعمة"},{id:"education",name:"التعليم"},{id:"intellectual-property",name:"الملكية الفكرية"}],m=[{id:"beginner",name:"مبتدئ"},{id:"intermediate",name:"متوسط"},{id:"advanced",name:"متقدم"}],g=(j,w)=>{if(i(_=>({..._,[j]:w})),j==="videoUrl"&&w)try{if(w.includes("youtube.com")||w.includes("youtu.be")){if(w.includes("embed")){const _=w.split("/").pop();_&&i(S=>({...S,watchUrl:`https://www.youtube.com/watch?v=${_}`,embedUrl:w}))}else if(w.includes("watch")){const S=new URL(w).searchParams.get("v");S&&i(k=>({...k,watchUrl:w,embedUrl:`https://www.youtube.com/embed/${S}`}))}}}catch(_){console.error("Error parsing video URL:",_)}},v=()=>{o.trim()&&(i(j=>({...j,tags:[...j.tags||[],o.trim()]})),l(""))},b=j=>{i(w=>{var _;return{...w,tags:(_=w.tags)==null?void 0:_.filter((S,k)=>k!==j)}})},y=async j=>{if(j.preventDefault(),!s.title||!s.description||!s.category||!s.author){f("يرجى ملء جميع الحقول المطلوبة");return}if(s.videoUrl&&(!s.watchUrl||!s.embedUrl))try{if(s.videoUrl.includes("youtube.com")||s.videoUrl.includes("youtu.be")){if(s.videoUrl.includes("embed")&&!s.watchUrl){const w=s.videoUrl.split("/").pop();w&&(s.watchUrl=`https://www.youtube.com/watch?v=${w}`)}else if(s.videoUrl.includes("watch")&&!s.embedUrl){const _=new URL(s.videoUrl).searchParams.get("v");_&&(s.embedUrl=`https://www.youtube.com/embed/${_}`)}}}catch(w){console.error("Error deriving video URLs:",w)}d(!0),f(null),p(null);try{await r(s),p("تم حفظ الفيديو بنجاح"),setTimeout(()=>{t()},1500)}catch(w){console.error("Error submitting video:",w),f(w instanceof Error?w.message:"حدث خطأ في حفظ الفيديو")}finally{d(!1)}};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(ar,{className:"w-6 h-6 text-emerald-600"}),a?"تعديل فيديو تعليمي":"إضافة فيديو تعليمي جديد"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),u&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Ge,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:u})]}),x&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(Le,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:x})]}),n.jsxs("form",{onSubmit:y,className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان الفيديو *"}),n.jsx("input",{type:"text",value:s.title,onChange:j=>g("title",j.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"أدخل عنوان الفيديو",required:!0})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف الفيديو *"}),n.jsx("textarea",{value:s.description,onChange:j=>g("description",j.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"اكتب وصفاً شاملاً للفيديو ومحتواه",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الفئة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(bt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:s.category,onChange:j=>g("category",j.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:"اختر الفئة"}),h.map(j=>n.jsx("option",{value:j.id,children:j.name},j.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المؤلف *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Xt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:s.author,onChange:j=>g("author",j.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"اسم المؤلف أو المقدم",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدة"}),n.jsxs("div",{className:"relative",children:[n.jsx(xt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:s.duration,onChange:j=>g("duration",j.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"مثال: 15 دقيقة"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مستوى الصعوبة"}),n.jsxs("div",{className:"relative",children:[n.jsx(xP,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("select",{value:s.difficulty||"beginner",onChange:j=>g("difficulty",j.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:m.map(j=>n.jsx("option",{value:j.id,children:j.name},j.id))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط الصورة المصغرة"}),n.jsxs("div",{className:"relative",children:[n.jsx(sl,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"url",value:s.thumbnail||"",onChange:j=>g("thumbnail",j.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"أدخل رابط الصورة المصغرة"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط الفيديو *"}),n.jsxs("div",{className:"relative",children:[n.jsx(fu,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"url",value:s.videoUrl||"",onChange:j=>g("videoUrl",j.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"أدخل رابط الفيديو (مثال: https://www.youtube.com/watch?v=...)",required:!0})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"يمكنك إدخال رابط المشاهدة العادي أو رابط التضمين"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكلمات المفتاحية"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(N=s.tags)==null?void 0:N.map((j,w)=>n.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full",children:[n.jsx("span",{children:j}),n.jsx("button",{type:"button",onClick:()=>b(w),className:"w-4 h-4 rounded-full flex items-center justify-center hover:bg-emerald-200",children:n.jsx(Qe,{className:"w-3 h-3"})})]},w))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(il,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:o,onChange:j=>l(j.target.value),onKeyPress:j=>j.key==="Enter"&&(j.preventDefault(),v()),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"أضف كلمة مفتاحية"})]}),n.jsx("button",{type:"button",onClick:v,className:"px-4 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:"إضافة"})]})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"featured",checked:s.featured||!1,onChange:j=>g("featured",j.target.checked),className:"w-4 h-4 text-emerald-600 border-gray-300 rounded focus:ring-emerald-500"}),n.jsx("label",{htmlFor:"featured",className:"ml-2 block text-sm text-gray-900",children:"عرض كفيديو مميز"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:c?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Za,{className:"w-5 h-5"}),a?"حفظ التغييرات":"إضافة الفيديو"]})})]})]})]})}):null},Vle=({isOpen:e,onClose:t,onConfirm:r,title:a,isDeleting:s})=>e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Ge,{className:"w-6 h-6 text-red-600"}),"تأكيد الحذف"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700",children:"هل أنت متأكد من حذف الفيديو التالي؟"}),n.jsxs("p",{className:"font-semibold text-gray-800 mt-2",children:['"',a,'"']}),n.jsx("p",{className:"text-red-600 text-sm mt-4",children:"هذا الإجراء لا يمكن التراجع عنه."})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:r,disabled:s,className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحذف..."]}):n.jsxs(n.Fragment,{children:[n.jsx(nr,{className:"w-5 h-5"}),"تأكيد الحذف"]})})]})]})}):null,Gle=()=>{const{resources:e,loading:t,error:r,fetchResources:a,createResource:s,updateResource:i,deleteResource:o,cleanupDuplicateResources:l}=fv(),[c,d]=C.useState([]),[u,f]=C.useState(""),[x,p]=C.useState("all"),[h,m]=C.useState(!1),[g,v]=C.useState(null),[b,y]=C.useState(!1),[N,j]=C.useState(null),[w,_]=C.useState(!1),[S,k]=C.useState(null),[E,A]=C.useState(!1),[P,L]=C.useState(null),[R,I]=C.useState(null);C.useEffect(()=>{if(e){const z=e.filter(te=>te.type==="video");d(z)}},[e]),C.useEffect(()=>{a("video")},[]);const D=[{id:"all",name:"جميع الفئات"},{id:"project-management",name:"إدارة المشاريع"},{id:"programming",name:"البرمجة"},{id:"design",name:"التصميم"},{id:"entrepreneurship",name:"ريادة الأعمال"},{id:"stem",name:"ستيم"},{id:"soft-skills",name:"المهارات الناعمة"},{id:"education",name:"التعليم"},{id:"intellectual-property",name:"الملكية الفكرية"}],V=c.filter(z=>{const te=x==="all"||z.category===x,ae=z.title.toLowerCase().includes(u.toLowerCase())||z.description.toLowerCase().includes(u.toLowerCase())||z.author.toLowerCase().includes(u.toLowerCase());return te&&ae}),F=async z=>{try{await s({...z,type:"video"}),k("تم إضافة الفيديو بنجاح"),setTimeout(()=>k(null),3e3);return}catch(te){throw console.error("Error adding video:",te),te}},U=async z=>{if(g)try{await i(g.id,{...z,type:"video"}),k("تم تحديث الفيديو بنجاح"),setTimeout(()=>k(null),3e3);return}catch(te){throw console.error("Error updating video:",te),te}},q=async()=>{if(N){_(!0);try{await o(N.id),y(!1),k("تم حذف الفيديو بنجاح"),setTimeout(()=>k(null),3e3)}catch(z){console.error("Error deleting video:",z)}finally{_(!1),j(null)}}},K=async()=>{A(!0),L(null),I(null);try{const z=await l();L(`تم حذف ${z} مورد تعليمي مكرر بنجاح`),await a("video")}catch(z){console.error("Error cleaning up duplicates:",z),I("حدث خطأ أثناء حذف الموارد المكررة")}finally{A(!1)}},T=z=>{switch(z){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},O=z=>{switch(z){case"beginner":return"مبتدئ";case"intermediate":return"متوسط";case"advanced":return"متقدم";default:return z||"غير محدد"}},W=z=>{const te=D.find(ae=>ae.id===z);return te?te.name:z};return t&&c.length===0?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ge,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:r})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ar,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"إدارة الفيديوهات التعليمية"}),n.jsx("p",{className:"opacity-90",children:"إضافة وتعديل وحذف الفيديوهات التعليمية"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:K,disabled:E,className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(fE,{className:"w-5 h-5"}),E?"جاري الحذف...":"حذف المكرر"]}),n.jsxs("button",{onClick:()=>{v(null),m(!0)},className:"bg-white text-emerald-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5"}),"إضافة فيديو جديد"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.length}),n.jsx("div",{className:"text-sm opacity-80",children:"فيديو تعليمي"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.filter(z=>z.featured).length}),n.jsx("div",{className:"text-sm opacity-80",children:"فيديو مميز"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.reduce((z,te)=>z+te.views,0).toLocaleString()}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي المشاهدات"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:D.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:"فئة"})]})]})]}),S&&n.jsxs(re.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(Le,{className:"w-6 h-6 text-green-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-green-800 mb-1",children:"تمت العملية بنجاح"}),n.jsx("p",{className:"text-green-700",children:S})]})]}),P&&n.jsxs(re.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(Le,{className:"w-6 h-6 text-green-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-green-800 mb-1",children:"تم حذف العناصر المكررة بنجاح"}),n.jsx("p",{className:"text-green-700",children:P})]})]}),R&&n.jsxs(re.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(Ge,{className:"w-6 h-6 text-red-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-red-800 mb-1",children:"حدث خطأ"}),n.jsx("p",{className:"text-red-700",children:R})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في الفيديوهات...",value:u,onChange:z=>f(z.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"الفئات"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:D.map(z=>n.jsx("button",{onClick:()=>p(z.id),className:`px-4 py-2 rounded-xl transition-all ${x===z.id?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:z.name},z.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:["عرض ",V.length," من أصل ",c.length," فيديو"]})}),n.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الفيديو"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الفئة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المؤلف"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المستوى"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المشاهدات"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ الإضافة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:V.map(z=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0 h-10 w-16 rounded-md overflow-hidden",children:n.jsx("img",{src:z.thumbnail||"https://images.pexels.com/photos/3183150/pexels-photo-3183150.jpeg?auto=compress&cs=tinysrgb&w=150",alt:z.title,className:"h-10 w-16 object-cover"})}),n.jsxs("div",{className:"mr-4",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:z.title}),n.jsx("div",{className:"text-sm text-gray-500 line-clamp-1",children:z.description})]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-emerald-100 text-emerald-800",children:W(z.category)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:z.author}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${T(z.difficulty)}`,children:O(z.difficulty)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:z.views.toLocaleString()}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Ye(z.createdAt)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>{v(z),m(!0)},className:"p-1 text-indigo-600 hover:text-indigo-900 hover:bg-indigo-50 rounded transition-colors",title:"تعديل",children:n.jsx(Ia,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>{j(z),y(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:"حذف",children:n.jsx(nr,{className:"w-5 h-5"})}),n.jsx("a",{href:z.watchUrl||z.contentUrl||"#",target:"_blank",rel:"noopener noreferrer",className:"p-1 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded transition-colors",title:"عرض",children:n.jsx(_o,{className:"w-5 h-5"})})]})})]},z.id))})]})})}),V.length===0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12 bg-white rounded-2xl shadow-lg",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ar,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لا توجد فيديوهات"}),n.jsx("p",{className:"text-gray-600 mb-4",children:c.length===0?"لم يتم إضافة أي فيديوهات تعليمية بعد":"لم يتم العثور على فيديوهات تطابق معايير البحث"}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs("button",{onClick:()=>{v(null),m(!0)},className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors flex items-center gap-2",children:[n.jsx(pt,{className:"w-4 h-4"}),"إضافة فيديو جديد"]}),c.length>0&&n.jsx("button",{onClick:()=>{p("all"),f("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إعادة تعيين الفلاتر"})]})]}),n.jsx(zle,{isOpen:h,onClose:()=>m(!1),onSubmit:g?U:F,editingVideo:g}),n.jsx(Vle,{isOpen:b,onClose:()=>y(!1),onConfirm:q,title:(N==null?void 0:N.title)||"",isDeleting:w})]})},Kle=({isOpen:e,onClose:t,registration:r})=>{const{t:a}=ft();return!e||!r?null:n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Xt,{className:"w-6 h-6 text-blue-600"}),r.fullName]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.email")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ma,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.email})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.phone")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Cr,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.phone})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.parentPhone")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Cr,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.parentPhone})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.city")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(fd,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.city})]})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.idNumber")}),n.jsx("span",{className:"text-gray-800",children:r.idNumber})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.school")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(fa,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.school})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.grade")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vi,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.grade})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.educationAdministration")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ks,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.educationAdministration})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.admin.table.status")}),n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r.status==="approved"?"bg-green-100 text-green-800":r.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:r.status==="approved"?a("summerProgram.admin.statuses.approved"):r.status==="rejected"?a("summerProgram.admin.statuses.rejected"):a("summerProgram.admin.statuses.pending")})]})]})]}),n.jsxs("div",{className:"space-y-6 mb-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:a("summerProgram.enrollmentForm.interests")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:r.interests.map(s=>n.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:s},s))})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:a("summerProgram.enrollmentForm.howDidYouHear")}),n.jsx("p",{className:"text-gray-800",children:r.howDidYouHear})]}),r.hasParticipatedBefore&&r.previousProjects&&n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:a("summerProgram.enrollmentForm.previousProjects")}),n.jsx("p",{className:"text-gray-800 whitespace-pre-line",children:r.previousProjects})]}),r.notes&&n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:a("summerProgram.enrollmentForm.notes")}),n.jsx("p",{className:"text-gray-800 whitespace-pre-line",children:r.notes})]})]}),n.jsx("div",{className:"border-t border-gray-200 pt-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"text-sm text-gray-500",children:[a("summerProgram.admin.table.submittedAt"),": ",Ye(r.createdAt.toString())]}),n.jsx("div",{className:"flex gap-2",children:n.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:a("common.close")})})]})})]})})},dg=({isOpen:e,onClose:t,onConfirm:r,title:a,message:s,confirmText:i,confirmColor:o,icon:l,isProcessing:c})=>{const{t:d}=ft();return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(re.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[l,a]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5 text-gray-600"})})]}),n.jsx("div",{className:"mb-6",children:n.jsx("p",{className:"text-gray-700",children:s})}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:d("common.cancel")}),n.jsx("button",{onClick:r,disabled:c,className:`px-6 py-3 ${o} text-white rounded-xl hover:opacity-90 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed`,children:c?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),d("common.loading")]}):n.jsxs(n.Fragment,{children:[l,i]})})]})]})}):null},Xle=()=>{const{t:e}=ft(),[t,r]=C.useState([]),[a,s]=C.useState(!0),[i,o]=C.useState(null),[l,c]=C.useState(""),[d,u]=C.useState("all"),[f,x]=C.useState("all"),[p,h]=C.useState("all"),[m,g]=C.useState("all"),[v,b]=C.useState(null),[y,N]=C.useState(!1),[j,w]=C.useState(!1),[_,S]=C.useState(!1),[k,E]=C.useState(!1),[A,P]=C.useState(null),[L,R]=C.useState(!1),[I,D]=C.useState(null),[V,F]=C.useState(null);C.useEffect(()=>{U()},[]);const U=async()=>{try{s(!0),o(null);const G=await CO();r(G)}catch(G){console.error("Error fetching summer program registrations:",G),o(G instanceof Error?G.message:"Failed to load registrations")}finally{s(!1)}},q=["all",...new Set(t.map(G=>G.city))],K=["all",...new Set(t.map(G=>G.grade))],T=["all",...new Set(t.map(G=>G.educationAdministration))],O=t.filter(G=>{const ne=d==="all"||G.status===d,B=f==="all"||G.city===f,pe=p==="all"||G.grade===p,ye=m==="all"||G.educationAdministration===m,Te=G.fullName.toLowerCase().includes(l.toLowerCase())||G.email.toLowerCase().includes(l.toLowerCase())||G.phone.includes(l)||G.school.toLowerCase().includes(l.toLowerCase());return ne&&B&&pe&&ye&&Te}),W={total:t.length,pending:t.filter(G=>G.status==="pending").length,approved:t.filter(G=>G.status==="approved").length,rejected:t.filter(G=>G.status==="rejected").length},z=G=>{b(G),N(!0)},te=async()=>{if(A){R(!0),F(null);try{await m1(A,{status:"approved"}),await U(),w(!1),D(e("summerProgram.admin.approveSuccess")),setTimeout(()=>{D(null)},3e3)}catch(G){console.error("Error approving registration:",G),F(e("summerProgram.admin.approveError"))}finally{R(!1),P(null)}}},ae=async()=>{if(A){R(!0),F(null);try{await m1(A,{status:"rejected"}),await U(),S(!1),D(e("summerProgram.admin.rejectSuccess")),setTimeout(()=>{D(null)},3e3)}catch(G){console.error("Error rejecting registration:",G),F(e("summerProgram.admin.rejectError"))}finally{R(!1),P(null)}}},se=async()=>{if(A){R(!0),F(null);try{await OO(A),await U(),E(!1),D(e("summerProgram.admin.deleteSuccess")),setTimeout(()=>{D(null)},3e3)}catch(G){console.error("Error deleting registration:",G),F(e("summerProgram.admin.deleteError"))}finally{R(!1),P(null)}}},M=()=>{try{const G=O.map(pe=>({[e("summerProgram.admin.table.name")]:pe.fullName,[e("summerProgram.admin.table.email")]:pe.email,[e("summerProgram.admin.table.phone")]:pe.phone,[e("summerProgram.enrollmentForm.parentPhone")]:pe.parentPhone,[e("summerProgram.admin.table.city")]:pe.city,[e("summerProgram.enrollmentForm.idNumber")]:pe.idNumber,[e("summerProgram.enrollmentForm.school")]:pe.school,[e("summerProgram.admin.table.grade")]:pe.grade,[e("summerProgram.admin.table.educationAdministration")]:pe.educationAdministration,[e("summerProgram.enrollmentForm.hasParticipatedBefore")]:pe.hasParticipatedBefore?e("summerProgram.enrollmentForm.yes"):e("summerProgram.enrollmentForm.no"),[e("summerProgram.enrollmentForm.previousProjects")]:pe.previousProjects||"",[e("summerProgram.enrollmentForm.interests")]:pe.interests.join(", "),[e("summerProgram.enrollmentForm.howDidYouHear")]:pe.howDidYouHear,[e("summerProgram.enrollmentForm.notes")]:pe.notes||"",[e("summerProgram.admin.table.status")]:pe.status==="approved"?e("summerProgram.admin.statuses.approved"):pe.status==="rejected"?e("summerProgram.admin.statuses.rejected"):e("summerProgram.admin.statuses.pending"),[e("summerProgram.admin.table.submittedAt")]:Ye(pe.createdAt.toString())})),ne=Vt.json_to_sheet(G),B=Vt.book_new();Vt.book_append_sheet(B,ne,"Registrations"),wd(B,"summer_program_registrations.xlsx"),D(e("summerProgram.admin.exportSuccess")),setTimeout(()=>{D(null)},3e3)}catch(G){console.error("Error exporting to Excel:",G),F(e("summerProgram.admin.exportError"))}};return a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):i?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(AlertCircle,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:i})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ot,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("summerProgram.admin.title")}),n.jsx("p",{className:"opacity-90",children:e("summerProgram.admin.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:W.total}),n.jsx("div",{className:"text-sm opacity-80",children:e("summerProgram.admin.stats.totalRegistrations")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:W.pending}),n.jsx("div",{className:"text-sm opacity-80",children:e("summerProgram.admin.stats.pendingReview")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:W.approved}),n.jsx("div",{className:"text-sm opacity-80",children:e("summerProgram.admin.stats.approved")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:W.rejected}),n.jsx("div",{className:"text-sm opacity-80",children:e("summerProgram.admin.stats.rejected")})]})]})]}),I&&n.jsxs(re.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(Le,{className:"w-6 h-6 text-green-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-green-800 mb-1",children:e("common.success")}),n.jsx("p",{className:"text-green-700",children:I})]})]}),V&&n.jsxs(re.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(AlertCircle,{className:"w-6 h-6 text-red-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-red-800 mb-1",children:e("common.error")}),n.jsx("p",{className:"text-red-700",children:V})]})]}),n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("summerProgram.admin.searchPlaceholder"),value:l,onChange:G=>c(G.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:M,className:"px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2",children:[n.jsx(Mr,{className:"w-5 h-5"}),e("summerProgram.admin.actions.export")]})]}),n.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.admin.filters.status")}),n.jsxs("select",{value:d,onChange:G=>u(G.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("summerProgram.admin.statuses.all")}),n.jsx("option",{value:"pending",children:e("summerProgram.admin.statuses.pending")}),n.jsx("option",{value:"approved",children:e("summerProgram.admin.statuses.approved")}),n.jsx("option",{value:"rejected",children:e("summerProgram.admin.statuses.rejected")})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.admin.filters.city")}),n.jsxs("select",{value:f,onChange:G=>x(G.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("common.all")}),q.filter(G=>G!=="all").map(G=>n.jsx("option",{value:G,children:G},G))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.admin.filters.grade")}),n.jsxs("select",{value:p,onChange:G=>h(G.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("common.all")}),K.filter(G=>G!=="all").map(G=>n.jsx("option",{value:G,children:G},G))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.admin.filters.educationAdministration")}),n.jsxs("select",{value:m,onChange:G=>g(G.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("common.all")}),T.filter(G=>G!=="all").map(G=>n.jsx("option",{value:G,children:G},G))]})]})]})]}),n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.name")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.email")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.phone")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.city")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.grade")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.educationAdministration")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.status")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.submittedAt")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.actions")})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:O.map(G=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:n.jsx(Xt,{className:"h-6 w-6 text-blue-600"})}),n.jsx("div",{className:"mr-4",children:n.jsx("div",{className:"text-sm font-medium text-gray-900",children:G.fullName})})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:G.email})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:G.phone})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:G.city})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:G.grade})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:G.educationAdministration})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${G.status==="approved"?"bg-green-100 text-green-800":G.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:G.status==="approved"?e("summerProgram.admin.statuses.approved"):G.status==="rejected"?e("summerProgram.admin.statuses.rejected"):e("summerProgram.admin.statuses.pending")})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Ye(G.createdAt.toString())}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>z(G),className:"p-1 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded transition-colors",title:e("summerProgram.admin.actions.view"),children:n.jsx(mr,{className:"w-5 h-5"})}),G.status==="pending"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>{P(G.id),w(!0)},className:"p-1 text-green-600 hover:text-green-900 hover:bg-green-50 rounded transition-colors",title:e("summerProgram.admin.actions.approve"),children:n.jsx(Le,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>{P(G.id),S(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:e("summerProgram.admin.actions.reject"),children:n.jsx(un,{className:"w-5 h-5"})})]}),n.jsx("button",{onClick:()=>{P(G.id),E(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:e("summerProgram.admin.actions.delete"),children:n.jsx(nr,{className:"w-5 h-5"})})]})})]},G.id))})]})})}),O.length===0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12 bg-white rounded-2xl shadow-lg",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(cr,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("summerProgram.admin.noRegistrations")}),n.jsx("p",{className:"text-gray-600 mb-4",children:t.length===0?e("summerProgram.admin.noRegistrations"):e("summerProgram.admin.noRegistrationsMatch")}),t.length>0&&n.jsx("button",{onClick:()=>{u("all"),x("all"),h("all"),g("all"),c("")},className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("common.resetFilters")})]}),n.jsx(Kle,{isOpen:y,onClose:()=>N(!1),registration:v}),n.jsx(dg,{isOpen:j,onClose:()=>w(!1),onConfirm:te,title:e("summerProgram.admin.approveConfirmation"),message:e("summerProgram.admin.approveConfirmation"),confirmText:e("summerProgram.admin.actions.approve"),confirmColor:"bg-green-500 hover:bg-green-600",icon:n.jsx(Le,{className:"w-5 h-5"}),isProcessing:L}),n.jsx(dg,{isOpen:_,onClose:()=>S(!1),onConfirm:ae,title:e("summerProgram.admin.rejectConfirmation"),message:e("summerProgram.admin.rejectConfirmation"),confirmText:e("summerProgram.admin.actions.reject"),confirmColor:"bg-red-500 hover:bg-red-600",icon:n.jsx(un,{className:"w-5 h-5"}),isProcessing:L}),n.jsx(dg,{isOpen:k,onClose:()=>E(!1),onConfirm:se,title:e("summerProgram.admin.deleteConfirmation"),message:e("summerProgram.admin.deleteConfirmation"),confirmText:e("summerProgram.admin.actions.delete"),confirmColor:"bg-red-500 hover:bg-red-600",icon:n.jsx(nr,{className:"w-5 h-5"}),isProcessing:L})]})},Yle=[{id:"all",name:"الكل",icon:wt},{id:"projects",name:"المشاريع",icon:cr},{id:"ideas",name:"أفكار المشاريع",icon:jr},{id:"resources",name:"المصادر التعليمية",icon:bt},{id:"store",name:"المتجر",icon:zr},{id:"consultants",name:"المستشارين",icon:dt}],Jle=()=>{const{t:e}=ft(),t=nv(),a=new URLSearchParams(t.search).get("q")||"",[s,i]=C.useState("all"),[o,l]=C.useState(!0),[c,d]=C.useState(null),{projects:u}=Ii(),{storeItems:f}=Wf(),{resources:x}=fv(),{consultants:p}=Ms(),{projectIdeas:h}=qf();C.useEffect(()=>{u&&f&&x&&p&&h&&l(!1)},[u,f,x,p,h]);const m=u.filter(E=>E.title.toLowerCase().includes(a.toLowerCase())||E.description.toLowerCase().includes(a.toLowerCase())),g=h.filter(E=>{var A;return E.title.toLowerCase().includes(a.toLowerCase())||E.description.toLowerCase().includes(a.toLowerCase())||((A=E.tags)==null?void 0:A.some(P=>P.toLowerCase().includes(a.toLowerCase())))}),v=x.filter(E=>E.title.toLowerCase().includes(a.toLowerCase())||E.description.toLowerCase().includes(a.toLowerCase())||E.tags.some(A=>A.toLowerCase().includes(a.toLowerCase()))),b=f.filter(E=>{var A;return E.name.toLowerCase().includes(a.toLowerCase())||E.description.toLowerCase().includes(a.toLowerCase())||((A=E.tags)==null?void 0:A.some(P=>P.toLowerCase().includes(a.toLowerCase())))}),y=p.filter(E=>E.name.toLowerCase().includes(a.toLowerCase())||E.title.toLowerCase().includes(a.toLowerCase())||E.specialties.some(A=>A.toLowerCase().includes(a.toLowerCase()))),j=(()=>{switch(s){case"projects":return{projects:m,ideas:[],resources:[],storeItems:[],consultants:[]};case"ideas":return{projects:[],ideas:g,resources:[],storeItems:[],consultants:[]};case"resources":return{projects:[],ideas:[],resources:v,storeItems:[],consultants:[]};case"store":return{projects:[],ideas:[],resources:[],storeItems:b,consultants:[]};case"consultants":return{projects:[],ideas:[],resources:[],storeItems:[],consultants:y};default:return{projects:m,ideas:g,resources:v,storeItems:b,consultants:y}}})(),w=j.projects.length+j.ideas.length+j.resources.length+j.storeItems.length+j.consultants.length,_=E=>{switch(E){case"stem":return"العلوم والتقنية";case"entrepreneurship":return"ريادة الأعمال";case"volunteer":return"التطوع";case"ethics":return"الأخلاق";default:return E}},S=E=>{switch(E){case"beginner":return"مبتدئ";case"intermediate":return"متوسط";case"advanced":return"متقدم";default:return E}},k=E=>{switch(E){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return o?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):c?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ge,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:c})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(wt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"نتائج البحث"}),n.jsxs("p",{className:"opacity-90",children:['نتائج البحث عن: "',a,'"']})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:w}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي النتائج"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:j.projects.length}),n.jsx("div",{className:"text-sm opacity-80",children:"مشروع"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:j.ideas.length}),n.jsx("div",{className:"text-sm opacity-80",children:"فكرة مشروع"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:j.resources.length+j.storeItems.length+j.consultants.length}),n.jsx("div",{className:"text-sm opacity-80",children:"نتائج أخرى"})]})]})]}),n.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:n.jsx("div",{className:"flex flex-wrap gap-2",children:Yle.map(E=>n.jsxs("button",{onClick:()=>i(E.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${s===E.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(E.icon,{className:"w-4 h-4"}),E.name]},E.id))})}),n.jsxs("div",{className:"space-y-8",children:[(s==="all"||s==="projects")&&j.projects.length>0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(cr,{className:"w-5 h-5 text-blue-600"}),"المشاريع (",j.projects.length,")"]}),n.jsx(ke,{to:"/projects",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[j.projects.slice(0,5).map(E=>n.jsx(ke,{to:`/projects/${E.id}`,className:"block border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:E.title}),n.jsx("p",{className:"text-gray-600 line-clamp-2",children:E.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500",children:[n.jsxs("span",{children:["الحالة: ",E.status==="active"?"نشط":E.status==="completed"?"مكتمل":E.status==="draft"?"مسودة":"مؤرشف"]}),n.jsxs("span",{children:["التقدم: ",E.progress,"/10"]}),E.due_date&&n.jsxs("span",{children:["تاريخ الاستحقاق: ",Ye(E.due_date)]})]})]}),n.jsx("div",{className:"flex flex-col items-end",children:n.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:"مشروع"})})]})},E.id)),j.projects.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(ke,{to:`/projects?search=${encodeURIComponent(a)}`,className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من المشاريع (",j.projects.length-5,")"]})})]})]}),(s==="all"||s==="ideas")&&j.ideas.length>0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(jr,{className:"w-5 h-5 text-yellow-600"}),"أفكار المشاريع (",j.ideas.length,")"]}),n.jsx(ke,{to:"/project-ideas",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[j.ideas.slice(0,5).map(E=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:E.title}),n.jsx("p",{className:"text-gray-600 line-clamp-2",children:E.description}),n.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-lg",children:_(E.category)}),n.jsx("span",{className:`px-2 py-1 text-xs rounded-lg ${k(E.difficulty)}`,children:S(E.difficulty)}),E.tags&&E.tags.slice(0,2).map((A,P)=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["#",A]},P))]})]}),n.jsx("div",{className:"flex flex-col items-end",children:n.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:"فكرة مشروع"})})]})},E.id)),j.ideas.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(ke,{to:"/project-ideas",className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من أفكار المشاريع (",j.ideas.length-5,")"]})})]})]}),(s==="all"||s==="resources")&&j.resources.length>0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(bt,{className:"w-5 h-5 text-emerald-600"}),"المصادر التعليمية (",j.resources.length,")"]}),n.jsx(ke,{to:"/resources",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[j.resources.slice(0,5).map(E=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:n.jsx("img",{src:E.thumbnail||"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=150",alt:E.title,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:E.title}),n.jsx("span",{className:"px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full text-xs font-medium",children:E.type==="video"?"فيديو":E.type==="article"?"مقالة":E.type==="course"?"دورة":E.type==="template"?"قالب":E.type==="podcast"?"بودكاست":"مصدر تعليمي"})]}),n.jsx("p",{className:"text-gray-600 line-clamp-2",children:E.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-3 h-3 text-yellow-400 fill-current"}),n.jsx("span",{children:E.rating})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(mr,{className:"w-3 h-3"}),n.jsxs("span",{children:[E.views," مشاهدة"]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(xt,{className:"w-3 h-3"}),n.jsx("span",{children:E.duration||"15 دقيقة"})]})]})]})]})},E.id)),j.resources.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(ke,{to:"/resources",className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من المصادر التعليمية (",j.resources.length-5,")"]})})]})]}),(s==="all"||s==="store")&&j.storeItems.length>0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.5},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(zr,{className:"w-5 h-5 text-purple-600"}),"المتجر (",j.storeItems.length,")"]}),n.jsx(ke,{to:"/store",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[j.storeItems.slice(0,5).map(E=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:n.jsx("img",{src:E.image,alt:E.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:E.name}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xl font-bold text-purple-600",children:[E.price," ر.س"]}),E.originalPrice&&n.jsxs("span",{className:"text-sm text-gray-400 line-through",children:[E.originalPrice," ر.س"]})]})]}),n.jsx("p",{className:"text-gray-600 line-clamp-2",children:E.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-3 h-3 text-yellow-400 fill-current"}),n.jsxs("span",{children:[E.rating," (",E.reviews," تقييم)"]})]}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${E.inStock?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:E.inStock?"متوفر":"غير متوفر"})]})]})]})},E.id)),j.storeItems.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(ke,{to:"/store",className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من المنتجات (",j.storeItems.length-5,")"]})})]})]}),(s==="all"||s==="consultants")&&j.consultants.length>0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(dt,{className:"w-5 h-5 text-emerald-600"}),"المستشارين (",j.consultants.length,")"]}),n.jsx(ke,{to:"/search",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[j.consultants.slice(0,5).map(E=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden flex-shrink-0",children:n.jsx("img",{src:E.avatar,alt:E.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:E.name}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsxs("span",{children:[E.rating," (",E.reviews," تقييم)"]})]})]}),n.jsx("p",{className:"text-gray-600",children:E.title}),n.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[E.specialties.slice(0,3).map((A,P)=>n.jsx("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-800 text-xs rounded-lg",children:A},P)),E.specialties.length>3&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",E.specialties.length-3]})]})]})]})},E.id)),j.consultants.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(ke,{to:"/search",className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من المستشارين (",j.consultants.length-5,")"]})})]})]}),w===0&&n.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-8 text-center",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(wt,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لم يتم العثور على نتائج"}),n.jsxs("p",{className:"text-gray-600 mb-4",children:['لم يتم العثور على نتائج تطابق "',a,'"']}),n.jsx("p",{className:"text-gray-500 text-sm mb-6",children:"حاول تغيير كلمات البحث أو البحث في فئة محددة"}),n.jsx("div",{className:"flex justify-center gap-4",children:n.jsx(ke,{to:"/",className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"العودة للرئيسية"})})]})]}),!1]})},yt=({children:e,allowedRoles:t=[]})=>{const{user:r,loading:a}=ut();return a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):r?r.status==="pending"?n.jsx(Wn,{to:"/pending-activation"}):t.length>0&&!t.includes(r.role)?n.jsx(Wn,{to:"/home"}):n.jsx(LO,{children:e}):n.jsx(Wn,{to:"/login"})},Qle=()=>{const{user:e,loading:t}=ut();return t?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-48 w-48 border-b-2 border-blue-500"})}):n.jsxs(vP,{children:[n.jsx(at,{path:"/",element:e?n.jsx(Wn,{to:"/home"}):n.jsx(WO,{})}),n.jsx(at,{path:"/login",element:e?n.jsx(Wn,{to:"/home"}):n.jsx(BO,{})}),n.jsx(at,{path:"/register",element:e?n.jsx(Wn,{to:"/home"}):n.jsx(UO,{})}),n.jsx(at,{path:"/auth/classera",element:e?n.jsx(Wn,{to:"/home"}):n.jsx(W8,{})}),n.jsx(at,{path:"/lti/callback",element:n.jsx(H8,{})}),n.jsx(at,{path:"/pending-activation",element:e?e.status!=="pending"?n.jsx(Wn,{to:"/"}):n.jsx(HO,{}):n.jsx(Wn,{to:"/login"})}),n.jsx(at,{path:"/summer-program-enrollment",element:n.jsx(q8,{})}),n.jsx(at,{path:"/home",element:n.jsx(yt,{children:n.jsx(qO,{})})}),n.jsx(at,{path:"/search-results",element:n.jsx(yt,{children:n.jsx(Jle,{})})}),n.jsx(at,{path:"/project-ideas",element:n.jsx(yt,{children:n.jsx(DF,{})})}),n.jsx(at,{path:"/projects",element:n.jsx(yt,{children:n.jsx(J8,{})})}),n.jsx(at,{path:"/projects/:id",element:n.jsx(yt,{children:n.jsx(OF,{})})}),n.jsx(at,{path:"/projects/new",element:n.jsx(yt,{children:n.jsx(IF,{})})}),n.jsx(at,{path:"/projects/:id/edit",element:n.jsx(yt,{children:n.jsx(FF,{})})}),n.jsx(at,{path:"/gallery",element:n.jsx(yt,{children:n.jsx(RF,{})})}),n.jsx(at,{path:"/store",element:n.jsx(yt,{children:n.jsx(BF,{})})}),n.jsx(at,{path:"/cart",element:n.jsx(yt,{children:n.jsx(UF,{})})}),n.jsx(at,{path:"/checkout",element:n.jsx(yt,{children:n.jsx(qF,{})})}),n.jsx(at,{path:"/ai-assistant",element:n.jsx(yt,{children:n.jsx(VF,{})})}),n.jsx(at,{path:"/resources",element:n.jsx(yt,{children:n.jsx(GF,{})})}),n.jsx(at,{path:"/intellectual-property",element:n.jsx(yt,{children:n.jsx(YF,{})})}),n.jsx(at,{path:"/consultations",element:n.jsx(yt,{children:n.jsx(G8,{})})}),n.jsx(at,{path:"/my-consultations",element:n.jsx(yt,{children:n.jsx(K8,{})})}),n.jsx(at,{path:"/create-consultation-request",element:n.jsx(yt,{children:n.jsx(X8,{})})}),n.jsx(at,{path:"/consultant-dashboard",element:n.jsx(yt,{allowedRoles:["consultant"],children:n.jsx(Dle,{})})}),n.jsx(at,{path:"/consultation-requests",element:n.jsx(yt,{allowedRoles:["consultant"],children:n.jsx(Rle,{})})}),n.jsx(at,{path:"/consultant-schedule",element:n.jsx(yt,{allowedRoles:["consultant"],children:n.jsx(Mle,{})})}),n.jsx(at,{path:"/consultant-profile",element:n.jsx(yt,{allowedRoles:["consultant"],children:n.jsx(Lle,{})})}),n.jsx(at,{path:"/reviews",element:n.jsx(yt,{allowedRoles:["consultant"],children:n.jsx($le,{})})}),n.jsx(at,{path:"/search",element:n.jsx(yt,{children:n.jsx(Ile,{})})}),n.jsx(at,{path:"/favorites",element:n.jsx(yt,{children:n.jsx(Fle,{})})}),n.jsx(at,{path:"/students",element:n.jsx(yt,{allowedRoles:["teacher","school","admin"],children:n.jsx(ow,{})})}),n.jsx(at,{path:"/reports",element:n.jsx(yt,{allowedRoles:["teacher","school","admin"],children:n.jsx(Ole,{})})}),n.jsx(at,{path:"/admin-dashboard",element:n.jsx(yt,{allowedRoles:["admin"],children:n.jsx(qle,{})})}),n.jsx(at,{path:"/admin/manage-project-ideas",element:n.jsx(yt,{allowedRoles:["admin"],children:n.jsx(Hle,{})})}),n.jsx(at,{path:"/admin/manage-videos",element:n.jsx(yt,{allowedRoles:["admin"],children:n.jsx(Gle,{})})}),n.jsx(at,{path:"/admin/summer-program-registrations",element:n.jsx(yt,{allowedRoles:["admin"],children:n.jsx(Xle,{})})}),n.jsx(at,{path:"/users",element:n.jsx(yt,{allowedRoles:["admin","school"],children:n.jsx(ow,{})})}),n.jsx(at,{path:"/settings",element:n.jsx(yt,{children:n.jsx(Y8,{})})})]})};function Zle(){return C.useEffect(()=>{document.documentElement.dir=wr.language==="ar"?"rtl":"ltr",document.documentElement.lang=wr.language},[wr.language]),n.jsx(IO,{children:n.jsx(FO,{children:n.jsx(yP,{children:n.jsx("div",{className:"min-h-screen bg-gray-50",children:n.jsx(Qle,{})})})})})}UP.createRoot(document.getElementById("root")).render(n.jsx(C.StrictMode,{children:n.jsx(aO,{i18n:wr,children:n.jsx(Zle,{})})}));
